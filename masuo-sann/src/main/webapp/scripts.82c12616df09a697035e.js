var PIXI;!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PIXI=t()}(function(){return function t(e,i,r){function n(o,s){if(!i[o]){if(!e[o]){var h="function"==typeof require&&require;if(!s&&h)return h(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){return n(e[o][1][t]||t)},u,u.exports,t,e,i,r)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(t,e,i){var r=new ArrayBuffer(0),n=function(t,e,i,n){this.gl=t,this.buffer=t.createBuffer(),this.type=e||t.ARRAY_BUFFER,this.drawType=n||t.STATIC_DRAW,this.data=r,i&&this.upload(i),this._updateID=0};n.prototype.upload=function(t,e,i){i||this.bind();var r=this.gl;e=e||0,this.data.byteLength>=(t=t||this.data).byteLength?r.bufferSubData(this.type,e,t):r.bufferData(this.type,t,this.drawType),this.data=t},n.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},n.createVertexBuffer=function(t,e,i){return new n(t,t.ARRAY_BUFFER,e,i)},n.createIndexBuffer=function(t,e,i){return new n(t,t.ELEMENT_ARRAY_BUFFER,e,i)},n.create=function(t,e,i,r){return new n(t,e,i,r)},n.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=n},{}],2:[function(t,e,i){var r=t("./GLTexture"),n=function(t,e,i){this.gl=t,this.framebuffer=t.createFramebuffer(),this.stencil=null,this.texture=null,this.width=e||100,this.height=i||100};n.prototype.enableTexture=function(t){var e=this.gl;this.texture=t||new r(e),this.texture.bind(),this.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.texture,0)},n.prototype.enableStencil=function(){if(!this.stencil){var t=this.gl;this.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencil),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height)}},n.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),this.bind(),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},n.prototype.bind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer)},n.prototype.unbind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},n.prototype.resize=function(t,e){var i=this.gl;this.width=t,this.height=e,this.texture&&this.texture.uploadData(null,t,e),this.stencil&&(i.bindRenderbuffer(i.RENDERBUFFER,this.stencil),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e))},n.prototype.destroy=function(){var t=this.gl;this.texture&&this.texture.destroy(),t.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},n.createRGBA=function(t,e,i,a){var o=r.fromData(t,null,e,i);o.enableNearestScaling(),o.enableWrapClamp();var s=new n(t,e,i);return s.enableTexture(o),s.unbind(),s},n.createFloat32=function(t,e,i,a){var o=new r.fromData(t,a,e,i);o.enableNearestScaling(),o.enableWrapClamp();var s=new n(t,e,i);return s.enableTexture(o),s.unbind(),s},e.exports=n},{"./GLTexture":4}],3:[function(t,e,i){var r=t("./shader/compileProgram"),n=t("./shader/extractAttributes"),a=t("./shader/extractUniforms"),o=t("./shader/setPrecision"),s=t("./shader/generateUniformAccessObject"),h=function(t,e,i,h,c){this.gl=t,h&&(e=o(e,h),i=o(i,h)),this.program=r(t,e,i,c),this.attributes=n(t,this.program),this.uniformData=a(t,this.program),this.uniforms=s(t,this.uniformData)};h.prototype.bind=function(){this.gl.useProgram(this.program)},h.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null,this.gl.deleteProgram(this.program)},e.exports=h},{"./shader/compileProgram":9,"./shader/extractAttributes":11,"./shader/extractUniforms":12,"./shader/generateUniformAccessObject":13,"./shader/setPrecision":17}],4:[function(t,e,i){var r=function(t,e,i,r,n){this.gl=t,this.texture=t.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=e||-1,this.height=i||-1,this.format=r||t.RGBA,this.type=n||t.UNSIGNED_BYTE};r.prototype.upload=function(t){this.bind();var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var i=t.videoWidth||t.width,r=t.videoHeight||t.height;r!==this.height||i!==this.width?e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,t):e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.format,this.type,t),this.width=i,this.height=r};var n=!1;r.prototype.uploadData=function(t,e,i){this.bind();var r=this.gl;if(t instanceof Float32Array){if(!n){if(!r.getExtension("OES_texture_float"))throw new Error("floating point textures not available");n=!0}this.type=r.FLOAT}else this.type=this.type||r.UNSIGNED_BYTE;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e!==this.width||i!==this.height?r.texImage2D(r.TEXTURE_2D,0,this.format,e,i,0,this.format,this.type,t||null):r.texSubImage2D(r.TEXTURE_2D,0,0,0,e,i,this.format,this.type,t||null),this.width=e,this.height=i},r.prototype.bind=function(t){var e=this.gl;void 0!==t&&e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},r.prototype.unbind=function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,null)},r.prototype.minFilter=function(t){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,this.mipmap?t?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST:t?e.LINEAR:e.NEAREST)},r.prototype.magFilter=function(t){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t?e.LINEAR:e.NEAREST)},r.prototype.enableMipmap=function(){var t=this.gl;this.bind(),this.mipmap=!0,t.generateMipmap(t.TEXTURE_2D)},r.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},r.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},r.prototype.enableWrapClamp=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},r.prototype.enableWrapRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)},r.prototype.enableWrapMirrorRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.MIRRORED_REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.MIRRORED_REPEAT)},r.prototype.destroy=function(){this.gl.deleteTexture(this.texture)},r.fromSource=function(t,e,i){var n=new r(t);return n.premultiplyAlpha=i||!1,n.upload(e),n},r.fromData=function(t,e,i,n){var a=new r(t);return a.uploadData(e,i,n),a},e.exports=r},{}],5:[function(t,e,i){var r=t("./setVertexAttribArrays");function n(t,e){if(this.nativeVaoExtension=null,n.FORCE_NATIVE||(this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=e,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var i=t.getParameter(t.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(i),attribState:new Array(i)}}this.gl=t,this.attributes=[],this.indexBuffer=null,this.dirty=!1}n.prototype.constructor=n,e.exports=n,n.FORCE_NATIVE=!1,n.prototype.bind=function(){return this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate(),this},n.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},n.prototype.activate=function(){for(var t=this.gl,e=null,i=0;i<this.attributes.length;i++){var n=this.attributes[i];e!==n.buffer&&(n.buffer.bind(),e=n.buffer),t.vertexAttribPointer(n.attribute.location,n.attribute.size,n.type||t.FLOAT,n.normalized||!1,n.stride||0,n.start||0)}return r(t,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},n.prototype.addAttribute=function(t,e,i,r,n,a){return this.attributes.push({buffer:t,attribute:e,location:e.location,type:i||this.gl.FLOAT,normalized:r||!1,stride:n||0,start:a||0}),this.dirty=!0,this},n.prototype.addIndex=function(t){return this.indexBuffer=t,this.dirty=!0,this},n.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},n.prototype.draw=function(t,e,i){var r=this.gl;return this.indexBuffer?r.drawElements(t,e||this.indexBuffer.data.length,r.UNSIGNED_SHORT,2*(i||0)):r.drawArrays(t,i,e||this.getSize()),this},n.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},n.prototype.getSize=function(){var t=this.attributes[0];return t.buffer.data.length/(t.stride/4||t.attribute.size)}},{"./setVertexAttribArrays":8}],6:[function(t,e,i){e.exports=function(t,e){var i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!i)throw new Error("This browser does not support webGL. Try using the canvas renderer");return i}},{}],7:[function(t,e,i){var r={createContext:t("./createContext"),setVertexAttribArrays:t("./setVertexAttribArrays"),GLBuffer:t("./GLBuffer"),GLFramebuffer:t("./GLFramebuffer"),GLShader:t("./GLShader"),GLTexture:t("./GLTexture"),VertexArrayObject:t("./VertexArrayObject"),shader:t("./shader")};void 0!==e&&e.exports&&(e.exports=r),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=r)},{"./GLBuffer":1,"./GLFramebuffer":2,"./GLShader":3,"./GLTexture":4,"./VertexArrayObject":5,"./createContext":6,"./setVertexAttribArrays":8,"./shader":14}],8:[function(t,e,i){e.exports=function(t,e,i){var r;if(i){var n=i.tempAttribState,a=i.attribState;for(r=0;r<n.length;r++)n[r]=!1;for(r=0;r<e.length;r++)n[e[r].attribute.location]=!0;for(r=0;r<a.length;r++)a[r]!==n[r]&&(a[r]=n[r],i.attribState[r]?t.enableVertexAttribArray(r):t.disableVertexAttribArray(r))}else for(r=0;r<e.length;r++)t.enableVertexAttribArray(e[r].attribute.location)}},{}],9:[function(t,e,i){var r=function(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.log(t.getShaderInfoLog(r)),null)};e.exports=function(t,e,i,n){var a=r(t,t.VERTEX_SHADER,e),o=r(t,t.FRAGMENT_SHADER,i),s=t.createProgram();if(t.attachShader(s,a),t.attachShader(s,o),n)for(var h in n)t.bindAttribLocation(s,n[h],h);return t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(s,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(s)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(s)),t.deleteProgram(s),s=null),t.deleteShader(a),t.deleteShader(o),s}},{}],10:[function(t,e,i){var r=function(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e};e.exports=function(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return r(2*e);case"bvec3":return r(3*e);case"bvec4":return r(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}},{}],11:[function(t,e,i){var r=t("./mapType"),n=t("./mapSize"),a=function(t,e,i,r){gl.vertexAttribPointer(this.location,this.size,t||gl.FLOAT,e||!1,i||0,r||0)};e.exports=function(t,e){for(var i={},o=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),s=0;s<o;s++){var h=t.getActiveAttrib(e,s),c=r(t,h.type);i[h.name]={type:c,size:n(c),location:t.getAttribLocation(e,h.name),pointer:a}}return i}},{"./mapSize":15,"./mapType":16}],12:[function(t,e,i){var r=t("./mapType"),n=t("./defaultValue");e.exports=function(t,e){for(var i={},a=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;o<a;o++){var s=t.getActiveUniform(e,o),h=s.name.replace(/\[.*?\]/,""),c=r(t,s.type);i[h]={type:c,size:s.size,location:t.getUniformLocation(e,h),value:n(c,s.size)}}return i}},{"./defaultValue":10,"./mapType":16}],13:[function(t,e,i){var r=function(t){var e=o.replace("%%",t);return new Function(e)},n=function(t,e){var i,r=s.replace(/%%/g,t);return(i=1===e.size?h[e.type]:c[e.type])&&(r+="\nthis.gl."+i+";"),new Function("value",r)},a=function(t,e){for(var i=e,r=0;r<t.length-1;r++){var n=i[t[r]]||{data:{}};i[t[r]]=n,i=n}return i},o=["return this.data.%%.value;"].join("\n"),s=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),h={float:"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])",int:"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},c={float:"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)",int:"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};e.exports=function(t,e){var i={data:{}};i.gl=t;for(var o=Object.keys(e),s=0;s<o.length;s++){var h=o[s],c=h.split("."),u=c[c.length-1],p=a(c,i),l=e[h];p.data[u]=l,p.gl=t,Object.defineProperty(p,u,{get:r(u),set:n(u,l)})}return i}},{}],14:[function(t,e,i){e.exports={compileProgram:t("./compileProgram"),defaultValue:t("./defaultValue"),extractAttributes:t("./extractAttributes"),extractUniforms:t("./extractUniforms"),generateUniformAccessObject:t("./generateUniformAccessObject"),setPrecision:t("./setPrecision"),mapSize:t("./mapSize"),mapType:t("./mapType")}},{"./compileProgram":9,"./defaultValue":10,"./extractAttributes":11,"./extractUniforms":12,"./generateUniformAccessObject":13,"./mapSize":15,"./mapType":16,"./setPrecision":17}],15:[function(t,e,i){var r={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=function(t){return r[t]}},{}],16:[function(t,e,i){var r=null,n={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};e.exports=function(t,e){if(!r){var i=Object.keys(n);r={};for(var a=0;a<i.length;++a){var o=i[a];r[t[o]]=n[o]}}return r[e]}},{}],17:[function(t,e,i){e.exports=function(t,e){return"precision"!==t.substring(0,9)?"precision "+e+" float;\n"+t:t}},{}],18:[function(t,e,i){"use strict";function r(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}i.INT_BITS=32,i.INT_MAX=2147483647,i.INT_MIN=-1<<31,i.sign=function(t){return(t>0)-(t<0)},i.abs=function(t){var e=t>>31;return(t^e)-e},i.min=function(t,e){return e^(t^e)&-(t<e)},i.max=function(t,e){return t^(t^e)&-(t<e)},i.isPow2=function(t){return!(t&t-1||!t)},i.log2=function(t){var e,i;return e=(t>65535)<<4,e|=i=((t>>>=e)>255)<<3,e|=i=((t>>>=i)>15)<<2,(e|=i=((t>>>=i)>3)<<1)|(t>>>=i)>>1},i.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},i.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},i.countTrailingZeros=r,i.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,1+((t|=t>>>8)|t>>>16)},i.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},i.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var n=new Array(256);!function(t){for(var e=0;e<256;++e){var i=e,r=e,n=7;for(i>>>=1;i;i>>>=1)r<<=1,r|=1&i,--n;t[e]=r<<n&255}}(n),i.reverse=function(t){return n[255&t]<<24|n[t>>>8&255]<<16|n[t>>>16&255]<<8|n[t>>>24&255]},i.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},i.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},i.interleave3=function(t,e,i){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(i=1227133513&((i=3272356035&((i=251719695&((i=4278190335&((i&=1023)|i<<16))|i<<8))|i<<4))|i<<2))<<2},i.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},i.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>r(t)+1}},{}],19:[function(t,e,i){"use strict";function r(t,e,i){i=i||2;var r,s,h,c,u,d,f,_=e&&e.length,y=_?e[0]*i:t.length,g=n(t,0,y,i,!0),v=[];if(!g)return v;if(_&&(g=function(t,e,i,r){var o,s,h,c=[];for(o=0,s=e.length;o<s;o++)(h=n(t,e[o]*r,o<s-1?e[o+1]*r:t.length,r,!1))===h.next&&(h.steiner=!0),c.push(m(h));for(c.sort(p),o=0;o<c.length;o++)l(c[o],i),i=a(i,i.next);return i}(t,e,g,i)),t.length>80*i){r=h=t[0],s=c=t[1];for(var w=i;w<y;w+=i)(u=t[w])<r&&(r=u),(d=t[w+1])<s&&(s=d),u>h&&(h=u),d>c&&(c=d);f=Math.max(h-r,c-s)}return o(g,v,i,r,s,f),v}function n(t,e,i,r,n){var a,o;if(n===M(t,e,i,r)>0)for(a=e;a<i;a+=r)o=b(a,t[a],t[a+1],o);else for(a=i-r;a>=e;a-=r)o=b(a,t[a],t[a+1],o);return o&&g(o,o.next)&&(x(o),o=o.next),o}function a(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!g(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(x(r),(r=e=r.prev)===r.next)return null;i=!0}}while(i||r!==e);return e}function o(t,e,i,r,n,p,l){if(t){!l&&p&&function(t,e,i,r){var n=t;do{null===n.z&&(n.z=d(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,a,o,s,h,c=1;do{for(i=t,t=null,a=null,o=0;i;){for(o++,r=i,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(h=c;s>0||h>0&&r;)0===s?(n=r,r=r.nextZ,h--):0!==h&&r?i.z<=r.z?(n=i,i=i.nextZ,s--):(n=r,r=r.nextZ,h--):(n=i,i=i.nextZ,s--),a?a.nextZ=n:t=n,n.prevZ=a,a=n;i=r}a.nextZ=null,c*=2}while(o>1)}(n)}(t,r,n,p);for(var m,f,_=t;t.prev!==t.next;)if(m=t.prev,f=t.next,p?h(t,r,n,p):s(t))e.push(m.i/i),e.push(t.i/i),e.push(f.i/i),x(t),t=f.next,_=f.next;else if((t=f)===_){l?1===l?o(t=c(t,e,i),e,i,r,n,p,2):2===l&&u(t,e,i,r,n,p):o(a(t),e,i,r,n,p,1);break}}}function s(t){var e=t.prev,i=t,r=t.next;if(y(e,i,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(f(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&y(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function h(t,e,i,r){var n=t.prev,a=t,o=t.next;if(y(n,a,o)>=0)return!1;for(var s=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,h=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y,c=d(n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,e,i,r),u=d(s,h,e,i,r),p=t.nextZ;p&&p.z<=u;){if(p!==t.prev&&p!==t.next&&f(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&f(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function c(t,e,i){var r=t;do{var n=r.prev,a=r.next.next;!g(n,a)&&v(n,r,r.next,a)&&w(n,a)&&w(a,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(a.i/i),x(r),x(r.next),r=t=a),r=r.next}while(r!==t);return r}function u(t,e,i,r,n,s){var h=t;do{for(var c=h.next.next;c!==h.prev;){if(h.i!==c.i&&_(h,c)){var u=S(h,c);return h=a(h,h.next),u=a(u,u.next),o(h,e,i,r,n,s),void o(u,e,i,r,n,s)}c=c.next}h=h.next}while(h!==t)}function p(t,e){return t.x-e.x}function l(t,e){if(e=function(t,e){var i,r=e,n=t.x,a=t.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o){if(o=s,s===n){if(a===r.y)return r;if(a===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===o)return i.prev;var h,c=i,u=i.x,p=i.y,l=1/0;for(r=i.next;r!==c;)n>=r.x&&r.x>=u&&f(a<p?n:o,a,u,p,a<p?o:n,a,r.x,r.y)&&((h=Math.abs(a-r.y)/(n-r.x))<l||h===l&&r.x>i.x)&&w(r,t)&&(i=r,l=h),r=r.next;return i}(t,e)){var i=S(e,t);a(i,i.next)}}function d(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)/n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function m(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function f(t,e,i,r,n,a,o,s){return(n-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(r-s)-(i-o)*(e-s)>=0&&(i-o)*(a-s)-(n-o)*(r-s)>=0}function _(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&v(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&w(t,e)&&w(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!=i.next.y>a&&n<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)}function y(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function g(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,i,r){return!!(g(t,e)&&g(i,r)||g(t,r)&&g(i,e))||y(t,e,i)>0!=y(t,e,r)>0&&y(i,r,t)>0!=y(i,r,e)>0}function w(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function S(t,e){var i=new T(t.i,t.x,t.y),r=new T(e.i,e.x,e.y),n=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function b(t,e,i,r){var n=new T(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function x(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function T(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(t,e,i,r){for(var n=0,a=e,o=i-r;a<i;a+=r)n+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return n}e.exports=r,r.deviation=function(t,e,i,r){var n=e&&e.length,a=Math.abs(M(t,0,n?e[0]*i:t.length,i));if(n)for(var o=0,s=e.length;o<s;o++)a-=Math.abs(M(t,e[o]*i,o<s-1?e[o+1]*i:t.length,i));var h=0;for(o=0;o<r.length;o+=3){var c=r[o]*i,u=r[o+1]*i,p=r[o+2]*i;h+=Math.abs((t[c]-t[p])*(t[u+1]-t[c+1])-(t[c]-t[u])*(t[p+1]-t[c+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var a=0;a<t[n].length;a++)for(var o=0;o<e;o++)i.vertices.push(t[n][a][o]);n>0&&i.holes.push(r+=t[n-1].length)}return i}},{}],20:[function(t,e,i){"use strict";var r=Object.prototype.hasOwnProperty,n="~";function a(){}function o(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function s(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)r.call(t,e)&&i.push(n?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},s.prototype.listeners=function(t,e){var i=this._events[n?n+t:t];if(e)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,o=new Array(a);r<a;r++)o[r]=i[r].fn;return o},s.prototype.emit=function(t,e,i,r,a,o){var s=n?n+t:t;if(!this._events[s])return!1;var h,c,u=this._events[s],p=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),p){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,a),!0;case 6:return u.fn.call(u.context,e,i,r,a,o),!0}for(c=1,h=new Array(p-1);c<p;c++)h[c-1]=arguments[c];u.fn.apply(u.context,h)}else{var l,d=u.length;for(c=0;c<d;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),p){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,i);break;case 4:u[c].fn.call(u[c].context,e,i,r);break;default:if(!h)for(l=1,h=new Array(p-1);l<p;l++)h[l-1]=arguments[l];u[c].fn.apply(u[c].context,h)}}return!0},s.prototype.on=function(t,e,i){var r=new o(e,i||this),a=n?n+t:t;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},s.prototype.once=function(t,e,i){var r=new o(e,i||this,!0),a=n?n+t:t;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},s.prototype.removeListener=function(t,e,i,r){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return 0==--this._eventsCount?this._events=new a:delete this._events[o],this;var s=this._events[o];if(s.fn)s.fn!==e||r&&!s.once||i&&s.context!==i||(0==--this._eventsCount?this._events=new a:delete this._events[o]);else{for(var h=0,c=[],u=s.length;h<u;h++)(s[h].fn!==e||r&&!s[h].once||i&&s[h].context!==i)&&c.push(s[h]);c.length?this._events[o]=1===c.length?c[0]:c:0==--this._eventsCount?this._events=new a:delete this._events[o]}return this},s.prototype.removeAllListeners=function(t){var e;return t?this._events[e=n?n+t:t]&&(0==--this._eventsCount?this._events=new a:delete this._events[e]):(this._events=new a,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prototype.setMaxListeners=function(){return this},s.prefixed=n,s.EventEmitter=s,void 0!==e&&(e.exports=s)},{}],21:[function(t,e,i){var r,n,a,o,s,h,c,u,p,l,d,m,f,_,y,g,v,w;r=/iPhone/i,n=/iPod/i,a=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,h=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,c=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,u=/IEMobile/i,p=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,l=/BlackBerry/i,d=/BB10/i,m=/Opera Mini/i,f=/(CriOS|Chrome)(?=.*\bMobile\b)/i,_=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,y=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),g=function(t,e){return t.test(e)},v=function(t){var e=t||navigator.userAgent,i=e.split("[FBAN");if(void 0!==i[1]&&(e=i[0]),void 0!==(i=e.split("Twitter"))[1]&&(e=i[0]),this.apple={phone:g(r,e),ipod:g(n,e),tablet:!g(r,e)&&g(a,e),device:g(r,e)||g(n,e)||g(a,e)},this.amazon={phone:g(h,e),tablet:!g(h,e)&&g(c,e),device:g(h,e)||g(c,e)},this.android={phone:g(h,e)||g(o,e),tablet:!g(h,e)&&!g(o,e)&&(g(c,e)||g(s,e)),device:g(h,e)||g(c,e)||g(o,e)||g(s,e)},this.windows={phone:g(u,e),tablet:g(p,e),device:g(u,e)||g(p,e)},this.other={blackberry:g(l,e),blackberry10:g(d,e),opera:g(m,e),firefox:g(_,e),chrome:g(f,e),device:g(l,e)||g(d,e)||g(m,e)||g(_,e)||g(f,e)},this.seven_inch=g(y,e),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},w=function(){var t=new v;return t.Class=v,t},void 0!==e&&e.exports&&"undefined"==typeof window?e.exports=v:void 0!==e&&e.exports&&"undefined"!=typeof window?e.exports=w():this.isMobile=w()},{}],22:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(e,i,r){void 0===i&&(i=!1),n(this,t),this._fn=e,this._once=i,this._thisArg=r,this._next=this._prev=this._owner=null}return r(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function o(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var s=function(){function t(){n(this,t),this._head=this._tail=void 0}return r(t,[{key:"handlers",value:function(){var t=this._head;if(!(arguments.length<=0||void 0===arguments[0])&&arguments[0])return!!t;for(var e=[];t;)e.push(t),t=t._next;return e}},{key:"has",value:function(t){if(!(t instanceof a))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return o(this,new a(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return o(this,new a(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof a))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();s.MiniSignalBinding=a,i.default=s,e.exports=i.default},{}],23:[function(t,e,i){"use strict";var r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(n){return!1}}()?Object.assign:function(t,e){for(var i,a,o=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),s=1;s<arguments.length;s++){for(var h in i=Object(arguments[s]))r.call(i,h)&&(o[h]=i[h]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(i);for(var c=0;c<a.length;c++)n.call(i,a[c])&&(o[a[c]]=i[a[c]])}}return o}},{}],24:[function(t,e,i){"use strict";e.exports=function(t,e){for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=i.parser[(e=e||{}).strictMode?"strict":"loose"].exec(t),n={},a=14;a--;)n[i.key[a]]=r[a]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,function(t,e,r){e&&(n[i.q.name][e]=r)}),n}},{}],25:[function(t,e,i){(function(t){function e(t,e){for(var i=0,r=t.length-1;r>=0;r--){var n=t[r];"."===n?t.splice(r,1):".."===n?(t.splice(r,1),i++):i&&(t.splice(r,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,n=function(t){return r.exec(t).slice(1)};function a(t,e){if(t.filter)return t.filter(e);for(var i=[],r=0;r<t.length;r++)e(t[r],r,t)&&i.push(t[r]);return i}i.resolve=function(){for(var i="",r=!1,n=arguments.length-1;n>=-1&&!r;n--){var o=n>=0?arguments[n]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(i=o+"/"+i,r="/"===o.charAt(0))}return(r?"/":"")+(i=e(a(i.split("/"),function(t){return!!t}),!r).join("/"))||"."},i.normalize=function(t){var r=i.isAbsolute(t),n="/"===o(t,-1);return(t=e(a(t.split("/"),function(t){return!!t}),!r).join("/"))||r||(t="."),t&&n&&(t+="/"),(r?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(a(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},i.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var n=r(t.split("/")),a=r(e.split("/")),o=Math.min(n.length,a.length),s=o,h=0;h<o;h++)if(n[h]!==a[h]){s=h;break}var c=[];for(h=s;h<n.length;h++)c.push("..");return(c=c.concat(a.slice(s))).join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=n(t),i=e[0],r=e[1];return i||r?(r&&(r=r.substr(0,r.length-1)),i+r):"."},i.basename=function(t,e){var i=n(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return n(t)[3]};var o="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return e<0&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:26}],26:[function(t,e,i){var r,n,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function h(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var c,u=[],p=!1,l=-1;function d(){p&&c&&(p=!1,c.length?u=c.concat(u):l=-1,u.length&&m())}function m(){if(!p){var t=h(d);p=!0;for(var e=u.length;e;){for(c=u,u=[];++l<e;)c&&c[l].run();l=-1,e=u.length}c=null,p=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function _(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new f(t,e)),1!==u.length||p||h(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=_,a.addListener=_,a.once=_,a.off=_,a.removeListener=_,a.removeAllListeners=_,a.emit=_,a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],27:[function(t,e,i){(function(t){!function(r){var n="object"==typeof i&&i&&!i.nodeType&&i,a="object"==typeof e&&e&&!e.nodeType&&e,o="object"==typeof t&&t;o.global!==o&&o.window!==o&&o.self!==o||(r=o);var s,h,c=2147483647,u=36,p=1,l=26,d=38,m=700,f=72,_=128,y="-",g=/^xn--/,v=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=u-p,x=Math.floor,T=String.fromCharCode;function M(t){throw new RangeError(S[t])}function E(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function I(t,e){var i=t.split("@"),r="";return i.length>1&&(r=i[0]+"@",t=i[1]),r+E((t=t.replace(w,".")).split("."),e).join(".")}function C(t){for(var e,i,r=[],n=0,a=t.length;n<a;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<a?56320==(64512&(i=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--):r.push(e);return r}function A(t){return E(t,function(t){var e="";return t>65535&&(e+=T((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+T(t)}).join("")}function B(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function W(t,e,i){var r=0;for(t=i?x(t/m):t>>1,t+=x(t/e);t>b*l>>1;r+=u)t=x(t/b);return x(r+(b+1)*t/(t+d))}function P(t){var e,i,r,n,a,o,s,h,d,m,g,v=[],w=t.length,S=0,b=_,T=f;for((i=t.lastIndexOf(y))<0&&(i=0),r=0;r<i;++r)t.charCodeAt(r)>=128&&M("not-basic"),v.push(t.charCodeAt(r));for(n=i>0?i+1:0;n<w;){for(a=S,o=1,s=u;n>=w&&M("invalid-input"),((h=(g=t.charCodeAt(n++))-48<10?g-22:g-65<26?g-65:g-97<26?g-97:u)>=u||h>x((c-S)/o))&&M("overflow"),S+=h*o,!(h<(d=s<=T?p:s>=T+l?l:s-T));s+=u)o>x(c/(m=u-d))&&M("overflow"),o*=m;T=W(S-a,e=v.length+1,0==a),x(S/e)>c-b&&M("overflow"),b+=x(S/e),S%=e,v.splice(S++,0,b)}return A(v)}function O(t){var e,i,r,n,a,o,s,h,d,m,g,v,w,S,b,E=[];for(v=(t=C(t)).length,e=_,i=0,a=f,o=0;o<v;++o)(g=t[o])<128&&E.push(T(g));for(r=n=E.length,n&&E.push(y);r<v;){for(s=c,o=0;o<v;++o)(g=t[o])>=e&&g<s&&(s=g);for(s-e>x((c-i)/(w=r+1))&&M("overflow"),i+=(s-e)*w,e=s,o=0;o<v;++o)if((g=t[o])<e&&++i>c&&M("overflow"),g==e){for(h=i,d=u;!(h<(m=d<=a?p:d>=a+l?l:d-a));d+=u)E.push(T(B(m+(b=h-m)%(S=u-m),0))),h=x(b/S);E.push(T(B(h,0))),a=W(i,w,r==n),i=0,++r}++i,++e}return E.join("")}if(s={version:"1.4.1",ucs2:{decode:C,encode:A},decode:P,encode:O,toASCII:function(t){return I(t,function(t){return v.test(t)?"xn--"+O(t):t})},toUnicode:function(t){return I(t,function(t){return g.test(t)?P(t.slice(4).toLowerCase()):t})}},n&&a)if(e.exports==n)a.exports=s;else for(h in s)s.hasOwnProperty(h)&&(n[h]=s[h]);else r.punycode=s}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],28:[function(t,e,i){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,i,a){i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var s=/\+/g;t=t.split(e=e||"&");var h=1e3;a&&"number"==typeof a.maxKeys&&(h=a.maxKeys);var c=t.length;h>0&&c>h&&(c=h);for(var u=0;u<c;++u){var p,l,d,m,f=t[u].replace(s,"%20"),_=f.indexOf(i);_>=0?(p=f.substr(0,_),l=f.substr(_+1)):(p=f,l=""),d=decodeURIComponent(p),m=decodeURIComponent(l),r(o,d)?n(o[d])?o[d].push(m):o[d]=[o[d],m]:o[d]=m}return o};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],29:[function(t,e,i){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,s){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?a(o(t),function(o){var s=encodeURIComponent(r(o))+i;return n(t[o])?a(t[o],function(t){return s+encodeURIComponent(r(t))}).join(e):s+encodeURIComponent(r(t[o]))}).join(e):s?encodeURIComponent(r(s))+i+encodeURIComponent(r(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function a(t,e){if(t.map)return t.map(e);for(var i=[],r=0;r<t.length;r++)i.push(e(t[r],r));return i}var o=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],30:[function(t,e,i){"use strict";i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":28,"./encode":29}],31:[function(t,e,i){"use strict";e.exports=function(t,e,i){var r,n=t.length;if(!(e>=n||0===i)){var a=n-(i=e+i>n?n-e:i);for(r=e;r<a;++r)t[r]=t[r+i];t.length=a}}},{}],32:[function(t,e,i){"use strict";i.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=h(t("mini-signals")),a=h(t("parse-uri")),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("./async")),s=h(t("./Resource"));function h(t){return t&&t.__esModule?t:{default:t}}var c=/(#[\w-]+)?$/,u=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.baseUrl=i,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,i){return e._loadResource(t,i)},this._queue=o.queue(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new n.default,this.onError=new n.default,this.onLoad=new n.default,this.onStart=new n.default,this.onComplete=new n.default}return t.prototype.add=function(t,e,i,n){if(Array.isArray(t)){for(var a=0;a<t.length;++a)this.add(t[a]);return this}if("object"===(void 0===t?"undefined":r(t))&&(n=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(n=i,i=null),this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new s.default(t,e,i),"function"==typeof n&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var o=i.parentResource,h=[],c=0;c<o.children.length;++c)o.children[c].isComplete||h.push(o.children[c]);var u=o.progressChunk*(h.length+1)/(h.length+2);o.children.push(this.resources[t]),o.progressChunk=u;for(var p=0;p<h.length;++p)h[p].progressChunk=u;this.resources[t].progressChunk=u}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;for(var e=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;return this.loading=!0,this.onStart.dispatch(this),this._queue.resume(),this},t.prototype._prepareUrl=function(t){var e=(0,a.default)(t,{strictMode:!0}),i=void 0;if(i=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=c.exec(i)[0];-1!==(i=i.substr(0,i.length-r.length)).indexOf("?")?i+="&"+this.defaultQueryString:i+="?"+this.defaultQueryString,i+=r}return i},t.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,o.eachSeries(this._beforeMiddleware,function(e,r){e.call(i,t,function(){r(t.isComplete?{}:null)})},function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())},!0)},t.prototype._onComplete=function(){this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),o.eachSeries(this._afterMiddleware,function(i,r){i.call(e,t,r)},function(){t.onAfterMiddleware.dispatch(t),e.progress+=t.progressChunk,e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&(e.progress=100,e._onComplete())},!0)},t}();i.default=u},{"./Resource":33,"./async":34,"mini-signals":22,"parse-uri":24}],33:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=o(t("parse-uri")),a=o(t("mini-signals"));function o(t){return t&&t.__esModule?t:{default:t}}var s=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),h=null;function c(){}var u=function(){function t(e,i,r){if(function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),"string"!=typeof e||"string"!=typeof i)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===i.indexOf("data:")),this.name=e,this.url=i,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=c,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new a.default,this.onProgress=new a.default,this.onComplete=new a.default,this.onAfterMiddleware=new a.default}return t.setExtensionLoadType=function(e,i){p(t._loadTypeMap,e,i)},t.setExtensionXhrType=function(e,i){p(t._xhrTypeMap,e,i)},t.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},t.prototype.load=function(e){var i=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout(function(){return e(i)},1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:s&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return!!(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._loadElement=function(t){this.data=this.metadata.loadElement?this.metadata.loadElement:"image"===t&&void 0!==window.Image?new Image:document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},t.prototype._loadSourceElement=function(t){if(this.data=this.metadata.loadElement?this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?new Audio:document.createElement(t),null!==this.data){if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=0;e<this.url.length;++e)this.data.appendChild(this._createSource(t,this.url[e]));else this.data.appendChild(this._createSource(t,this.url));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.responseType=this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?t.XHR_RESPONSE_TYPE.TEXT:this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,i){i||(i=t+"/"+e.substr(e.lastIndexOf(".")+1));var r=document.createElement("source");return r.src=e,r.type=i,r},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(l(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnAbort=function(){this.abort(l(this.xhr)+" Request was aborted by the user.")},t.prototype._xdrOnTimeout=function(){this.abort(l(this.xhr)+" Request timed out.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,i="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(i=e.responseText),0===r&&i.length>0?r=200:1223===r&&(r=204),2==(r/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=i,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(i),this.type=t.TYPE.JSON}catch(o){return void this.abort("Error trying to parse loaded json: "+o)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(i,"text/xml")}else{var a=document.createElement("div");a.innerHTML=i,this.data=a}this.type=t.TYPE.XML}catch(o){return void this.abort("Error trying to parse loaded xml: "+o)}else this.data=e.response||i;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){return 0===t.indexOf("data:")?"":(e=e||window.location,h||(h=document.createElement("a")),h.href=t,(t=(0,n.default)(h.href,{strictMode:!0})).host!==e.hostname||(t.port||""!==e.port)&&t.port!==e.port||(t.protocol?t.protocol+":":"")!==e.protocol?"anonymous":"")},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var r=t.indexOf("?");-1!==r&&(t=t.substring(0,r)),e=t.substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},r(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function p(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function l(t){return t.toString().replace("object ","")}i.default=u,u.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},u.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},u.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},u.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},u._loadTypeMap={gif:u.LOAD_TYPE.IMAGE,png:u.LOAD_TYPE.IMAGE,bmp:u.LOAD_TYPE.IMAGE,jpg:u.LOAD_TYPE.IMAGE,jpeg:u.LOAD_TYPE.IMAGE,tif:u.LOAD_TYPE.IMAGE,tiff:u.LOAD_TYPE.IMAGE,webp:u.LOAD_TYPE.IMAGE,tga:u.LOAD_TYPE.IMAGE,svg:u.LOAD_TYPE.IMAGE,"svg+xml":u.LOAD_TYPE.IMAGE,mp3:u.LOAD_TYPE.AUDIO,ogg:u.LOAD_TYPE.AUDIO,wav:u.LOAD_TYPE.AUDIO,mp4:u.LOAD_TYPE.VIDEO,webm:u.LOAD_TYPE.VIDEO},u._xhrTypeMap={xhtml:u.XHR_RESPONSE_TYPE.DOCUMENT,html:u.XHR_RESPONSE_TYPE.DOCUMENT,htm:u.XHR_RESPONSE_TYPE.DOCUMENT,xml:u.XHR_RESPONSE_TYPE.DOCUMENT,tmx:u.XHR_RESPONSE_TYPE.DOCUMENT,svg:u.XHR_RESPONSE_TYPE.DOCUMENT,tsx:u.XHR_RESPONSE_TYPE.DOCUMENT,gif:u.XHR_RESPONSE_TYPE.BLOB,png:u.XHR_RESPONSE_TYPE.BLOB,bmp:u.XHR_RESPONSE_TYPE.BLOB,jpg:u.XHR_RESPONSE_TYPE.BLOB,jpeg:u.XHR_RESPONSE_TYPE.BLOB,tif:u.XHR_RESPONSE_TYPE.BLOB,tiff:u.XHR_RESPONSE_TYPE.BLOB,webp:u.XHR_RESPONSE_TYPE.BLOB,tga:u.XHR_RESPONSE_TYPE.BLOB,json:u.XHR_RESPONSE_TYPE.JSON,text:u.XHR_RESPONSE_TYPE.TEXT,txt:u.XHR_RESPONSE_TYPE.TEXT,ttf:u.XHR_RESPONSE_TYPE.BUFFER,otf:u.XHR_RESPONSE_TYPE.BUFFER},u.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},{"mini-signals":22,"parse-uri":24}],34:[function(t,e,i){"use strict";function r(){}function n(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}i.__esModule=!0,i.eachSeries=function(t,e,i,r){var n=0,a=t.length;!function o(s){s||n===a?i&&i(s):r?setTimeout(function(){e(t[n++],o)},1):e(t[n++],o)}()},i.queue=function(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var i=0,a={_tasks:[],concurrency:e,saturated:r,unsaturated:r,buffer:e/4,empty:r,drain:r,error:r,started:!1,paused:!1,push:function(t,e){o(t,!1,e)},kill:function(){i=0,a.drain=r,a.started=!1,a._tasks=[]},unshift:function(t,e){o(t,!0,e)},process:function(){for(;!a.paused&&i<a.concurrency&&a._tasks.length;){var e=a._tasks.shift();0===a._tasks.length&&a.empty(),(i+=1)===a.concurrency&&a.saturated(),t(e.data,n(s(e)))}},length:function(){return a._tasks.length},running:function(){return i},idle:function(){return a._tasks.length+i===0},pause:function(){!0!==a.paused&&(a.paused=!0)},resume:function(){if(!1!==a.paused){a.paused=!1;for(var t=1;t<=a.concurrency;t++)a.process()}}};function o(t,e,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(a.started=!0,null==t&&a.idle())setTimeout(function(){return a.drain()},1);else{var n={data:t,callback:"function"==typeof i?i:r};e?a._tasks.unshift(n):a._tasks.push(n),setTimeout(function(){return a.process()},1)}}function s(t){return function(){i-=1,t.callback.apply(t,arguments),null!=arguments[0]&&a.error(arguments[0],t.data),i<=a.concurrency-a.buffer&&a.unsaturated(),a.idle()&&a.drain(),a.process()}}return a}},{}],35:[function(t,e,i){"use strict";i.__esModule=!0,i.encodeBinary=function(t){for(var e="",i=0;i<t.length;){for(var n=[0,0,0],a=[0,0,0,0],o=0;o<n.length;++o)n[o]=i<t.length?255&t.charCodeAt(i++):0;switch(a[0]=n[0]>>2,a[1]=(3&n[0])<<4|n[1]>>4,a[2]=(15&n[1])<<2|n[2]>>6,a[3]=63&n[2],i-(t.length-1)){case 2:a[3]=64,a[2]=64;break;case 1:a[3]=64}for(var s=0;s<a.length;++s)e+=r.charAt(a[s])}return e};var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},{}],36:[function(t,e,i){"use strict";var r=t("./Loader").default,n=t("./Resource").default,a=t("./async"),o=t("./b64");r.Resource=n,r.async=a,r.base64=o,e.exports=r,e.exports.default=r},{"./Loader":32,"./Resource":33,"./async":34,"./b64":35}],37:[function(t,e,i){"use strict";i.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};i.blobMiddlewareFactory=function(){return function(t,e){if(t.data){if(t.xhr&&t.xhrType===n.default.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=(h=s.createObjectURL(t.data),t.blob=t.data,t.data=new Image,t.data.src=h,t.type=n.default.TYPE.IMAGE,t.data.onload=function(){s.revokeObjectURL(h),t.data.onload=null,e()},{v:void 0});if("object"===(void 0===i?"undefined":r(i)))return i.v}}else{var o=t.xhr.getResponseHeader("content-type");if(o&&0===o.indexOf("image"))return t.data=new Image,t.data.src="data:"+o+";base64,"+a.default.encodeBinary(t.xhr.responseText),t.type=n.default.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}var h;e()}else e()}};var n=o(t("../../Resource")),a=o(t("../../b64"));function o(t){return t&&t.__esModule?t:{default:t}}var s=window.URL||window.webkitURL},{"../../Resource":33,"../../b64":35}],38:[function(t,e,i){"use strict";var r=t("punycode"),n=t("./util");function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}i.parse=v,i.resolve=function(t,e){return v(t,!1,!0).resolve(e)},i.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},i.format=function(t){return n.isString(t)&&(t=v(t)),t instanceof a?t.format():a.prototype.format.call(t)},i.Url=a;var o=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),p=["%","/","?",";","#"].concat(u),l=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},_={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=t("querystring");function v(t,e,i){if(t&&n.isObject(t)&&t instanceof a)return t;var r=new a;return r.parse(t,e,i),r}a.prototype.parse=function(t,e,i){if(!n.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var a=t.indexOf("?"),s=-1!==a&&a<t.indexOf("#")?"?":"#",c=t.split(s);c[0]=c[0].replace(/\\/g,"/");var v=t=c.join(s);if(v=v.trim(),!i&&1===t.split("#").length){var w=h.exec(v);if(w)return this.path=v,this.href=v,this.pathname=w[1],w[2]?(this.search=w[2],this.query=e?g.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var S=o.exec(v);if(S){var b=(S=S[0]).toLowerCase();this.protocol=b,v=v.substr(S.length)}if(i||S||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var x="//"===v.substr(0,2);!x||S&&_[S]||(v=v.substr(2),this.slashes=!0)}if(!_[S]&&(x||S&&!y[S])){for(var T,M,E=-1,I=0;I<l.length;I++)-1!==(C=v.indexOf(l[I]))&&(-1===E||C<E)&&(E=C);for(-1!==(M=-1===E?v.lastIndexOf("@"):v.lastIndexOf("@",E))&&(T=v.slice(0,M),v=v.slice(M+1),this.auth=decodeURIComponent(T)),E=-1,I=0;I<p.length;I++){var C;-1!==(C=v.indexOf(p[I]))&&(-1===E||C<E)&&(E=C)}-1===E&&(E=v.length),this.host=v.slice(0,E),v=v.slice(E),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var B=this.hostname.split(/\./),W=(I=0,B.length);I<W;I++){var P=B[I];if(P&&!P.match(d)){for(var O="",G=0,R=P.length;G<R;G++)P.charCodeAt(G)>127?O+="x":O+=P[G];if(!O.match(d)){var k=B.slice(0,I),D=B.slice(I+1),L=P.match(m);L&&(k.push(L[1]),D.unshift(L[2])),D.length&&(v="/"+D.join(".")+v),this.hostname=k.join(".");break}}}this.hostname=this.hostname.length>255?"":this.hostname.toLowerCase(),A||(this.hostname=r.toASCII(this.hostname)),this.host=(this.hostname||"")+(this.port?":"+this.port:""),this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!f[b])for(I=0,W=u.length;I<W;I++){var F=u[I];if(-1!==v.indexOf(F)){var N=encodeURIComponent(F);N===F&&(N=escape(F)),v=v.split(F).join(N)}}var U=v.indexOf("#");-1!==U&&(this.hash=v.substr(U),v=v.slice(0,U));var j=v.indexOf("?");return-1!==j?(this.search=v.substr(j),this.query=v.substr(j+1),e&&(this.query=g.parse(this.query)),v=v.slice(0,j)):e&&(this.search="",this.query={}),v&&(this.pathname=v),y[b]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(this.path=(this.pathname||"")+(this.search||"")),this.href=this.format(),this},a.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",a=!1,o="";this.host?a=t+this.host:this.hostname&&(a=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(o=g.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||y[e])&&!1!==a?(a="//"+(a||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):a||(a=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),e+a+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(s=s.replace("#","%23"))+r},a.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},a.prototype.resolveObject=function(t){if(n.isString(t)){var e=new a;e.parse(t,!1,!0),t=e}for(var i=new a,r=Object.keys(this),o=0;o<r.length;o++){var s=r[o];i[s]=this[s]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var h=Object.keys(t),c=0;c<h.length;c++){var u=h[c];"protocol"!==u&&(i[u]=t[u])}return y[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!y[t.protocol]){for(var p=Object.keys(t),l=0;l<p.length;l++){var d=p[l];i[d]=t[d]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||_[t.protocol])i.pathname=t.pathname;else{for(var m=(t.pathname||"").split("/");m.length&&!(t.host=m.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),i.pathname=m.join("/")}return i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,(i.pathname||i.search)&&(i.path=(i.pathname||"")+(i.search||"")),i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var f=i.pathname&&"/"===i.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=g||f||i.host&&t.pathname,w=v,S=i.pathname&&i.pathname.split("/")||[],b=(m=t.pathname&&t.pathname.split("/")||[],i.protocol&&!y[i.protocol]);if(b&&(i.hostname="",i.port=null,i.host&&(""===S[0]?S[0]=i.host:S.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===m[0]?m[0]=t.host:m.unshift(t.host)),t.host=null),v=v&&(""===m[0]||""===S[0])),g)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,S=m;else if(m.length)S||(S=[]),S.pop(),S=S.concat(m),i.search=t.search,i.query=t.query;else if(!n.isNullOrUndefined(t.search))return b&&(i.hostname=i.host=S.shift(),(I=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=I.shift(),i.host=i.hostname=I.shift())),i.search=t.search,i.query=t.query,n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!S.length)return i.pathname=null,i.path=i.search?"/"+i.search:null,i.href=i.format(),i;for(var x=S.slice(-1)[0],T=(i.host||t.host||S.length>1)&&("."===x||".."===x)||""===x,M=0,E=S.length;E>=0;E--)"."===(x=S[E])?S.splice(E,1):".."===x?(S.splice(E,1),M++):M&&(S.splice(E,1),M--);if(!v&&!w)for(;M--;M)S.unshift("..");!v||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),T&&"/"!==S.join("/").substr(-1)&&S.push("");var I,C=""===S[0]||S[0]&&"/"===S[0].charAt(0);return b&&(i.hostname=i.host=C?"":S.length?S.shift():"",(I=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=I.shift(),i.host=i.hostname=I.shift())),(v=v||i.host&&S.length)&&!C&&S.unshift(""),S.length?i.pathname=S.join("/"):(i.pathname=null,i.path=null),n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},a.prototype.parseHost=function(){var t=this.host,e=s.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":39,punycode:27,querystring:30}],39:[function(t,e,i){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],40:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),n=o(t("ismobilejs")),a=o(t("./accessibleTarget"));function o(t){return t&&t.__esModule?t:{default:t}}r.utils.mixins.delayMixin(r.DisplayObject.prototype,a.default);var s=100,h=0,c=0,u=2,p=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),!n.default.tablet&&!n.default.phone||navigator.isCocoonJS||this.createTouchHook();var i=document.createElement("div");i.style.width=s+"px",i.style.height=s+"px",i.style.position="absolute",i.style.top=h+"px",i.style.left=c+"px",i.style.zIndex=u,this.div=i,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessabillity=!0,t.activate(),document.body.removeChild(e)}),document.body.appendChild(e)},t.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},t.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=e.length-1;i>=0;i--)this.updateAccessibleObjects(e[i])}},t.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,n=this.div;n.style.left=t.left+"px",n.style.top=t.top+"px",n.style.width=this.renderer.width+"px",n.style.height=this.renderer.height+"px";for(var a=0;a<this.children.length;a++){var o=this.children[a];if(o.renderId!==this.renderId)o._accessibleActive=!1,r.utils.removeItems(this.children,a,1),this.div.removeChild(o._accessibleDiv),this.pool.push(o._accessibleDiv),o._accessibleDiv=null,a--,0===this.children.length&&this.deactivate();else{n=o._accessibleDiv;var s=o.hitArea,h=o.worldTransform;o.hitArea?(n.style.left=(h.tx+s.x*h.a)*e+"px",n.style.top=(h.ty+s.y*h.d)*i+"px",n.style.width=s.width*h.a*e+"px",n.style.height=s.height*h.d*i+"px"):(s=o.getBounds(),this.capHitArea(s),n.style.left=s.x*e+"px",n.style.top=s.y*i+"px",n.style.width=s.width*e+"px",n.style.height=s.height*i+"px")}}this.renderId++}},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width=s+"px",e.style.height=s+"px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=u,e.style.borderStyle="none",e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleTitle||t.accessibleHint||(e.title="displayObject "+this.tabIndex),t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},t.prototype._onFocus=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},t.prototype._onFocusOut=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(){this.deactivate()},t.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}();i.default=p,r.WebGLRenderer.registerPlugin("accessibility",p),r.CanvasRenderer.registerPlugin("accessibility",p)},{"../core":65,"./accessibleTarget":41,ismobilejs:21}],41:[function(t,e,i){"use strict";i.__esModule=!0,i.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],42:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("./accessibleTarget");Object.defineProperty(i,"accessibleTarget",{enumerable:!0,get:function(){return a(r).default}});var n=t("./AccessibilityManager");function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"AccessibilityManager",{enumerable:!0,get:function(){return a(n).default}})},{"./AccessibilityManager":40,"./accessibleTarget":41}],43:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=t("./autoDetectRenderer"),a=c(t("./display/Container")),o=t("./ticker"),s=c(t("./settings")),h=t("./const");function c(t){return t&&t.__esModule?t:{default:t}}var u=function(){function t(e,i,r,h,c){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),"number"==typeof e&&(e=Object.assign({width:e,height:i||s.default.RENDER_OPTIONS.height,forceCanvas:!!h,sharedTicker:!!c},r)),this._options=e=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},e),this.renderer=(0,n.autoDetectRenderer)(e),this.stage=new a.default,this._ticker=null,this.ticker=e.sharedTicker?o.shared:new o.Ticker,e.autoStart&&this.start()}return t.prototype.render=function(){this.renderer.render(this.stage)},t.prototype.stop=function(){this._ticker.stop()},t.prototype.start=function(){this._ticker.start()},t.prototype.destroy=function(t){var e=this._ticker;this.ticker=null,e.destroy(),this.stage.destroy(),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},r(t,[{key:"ticker",set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,h.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),t}();i.default=u},{"./autoDetectRenderer":45,"./const":46,"./display/Container":48,"./settings":101,"./ticker":120}],44:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=t("pixi-gl-core"),a=(r=t("./settings"))&&r.__esModule?r:{default:r};function o(t,e){if(t instanceof Array){if("precision"!==t[0].substring(0,9)){var i=t.slice(0);return i.unshift("precision "+e+" float;"),i}}else if("precision"!==t.substring(0,9))return"precision "+e+" float;\n"+t;return t}var s=function(t){function e(i,r,n){return function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,o(r,a.default.PRECISION_VERTEX),o(n,a.default.PRECISION_FRAGMENT)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n.GLShader);i.default=s},{"./settings":101,"pixi-gl-core":7}],45:[function(t,e,i){"use strict";i.__esModule=!0,i.autoDetectRenderer=function(t,e,i,o){var s=t&&t.forceCanvas;return void 0!==o&&(s=o),!s&&r.isWebGLSupported()?new a.default(t,e,i):new n.default(t,e,i)};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("./utils")),n=o(t("./renderers/canvas/CanvasRenderer")),a=o(t("./renderers/webgl/WebGLRenderer"));function o(t){return t&&t.__esModule?t:{default:t}}},{"./renderers/canvas/CanvasRenderer":77,"./renderers/webgl/WebGLRenderer":84,"./utils":124}],46:[function(t,e,i){"use strict";i.__esModule=!0,i.VERSION="4.5.4",i.PI_2=2*Math.PI,i.RAD_TO_DEG=180/Math.PI,i.DEG_TO_RAD=Math.PI/180,i.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},i.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},i.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},i.SCALE_MODES={LINEAR:0,NEAREST:1},i.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},i.GC_MODES={AUTO:0,MANUAL:1},i.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,i.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/i,i.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,i.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},i.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},i.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},i.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},i.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],47:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("../math"),n=function(){function t(){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?r.Rectangle.EMPTY:((t=t||new r.Rectangle(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,a=t[0],o=t[1];e=a<e?a:e,i=o<i?o:i,r=a>r?a:r,n=o>n?o:n,e=(a=t[2])<e?a:e,i=(o=t[3])<i?o:i,r=a>r?a:r,n=o>n?o:n,e=(a=t[4])<e?a:e,i=(o=t[5])<i?o:i,r=a>r?a:r,n=o>n?o:n,i=(o=t[7])<i?o:i,r=(a=t[6])>r?a:r,n=o>n?o:n,this.minX=e=a<e?a:e,this.minY=i,this.maxX=r,this.maxY=n},t.prototype.addFrame=function(t,e,i,r,n){var a=t.worldTransform,o=a.a,s=a.b,h=a.c,c=a.d,u=a.tx,p=a.ty,l=this.minX,d=this.minY,m=this.maxX,f=this.maxY,_=o*e+h*i+u,y=s*e+c*i+p;l=_<l?_:l,d=y<d?y:d,m=_>m?_:m,f=y>f?y:f,l=(_=o*r+h*i+u)<l?_:l,d=(y=s*r+c*i+p)<d?y:d,m=_>m?_:m,f=y>f?y:f,l=(_=o*e+h*n+u)<l?_:l,d=(y=s*e+c*n+p)<d?y:d,m=_>m?_:m,f=y>f?y:f,d=(y=s*r+c*n+p)<d?y:d,m=(_=o*r+h*n+u)>m?_:m,f=y>f?y:f,this.minX=l=_<l?_:l,this.minY=d,this.maxX=m,this.maxY=f},t.prototype.addVertices=function(t,e,i,r){for(var n=t.worldTransform,a=n.a,o=n.b,s=n.c,h=n.d,c=n.tx,u=n.ty,p=this.minX,l=this.minY,d=this.maxX,m=this.maxY,f=i;f<r;f+=2){var _=e[f],y=e[f+1],g=a*_+s*y+c,v=h*y+o*_+u;p=g<p?g:p,l=v<l?v:l,d=g>d?g:d,m=v>m?v:m}this.minX=p,this.minY=l,this.maxX=d,this.maxY=m},t.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},t.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,a=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=a){var o=this.minX,s=this.minY,h=this.maxX,c=this.maxY;this.minX=i<o?i:o,this.minY=r<s?r:s,this.maxX=n>h?n:h,this.maxY=a>c?a:c}},t.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,a=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=a){var o=this.minX,s=this.minY,h=this.maxX,c=this.maxY;this.minX=i<o?i:o,this.minY=r<s?r:s,this.maxX=n>h?n:h,this.maxY=a>c?a:c}},t}();i.default=n},{"../math":70}],48:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("../utils"),o=function(t){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.children=[],i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments.length;if(e>1)for(var i=0;i<e;i++)this.addChild(arguments[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);(0,a.removeItems)(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments.length;if(e>1)for(var i=0;i<e;i++)this.removeChild(arguments[i]);else{var r=this.children.indexOf(t);if(-1===r)return null;t.parent=null,t.transform._parentID=-1,(0,a.removeItems)(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,(0,a.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),e},e.prototype.removeChildren=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],i="number"==typeof e?e:this.children.length,r=i-t,n=void 0;if(r>0&&r<=i){n=this.children.splice(t,r);for(var a=0;a<n.length;++a)n[a].parent=null,n[a].transform&&(n[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var o=0;o<n.length;++o)n[o].emit("removed",this);return n}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(t);else{this._renderWebGL(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].renderWebGL(t)}},e.prototype.renderAdvancedWebGL=function(t){t.flush();var e=this._filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var r=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filterManager.pushFilter(this,this._enabledFilters)}i&&t.maskManager.pushMask(this,this._mask),this._renderWebGL(t);for(var n=0,a=this.children.length;n<a;n++)this.children[n].renderWebGL(t);t.flush(),i&&t.maskManager.popMask(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filterManager.popFilter()},e.prototype._renderWebGL=function(t){},e.prototype._renderCanvas=function(t){},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},e.prototype.destroy=function(e){t.prototype.destroy.call(this);var i="boolean"==typeof e?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(i)for(var n=0;n<r.length;++n)r[n].destroy(e)},n(e,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}]),e}(((r=t("./DisplayObject"))&&r.__esModule?r:{default:r}).default);i.default=o,o.prototype.containerUpdateTransform=o.prototype.updateTransform},{"../utils":124,"./DisplayObject":49}],49:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=p(t("eventemitter3")),a=t("../const"),o=p(t("../settings")),s=p(t("./TransformStatic")),h=p(t("./Transform")),c=p(t("./Bounds")),u=t("../math");function p(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this)),r=o.default.TRANSFORM_MODE===a.TRANSFORM_MODE.STATIC?s.default:h.default;return i.tempDisplayObjectParent=null,i.transform=new r,i.alpha=1,i.visible=!0,i.renderable=!0,i.parent=null,i.worldAlpha=1,i.filterArea=null,i._filters=null,i._enabledFilters=null,i._bounds=new c.default,i._boundsID=0,i._lastBoundsID=-1,i._boundsRect=null,i._localBoundsRect=null,i._mask=null,i._destroyed=!1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new u.Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new u.Rectangle),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},e.prototype.toGlobal=function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.renderWebGL=function(t){},e.prototype.renderCanvas=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,this.position.y=t,this.scale.x=e||1,this.scale.y=i||1,this.rotation=r,this.skew.x=n,this.skew.y=a,this.pivot.x=o,this.pivot.y=s,this},e.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},r(e,[{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(t){this.transform.position.copy(t)}},{key:"scale",get:function(){return this.transform.scale},set:function(t){this.transform.scale.copy(t)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copy(t)}},{key:"skew",get:function(){return this.transform.skew},set:function(t){this.transform.skew.copy(t)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"worldVisible",get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}]),e}(n.default);i.default=l,l.prototype.displayObjectUpdateTransform=l.prototype.updateTransform},{"../const":46,"../math":70,"../settings":101,"./Bounds":47,"./Transform":50,"./TransformStatic":52,eventemitter3:20}],50:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("../math"),o=function(t){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.position=new a.Point(0,0),i.scale=new a.Point(1,1),i.skew=new a.ObservablePoint(i.updateSkew,i,0,0),i.pivot=new a.Point(0,0),i._rotation=0,i._cx=1,i._sx=0,i._cy=0,i._sy=1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},e.prototype.updateLocalTransform=function(){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d)},e.prototype.updateTransform=function(t){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d);var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._worldID++},e.prototype.setFromMatrix=function(t){t.decompose(this)},n(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(((r=t("./TransformBase"))&&r.__esModule?r:{default:r}).default);i.default=o},{"../math":70,"./TransformBase":51}],51:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("../math"),n=function(){function t(){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.worldTransform=new r.Matrix,this.localTransform=new r.Matrix,this._worldID=0,this._parentID=0}return t.prototype.updateLocalTransform=function(){},t.prototype.updateTransform=function(t){var e=t.worldTransform,i=this.worldTransform,r=this.localTransform;i.a=r.a*e.a+r.b*e.c,i.b=r.a*e.b+r.b*e.d,i.c=r.c*e.a+r.d*e.c,i.d=r.c*e.b+r.d*e.d,i.tx=r.tx*e.a+r.ty*e.c+e.tx,i.ty=r.tx*e.b+r.ty*e.d+e.ty,this._worldID++},t}();i.default=n,n.prototype.updateWorldTransform=n.prototype.updateTransform,n.IDENTITY=new n},{"../math":70}],52:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=t("../math"),o=function(t){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.position=new a.ObservablePoint(i.onChange,i,0,0),i.scale=new a.ObservablePoint(i.onChange,i,1,1),i.pivot=new a.ObservablePoint(i.onChange,i,0,0),i.skew=new a.ObservablePoint(i.updateSkew,i,0,0),i._rotation=0,i._cx=1,i._sx=0,i._cy=0,i._sy=1,i._localID=0,i._currentLocalID=0,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},e.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},e.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},n(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(((r=t("./TransformBase"))&&r.__esModule?r:{default:r}).default);i.default=o},{"../math":70,"./TransformBase":51}],53:[function(t,e,i){"use strict";i.__esModule=!0;var r=m(t("../display/Container")),n=m(t("../textures/RenderTexture")),a=m(t("../textures/Texture")),o=m(t("./GraphicsData")),s=m(t("../sprites/Sprite")),h=t("../math"),c=t("../utils"),u=t("../const"),p=m(t("../display/Bounds")),l=m(t("./utils/bezierCurveTo")),d=m(t("../renderers/canvas/CanvasRenderer"));function m(t){return t&&t.__esModule?t:{default:t}}var f=void 0,_=new h.Matrix,y=new h.Point,g=new Float32Array(4),v=new Float32Array(4),w=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.fillAlpha=1,r.lineWidth=0,r.nativeLines=i,r.lineColor=0,r.graphicsData=[],r.tint=16777215,r._prevTint=16777215,r.blendMode=u.BLEND_MODES.NORMAL,r.currentPath=null,r._webGL={},r.isMask=!1,r.boundsPadding=0,r._localBounds=new p.default,r.dirty=0,r.fastRectDirty=-1,r.clearDirty=0,r.boundsDirty=-1,r.cachedSpriteDirty=!1,r._spriteRect=null,r._fastRect=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.clone=function(){var t=new e;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var i=0;i<this.graphicsData.length;++i)t.graphicsData.push(this.graphicsData[i].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},e.prototype.lineStyle=function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.lineWidth=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,this.lineColor=t,this.lineAlpha=e,this.currentPath)if(this.currentPath.shape.points.length){var i=new h.Polygon(this.currentPath.shape.points.slice(-2));i.closed=!1,this.drawShape(i)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},e.prototype.moveTo=function(t,e){var i=new h.Polygon([t,e]);return i.closed=!1,this.drawShape(i),this},e.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty++,this},e.prototype.quadraticCurveTo=function(t,e,i,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var n=this.currentPath.shape.points,a=0,o=0;0===n.length&&this.moveTo(0,0);for(var s=n[n.length-2],h=n[n.length-1],c=1;c<=20;++c){var u=c/20;n.push((a=s+(t-s)*u)+(t+(i-t)*u-a)*u,(o=h+(e-h)*u)+(e+(r-e)*u-o)*u)}return this.dirty++,this},e.prototype.bezierCurveTo=function(t,e,i,r,n,a){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=this.currentPath.shape.points,s=o[o.length-2],h=o[o.length-1];return o.length-=2,(0,l.default)(s,h,t,e,i,r,n,a,o),this.dirty++,this},e.prototype.arcTo=function(t,e,i,r,n){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var a=this.currentPath.shape.points,o=a[a.length-1]-e,s=a[a.length-2]-t,h=r-e,c=i-t,u=Math.abs(o*c-s*h);if(u<1e-8||0===n)a[a.length-2]===t&&a[a.length-1]===e||a.push(t,e);else{var p=o*o+s*s,l=h*h+c*c,d=o*h+s*c,m=n*Math.sqrt(p)/u,f=n*Math.sqrt(l)/u,_=m*d/p,y=f*d/l,g=m*c+f*s,v=m*h+f*o,w=c*(m+y),S=h*(m+y),b=Math.atan2(o*(f+_)-v,s*(f+_)-g),x=Math.atan2(S-v,w-g);this.arc(g+t,v+e,n,b,x,s*h>c*o)}return this.dirty++,this},e.prototype.arc=function(t,e,i,r,n){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(r===n)return this;!a&&n<=r?n+=2*Math.PI:a&&r<=n&&(r+=2*Math.PI);var o=n-r,s=40*Math.ceil(Math.abs(o)/(2*Math.PI));if(0===o)return this;var h=t+Math.cos(r)*i,c=e+Math.sin(r)*i,u=this.currentPath?this.currentPath.shape.points:null;u?u[u.length-2]===h&&u[u.length-1]===c||u.push(h,c):(this.moveTo(h,c),u=this.currentPath.shape.points);for(var p=o/(2*s),l=2*p,d=Math.cos(p),m=Math.sin(p),f=s-1,_=f%1/f,y=0;y<=f;++y){var g=p+r+l*(y+_*y),v=Math.cos(g),w=-Math.sin(g);u.push((d*v+m*w)*i+t,(d*-w+m*v)*i+e)}return this.dirty++,this},e.prototype.beginFill=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=t,this.fillAlpha=e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},e.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.prototype.drawRect=function(t,e,i,r){return this.drawShape(new h.Rectangle(t,e,i,r)),this},e.prototype.drawRoundedRect=function(t,e,i,r,n){return this.drawShape(new h.RoundedRectangle(t,e,i,r,n)),this},e.prototype.drawCircle=function(t,e,i){return this.drawShape(new h.Circle(t,e,i)),this},e.prototype.drawEllipse=function(t,e,i,r){return this.drawShape(new h.Ellipse(t,e,i,r)),this},e.prototype.drawPolygon=function(t){var e=t,i=!0;if(e instanceof h.Polygon&&(i=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var r=0;r<e.length;++r)e[r]=arguments[r]}var n=new h.Polygon(e);return n.closed=i,this.drawShape(n),this},e.prototype.clear=function(){return(this.lineWidth||this.filling||this.graphicsData.length>0)&&(this.lineWidth=0,this.filling=!1,this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},e.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===u.SHAPES.RECT&&!this.graphicsData[0].lineWidth},e.prototype._renderWebGL=function(t){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(t):(t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this))},e.prototype._renderSpriteRect=function(t){var e=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new s.default(new a.default(a.default.WHITE)));var i=this._spriteRect;if(16777215===this.tint)i.tint=this.graphicsData[0].fillColor;else{var r=g,n=v;(0,c.hex2rgb)(this.graphicsData[0].fillColor,r),(0,c.hex2rgb)(this.tint,n),r[0]*=n[0],r[1]*=n[1],r[2]*=n[2],i.tint=(0,c.rgb2hex)(r)}i.alpha=this.graphicsData[0].fillAlpha,i.worldAlpha=this.worldAlpha*i.alpha,i.blendMode=this.blendMode,i._texture._frame.width=e.width,i._texture._frame.height=e.height,i.transform.worldTransform=this.transform.worldTransform,i.anchor.set(-e.x/e.width,-e.y/e.height),i._onAnchorUpdate(),i._renderWebGL(t)},e.prototype._renderCanvas=function(t){!0!==this.isMask&&t.plugins.graphics.render(this)},e.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var t=this._localBounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,y);for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fill&&r.shape&&r.shape.contains(y.x,y.y)){if(r.holes)for(var n=0;n<r.holes.length;n++)if(r.holes[n].contains(y.x,y.y))return!1;return!0}}return!1},e.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,i=1/0,r=-1/0;if(this.graphicsData.length)for(var n=0,a=0,o=0,s=0,h=0,c=0;c<this.graphicsData.length;c++){var p=this.graphicsData[c],l=p.type,d=p.lineWidth;if(n=p.shape,l===u.SHAPES.RECT||l===u.SHAPES.RREC)t=(a=n.x-d/2)<t?a:t,e=a+(s=n.width+d)>e?a+s:e,i=(o=n.y-d/2)<i?o:i,r=o+(h=n.height+d)>r?o+h:r;else if(l===u.SHAPES.CIRC)t=(a=n.x)-(s=n.radius+d/2)<t?a-s:t,e=a+s>e?a+s:e,i=(o=n.y)-(h=n.radius+d/2)<i?o-h:i,r=o+h>r?o+h:r;else if(l===u.SHAPES.ELIP)t=(a=n.x)-(s=n.width+d/2)<t?a-s:t,e=a+s>e?a+s:e,i=(o=n.y)-(h=n.height+d/2)<i?o-h:i,r=o+h>r?o+h:r;else for(var m=n.points,f=0,_=0,y=0,g=0,v=0,w=0,S=0,b=0,x=0;x+2<m.length;x+=2)a=m[x],o=m[x+1],f=m[x+2],_=m[x+3],y=Math.abs(f-a),g=Math.abs(_-o),h=d,(s=Math.sqrt(y*y+g*g))<1e-9||(t=(S=(f+a)/2)-(v=(h/s*g+y)/2)<t?S-v:t,e=S+v>e?S+v:e,i=(b=(_+o)/2)-(w=(h/s*y+g)/2)<i?b-w:i,r=b+w>r?b+w:r)}else t=0,e=0,i=0,r=0;var T=this.boundsPadding;this._localBounds.minX=t-T,this._localBounds.maxX=e+T,this._localBounds.minY=i-T,this._localBounds.maxY=r+T},e.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new o.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,t);return this.graphicsData.push(e),e.type===u.SHAPES.POLY&&(e.shape.closed=e.shape.closed||this.filling,this.currentPath=e),this.dirty++,e},e.prototype.generateCanvasTexture=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.getLocalBounds(),r=n.default.create(i.width,i.height,t,e);f||(f=new d.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(_),_.invert(),_.tx-=i.x,_.ty-=i.y,f.render(this,r,!0,_);var o=a.default.fromCanvas(r.baseTexture._canvasRenderTarget.canvas,t,"graphics");return o.baseTexture.resolution=e,o.baseTexture.update(),o},e.prototype.closePath=function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this},e.prototype.addHole=function(){var t=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(t.shape),this.currentPath=null,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();for(var r in this._webgl)for(var n=0;n<this._webgl[r].data.length;++n)this._webgl[r].data[n].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null},e}(r.default);i.default=w,w._SPRITE_TEXTURE=null},{"../const":46,"../display/Bounds":47,"../display/Container":48,"../math":70,"../renderers/canvas/CanvasRenderer":77,"../sprites/Sprite":102,"../textures/RenderTexture":113,"../textures/Texture":115,"../utils":124,"./GraphicsData":54,"./utils/bezierCurveTo":56}],54:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(e,i,r,n,a,o,s,h){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.lineWidth=e,this.nativeLines=s,this.lineColor=i,this.lineAlpha=r,this._lineTint=i,this.fillColor=n,this.fillAlpha=a,this._fillTint=n,this.fill=o,this.holes=[],this.shape=h,this.type=h.type}return t.prototype.clone=function(){return new t(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},t.prototype.addHole=function(t){this.holes.push(t)},t.prototype.destroy=function(){this.shape=null,this.holes=null},t}();i.default=r},{}],55:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("../../renderers/canvas/CanvasRenderer"))&&r.__esModule?r:{default:r},a=t("../../const"),o=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,i=e.context,r=t.worldAlpha,n=t.transform.worldTransform,o=e.resolution;this._prevTint!==this.tint&&(this.dirty=!0),i.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1),e.setBlendMode(t.blendMode);for(var s=0;s<t.graphicsData.length;s++){var h=t.graphicsData[s],c=h.shape,u=h._fillTint,p=h._lineTint;if(i.lineWidth=h.lineWidth,h.type===a.SHAPES.POLY){i.beginPath(),this.renderPolygon(c.points,c.closed,i);for(var l=0;l<h.holes.length;l++)this.renderPolygon(h.holes[l].points,!0,i);h.fill&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fill()),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.stroke())}else if(h.type===a.SHAPES.RECT)(h.fillColor||0===h.fillColor)&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fillRect(c.x,c.y,c.width,c.height)),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.strokeRect(c.x,c.y,c.width,c.height));else if(h.type===a.SHAPES.CIRC)i.beginPath(),i.arc(c.x,c.y,c.radius,0,2*Math.PI),i.closePath(),h.fill&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fill()),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.stroke());else if(h.type===a.SHAPES.ELIP){var d=2*c.width,m=2*c.height,f=c.x-d/2,_=c.y-m/2;i.beginPath();var y=d/2*.5522848,g=m/2*.5522848,v=f+d,w=_+m,S=f+d/2,b=_+m/2;i.moveTo(f,b),i.bezierCurveTo(f,b-g,S-y,_,S,_),i.bezierCurveTo(S+y,_,v,b-g,v,b),i.bezierCurveTo(v,b+g,S+y,w,S,w),i.bezierCurveTo(S-y,w,f,b+g,f,b),i.closePath(),h.fill&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fill()),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.stroke())}else if(h.type===a.SHAPES.RREC){var x=c.x,T=c.y,M=c.width,E=c.height,I=c.radius,C=Math.min(M,E)/2|0;I=I>C?C:I,i.beginPath(),i.moveTo(x,T+I),i.lineTo(x,T+E-I),i.quadraticCurveTo(x,T+E,x+I,T+E),i.lineTo(x+M-I,T+E),i.quadraticCurveTo(x+M,T+E,x+M,T+E-I),i.lineTo(x+M,T+I),i.quadraticCurveTo(x+M,T,x+M-I,T),i.lineTo(x+I,T),i.quadraticCurveTo(x,T,x,T+I),i.closePath(),(h.fillColor||0===h.fillColor)&&(i.globalAlpha=h.fillAlpha*r,i.fillStyle="#"+("00000"+(0|u).toString(16)).substr(-6),i.fill()),h.lineWidth&&(i.globalAlpha=h.lineAlpha*r,i.strokeStyle="#"+("00000"+(0|p).toString(16)).substr(-6),i.stroke())}}},t.prototype.updateGraphicsTint=function(t){t._prevTint=t.tint;for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,r=(255&t.tint)/255,n=0;n<t.graphicsData.length;++n){var a=t.graphicsData[n],o=0|a.fillColor,s=0|a.lineColor;a._fillTint=((o>>16&255)/255*e*255<<16)+((o>>8&255)/255*i*255<<8)+(255&o)/255*r*255,a._lineTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*i*255<<8)+(255&s)/255*r*255}},t.prototype.renderPolygon=function(t,e,i){i.moveTo(t[0],t[1]);for(var r=1;r<t.length/2;++r)i.lineTo(t[2*r],t[2*r+1]);e&&i.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();i.default=o,n.default.registerPlugin("graphics",o)},{"../../const":46,"../../renderers/canvas/CanvasRenderer":77}],56:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i,r,n,a,o,s){var h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],c=0,u=0,p=0,l=0,d=0;h.push(t,e);for(var m=1,f=0;m<=20;++m)h.push((p=(u=(c=1-(f=m/20))*c)*c)*t+3*u*f*i+3*c*(l=f*f)*n+(d=l*f)*o,p*e+3*u*f*r+3*c*l*a+d*s);return h}},{}],57:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("../../utils"),n=t("../../const"),a=d(t("../../renderers/webgl/utils/ObjectRenderer")),o=d(t("../../renderers/webgl/WebGLRenderer")),s=d(t("./WebGLGraphicsData")),h=d(t("./shaders/PrimitiveShader")),c=d(t("./utils/buildPoly")),u=d(t("./utils/buildRectangle")),p=d(t("./utils/buildRoundedRectangle")),l=d(t("./utils/buildCircle"));function d(t){return t&&t.__esModule?t:{default:t}}var m=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.graphicsDataPool=[],r.primitiveShader=null,r.gl=i.gl,r.CONTEXT_UID=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new h.default(this.gl)},e.prototype.destroy=function(){a.default.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},e.prototype.render=function(t){var e=this.renderer,i=e.gl,n=void 0,a=t._webGL[this.CONTEXT_UID];a&&t.dirty===a.dirty||(this.updateGraphics(t),a=t._webGL[this.CONTEXT_UID]),e.bindShader(this.primitiveShader),e.state.setBlendMode(t.blendMode);for(var o=0,s=a.data.length;o<s;o++){var h=(n=a.data[o]).shader;e.bindShader(h),h.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),h.uniforms.tint=(0,r.hex2rgb)(t.tint),h.uniforms.alpha=t.worldAlpha,e.bindVao(n.vao),n.nativeLines?i.drawArrays(i.LINES,0,n.points.length/6):n.vao.draw(i.TRIANGLE_STRIP,n.indices.length)}},e.prototype.updateGraphics=function(t){var e=t._webGL[this.CONTEXT_UID];if(e||(e=t._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:this.renderer.gl,clearDirty:-1,dirty:-1}),e.dirty=t.dirty,t.clearDirty!==e.clearDirty){e.clearDirty=t.clearDirty;for(var i=0;i<e.data.length;i++)this.graphicsDataPool.push(e.data[i]);e.data.length=0,e.lastIndex=0}for(var r=void 0,a=void 0,o=e.lastIndex;o<t.graphicsData.length;o++){var s=t.graphicsData[o];r=this.getWebGLData(e,0),s.nativeLines&&s.lineWidth&&(a=this.getWebGLData(e,0,!0),e.lastIndex++),s.type===n.SHAPES.POLY&&(0,c.default)(s,r,a),s.type===n.SHAPES.RECT?(0,u.default)(s,r,a):s.type===n.SHAPES.CIRC||s.type===n.SHAPES.ELIP?(0,l.default)(s,r,a):s.type===n.SHAPES.RREC&&(0,p.default)(s,r,a),e.lastIndex++}this.renderer.bindVao(null);for(var h=0;h<e.data.length;h++)(r=e.data[h]).dirty&&r.upload()},e.prototype.getWebGLData=function(t,e,i){var r=t.data[t.data.length-1];return(!r||r.nativeLines!==i||r.points.length>32e4)&&((r=this.graphicsDataPool.pop()||new s.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState)).nativeLines=i,r.reset(e),t.data.push(r)),r.dirty=!0,r},e}(a.default);i.default=m,o.default.registerPlugin("graphics",m)},{"../../const":46,"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../utils":124,"./WebGLGraphicsData":58,"./shaders/PrimitiveShader":59,"./utils/buildCircle":60,"./utils/buildPoly":62,"./utils/buildRectangle":63,"./utils/buildRoundedRectangle":64}],58:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("pixi-gl-core"))&&r.__esModule?r:{default:r},a=function(){function t(e,i,r){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=n.default.GLBuffer.createVertexBuffer(e),this.indexBuffer=n.default.GLBuffer.createIndexBuffer(e),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=i,this.vao=new n.default.VertexArrayObject(e,r).addIndex(this.indexBuffer).addAttribute(this.buffer,i.attributes.aVertexPosition,e.FLOAT,!1,24,0).addAttribute(this.buffer,i.attributes.aColor,e.FLOAT,!1,24,8)}return t.prototype.reset=function(){this.points.length=0,this.indices.length=0},t.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},t.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},t}();i.default=a},{"pixi-gl-core":7}],59:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(t){function e(i){return function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((r=t("../../../Shader"))&&r.__esModule?r:{default:r}).default);i.default=n},{"../../../Shader":44}],60:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){var r=t.shape,s=r.x,h=r.y,c=void 0,u=void 0;if(t.type===a.SHAPES.CIRC?(c=r.radius,u=r.radius):(c=r.width,u=r.height),0!==c&&0!==u){var p=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(r.width+r.height)),l=2*Math.PI/p;if(t.fill){var d=(0,o.hex2rgb)(t.fillColor),m=t.fillAlpha,f=d[0]*m,_=d[1]*m,y=d[2]*m,g=e.points,v=e.indices,w=g.length/6;v.push(w);for(var S=0;S<p+1;S++)g.push(s,h,f,_,y,m),g.push(s+Math.sin(l*S)*c,h+Math.cos(l*S)*u,f,_,y,m),v.push(w++,w++);v.push(w-1)}if(t.lineWidth){var b=t.points;t.points=[];for(var x=0;x<p+1;x++)t.points.push(s+Math.sin(l*x)*c,h+Math.cos(l*x)*u);(0,n.default)(t,e,i),t.points=b}}};var r,n=(r=t("./buildLine"))&&r.__esModule?r:{default:r},a=t("../../../const"),o=t("../../../utils")},{"../../../const":46,"../../../utils":124,"./buildLine":61}],61:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){t.nativeLines?function(t,e){var r=0,a=t.points;if(0!==a.length){var o=i.points,s=a.length/2,h=(0,n.hex2rgb)(t.lineColor),c=t.lineAlpha,u=h[0]*c,p=h[1]*c,l=h[2]*c;for(r=1;r<s;r++){var d=a[2*r],m=a[2*r+1];o.push(a[2*(r-1)],a[2*(r-1)+1]),o.push(u,p,l,c),o.push(d,m),o.push(u,p,l,c)}}}(t):function(t,e){var i=t.points;if(0!==i.length){var a=new r.Point(i[0],i[1]),o=new r.Point(i[i.length-2],i[i.length-1]);if(a.x===o.x&&a.y===o.y){(i=i.slice()).pop(),i.pop();var s=(o=new r.Point(i[i.length-2],i[i.length-1])).x+.5*(a.x-o.x),h=o.y+.5*(a.y-o.y);i.unshift(s,h),i.push(s,h)}var c=e.points,u=e.indices,p=i.length/2,l=i.length,d=c.length/6,m=t.lineWidth/2,f=(0,n.hex2rgb)(t.lineColor),_=t.lineAlpha,y=f[0]*_,g=f[1]*_,v=f[2]*_,w=i[0],S=i[1],b=i[2],x=i[3],T=0,M=0,E=-(S-x),I=w-b,C=0,A=0,B=0,W=0,P=Math.sqrt(E*E+I*I);E/=P,I/=P,c.push(w-(E*=m),S-(I*=m),y,g,v,_),c.push(w+E,S+I,y,g,v,_);for(var O=1;O<p-1;++O){T=i[2*(O+1)],M=i[2*(O+1)+1],E=-((S=i[2*(O-1)+1])-(x=i[2*O+1])),I=(w=i[2*(O-1)])-(b=i[2*O]),E/=P=Math.sqrt(E*E+I*I),I/=P,E*=m,I*=m,C=-(x-M),A=b-T,C/=P=Math.sqrt(C*C+A*A),A/=P;var G=-I+S-(-I+x),R=-E+b-(-E+w),k=(-E+w)*(-I+x)-(-E+b)*(-I+S),D=-(A*=m)+M-(-A+x),L=-(C*=m)+b-(-C+T),F=(-C+T)*(-A+x)-(-C+b)*(-A+M),N=G*L-D*R;if(Math.abs(N)<.1)N+=10.1,c.push(b-E,x-I,y,g,v,_),c.push(b+E,x+I,y,g,v,_);else{var U=(R*F-L*k)/N,j=(D*k-G*F)/N;(U-b)*(U-b)+(j-x)*(j-x)>196*m*m?(B=E-C,W=I-A,B/=P=Math.sqrt(B*B+W*W),W/=P,c.push(b-(B*=m),x-(W*=m)),c.push(y,g,v,_),c.push(b+B,x+W),c.push(y,g,v,_),c.push(b-B,x-W),c.push(y,g,v,_),l++):(c.push(U,j),c.push(y,g,v,_),c.push(b-(U-b),x-(j-x)),c.push(y,g,v,_))}}E=-((S=i[2*(p-2)+1])-(x=i[2*(p-1)+1])),I=(w=i[2*(p-2)])-(b=i[2*(p-1)]),E/=P=Math.sqrt(E*E+I*I),I/=P,c.push(b-(E*=m),x-(I*=m)),c.push(y,g,v,_),c.push(b+E,x+I),c.push(y,g,v,_),u.push(d);for(var H=0;H<l;++H)u.push(d++);u.push(d-1)}}(t,e)};var r=t("../../../math"),n=t("../../../utils")},{"../../../math":70,"../../../utils":124}],62:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){t.points=t.shape.points.slice();var o=t.points;if(t.fill&&o.length>=6){for(var s=[],h=t.holes,c=0;c<h.length;c++){var u=h[c];s.push(o.length/2),o=o.concat(u.points)}var p=e.points,l=e.indices,d=o.length/2,m=(0,n.hex2rgb)(t.fillColor),f=t.fillAlpha,_=m[0]*f,y=m[1]*f,g=m[2]*f,v=(0,a.default)(o,s,2);if(!v)return;for(var w=p.length/6,S=0;S<v.length;S+=3)l.push(v[S]+w),l.push(v[S]+w),l.push(v[S+1]+w),l.push(v[S+2]+w),l.push(v[S+2]+w);for(var b=0;b<d;b++)p.push(o[2*b],o[2*b+1],_,y,g,f)}t.lineWidth>0&&(0,r.default)(t,e,i)};var r=o(t("./buildLine")),n=t("../../../utils"),a=o(t("earcut"));function o(t){return t&&t.__esModule?t:{default:t}}},{"../../../utils":124,"./buildLine":61,earcut:19}],63:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){var r=t.shape,o=r.x,s=r.y,h=r.width,c=r.height;if(t.fill){var u=(0,a.hex2rgb)(t.fillColor),p=t.fillAlpha,l=u[0]*p,d=u[1]*p,m=u[2]*p,f=e.points,_=e.indices,y=f.length/6;f.push(o,s),f.push(l,d,m,p),f.push(o+h,s),f.push(l,d,m,p),f.push(o,s+c),f.push(l,d,m,p),f.push(o+h,s+c),f.push(l,d,m,p),_.push(y,y,y+1,y+2,y+3,y+3)}if(t.lineWidth){var g=t.points;t.points=[o,s,o+h,s,o+h,s+c,o,s+c,o,s],(0,n.default)(t,e,i),t.points=g}};var r,n=(r=t("./buildLine"))&&r.__esModule?r:{default:r},a=t("../../../utils")},{"../../../utils":124,"./buildLine":61}],64:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){var o=t.shape,s=o.x,c=o.y,u=o.width,p=o.height,l=o.radius,d=[];if(d.push(s,c+l),h(s,c+p-l,s,c+p,s+l,c+p,d),h(s+u-l,c+p,s+u,c+p,s+u,c+p-l,d),h(s+u,c+l,s+u,c,s+u-l,c,d),h(s+l,c,s,c,s,c+l+1e-10,d),t.fill){for(var m=(0,a.hex2rgb)(t.fillColor),f=t.fillAlpha,_=m[0]*f,y=m[1]*f,g=m[2]*f,v=e.points,w=e.indices,S=v.length/6,b=(0,r.default)(d,null,2),x=0,T=b.length;x<T;x+=3)w.push(b[x]+S),w.push(b[x]+S),w.push(b[x+1]+S),w.push(b[x+2]+S),w.push(b[x+2]+S);for(var M=0,E=d.length;M<E;M++)v.push(d[M],d[++M],_,y,g,f)}if(t.lineWidth){var I=t.points;t.points=d,(0,n.default)(t,e,i),t.points=I}};var r=o(t("earcut")),n=o(t("./buildLine")),a=t("../../../utils");function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e,i){return t+(e-t)*i}function h(t,e,i,r,n,a){for(var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],h=0,c=0,u=0,p=0,l=0,d=0,m=0,f=0;m<=20;++m)h=s(t,i,f=m/20),c=s(e,r,f),u=s(i,n,f),p=s(r,a,f),l=s(h,u,f),d=s(c,p,f),o.push(l,d);return o}},{"../../../utils":124,"./buildLine":61,earcut:19}],65:[function(t,e,i){"use strict";i.__esModule=!0,i.autoDetectRenderer=i.Application=i.Filter=i.SpriteMaskFilter=i.Quad=i.RenderTarget=i.ObjectRenderer=i.WebGLManager=i.Shader=i.CanvasRenderTarget=i.TextureUvs=i.VideoBaseTexture=i.BaseRenderTexture=i.RenderTexture=i.BaseTexture=i.Texture=i.Spritesheet=i.CanvasGraphicsRenderer=i.GraphicsRenderer=i.GraphicsData=i.Graphics=i.TextMetrics=i.TextStyle=i.Text=i.SpriteRenderer=i.CanvasTinter=i.CanvasSpriteRenderer=i.Sprite=i.TransformBase=i.TransformStatic=i.Transform=i.Container=i.DisplayObject=i.Bounds=i.glCore=i.WebGLRenderer=i.CanvasRenderer=i.ticker=i.utils=i.settings=void 0;var r=t("./const");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return r[t]}})});var n=t("./math");Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return n[t]}})});var a=t("pixi-gl-core");Object.defineProperty(i,"glCore",{enumerable:!0,get:function(){return z(a).default}});var o=t("./display/Bounds");Object.defineProperty(i,"Bounds",{enumerable:!0,get:function(){return z(o).default}});var s=t("./display/DisplayObject");Object.defineProperty(i,"DisplayObject",{enumerable:!0,get:function(){return z(s).default}});var h=t("./display/Container");Object.defineProperty(i,"Container",{enumerable:!0,get:function(){return z(h).default}});var c=t("./display/Transform");Object.defineProperty(i,"Transform",{enumerable:!0,get:function(){return z(c).default}});var u=t("./display/TransformStatic");Object.defineProperty(i,"TransformStatic",{enumerable:!0,get:function(){return z(u).default}});var p=t("./display/TransformBase");Object.defineProperty(i,"TransformBase",{enumerable:!0,get:function(){return z(p).default}});var l=t("./sprites/Sprite");Object.defineProperty(i,"Sprite",{enumerable:!0,get:function(){return z(l).default}});var d=t("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(i,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return z(d).default}});var m=t("./sprites/canvas/CanvasTinter");Object.defineProperty(i,"CanvasTinter",{enumerable:!0,get:function(){return z(m).default}});var f=t("./sprites/webgl/SpriteRenderer");Object.defineProperty(i,"SpriteRenderer",{enumerable:!0,get:function(){return z(f).default}});var _=t("./text/Text");Object.defineProperty(i,"Text",{enumerable:!0,get:function(){return z(_).default}});var y=t("./text/TextStyle");Object.defineProperty(i,"TextStyle",{enumerable:!0,get:function(){return z(y).default}});var g=t("./text/TextMetrics");Object.defineProperty(i,"TextMetrics",{enumerable:!0,get:function(){return z(g).default}});var v=t("./graphics/Graphics");Object.defineProperty(i,"Graphics",{enumerable:!0,get:function(){return z(v).default}});var w=t("./graphics/GraphicsData");Object.defineProperty(i,"GraphicsData",{enumerable:!0,get:function(){return z(w).default}});var S=t("./graphics/webgl/GraphicsRenderer");Object.defineProperty(i,"GraphicsRenderer",{enumerable:!0,get:function(){return z(S).default}});var b=t("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(i,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return z(b).default}});var x=t("./textures/Spritesheet");Object.defineProperty(i,"Spritesheet",{enumerable:!0,get:function(){return z(x).default}});var T=t("./textures/Texture");Object.defineProperty(i,"Texture",{enumerable:!0,get:function(){return z(T).default}});var M=t("./textures/BaseTexture");Object.defineProperty(i,"BaseTexture",{enumerable:!0,get:function(){return z(M).default}});var E=t("./textures/RenderTexture");Object.defineProperty(i,"RenderTexture",{enumerable:!0,get:function(){return z(E).default}});var I=t("./textures/BaseRenderTexture");Object.defineProperty(i,"BaseRenderTexture",{enumerable:!0,get:function(){return z(I).default}});var C=t("./textures/VideoBaseTexture");Object.defineProperty(i,"VideoBaseTexture",{enumerable:!0,get:function(){return z(C).default}});var A=t("./textures/TextureUvs");Object.defineProperty(i,"TextureUvs",{enumerable:!0,get:function(){return z(A).default}});var B=t("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(i,"CanvasRenderTarget",{enumerable:!0,get:function(){return z(B).default}});var W=t("./Shader");Object.defineProperty(i,"Shader",{enumerable:!0,get:function(){return z(W).default}});var P=t("./renderers/webgl/managers/WebGLManager");Object.defineProperty(i,"WebGLManager",{enumerable:!0,get:function(){return z(P).default}});var O=t("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(i,"ObjectRenderer",{enumerable:!0,get:function(){return z(O).default}});var G=t("./renderers/webgl/utils/RenderTarget");Object.defineProperty(i,"RenderTarget",{enumerable:!0,get:function(){return z(G).default}});var R=t("./renderers/webgl/utils/Quad");Object.defineProperty(i,"Quad",{enumerable:!0,get:function(){return z(R).default}});var k=t("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(i,"SpriteMaskFilter",{enumerable:!0,get:function(){return z(k).default}});var D=t("./renderers/webgl/filters/Filter");Object.defineProperty(i,"Filter",{enumerable:!0,get:function(){return z(D).default}});var L=t("./Application");Object.defineProperty(i,"Application",{enumerable:!0,get:function(){return z(L).default}});var F=t("./autoDetectRenderer");Object.defineProperty(i,"autoDetectRenderer",{enumerable:!0,get:function(){return F.autoDetectRenderer}});var N=V(t("./utils")),U=V(t("./ticker")),j=z(t("./settings")),H=z(t("./renderers/canvas/CanvasRenderer")),$=z(t("./renderers/webgl/WebGLRenderer"));function V(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function z(t){return t&&t.__esModule?t:{default:t}}i.settings=j.default,i.utils=N,i.ticker=U,i.CanvasRenderer=H.default,i.WebGLRenderer=$.default},{"./Application":43,"./Shader":44,"./autoDetectRenderer":45,"./const":46,"./display/Bounds":47,"./display/Container":48,"./display/DisplayObject":49,"./display/Transform":50,"./display/TransformBase":51,"./display/TransformStatic":52,"./graphics/Graphics":53,"./graphics/GraphicsData":54,"./graphics/canvas/CanvasGraphicsRenderer":55,"./graphics/webgl/GraphicsRenderer":57,"./math":70,"./renderers/canvas/CanvasRenderer":77,"./renderers/canvas/utils/CanvasRenderTarget":79,"./renderers/webgl/WebGLRenderer":84,"./renderers/webgl/filters/Filter":86,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":89,"./renderers/webgl/managers/WebGLManager":93,"./renderers/webgl/utils/ObjectRenderer":94,"./renderers/webgl/utils/Quad":95,"./renderers/webgl/utils/RenderTarget":96,"./settings":101,"./sprites/Sprite":102,"./sprites/canvas/CanvasSpriteRenderer":103,"./sprites/canvas/CanvasTinter":104,"./sprites/webgl/SpriteRenderer":106,"./text/Text":108,"./text/TextMetrics":109,"./text/TextStyle":110,"./textures/BaseRenderTexture":111,"./textures/BaseTexture":112,"./textures/RenderTexture":113,"./textures/Spritesheet":114,"./textures/Texture":115,"./textures/TextureUvs":116,"./textures/VideoBaseTexture":117,"./ticker":120,"./utils":124,"pixi-gl-core":7}],66:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("./Matrix"))&&r.__esModule?r:{default:r},a=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],o=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],s=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],h=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],c=[],u=[];function p(t){return t<0?-1:t>0?1:0}!function(){for(var t=0;t<16;t++){var e=[];u.push(e);for(var i=0;i<16;i++)for(var r=p(a[t]*a[i]+s[t]*o[i]),l=p(o[t]*a[i]+h[t]*o[i]),d=p(a[t]*s[i]+s[t]*h[i]),m=p(o[t]*s[i]+h[t]*h[i]),f=0;f<16;f++)if(a[f]===r&&o[f]===l&&s[f]===d&&h[f]===m){e.push(f);break}}for(var _=0;_<16;_++){var y=new n.default;y.set(a[_],o[_],s[_],h[_],0,0),c.push(y)}}();var l={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return a[t]},uY:function(t){return o[t]},vX:function(t){return s[t]},vY:function(t){return h[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return u[t][e]},sub:function(t,e){return u[t][l.inv(e)]},rotate180:function(t){return 4^t},isSwapWidthHeight:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?l.S:l.N:2*Math.abs(e)<=Math.abs(t)?t>0?l.E:l.W:e>0?t>0?l.SE:l.SW:t>0?l.NE:l.NW},matrixAppendRotationInv:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=c[l.inv(e)];n.tx=i,n.ty=r,t.append(n)}};i.default=l},{"./Matrix":67}],67:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=(r=t("./Point"))&&r.__esModule?r:{default:r},o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=a,this.ty=o,this.array=null}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,i,r,n,a){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=a,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},t.prototype.apply=function(t,e){e=e||new a.default;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new a.default;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,a=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=a*e-this.ty*i,this.ty=a*i+this.ty*e,this},t.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},t.prototype.setTransform=function(t,e,i,r,n,a,o,s,h){var c=Math.sin(o),u=Math.cos(o),p=Math.cos(h),l=Math.sin(h),d=-Math.sin(s),m=Math.cos(s),f=u*n,_=c*n,y=-c*a,g=u*a;return this.a=p*f+l*y,this.b=p*_+l*g,this.c=d*f+m*y,this.d=d*_+m*g,this.tx=t+(i*f+r*y),this.ty=e+(i*_+r*g),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,a=-Math.atan2(-r,n),o=Math.atan2(i,e);return Math.abs(a+o)<1e-5?(t.rotation=o,e<0&&n>=0&&(t.rotation+=t.rotation<=0?Math.PI:-Math.PI),t.skew.x=t.skew.y=0):(t.skew.x=a,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,a=t*r-e*i;return this.a=r/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-r*n)/a,this.ty=-(t*this.ty-e*n)/a,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},n(t,null,[{key:"IDENTITY",get:function(){return new t}},{key:"TEMP_MATRIX",get:function(){return new t}}]),t}();i.default=o},{"./Point":69}],68:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this._x=r,this._y=n,this.cb=e,this.scope=i}return t.prototype.set=function(t,e){var i=t||0,r=e||(0!==e?i:0);this._x===i&&this._y===r||(this._x=i,this._y=r,this.cb.call(this.scope))},t.prototype.copy=function(t){this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope))},r(t,[{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}]),t}();i.default=n},{}],69:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.x=e,this.y=i}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copy=function(t){this.set(t.x,t.y)},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},t}();i.default=r},{}],70:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("./Point");Object.defineProperty(i,"Point",{enumerable:!0,get:function(){return l(r).default}});var n=t("./ObservablePoint");Object.defineProperty(i,"ObservablePoint",{enumerable:!0,get:function(){return l(n).default}});var a=t("./Matrix");Object.defineProperty(i,"Matrix",{enumerable:!0,get:function(){return l(a).default}});var o=t("./GroupD8");Object.defineProperty(i,"GroupD8",{enumerable:!0,get:function(){return l(o).default}});var s=t("./shapes/Circle");Object.defineProperty(i,"Circle",{enumerable:!0,get:function(){return l(s).default}});var h=t("./shapes/Ellipse");Object.defineProperty(i,"Ellipse",{enumerable:!0,get:function(){return l(h).default}});var c=t("./shapes/Polygon");Object.defineProperty(i,"Polygon",{enumerable:!0,get:function(){return l(c).default}});var u=t("./shapes/Rectangle");Object.defineProperty(i,"Rectangle",{enumerable:!0,get:function(){return l(u).default}});var p=t("./shapes/RoundedRectangle");function l(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"RoundedRectangle",{enumerable:!0,get:function(){return l(p).default}})},{"./GroupD8":66,"./Matrix":67,"./ObservablePoint":68,"./Point":69,"./shapes/Circle":71,"./shapes/Ellipse":72,"./shapes/Polygon":73,"./shapes/Rectangle":74,"./shapes/RoundedRectangle":75}],71:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("./Rectangle"))&&r.__esModule?r:{default:r},a=t("../../const"),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.x=e,this.y=i,this.radius=r,this.type=a.SHAPES.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.x-t,r=this.y-e;return(i*=i)+(r*=r)<=this.radius*this.radius},t.prototype.getBounds=function(){return new n.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}();i.default=o},{"../../const":46,"./Rectangle":74}],72:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("./Rectangle"))&&r.__esModule?r:{default:r},a=t("../../const"),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.x=e,this.y=i,this.width=r,this.height=n,this.type=a.SHAPES.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},t.prototype.getBounds=function(){return new n.default(this.x-this.width,this.y-this.height,this.width,this.height)},t}();i.default=o},{"../../const":46,"./Rectangle":74}],73:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("../Point"))&&r.__esModule?r:{default:r},a=t("../../const"),o=function(){function t(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];if(function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),Array.isArray(i[0])&&(i=i[0]),i[0]instanceof n.default){for(var o=[],s=0,h=i.length;s<h;s++)o.push(i[s].x,i[s].y);i=o}this.closed=!0,this.points=i,this.type=a.SHAPES.POLY}return t.prototype.clone=function(){return new t(this.points.slice())},t.prototype.close=function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1])},t.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,a=r-1;n<r;a=n++){var o=this.points[2*n],s=this.points[2*n+1],h=this.points[2*a+1];s>e!=h>e&&t<(e-s)/(h-s)*(this.points[2*a]-o)+o&&(i=!i)}return i},t}();i.default=o},{"../../const":46,"../Point":69}],74:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=t("../../const"),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.x=Number(e),this.y=Number(i),this.width=Number(r),this.height=Number(a),this.type=n.SHAPES.RECT}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},t.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},t.prototype.fit=function(t){this.x<t.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=t.x),this.y<t.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=t.y),this.x+this.width>t.x+t.width&&(this.width=t.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>t.y+t.height&&(this.height=t.height-this.y,this.height<0&&(this.height=0))},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=i-e,this.y=r,this.height=n-r},r(t,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new t(0,0,0,0)}}]),t}();i.default=a},{"../../const":46}],75:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("../../const"),n=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.x=e,this.y=i,this.width=n,this.height=a,this.radius=o,this.type=r.SHAPES.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1},t}();i.default=n},{"../../const":46}],76:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=t("../utils"),a=t("../math"),o=t("../const"),s=p(t("../settings")),h=p(t("../display/Container")),c=p(t("../textures/RenderTexture")),u=p(t("eventemitter3"));function p(t){return t&&t.__esModule?t:{default:t}}var l=new a.Matrix,d=function(t){function e(i,r,c,u){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var p=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return(0,n.sayHello)(i),"number"==typeof r&&(r=Object.assign({width:r,height:c||s.default.RENDER_OPTIONS.height},u)),r=Object.assign({},s.default.RENDER_OPTIONS,r),p.options=r,p.type=o.RENDERER_TYPE.UNKNOWN,p.screen=new a.Rectangle(0,0,r.width,r.height),p.view=r.view||document.createElement("canvas"),p.resolution=r.resolution||s.default.RESOLUTION,p.transparent=r.transparent,p.autoResize=r.autoResize||!1,p.blendModes=null,p.preserveDrawingBuffer=r.preserveDrawingBuffer,p.clearBeforeRender=r.clearBeforeRender,p.roundPixels=r.roundPixels,p._backgroundColor=0,p._backgroundColorRgba=[0,0,0,0],p._backgroundColorString="#000000",p.backgroundColor=r.backgroundColor||p._backgroundColor,p._tempDisplayObjectParent=new h.default,p._lastObjectRendered=p._tempDisplayObjectParent,p}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoResize&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,i){var r=t.getLocalBounds(),n=c.default.create(0|r.width,0|r.height,e,i);return l.tx=-r.x,l.ty=-r.y,this.render(t,n,!1,l,!0),n},e.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=o.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},r(e,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=(0,n.hex2string)(t),(0,n.hex2rgb)(t,this._backgroundColorRgba)}}]),e}(u.default);i.default=d},{"../const":46,"../display/Container":48,"../math":70,"../settings":101,"../textures/RenderTexture":113,"../utils":124,eventemitter3:20}],77:[function(t,e,i){"use strict";i.__esModule=!0;var r=u(t("../SystemRenderer")),n=u(t("./utils/CanvasMaskManager")),a=u(t("./utils/CanvasRenderTarget")),o=u(t("./utils/mapCanvasBlendModesToPixi")),s=t("../../utils"),h=t("../../const"),c=u(t("../../settings"));function u(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(i,r,a){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"Canvas",i,r,a));return s.type=h.RENDERER_TYPE.CANVAS,s.rootContext=s.view.getContext("2d",{alpha:s.transparent}),s.context=s.rootContext,s.refresh=!0,s.maskManager=new n.default(s),s.smoothProperty="imageSmoothingEnabled",s.rootContext.imageSmoothingEnabled||(s.rootContext.webkitImageSmoothingEnabled?s.smoothProperty="webkitImageSmoothingEnabled":s.rootContext.mozImageSmoothingEnabled?s.smoothProperty="mozImageSmoothingEnabled":s.rootContext.oImageSmoothingEnabled?s.smoothProperty="oImageSmoothingEnabled":s.rootContext.msImageSmoothingEnabled&&(s.smoothProperty="msImageSmoothingEnabled")),s.initPlugins(),s.blendModes=(0,o.default)(),s._activeBlendMode=null,s.renderingToScreen=!1,s.resize(s.options.width,s.options.height),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(t,e,i,r,n){if(this.view){this.renderingToScreen=!e,this.emit("prerender");var o=this.resolution;e?((e=e.baseTexture||e)._canvasRenderTarget||(e._canvasRenderTarget=new a.default(e.width,e.height,e.resolution),e.source=e._canvasRenderTarget.canvas,e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var s=this.context;if(e||(this._lastObjectRendered=t),!n){var c=t.parent,u=this._tempDisplayObjectParent.transform.worldTransform;r?(r.copy(u),this._tempDisplayObjectParent.transform._worldID=-1):u.identity(),t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=c}s.setTransform(1,0,0,1,0,0),s.globalAlpha=1,this._activeBlendMode=h.BLEND_MODES.NORMAL,s.globalCompositeOperation=this.blendModes[h.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(s.fillStyle="black",s.clear()),(void 0!==i?i:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?s.clearRect(0,0,this.width,this.height):(s.fillStyle=this._backgroundColorString,s.fillRect(0,0,this.width,this.height)));var p=this.context;this.context=s,t.renderCanvas(this),this.context=p,this.resolution=o,this.emit("postrender")}},e.prototype.clear=function(t){var e=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(e.fillStyle=t,e.fillRect(0,0,this.width,this.height)):e.clearRect(0,0,this.width,this.height)},e.prototype.setBlendMode=function(t){this._activeBlendMode!==t&&(this._activeBlendMode=t,this.context.globalCompositeOperation=this.blendModes[t])},e.prototype.destroy=function(e){this.destroyPlugins(),t.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.smoothProperty&&(this.rootContext[this.smoothProperty]=c.default.SCALE_MODE===h.SCALE_MODES.LINEAR)},e.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},e}(r.default);i.default=p,s.pluginTarget.mixin(p)},{"../../const":46,"../../settings":101,"../../utils":124,"../SystemRenderer":76,"./utils/CanvasMaskManager":78,"./utils/CanvasRenderTarget":79,"./utils/mapCanvasBlendModesToPixi":81}],78:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("../../../const"),n=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e}return t.prototype.pushMask=function(t){var e=this.renderer;e.context.save();var i=t.alpha,r=t.transform.worldTransform,n=e.resolution;e.context.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n,r.ty*n),t._texture||(this.renderGraphicsShape(t),e.context.clip()),t.worldAlpha=i},t.prototype.renderGraphicsShape=function(t){var e=this.renderer.context,i=t.graphicsData.length;if(0!==i){e.beginPath();for(var n=0;n<i;n++){var a=t.graphicsData[n],o=a.shape;if(a.type===r.SHAPES.POLY){var s=o.points;e.moveTo(s[0],s[1]);for(var h=1;h<s.length/2;h++)e.lineTo(s[2*h],s[2*h+1]);s[0]===s[s.length-2]&&s[1]===s[s.length-1]&&e.closePath()}else if(a.type===r.SHAPES.RECT)e.rect(o.x,o.y,o.width,o.height),e.closePath();else if(a.type===r.SHAPES.CIRC)e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.closePath();else if(a.type===r.SHAPES.ELIP){var c=2*o.width,u=2*o.height,p=o.x-c/2,l=o.y-u/2,d=c/2*.5522848,m=u/2*.5522848,f=p+c,_=l+u,y=p+c/2,g=l+u/2;e.moveTo(p,g),e.bezierCurveTo(p,g-m,y-d,l,y,l),e.bezierCurveTo(y+d,l,f,g-m,f,g),e.bezierCurveTo(f,g+m,y+d,_,y,_),e.bezierCurveTo(y-d,_,p,g+m,p,g),e.closePath()}else if(a.type===r.SHAPES.RREC){var v=o.x,w=o.y,S=o.width,b=o.height,x=o.radius,T=Math.min(S,b)/2|0;e.moveTo(v,w+(x=x>T?T:x)),e.lineTo(v,w+b-x),e.quadraticCurveTo(v,w+b,v+x,w+b),e.lineTo(v+S-x,w+b),e.quadraticCurveTo(v+S,w+b,v+S,w+b-x),e.lineTo(v+S,w+x),e.quadraticCurveTo(v+S,w,v+S-x,w),e.lineTo(v+x,w),e.quadraticCurveTo(v,w,v,w+x),e.closePath()}}}},t.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},t.prototype.destroy=function(){},t}();i.default=n},{"../../../const":46}],79:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=(r=t("../../../settings"))&&r.__esModule?r:{default:r},o=function(){function t(e,i,r){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||a.default.RESOLUTION,this.resize(e,i)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},n(t,[{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}]),t}();i.default=o},{"../../../settings":101}],80:[function(t,e,i){"use strict";function r(t){var e=document.createElement("canvas");e.width=6,e.height=1;var i=e.getContext("2d");return i.fillStyle=t,i.fillRect(0,0,6,1),e}i.__esModule=!0,i.default=function(){if("undefined"==typeof document)return!1;var t=r("#ff00ff"),e=r("#ffff00"),i=document.createElement("canvas");i.width=6,i.height=1;var n=i.getContext("2d");n.globalCompositeOperation="multiply",n.drawImage(t,0,0),n.drawImage(e,2,0);var a=n.getImageData(2,0,1,1);if(!a)return!1;var o=a.data;return 255===o[0]&&0===o[1]&&0===o[2]}},{}],81:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,a.default)()?(t[n.BLEND_MODES.NORMAL]="source-over",t[n.BLEND_MODES.ADD]="lighter",t[n.BLEND_MODES.MULTIPLY]="multiply",t[n.BLEND_MODES.SCREEN]="screen",t[n.BLEND_MODES.OVERLAY]="overlay",t[n.BLEND_MODES.DARKEN]="darken",t[n.BLEND_MODES.LIGHTEN]="lighten",t[n.BLEND_MODES.COLOR_DODGE]="color-dodge",t[n.BLEND_MODES.COLOR_BURN]="color-burn",t[n.BLEND_MODES.HARD_LIGHT]="hard-light",t[n.BLEND_MODES.SOFT_LIGHT]="soft-light",t[n.BLEND_MODES.DIFFERENCE]="difference",t[n.BLEND_MODES.EXCLUSION]="exclusion",t[n.BLEND_MODES.HUE]="hue",t[n.BLEND_MODES.SATURATION]="saturate",t[n.BLEND_MODES.COLOR]="color",t[n.BLEND_MODES.LUMINOSITY]="luminosity"):(t[n.BLEND_MODES.NORMAL]="source-over",t[n.BLEND_MODES.ADD]="lighter",t[n.BLEND_MODES.MULTIPLY]="source-over",t[n.BLEND_MODES.SCREEN]="source-over",t[n.BLEND_MODES.OVERLAY]="source-over",t[n.BLEND_MODES.DARKEN]="source-over",t[n.BLEND_MODES.LIGHTEN]="source-over",t[n.BLEND_MODES.COLOR_DODGE]="source-over",t[n.BLEND_MODES.COLOR_BURN]="source-over",t[n.BLEND_MODES.HARD_LIGHT]="source-over",t[n.BLEND_MODES.SOFT_LIGHT]="source-over",t[n.BLEND_MODES.DIFFERENCE]="source-over",t[n.BLEND_MODES.EXCLUSION]="source-over",t[n.BLEND_MODES.HUE]="source-over",t[n.BLEND_MODES.SATURATION]="source-over",t[n.BLEND_MODES.COLOR]="source-over",t[n.BLEND_MODES.LUMINOSITY]="source-over"),t[n.BLEND_MODES.NORMAL_NPM]=t[n.BLEND_MODES.NORMAL],t[n.BLEND_MODES.ADD_NPM]=t[n.BLEND_MODES.ADD],t[n.BLEND_MODES.SCREEN_NPM]=t[n.BLEND_MODES.SCREEN],t};var r,n=t("../../../const"),a=(r=t("./canUseNewCanvasBlendModes"))&&r.__esModule?r:{default:r}},{"../../../const":46,"./canUseNewCanvasBlendModes":80}],82:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=t("../../const"),a=(r=t("../../settings"))&&r.__esModule?r:{default:r},o=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=a.default.GC_MAX_IDLE,this.checkCountMax=a.default.GC_MAX_CHECK_COUNT,this.mode=a.default.GC_MODE}return t.prototype.update=function(){this.count++,this.mode!==n.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},t.prototype.run=function(){for(var t=this.renderer.textureManager,e=t._managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n._glRenderTargets&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[r]=null,i=!0)}if(i){for(var a=0,o=0;o<e.length;o++)null!==e[o]&&(e[a++]=e[o]);e.length=a}},t.prototype.unload=function(t){t._texture&&t._texture._glRenderTargets&&this.renderer.textureManager.destroyTexture(t._texture,!0);for(var e=t.children.length-1;e>=0;e--)this.unload(t.children[e])},t}();i.default=o},{"../../const":46,"../../settings":101}],83:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=t("pixi-gl-core"),a=t("../../const"),o=(r=t("./utils/RenderTarget"))&&r.__esModule?r:{default:r},s=t("../../utils"),h=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e,this.gl=e.gl,this._managedTextures=[]}return t.prototype.bindTexture=function(){},t.prototype.getTexture=function(){},t.prototype.updateTexture=function(t,e){var i=this.gl,r=!!t._glRenderTargets;if(!t.hasLoaded)return null;var s=this.renderer.boundTextures;if(void 0===e){e=0;for(var h=0;h<s.length;++h)if(s[h]===t){e=h;break}}s[e]=t,i.activeTexture(i.TEXTURE0+e);var c=t._glTextures[this.renderer.CONTEXT_UID];if(c)r?t._glRenderTargets[this.renderer.CONTEXT_UID].resize(t.width,t.height):c.upload(t.source);else{if(r){var u=new o.default(this.gl,t.width,t.height,t.scaleMode,t.resolution);u.resize(t.width,t.height),t._glRenderTargets[this.renderer.CONTEXT_UID]=u,c=u.texture}else(c=new n.GLTexture(this.gl,null,null,null,null)).bind(e),c.premultiplyAlpha=!0,c.upload(t.source);t._glTextures[this.renderer.CONTEXT_UID]=c,t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t),t.isPowerOfTwo?(t.mipmap&&c.enableMipmap(),t.wrapMode===a.WRAP_MODES.CLAMP?c.enableWrapClamp():t.wrapMode===a.WRAP_MODES.REPEAT?c.enableWrapRepeat():c.enableWrapMirrorRepeat()):c.enableWrapClamp(),t.scaleMode===a.SCALE_MODES.NEAREST?c.enableNearestScaling():c.enableLinearScaling()}return c},t.prototype.destroyTexture=function(t,e){if((t=t.baseTexture||t).hasLoaded){var i=this.renderer.CONTEXT_UID,r=t._glTextures,n=t._glRenderTargets;if(r[i]&&(this.renderer.unbindTexture(t),r[i].destroy(),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this),delete r[i],!e)){var a=this._managedTextures.indexOf(t);-1!==a&&(0,s.removeItems)(this._managedTextures,a,1)}n&&n[i]&&(n[i].destroy(),delete n[i])}},t.prototype.removeAll=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.renderer.CONTEXT_UID]&&delete e._glTextures[this.renderer.CONTEXT_UID]}},t.prototype.destroy=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];this.destroyTexture(e,!0),e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this)}this._managedTextures=null},t}();i.default=h},{"../../const":46,"../../utils":124,"./utils/RenderTarget":96,"pixi-gl-core":7}],84:[function(t,e,i){"use strict";i.__esModule=!0;var r=g(t("../SystemRenderer")),n=g(t("./managers/MaskManager")),a=g(t("./managers/StencilManager")),o=g(t("./managers/FilterManager")),s=g(t("./utils/RenderTarget")),h=g(t("./utils/ObjectRenderer")),c=g(t("./TextureManager")),u=g(t("../../textures/BaseTexture")),p=g(t("./TextureGarbageCollector")),l=g(t("./WebGLState")),d=g(t("./utils/mapWebGLDrawModesToPixi")),m=g(t("./utils/validateContext")),f=t("../../utils"),_=g(t("pixi-gl-core")),y=t("../../const");function g(t){return t&&t.__esModule?t:{default:t}}var v=0,w=function(t){function e(i,r,s){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"WebGL",i,r,s));return c.legacy=c.options.legacy,c.legacy&&(_.default.VertexArrayObject.FORCE_NATIVE=!0),c.type=y.RENDERER_TYPE.WEBGL,c.handleContextLost=c.handleContextLost.bind(c),c.handleContextRestored=c.handleContextRestored.bind(c),c.view.addEventListener("webglcontextlost",c.handleContextLost,!1),c.view.addEventListener("webglcontextrestored",c.handleContextRestored,!1),c._contextOptions={alpha:c.transparent,antialias:c.options.antialias,premultipliedAlpha:c.transparent&&"notMultiplied"!==c.transparent,stencil:!0,preserveDrawingBuffer:c.options.preserveDrawingBuffer,powerPreference:c.options.powerPreference},c._backgroundColorRgba[3]=c.transparent?0:1,c.maskManager=new n.default(c),c.stencilManager=new a.default(c),c.emptyRenderer=new h.default(c),c.currentRenderer=c.emptyRenderer,c.initPlugins(),c.options.context&&(0,m.default)(c.options.context),c.gl=c.options.context||_.default.createContext(c.view,c._contextOptions),c.CONTEXT_UID=v++,c.state=new l.default(c.gl),c.renderingToScreen=!0,c.boundTextures=null,c._activeShader=null,c._activeVao=null,c._activeRenderTarget=null,c._initContext(),c.filterManager=new o.default(c),c.drawModes=(0,d.default)(c.gl),c._nextTextureLocation=0,c.setBlendMode(0),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._initContext=function(){var t=this.gl;t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext();var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(e),this.emptyTextures=new Array(e),this.textureManager=new c.default(this),this.textureGC=new p.default(this),this.state.resetToDefault(),this.rootRenderTarget=new s.default(t,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var i=new _.default.GLTexture.fromData(t,null,1,1),r={_glTextures:{}};r._glTextures[this.CONTEXT_UID]={};for(var n=0;n<e;n++){var a=new u.default;a._glTextures[this.CONTEXT_UID]=i,this.boundTextures[n]=r,this.emptyTextures[n]=a,this.bindTexture(null,n)}this.emit("context",t),this.resize(this.screen.width,this.screen.height)},e.prototype.render=function(t,e,i,r,n){if(this.renderingToScreen=!e,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,e||(this._lastObjectRendered=t),!n){var a=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=a}this.bindRenderTexture(e,r),this.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this._activeRenderTarget.clear(),t.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.resize=function(t,e){r.default.prototype.resize.call(this,t,e),this.rootRenderTarget.resize(t,e),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},e.prototype.setBlendMode=function(t){this.state.setBlendMode(t)},e.prototype.clear=function(t){this._activeRenderTarget.clear(t)},e.prototype.setTransform=function(t){this._activeRenderTarget.transform=t},e.prototype.clearRenderTexture=function(t,e){var i=t.baseTexture._glRenderTargets[this.CONTEXT_UID];return i&&i.clear(e),this},e.prototype.bindRenderTexture=function(t,e){var i=void 0;if(t){var r=t.baseTexture;r._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(r,0),this.unbindTexture(r),(i=r._glRenderTargets[this.CONTEXT_UID]).setFrame(t.frame)}else i=this.rootRenderTarget;return i.transform=e,this.bindRenderTarget(i),this},e.prototype.bindRenderTarget=function(t){return t!==this._activeRenderTarget&&(this._activeRenderTarget=t,t.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=t.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(t.stencilMaskStack)),this},e.prototype.bindShader=function(t,e){return this._activeShader!==t&&(this._activeShader=t,t.bind(),!1!==e&&(t.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},e.prototype.bindTexture=function(t,e,i){if((t=(t=t||this.emptyTextures[e]).baseTexture||t).touched=this.textureGC.count,i)e=e||0;else{for(var r=0;r<this.boundTextures.length;r++)if(this.boundTextures[r]===t)return r;void 0===e&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,e=this.boundTextures.length-this._nextTextureLocation-1)}var n=this.gl,a=t._glTextures[this.CONTEXT_UID];return a?(this.boundTextures[e]=t,n.activeTexture(n.TEXTURE0+e),n.bindTexture(n.TEXTURE_2D,a.texture)):this.textureManager.updateTexture(t,e),e},e.prototype.unbindTexture=function(t){var e=this.gl;t=t.baseTexture||t;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]===t&&(this.boundTextures[i]=this.emptyTextures[i],e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[i]._glTextures[this.CONTEXT_UID].texture));return this},e.prototype.createVao=function(){return new _.default.VertexArrayObject(this.gl,this.state.attribState)},e.prototype.bindVao=function(t){return this._activeVao===t?this:(t?t.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=t,this)},e.prototype.reset=function(){return this.setObjectRenderer(this.emptyRenderer),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget,this.rootRenderTarget.activate(),this.state.resetToDefault(),this},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this._initContext()},e.prototype.destroy=function(e){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),t.prototype.destroy.call(this,e),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},e}(r.default);i.default=w,f.pluginTarget.mixin(w)},{"../../const":46,"../../textures/BaseTexture":112,"../../utils":124,"../SystemRenderer":76,"./TextureGarbageCollector":82,"./TextureManager":83,"./WebGLState":85,"./managers/FilterManager":90,"./managers/MaskManager":91,"./managers/StencilManager":92,"./utils/ObjectRenderer":94,"./utils/RenderTarget":96,"./utils/mapWebGLDrawModesToPixi":99,"./utils/validateContext":100,"pixi-gl-core":7}],85:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("./utils/mapWebGLBlendModesToPixi"))&&r.__esModule?r:{default:r},a=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=e,this.maxAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,n.default)(e),this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")}return t.prototype.push=function(){var t=this.stack[this.stackIndex];t||(t=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var e=0;e<this.activeState.length;e++)t[e]=this.activeState[e]},t.prototype.pop=function(){var t=this.stack[--this.stackIndex];this.setState(t)},t.prototype.setState=function(t){this.setBlend(t[0]),this.setDepthTest(t[1]),this.setFrontFace(t[2]),this.setCullFace(t[3]),this.setBlendMode(t[4])},t.prototype.setBlend=function(t){this.activeState[0]!==(t=t?1:0)&&(this.activeState[0]=t,this.gl[t?"enable":"disable"](this.gl.BLEND))},t.prototype.setBlendMode=function(t){if(t!==this.activeState[4]){this.activeState[4]=t;var e=this.blendModes[t];2===e.length?this.gl.blendFunc(e[0],e[1]):this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3])}},t.prototype.setDepthTest=function(t){this.activeState[1]!==(t=t?1:0)&&(this.activeState[1]=t,this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST))},t.prototype.setCullFace=function(t){this.activeState[3]!==(t=t?1:0)&&(this.activeState[3]=t,this.gl[t?"enable":"disable"](this.gl.CULL_FACE))},t.prototype.setFrontFace=function(t){this.activeState[2]!==(t=t?1:0)&&(this.activeState[2]=t,this.gl.frontFace(this.gl[t?"CW":"CCW"]))},t.prototype.resetAttributes=function(){for(var t=0;t<this.attribState.tempAttribState.length;t++)this.attribState.tempAttribState[t]=0;for(var e=0;e<this.attribState.attribState.length;e++)this.attribState.attribState[e]=0;for(var i=1;i<this.maxAttribs;i++)this.gl.disableVertexAttribArray(i)},t.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var t=0;t<this.activeState.length;++t)this.activeState[t]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},t}();i.default=a},{"./utils/mapWebGLBlendModesToPixi":98}],86:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=h(t("./extractUniformsFromSrc")),a=t("../../../utils"),o=t("../../../const"),s=h(t("../../../settings"));function h(t){return t&&t.__esModule?t:{default:t}}var c={},u=function(){function t(e,i,r){for(var h in function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=i||t.defaultFragmentSrc,this._blendMode=o.BLEND_MODES.NORMAL,this.uniformData=r||(0,n.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={},this.uniformData)this.uniforms[h]=this.uniformData[h].value;this.glShaders={},c[this.vertexSrc+this.fragmentSrc]||(c[this.vertexSrc+this.fragmentSrc]=(0,a.uid)()),this.glShaderKey=c[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=s.default.RESOLUTION,this.enabled=!0,this.autoFit=!0}return t.prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r)},r(t,[{key:"blendMode",get:function(){return this._blendMode},set:function(t){this._blendMode=t}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),t}();i.default=u},{"../../../const":46,"../../../settings":101,"../../../utils":124,"./extractUniformsFromSrc":87}],87:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i){var r=a(t),n=a(e);return Object.assign(r,n)};var r,n=((r=t("pixi-gl-core"))&&r.__esModule?r:{default:r}).default.shader.defaultValue;function a(t){for(var e=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),i={},r=void 0,a=t.replace(/\s+/g," ").split(/\s*;\s*/),o=0;o<a.length;o++){var s=a[o].trim();if(s.indexOf("uniform")>-1){var h=s.split(" "),c=h[1],u=h[2],p=1;u.indexOf("[")>-1&&(r=u.split(/\[|]/),u=r[0],p*=Number(r[1])),u.match(e)||(i[u]={value:n(c,p),name:u,type:c})}}return i}},{"pixi-gl-core":7}],88:[function(t,e,i){"use strict";i.__esModule=!0,i.calculateScreenSpaceMatrix=function(t,e,i){var r=t.identity();return r.translate(e.x/i.width,e.y/i.height),r.scale(i.width,i.height),r},i.calculateNormalizedScreenSpaceMatrix=function(t,e,i){var r=t.identity();return r.translate(e.x/i.width,e.y/i.height),r.scale(i.width/e.width,i.height/e.height),r},i.calculateSpriteMatrix=function(t,e,i,n){var a=n.worldTransform.copy(r.Matrix.TEMP_MATRIX),o=n._texture.baseTexture,s=t.identity(),h=i.height/i.width;s.translate(e.x/i.width,e.y/i.height),s.scale(1,h);var c=i.width/o.width,u=i.height/o.height;return a.tx/=o.width*c,a.ty/=o.width*c,a.invert(),s.prepend(a),s.scale(1,1/h),s.scale(c,u),s.translate(n.anchor.x,n.anchor.y),s};var r=t("../../../math")},{"../../../math":70}],89:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("../Filter"))&&r.__esModule?r:{default:r},a=t("../../../../math");t("path");var o=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=new a.Matrix,n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 otherMatrix;\r\n\r\nvarying vec2 vMaskCoord;\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = aTextureCoord;\r\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\r\n}\r\n","varying vec2 vMaskCoord;\r\nvarying vec2 vTextureCoord;\r\n\r\nuniform sampler2D uSampler;\r\nuniform float alpha;\r\nuniform sampler2D mask;\r\n\r\nvoid main(void)\r\n{\r\n    // check clip! this will stop the mask bleeding out from the edges\r\n    vec2 text = abs( vMaskCoord - 0.5 );\r\n    text = step(0.5, text);\r\n\r\n    float clip = 1.0 - max(text.y, text.x);\r\n    vec4 original = texture2D(uSampler, vTextureCoord);\r\n    vec4 masky = texture2D(mask, vMaskCoord);\r\n\r\n    original *= (masky.r * masky.a * alpha * clip);\r\n\r\n    gl_FragColor = original;\r\n}\r\n"));return i.renderable=!1,n.maskSprite=i,n.maskMatrix=r,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i){var r=this.maskSprite;this.uniforms.mask=r._texture,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r),this.uniforms.alpha=r.worldAlpha,t.applyFilter(this,e,i)},e}(n.default);i.default=o},{"../../../../math":70,"../Filter":86,path:25}],90:[function(t,e,i){"use strict";i.__esModule=!0;var r=u(t("./WebGLManager")),n=u(t("../utils/RenderTarget")),a=u(t("../utils/Quad")),o=t("../../../math"),s=u(t("../../../Shader")),h=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../filters/filterTransforms")),c=u(t("bit-twiddle"));function u(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=function t(){p(this,t),this.renderTarget=null,this.sourceFrame=new o.Rectangle,this.destinationFrame=new o.Rectangle,this.filters=[],this.target=null,this.resolution=1},d=function(t){function e(i){p(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.gl=r.renderer.gl,r.quad=new a.default(r.gl,i.state.attribState),r.shaderCache={},r.pool={},r.filterData=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.pushFilter=function(t,e){var i=this.renderer,r=this.filterData;if(!r){r=this.renderer._activeRenderTarget.filterStack;var n=new l;n.sourceFrame=n.destinationFrame=this.renderer._activeRenderTarget.size,n.renderTarget=i._activeRenderTarget,this.renderer._activeRenderTarget.filterData=r={index:0,stack:[n]},this.filterData=r}var a=r.stack[++r.index];a||(a=r.stack[r.index]=new l);var o=e[0].resolution,s=0|e[0].padding,h=t.filterArea||t.getBounds(!0),c=a.sourceFrame,u=a.destinationFrame;c.x=(h.x*o|0)/o,c.y=(h.y*o|0)/o,c.width=(h.width*o|0)/o,c.height=(h.height*o|0)/o,r.stack[0].renderTarget.transform||e[0].autoFit&&c.fit(r.stack[0].destinationFrame),c.pad(s),u.width=c.width,u.height=c.height;var p=this.getPotRenderTarget(i.gl,c.width,c.height,o);a.target=t,a.filters=e,a.resolution=o,a.renderTarget=p,p.setFrame(u,c),i.bindRenderTarget(p),p.clear()},e.prototype.popFilter=function(){var t=this.filterData,e=t.stack[t.index-1],i=t.stack[t.index];this.quad.map(i.renderTarget.size,i.sourceFrame).upload();var r=i.filters;if(1===r.length)r[0].apply(this,i.renderTarget,e.renderTarget,!1,i),this.freePotRenderTarget(i.renderTarget);else{var n=i.renderTarget,a=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,i.resolution);a.setFrame(i.destinationFrame,i.sourceFrame),a.clear();var o=0;for(o=0;o<r.length-1;++o){r[o].apply(this,n,a,!0,i);var s=n;n=a,a=s}r[o].apply(this,n,e.renderTarget,!1,i),this.freePotRenderTarget(n),this.freePotRenderTarget(a)}t.index--,0===t.index&&(this.filterData=null)},e.prototype.applyFilter=function(t,e,i,r){var n=this.renderer,a=n.gl,o=t.glShaders[n.CONTEXT_UID];o||(t.glShaderKey?(o=this.shaderCache[t.glShaderKey])||(o=new s.default(this.gl,t.vertexSrc,t.fragmentSrc),t.glShaders[n.CONTEXT_UID]=this.shaderCache[t.glShaderKey]=o):o=t.glShaders[n.CONTEXT_UID]=new s.default(this.gl,t.vertexSrc,t.fragmentSrc),n.bindVao(null),this.quad.initVao(o)),n.bindVao(this.quad.vao),n.bindRenderTarget(i),r&&(a.disable(a.SCISSOR_TEST),n.clear(),a.enable(a.SCISSOR_TEST)),i===n.maskManager.scissorRenderTarget&&n.maskManager.pushScissorMask(null,n.maskManager.scissorData),n.bindShader(o);var h=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=h,this.syncUniforms(o,t),n.state.setBlendMode(t.blendMode),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,e.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),a.bindTexture(a.TEXTURE_2D,h._glTextures[this.renderer.CONTEXT_UID].texture)},e.prototype.syncUniforms=function(t,e){var i=e.uniformData,r=e.uniforms,n=1,a=void 0;if(t.uniforms.filterArea){var o=t.uniforms.filterArea;o[0]=(a=this.filterData.stack[this.filterData.index]).renderTarget.size.width,o[1]=a.renderTarget.size.height,o[2]=a.sourceFrame.x,o[3]=a.sourceFrame.y,t.uniforms.filterArea=o}if(t.uniforms.filterClamp){a=a||this.filterData.stack[this.filterData.index];var s=t.uniforms.filterClamp;s[0]=0,s[1]=0,s[2]=(a.sourceFrame.width-1)/a.renderTarget.size.width,s[3]=(a.sourceFrame.height-1)/a.renderTarget.size.height,t.uniforms.filterClamp=s}for(var h in i)if("sampler2D"===i[h].type&&0!==r[h]){if(r[h].baseTexture)t.uniforms[h]=this.renderer.bindTexture(r[h].baseTexture,n);else{t.uniforms[h]=n;var c=this.renderer.gl;this.renderer.boundTextures[n]=this.renderer.emptyTextures[n],c.activeTexture(c.TEXTURE0+n),r[h].texture.bind()}n++}else if("mat3"===i[h].type)t.uniforms[h]=void 0!==r[h].a?r[h].toArray(!0):r[h];else if("vec2"===i[h].type)if(void 0!==r[h].x){var u=t.uniforms[h]||new Float32Array(2);u[0]=r[h].x,u[1]=r[h].y,t.uniforms[h]=u}else t.uniforms[h]=r[h];else"float"===i[h].type?t.uniforms.data[h].value!==i[h]&&(t.uniforms[h]=r[h]):t.uniforms[h]=r[h]},e.prototype.getRenderTarget=function(t,e){var i=this.filterData.stack[this.filterData.index],r=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,e||i.resolution);return r.setFrame(i.destinationFrame,i.sourceFrame),r},e.prototype.returnRenderTarget=function(t){this.freePotRenderTarget(t)},e.prototype.calculateScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return h.calculateScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size)},e.prototype.calculateNormalizedScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return h.calculateNormalizedScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size,e.destinationFrame)},e.prototype.calculateSpriteMatrix=function(t,e){var i=this.filterData.stack[this.filterData.index];return h.calculateSpriteMatrix(t,i.sourceFrame,i.renderTarget.size,e)},e.prototype.destroy=function(){this.shaderCache={},this.emptyPool()},e.prototype.getPotRenderTarget=function(t,e,i,r){var a=(65535&(e=c.default.nextPow2(e*r)))<<16|65535&(i=c.default.nextPow2(i*r));this.pool[a]||(this.pool[a]=[]);var o=this.pool[a].pop();if(!o){var s=this.renderer.boundTextures[0];t.activeTexture(t.TEXTURE0),o=new n.default(t,e,i,null,1),t.bindTexture(t.TEXTURE_2D,s._glTextures[this.renderer.CONTEXT_UID].texture)}return o.resolution=r,o.defaultFrame.width=o.size.width=e/r,o.defaultFrame.height=o.size.height=i/r,o},e.prototype.emptyPool=function(){for(var t in this.pool){var e=this.pool[t];if(e)for(var i=0;i<e.length;i++)e[i].destroy(!0)}this.pool={}},e.prototype.freePotRenderTarget=function(t){this.pool[(65535&t.size.width*t.resolution)<<16|65535&t.size.height*t.resolution].push(t)},e}(r.default);i.default=d},{"../../../Shader":44,"../../../math":70,"../filters/filterTransforms":88,"../utils/Quad":95,"../utils/RenderTarget":96,"./WebGLManager":93,"bit-twiddle":18}],91:[function(t,e,i){"use strict";i.__esModule=!0;var r=a(t("./WebGLManager")),n=a(t("../filters/spriteMask/SpriteMaskFilter"));function a(t){return t&&t.__esModule?t:{default:t}}var o=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.scissor=!1,r.scissorData=null,r.scissorRenderTarget=null,r.enableScissor=!0,r.alphaMaskPool=[],r.alphaMaskIndex=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.pushMask=function(t,e){if(e.texture)this.pushSpriteMask(t,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a);(r=Math.round(r*(180/Math.PI)))%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},e.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},e.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new n.default(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e,t.filterArea=e.getBounds(!0),this.renderer.filterManager.pushFilter(t,i),this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},e.prototype.pushStencilMask=function(t){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(t)},e.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},e.prototype.pushScissorMask=function(t,e){e.renderable=!0;var i=this.renderer._activeRenderTarget,r=e.getBounds();r.fit(i.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var n=this.renderer.resolution;this.renderer.gl.scissor(r.x*n,(i.root?i.size.height-r.y-r.height:r.y)*n,r.width*n,r.height*n),this.scissorRenderTarget=i,this.scissorData=e,this.scissor=!0},e.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},e}(r.default);i.default=o},{"../filters/spriteMask/SpriteMaskFilter":89,"./WebGLManager":93}],92:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("./WebGLManager"))&&r.__esModule?r:{default:r},a=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.stencilMaskStack=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},e.prototype.pushStencil=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var e=this.renderer.gl,i=this.stencilMaskStack.length;0===i&&e.enable(e.STENCIL_TEST),this.stencilMaskStack.push(t),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,i,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.INCR),this.renderer.plugins.graphics.render(t),this._useCurrent()},e.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var t=this.renderer.gl,e=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderer.plugins.graphics.render(e),this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},e.prototype.destroy=function(){n.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},e}(n.default);i.default=a},{"./WebGLManager":93}],93:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e,this.renderer.on("context",this.onContextChange,this)}return t.prototype.onContextChange=function(){},t.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},t}();i.default=r},{}],94:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(t){function e(){return function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){},e.prototype.render=function(t){},e}(((r=t("../managers/WebGLManager"))&&r.__esModule?r:{default:r}).default);i.default=n},{"../managers/WebGLManager":93}],95:[function(t,e,i){"use strict";i.__esModule=!0;var r=a(t("pixi-gl-core")),n=a(t("../../../utils/createIndicesForQuads"));function a(t){return t&&t.__esModule?t:{default:t}}var o=function(){function t(e,i){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.gl=e,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var a=0;a<4;a++)this.interleaved[4*a]=this.vertices[2*a],this.interleaved[4*a+1]=this.vertices[2*a+1],this.interleaved[4*a+2]=this.uvs[2*a],this.interleaved[4*a+3]=this.uvs[2*a+1];this.indices=(0,n.default)(1),this.vertexBuffer=r.default.GLBuffer.createVertexBuffer(e,this.interleaved,e.STATIC_DRAW),this.indexBuffer=r.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.vao=new r.default.VertexArrayObject(e,i)}return t.prototype.initVao=function(t){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,t.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,t.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},t.prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,r=e.y,this.vertices[0]=i=e.x,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this},t.prototype.upload=function(){for(var t=0;t<4;t++)this.interleaved[4*t]=this.vertices[2*t],this.interleaved[4*t+1]=this.vertices[2*t+1],this.interleaved[4*t+2]=this.uvs[2*t],this.interleaved[4*t+3]=this.uvs[2*t+1];return this.vertexBuffer.upload(this.interleaved),this},t.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},t}();i.default=o},{"../../../utils/createIndicesForQuads":122,"pixi-gl-core":7}],96:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=t("../../../math"),a=t("../../../const"),o=(r=t("../../../settings"))&&r.__esModule?r:{default:r},s=t("pixi-gl-core"),h=function(){function t(e,i,r,h,c,u){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.gl=e,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new n.Rectangle(0,0,1,1),this.resolution=c||o.default.RESOLUTION,this.projectionMatrix=new n.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new n.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.scaleMode=void 0!==h?h:o.default.SCALE_MODE,this.root=u,this.root?(this.frameBuffer=new s.GLFramebuffer(e,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=s.GLFramebuffer.createRGBA(e,100,100),this.scaleMode===a.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(i,r)}return t.prototype.clear=function(t){var e=t||this.clearColor;this.frameBuffer.clear(e[0],e[1],e[2],e[3])},t.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},t.prototype.setFrame=function(t,e){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||this.destinationFrame},t.prototype.activate=function(){var t=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(t.enable(t.SCISSOR_TEST),t.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):t.disable(t.SCISSOR_TEST),t.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},t.prototype.calculateProjection=function(t,e){var i=this.projectionMatrix;e=e||t,i.identity(),this.root?(i.a=1/t.width*2,i.d=-1/t.height*2,i.tx=-1-e.x*i.a,i.ty=1-e.y*i.d):(i.a=1/t.width*2,i.d=1/t.height*2,i.tx=-1-e.x*i.a,i.ty=-1-e.y*i.d)},t.prototype.resize=function(t,e){e|=0,(this.size.width!==(t|=0)||this.size.height!==e)&&(this.size.width=t,this.size.height=e,this.defaultFrame.width=t,this.defaultFrame.height=e,this.frameBuffer.resize(t*this.resolution,e*this.resolution),this.calculateProjection(this.frame||this.size))},t.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},t}();i.default=h},{"../../../const":46,"../../../math":70,"../../../settings":101,"pixi-gl-core":7}],97:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e){var i=!e;if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(i){var r=document.createElement("canvas");r.width=1,r.height=1,e=n.default.createContext(r)}for(var s=e.createShader(e.FRAGMENT_SHADER);;){var h=a.replace(/%forloop%/gi,o(t));if(e.shaderSource(s,h),e.compileShader(s),e.getShaderParameter(s,e.COMPILE_STATUS))break;t=t/2|0}return i&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext(),t};var r,n=(r=t("pixi-gl-core"))&&r.__esModule?r:{default:r},a=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function o(t){for(var e="",i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}},{"pixi-gl-core":7}],98:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[r.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.ADD]=[t.ONE,t.DST_ALPHA],e[r.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR],e[r.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[r.BLEND_MODES.ADD_NPM]=[t.SRC_ALPHA,t.DST_ALPHA,t.ONE,t.DST_ALPHA],e[r.BLEND_MODES.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_COLOR],e};var r=t("../../../const")},{"../../../const":46}],99:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[r.DRAW_MODES.POINTS]=t.POINTS,e[r.DRAW_MODES.LINES]=t.LINES,e[r.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,e[r.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,e[r.DRAW_MODES.TRIANGLES]=t.TRIANGLES,e[r.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,e[r.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN,e};var r=t("../../../const")},{"../../../const":46}],100:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}},{}],101:[function(t,e,i){"use strict";i.__esModule=!0;var r=a(t("./utils/maxRecommendedTextures")),n=a(t("./utils/canUploadSameBuffer"));function a(t){return t&&t.__esModule?t:{default:t}}i.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,r.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,n.default)()}},{"./utils/canUploadSameBuffer":121,"./utils/maxRecommendedTextures":126}],102:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=t("../math"),a=t("../utils"),o=t("../const"),s=c(t("../textures/Texture")),h=c(t("../display/Container"));function c(t){return t&&t.__esModule?t:{default:t}}var u=new n.Point,p=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r._anchor=new n.ObservablePoint(r._onAnchorUpdate,r),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=o.BLEND_MODES.NORMAL,r.shader=null,r.cachedTint=16777215,r.texture=i||s.default.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.pluginName="sprite",r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._width&&(this.scale.x=(0,a.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,a.sign)(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var t=this._texture,e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,a=e.d,o=e.tx,s=e.ty,h=this.vertexData,c=t.trim,u=t.orig,p=this._anchor,l=0,d=0,m=0,f=0;c?(l=(d=c.x-p._x*u.width)+c.width,m=(f=c.y-p._y*u.height)+c.height):(l=(d=-p._x*u.width)+u.width,m=(f=-p._y*u.height)+u.height),h[0]=i*d+n*f+o,h[1]=a*f+r*d+s,h[2]=i*l+n*f+o,h[3]=a*f+r*l+s,h[4]=i*l+n*m+o,h[5]=a*m+r*l+s,h[6]=i*d+n*m+o,h[7]=a*m+r*d+s}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this.vertexTrimmedData,e=this._texture.orig,i=this._anchor,r=this.transform.worldTransform,n=r.a,a=r.b,o=r.c,s=r.d,h=r.tx,c=r.ty,u=-i._x*e.width,p=u+e.width,l=-i._y*e.height,d=l+e.height;t[0]=n*u+o*l+h,t[1]=s*l+a*u+c,t[2]=n*p+o*l+h,t[3]=s*l+a*p+c,t[4]=n*p+o*d+h,t[5]=s*d+a*p+c,t[6]=n*u+o*d+h,t[7]=s*d+a*u+c},e.prototype._renderWebGL=function(t){this.calculateVertices(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new n.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,u);var e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,n=0;return u.x>=r&&u.x<r+e&&u.y>=(n=-i*this.anchor.y)&&u.y<n+i},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._anchor=null,("boolean"==typeof e?e:e&&e.texture)&&this._texture.destroy(!!("boolean"==typeof e?e:e&&e.baseTexture)),this._texture=null,this.shader=null},e.from=function(t){return new e(s.default.from(t))},e.fromFrame=function(t){var i=a.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new e(i)},e.fromImage=function(t,i,r){return new e(s.default.fromImage(t,i,r))},r(e,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=(0,a.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=(0,a.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor.copy(t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}]),e}(h.default);i.default=p},{"../const":46,"../display/Container":48,"../math":70,"../textures/Texture":115,"../utils":124}],103:[function(t,e,i){"use strict";i.__esModule=!0;var r=s(t("../../renderers/canvas/CanvasRenderer")),n=t("../../const"),a=t("../../math"),o=s(t("./CanvasTinter"));function s(t){return t&&t.__esModule?t:{default:t}}var h=new a.Matrix,c=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e}return t.prototype.render=function(t){var e=t._texture,i=this.renderer,r=e._frame.width,s=e._frame.height,c=t.transform.worldTransform,u=0,p=0;if(!(e.orig.width<=0||e.orig.height<=0)&&e.baseTexture.source&&(i.setBlendMode(t.blendMode),e.valid)){i.context.globalAlpha=t.worldAlpha;var l=e.baseTexture.scaleMode===n.SCALE_MODES.LINEAR;i.smoothProperty&&i.context[i.smoothProperty]!==l&&(i.context[i.smoothProperty]=l),e.trim?(u=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,p=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(u=(.5-t.anchor.x)*e.orig.width,p=(.5-t.anchor.y)*e.orig.height),e.rotate&&(c.copy(h),a.GroupD8.matrixAppendRotationInv(c=h,e.rotate,u,p),u=0,p=0),u-=r/2,p-=s/2,i.roundPixels?(i.context.setTransform(c.a,c.b,c.c,c.d,c.tx*i.resolution|0,c.ty*i.resolution|0),u|=0,p|=0):i.context.setTransform(c.a,c.b,c.c,c.d,c.tx*i.resolution,c.ty*i.resolution);var d=e.baseTexture.resolution;16777215!==t.tint?(t.cachedTint===t.tint&&t.tintedTexture.tintId===t._texture._updateID||(t.cachedTint=t.tint,t.tintedTexture=o.default.getTintedTexture(t,t.tint)),i.context.drawImage(t.tintedTexture,0,0,r*d,s*d,u*i.resolution,p*i.resolution,r*i.resolution,s*i.resolution)):i.context.drawImage(e.baseTexture.source,e._frame.x*d,e._frame.y*d,r*d,s*d,u*i.resolution,p*i.resolution,r*i.resolution,s*i.resolution)}},t.prototype.destroy=function(){this.renderer=null},t}();i.default=c,r.default.registerPlugin("sprite",c)},{"../../const":46,"../../math":70,"../../renderers/canvas/CanvasRenderer":77,"./CanvasTinter":104}],104:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=t("../../utils"),a={getTintedTexture:function(t,e){var i=t._texture,r="#"+("00000"+(0|(e=a.roundColor(e))).toString(16)).substr(-6);i.tintCache=i.tintCache||{};var n=i.tintCache[r],o=void 0;if(n){if(n.tintId===i._updateID)return i.tintCache[r];o=i.tintCache[r]}else o=a.canvas||document.createElement("canvas");if(a.tintMethod(i,e,o),o.tintId=i._updateID,a.convertTintToImage){var s=new Image;s.src=o.toDataURL(),i.tintCache[r]=s}else i.tintCache[r]=o,a.canvas=null;return o},tintWithMultiply:function(t,e,i){var r=i.getContext("2d"),n=t._frame.clone(),a=t.baseTexture.resolution;n.x*=a,n.y*=a,n.width*=a,n.height*=a,i.width=Math.ceil(n.width),i.height=Math.ceil(n.height),r.save(),r.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),r.fillRect(0,0,n.width,n.height),r.globalCompositeOperation="multiply",r.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height),r.globalCompositeOperation="destination-atop",r.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height),r.restore()},tintWithOverlay:function(t,e,i){var r=i.getContext("2d"),n=t._frame.clone(),a=t.baseTexture.resolution;n.x*=a,n.y*=a,n.width*=a,n.height*=a,i.width=Math.ceil(n.width),i.height=Math.ceil(n.height),r.save(),r.globalCompositeOperation="copy",r.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),r.fillRect(0,0,n.width,n.height),r.globalCompositeOperation="destination-atop",r.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height),r.restore()},tintWithPerPixel:function(t,e,i){var r=i.getContext("2d"),a=t._frame.clone(),o=t.baseTexture.resolution;a.x*=o,a.y*=o,a.width*=o,a.height*=o,i.width=Math.ceil(a.width),i.height=Math.ceil(a.height),r.save(),r.globalCompositeOperation="copy",r.drawImage(t.baseTexture.source,a.x,a.y,a.width,a.height,0,0,a.width,a.height),r.restore();for(var s=(0,n.hex2rgb)(e),h=s[0],c=s[1],u=s[2],p=r.getImageData(0,0,a.width,a.height),l=p.data,d=0;d<l.length;d+=4)l[d+0]*=h,l[d+1]*=c,l[d+2]*=u;r.putImageData(p,0,0)},roundColor:function(t){var e=a.cacheStepsPerColorChannel,i=(0,n.hex2rgb)(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),(0,n.rgb2hex)(i)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,((r=t("../../renderers/canvas/utils/canUseNewCanvasBlendModes"))&&r.__esModule?r:{default:r}).default)(),tintMethod:0};a.tintMethod=a.canUseMultiply?a.tintWithMultiply:a.tintWithPerPixel,i.default=a},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":80,"../../utils":124}],105:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.vertices=new ArrayBuffer(e),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},t}();i.default=r},{}],106:[function(t,e,i){"use strict";i.__esModule=!0;var r=d(t("../../renderers/webgl/utils/ObjectRenderer")),n=d(t("../../renderers/webgl/WebGLRenderer")),a=d(t("../../utils/createIndicesForQuads")),o=d(t("./generateMultiTextureShader")),s=d(t("../../renderers/webgl/utils/checkMaxIfStatmentsInShader")),h=d(t("./BatchBuffer")),c=d(t("../../settings")),u=t("../../utils"),p=d(t("pixi-gl-core")),l=d(t("bit-twiddle"));function d(t){return t&&t.__esModule?t:{default:t}}var m=0,f=0,_=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));r.vertSize=5,r.vertByteSize=4*r.vertSize,r.size=c.default.SPRITE_BATCH_SIZE,r.buffers=[];for(var n=1;n<=l.default.nextPow2(r.size);n*=2)r.buffers.push(new h.default(4*n*r.vertByteSize));r.indices=(0,a.default)(r.size),r.shader=null,r.currentIndex=0,r.groups=[];for(var o=0;o<r.size;o++)r.groups[o]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return r.sprites=[],r.vertexBuffers=[],r.vaos=[],r.vaoMax=2,r.vertexCount=0,r.renderer.on("prerender",r.onPrerender,r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),c.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,s.default)(this.MAX_TEXTURES,t)),this.shader=(0,o.default)(t,this.MAX_TEXTURES),this.indexBuffer=p.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.renderer.bindVao(null);for(var e=this.shader.attributes,i=0;i<this.vaoMax;i++){var r=this.vertexBuffers[i]=p.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),n=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(r,e.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(r,e.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(r,e.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);e.aTextureId&&n.addAttribute(r,e.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[i]=n}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},e.prototype.onPrerender=function(){this.vertexCount=0},e.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&(this.sprites[this.currentIndex++]=t)},e.prototype.flush=function(){if(0!==this.currentIndex){var t=this.renderer.gl,e=this.MAX_TEXTURES,i=l.default.nextPow2(this.currentIndex),r=l.default.log2(i),n=this.buffers[r],a=this.sprites,o=this.groups,s=n.float32View,h=n.uint32View,d=this.boundTextures,_=this.renderer.boundTextures,y=this.renderer.textureGC.count,g=0,v=void 0,w=void 0,S=1,b=0,x=o[0],T=void 0,M=void 0,E=u.premultiplyBlendMode[a[0]._texture.baseTexture.premultipliedAlpha?1:0][a[0].blendMode];x.textureCount=0,x.start=0,x.blend=E,m++;var I=void 0;for(I=0;I<e;++I)d[I]=_[I],d[I]._virtalBoundId=I;for(I=0;I<this.currentIndex;++I){var C=a[I];v=C._texture.baseTexture;var A=u.premultiplyBlendMode[Number(v.premultipliedAlpha)][C.blendMode];if(E!==A&&(E=A,w=null,b=e,m++),w!==v&&(w=v,v._enabled!==m)){if(b===e&&(m++,x.size=I-x.start,b=0,(x=o[S++]).blend=E,x.textureCount=0,x.start=I),v.touched=y,-1===v._virtalBoundId)for(var B=0;B<e;++B){var W=(B+f)%e,P=d[W];if(P._enabled!==m){f++,P._virtalBoundId=-1,v._virtalBoundId=W,d[W]=v;break}}v._enabled=m,x.textureCount++,x.ids[b]=v._virtalBoundId,x.textures[b++]=v}if(T=C.vertexData,M=C._texture._uvs.uvsUint32,this.renderer.roundPixels){var O=this.renderer.resolution;s[g]=(T[0]*O|0)/O,s[g+1]=(T[1]*O|0)/O,s[g+5]=(T[2]*O|0)/O,s[g+6]=(T[3]*O|0)/O,s[g+10]=(T[4]*O|0)/O,s[g+11]=(T[5]*O|0)/O,s[g+15]=(T[6]*O|0)/O,s[g+16]=(T[7]*O|0)/O}else s[g]=T[0],s[g+1]=T[1],s[g+5]=T[2],s[g+6]=T[3],s[g+10]=T[4],s[g+11]=T[5],s[g+15]=T[6],s[g+16]=T[7];h[g+2]=M[0],h[g+7]=M[1],h[g+12]=M[2],h[g+17]=M[3];var G=Math.min(C.worldAlpha,1),R=G<1&&v.premultipliedAlpha?(0,u.premultiplyTint)(C._tintRGB,G):C._tintRGB+(255*G<<24);h[g+3]=h[g+8]=h[g+13]=h[g+18]=R,s[g+4]=s[g+9]=s[g+14]=s[g+19]=v._virtalBoundId,g+=20}if(x.size=I-x.start,c.default.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(n.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;var k=this.shader.attributes,D=this.vertexBuffers[this.vertexCount]=p.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),L=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(D,k.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(D,k.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(D,k.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12);k.aTextureId&&L.addAttribute(D,k.aTextureId,t.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=L}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(n.vertices,0,!1),this.vertexCount++}for(I=0;I<e;++I)_[I]._virtalBoundId=-1;for(I=0;I<S;++I){for(var F=o[I],N=F.textureCount,U=0;U<N;U++)_[F.ids[U]]!==(w=F.textures[U])&&this.renderer.bindTexture(w,F.ids[U],!0),w._virtalBoundId=-1;this.renderer.state.setBlendMode(F.blend),t.drawElements(t.TRIANGLES,6*F.size,t.UNSIGNED_SHORT,6*F.start*2)}this.currentIndex=0}},e.prototype.start=function(){this.renderer.bindShader(this.shader),c.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this.vaoMax;e++)this.vertexBuffers[e]&&this.vertexBuffers[e].destroy(),this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var i=0;i<this.buffers.length;++i)this.buffers[i].destroy()},e}(r.default);i.default=_,n.default.registerPlugin("sprite",_)},{"../../renderers/webgl/WebGLRenderer":84,"../../renderers/webgl/utils/ObjectRenderer":94,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":97,"../../settings":101,"../../utils":124,"../../utils/createIndicesForQuads":122,"./BatchBuffer":105,"./generateMultiTextureShader":107,"bit-twiddle":18,"pixi-gl-core":7}],107:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e){var i=a;i=(i=i.replace(/%count%/gi,e)).replace(/%forloop%/gi,function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(textureId == "+i+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return(e+="\n")+"\n"}(e));for(var r=new n.default(t,"precision highp float;\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nattribute vec4 aColor;\r\nattribute float aTextureId;\r\n\r\nuniform mat3 projectionMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nvarying float vTextureId;\r\n\r\nvoid main(void){\r\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = aTextureCoord;\r\n    vTextureId = aTextureId;\r\n    vColor = aColor;\r\n}\r\n",i),o=[],s=0;s<e;s++)o[s]=s;return r.bind(),r.uniforms.uSamplers=o,r};var r,n=(r=t("../../Shader"))&&r.__esModule?r:{default:r};t("path");var a=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n")},{"../../Shader":44,path:25}],108:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=d(t("../sprites/Sprite")),a=d(t("../textures/Texture")),o=t("../math"),s=t("../utils"),h=t("../const"),c=d(t("../settings")),u=d(t("./TextStyle")),p=d(t("./TextMetrics")),l=d(t("../utils/trimCanvas"));function d(t){return t&&t.__esModule?t:{default:t}}var m={texture:!0,children:!1,baseTexture:!0},f=function(t){function e(i,r,n){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),(n=n||document.createElement("canvas")).width=3,n.height=3;var s=a.default.fromCanvas(n,c.default.SCALE_MODE,"text");s.orig=new o.Rectangle,s.trim=new o.Rectangle;var h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,s));return a.default.addToCache(h._texture,h._texture.baseTexture.textureCacheIds[0]),h.canvas=n,h.context=h.canvas.getContext("2d"),h.resolution=c.default.RESOLUTION,h._text=null,h._style=null,h._styleListener=null,h._font="",h.text=i,h.style=r,h.localStyleID=-1,h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i=this.context,r=p.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),n=r.height,a=r.lines,o=r.lineHeight,s=r.lineWidths,h=r.maxLineWidth,c=r.fontProperties;this.canvas.width=Math.ceil((r.width+2*e.padding)*this.resolution),this.canvas.height=Math.ceil((n+2*e.padding)*this.resolution),i.scale(this.resolution,this.resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.strokeStyle=e.stroke,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;var u=void 0,l=void 0;if(e.dropShadow){i.fillStyle=e.dropShadowColor,i.globalAlpha=e.dropShadowAlpha,i.shadowBlur=e.dropShadowBlur,e.dropShadowBlur>0&&(i.shadowColor=e.dropShadowColor);for(var d=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,m=Math.sin(e.dropShadowAngle)*e.dropShadowDistance,f=0;f<a.length;f++)u=e.strokeThickness/2,l=e.strokeThickness/2+f*o+c.ascent,"right"===e.align?u+=h-s[f]:"center"===e.align&&(u+=(h-s[f])/2),e.fill&&(this.drawLetterSpacing(a[f],u+d+e.padding,l+m+e.padding),e.stroke&&e.strokeThickness&&(i.strokeStyle=e.dropShadowColor,this.drawLetterSpacing(a[f],u+d+e.padding,l+m+e.padding,!0),i.strokeStyle=e.stroke))}i.shadowBlur=0,i.globalAlpha=1,i.fillStyle=this._generateFillStyle(e,a);for(var _=0;_<a.length;_++)u=e.strokeThickness/2,l=e.strokeThickness/2+_*o+c.ascent,"right"===e.align?u+=h-s[_]:"center"===e.align&&(u+=(h-s[_])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[_],u+e.padding,l+e.padding,!0),e.fill&&this.drawLetterSpacing(a[_],u+e.padding,l+e.padding);this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=this._style.letterSpacing;if(0!==n)for(var a=String.prototype.split.call(t,""),o=e,s=0,h="";s<t.length;)h=a[s++],r?this.context.strokeText(h,o,i):this.context.fillText(h,o,i),o+=this.context.measureText(h).width+n;else r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=(0,l.default)(t);t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0)}var i=this._texture,r=this._style,n=r.trim?0:r.padding,a=i.baseTexture;a.hasLoaded=!0,a.resolution=this.resolution,a.realWidth=t.width,a.realHeight=t.height,a.width=t.width/this.resolution,a.height=t.height/this.resolution,i.trim.width=i._frame.width=t.width/this.resolution,i.trim.height=i._frame.height=t.height/this.resolution,i.trim.x=-n,i.trim.y=-n,i.orig.width=i._frame.width-2*n,i.orig.height=i._frame.height-2*n,this._onTextureUpdate(),a.emit("update",a),this.dirty=!1},e.prototype.renderWebGL=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype.renderWebGL.call(this,e)},e.prototype._renderCanvas=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._renderCanvas.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e){if(!Array.isArray(t.fill))return t.fill;if(navigator.isCocoonJS)return t.fill[0];var i=void 0,r=void 0,n=void 0,a=this.canvas.width/this.resolution,o=this.canvas.height/this.resolution,s=t.fill.slice(),c=t.fillGradientStops.slice();if(!c.length)for(var u=s.length+1,p=1;p<u;++p)c.push(p/u);if(s.unshift(t.fill[0]),c.unshift(0),s.push(t.fill[t.fill.length-1]),c.push(1),t.fillGradientType===h.TEXT_GRADIENT.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,0,a/2,o),r=(s.length+1)*e.length,n=0;for(var l=0;l<e.length;l++){n+=1;for(var d=0;d<s.length;d++)i.addColorStop("number"==typeof c[d]?c[d]/e.length+l/e.length:n/r,s[d]),n++}}else{i=this.context.createLinearGradient(0,o/2,a,o/2),r=s.length+1,n=1;for(var m=0;m<s.length;m++)i.addColorStop("number"==typeof c[m]?c[m]:n/r,s[m]),n++}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},m,e),t.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},r(e,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=(0,s.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=(0,s.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"style",get:function(){return this._style},set:function(t){this._style=(t=t||{})instanceof u.default?t:new u.default(t),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=String(""===t||null==t?" ":t),this._text!==t&&(this._text=t,this.dirty=!0)}}]),e}(n.default);i.default=f},{"../const":46,"../math":70,"../settings":101,"../sprites/Sprite":102,"../textures/Texture":115,"../utils":124,"../utils/trimCanvas":129,"./TextMetrics":109,"./TextStyle":110}],109:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(e,i,r,n,a,o,s,h,c){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.text=e,this.style=i,this.width=r,this.height=n,this.lines=a,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=h,this.fontProperties=c}return t.measureText=function(e,i,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t._canvas;r=r||i.wordWrap;var a=i.toFontString(),o=t.measureFont(a),s=n.getContext("2d");s.font=a;for(var h=(r?t.wordWrap(e,i,n):e).split(/(?:\r\n|\r|\n)/),c=new Array(h.length),u=0,p=0;p<h.length;p++){var l=s.measureText(h[p]).width+(h[p].length-1)*i.letterSpacing;c[p]=l,u=Math.max(u,l)}var d=u+i.strokeThickness;i.dropShadow&&(d+=i.dropShadowDistance);var m=i.lineHeight||o.fontSize+i.strokeThickness,f=Math.max(m,o.fontSize+i.strokeThickness)+(h.length-1)*(m+i.leading);return i.dropShadow&&(f+=i.dropShadowDistance),new t(e,i,d,f,h,c,m+i.leading,u,o)},t.wordWrap=function(e,i){for(var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:t._canvas).getContext("2d"),n="",a=e.split("\n"),o=i.wordWrapWidth,s={},h=0;h<a.length;h++){for(var c=o,u=a[h].split(" "),p=0;p<u.length;p++){var l=r.measureText(u[p]).width;if(i.breakWords&&l>o)for(var d=u[p].split(""),m=0;m<d.length;m++){var f=d[m],_=s[f];void 0===_&&(_=r.measureText(f).width,s[f]=_),_>c?(n+="\n"+f,c=o-_):(0===m&&(n+=" "),n+=f,c-=_)}else{var y=l+r.measureText(" ").width;0===p||y>c?(p>0&&(n+="\n"),n+=u[p],c=o-l):(c-=y,n+=" "+u[p])}}h<a.length-1&&(n+="\n")}return n},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var i={},r=t._canvas,n=t._context;n.font=e;var a=Math.ceil(n.measureText("|M\xc9q").width),o=Math.ceil(n.measureText("M").width),s=2*o;o=1.4*o|0,r.width=a,r.height=s,n.fillStyle="#f00",n.fillRect(0,0,a,s),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText("|M\xc9q",0,o);var h=n.getImageData(0,0,a,s).data,c=h.length,u=4*a,p=0,l=0,d=!1;for(p=0;p<o;++p){for(var m=0;m<u;m+=4)if(255!==h[l+m]){d=!0;break}if(d)break;l+=u}for(i.ascent=o-p,l=c-u,d=!1,p=s;p>o;--p){for(var f=0;f<u;f+=4)if(255!==h[l+f]){d=!0;break}if(d)break;l-=u}return i.descent=p-o,i.fontSize=i.ascent+i.descent,t._fonts[e]=i,i},t}();i.default=r;var n=document.createElement("canvas");n.width=n.height=10,r._canvas=n,r._context=n.getContext("2d"),r._fonts={}},{}],110:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=t("../const"),a=t("../utils"),o={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:n.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,wordWrap:!1,wordWrapWidth:100,leading:0},s=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.styleID=0,Object.assign(this,o,e)}return t.prototype.clone=function(){var e={};for(var i in o)e[i]=this[i];return new t(e)},t.prototype.reset=function(){Object.assign(this,o)},t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var r=e[i].trim();/([\"\'])[^\'\"]+\1/.test(r)||(r='"'+r+'"'),e[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},r(t,[{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(t){var e=c(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(t){var e=c(t);this._fill!==e&&(this._fill=e,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(t){var e=c(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}}]),t}();function h(t){return"number"==typeof t?(0,a.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function c(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=h(t[e]);return t}return h(t)}i.default=s},{"../const":46,"../utils":124}],111:[function(t,e,i){"use strict";i.__esModule=!0;var r=a(t("./BaseTexture")),n=a(t("../settings"));function a(t){return t&&t.__esModule?t:{default:t}}var o=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=arguments[2],o=arguments[3];!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,null,a));return s.resolution=o||n.default.RESOLUTION,s.width=i,s.height=r,s.realWidth=s.width*s.resolution,s.realHeight=s.height*s.resolution,s.scaleMode=void 0!==a?a:n.default.SCALE_MODE,s.hasLoaded=!0,s._glRenderTargets={},s._canvasRenderTarget=null,s.valid=!1,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e){t===this.width&&e===this.height||(this.valid=t>0&&e>0,this.width=t,this.height=e,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.renderer=null},e}(r.default);i.default=o},{"../settings":101,"./BaseTexture":112}],112:[function(t,e,i){"use strict";i.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=t("../utils"),a=c(t("../settings")),o=c(t("eventemitter3")),s=c(t("../utils/determineCrossOrigin")),h=c(t("bit-twiddle"));function c(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(i,r,o){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return s.uid=(0,n.uid)(),s.touched=0,s.resolution=o||a.default.RESOLUTION,s.width=100,s.height=100,s.realWidth=100,s.realHeight=100,s.scaleMode=void 0!==r?r:a.default.SCALE_MODE,s.hasLoaded=!1,s.isLoading=!1,s.source=null,s.origSource=null,s.imageType=null,s.sourceScale=1,s.premultipliedAlpha=!0,s.imageUrl=null,s.isPowerOfTwo=!1,s.mipmap=a.default.MIPMAP_TEXTURES,s.wrapMode=a.default.WRAP_MODE,s._glTextures={},s._enabled=0,s._virtalBoundId=-1,s._destroyed=!1,s.textureCacheIds=[],i&&s.loadSource(i),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},e.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=h.default.isPow2(this.realWidth)&&h.default.isPow2(this.realHeight)},e.prototype.loadSource=function(t){var e=this,i=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,i&&this.source&&(this.source.onload=null,this.source.onerror=null);var n=!this.source;if(this.source=t,(t.src&&t.complete||t.getContext)&&t.width&&t.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),n&&this.emit("loaded",this);else if(!t.getContext){var a=function(){e.isLoading=!0;var r=e;if(t.onload=function(){r._updateImageType(),t.onload=null,t.onerror=null,r.isLoading&&(r.isLoading=!1,r._sourceLoaded(),"svg"!==r.imageType?r.emit("loaded",r):r._loadSvgSource())},t.onerror=function(){t.onload=null,t.onerror=null,r.isLoading&&(r.isLoading=!1,r.emit("error",r))},t.complete&&t.src){if(t.onload=null,t.onerror=null,"svg"===r.imageType)return r._loadSvgSource(),{v:void 0};e.isLoading=!1,t.width&&t.height?(e._sourceLoaded(),i&&e.emit("loaded",e)):i&&e.emit("error",e)}}();if("object"===(void 0===a?"undefined":r(a)))return a.v}},e.prototype._updateImageType=function(){if(this.imageUrl){var t=(0,n.decomposeDataUri)(this.imageUrl),e=void 0;if(t&&"image"===t.mediaType){var i=t.subType.split("+")[0];if(!(e=(0,n.getUrlFileExtension)("."+i)))throw new Error("Invalid image type in data URI.")}else(e=(0,n.getUrlFileExtension)(this.imageUrl))||(e="png");this.imageType=e}},e.prototype._loadSvgSource=function(){if("svg"===this.imageType){var t=(0,n.decomposeDataUri)(this.imageUrl);t?this._loadSvgSourceUsingDataUri(t):this._loadSvgSourceUsingXhr()}},e.prototype._loadSvgSourceUsingDataUri=function(t){var e=void 0;if("base64"===t.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");e=atob(t.data)}else e=t.data;this._loadSvgSourceUsingString(e)},e.prototype._loadSvgSourceUsingXhr=function(){var t=this,e=new XMLHttpRequest;e.onload=function(){if(e.readyState!==e.DONE||200!==e.status)throw new Error("Failed to load SVG using XHR.");t._loadSvgSourceUsingString(e.response)},e.onerror=function(){return t.emit("error",t)},e.open("GET",this.imageUrl,!0),e.send()},e.prototype._loadSvgSourceUsingString=function(t){var i=(0,n.getSvgSize)(t),r=i.width,a=i.height;if(!r||!a)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(r*this.sourceScale),this.realHeight=Math.round(a*this.sourceScale),this._updateDimensions();var o=document.createElement("canvas");o.width=this.realWidth,o.height=this.realHeight,o._pixiId="canvas_"+(0,n.uid)(),o.getContext("2d").drawImage(this.source,0,0,r,a,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=o,e.addToCache(this,o._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},e.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},e.prototype.destroy=function(){this.imageUrl&&(delete n.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},e.fromImage=function(t,i,r,a){var o=n.BaseTextureCache[t];if(!o){var h=new Image;void 0===i&&0!==t.indexOf("data:")?h.crossOrigin=(0,s.default)(t):i&&(h.crossOrigin="string"==typeof i?i:"anonymous"),(o=new e(h,r)).imageUrl=t,a&&(o.sourceScale=a),o.resolution=(0,n.getResolutionOfUrl)(t),h.src=t,e.addToCache(o,t)}return o},e.fromCanvas=function(t,i){t._pixiId||(t._pixiId=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas")+"_"+(0,n.uid)());var r=n.BaseTextureCache[t._pixiId];return r||(r=new e(t,i),e.addToCache(r,t._pixiId)),r},e.from=function(t,i,r){if("string"==typeof t)return e.fromImage(t,void 0,i,r);if(t instanceof HTMLImageElement){var a=t.src,o=n.BaseTextureCache[a];return o||((o=new e(t,i)).imageUrl=a,r&&(o.sourceScale=r),o.resolution=(0,n.getResolutionOfUrl)(a),e.addToCache(o,a)),o}return t instanceof HTMLCanvasElement?e.fromCanvas(t,i):t},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),n.BaseTextureCache[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),n.BaseTextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=n.BaseTextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete n.BaseTextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete n.BaseTextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},e}(o.default);i.default=u},{"../settings":101,"../utils":124,"../utils/determineCrossOrigin":123,"bit-twiddle":18,eventemitter3:20}],113:[function(t,e,i){"use strict";i.__esModule=!0;var r=n(t("./BaseRenderTexture"));function n(t){return t&&t.__esModule?t:{default:t}}var a=function(t){function e(i,n){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var a=null;if(!(i instanceof r.default)){var o=arguments[1],s=arguments[2],h=arguments[3],c=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+s+") instead of the ctor directly."),a=arguments[0],n=null,i=new r.default(o,s,h,c)}var u=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,n));return u.legacyRenderer=a,u.valid=!0,u._updateUvs(),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resize=function(t,e,i){this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i||this.baseTexture.resize(t,e),this._updateUvs()},e.create=function(t,i,n,a){return new e(new r.default(t,i,n,a))},e}(n(t("./Texture")).default);i.default=a},{"./BaseRenderTexture":111,"./Texture":115}],114:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=t("../"),a=t("../utils"),o=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.baseTexture=e,this.textures={},this.data=i,this.resolution=this._updateResolution(r||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return r(t,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),t.prototype._updateResolution=function(t){var e=this.data.meta.scale,i=(0,a.getResolutionOfUrl)(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&(this.baseTexture.resolution=i,this.baseTexture.update()),i},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var i=e,r=t.BATCH_SIZE;i-e<r&&i<this._frameKeys.length;){var a=this._frameKeys[i],o=this._frames[a].frame;if(o){var s,h=null,c=new n.Rectangle(0,0,this._frames[a].sourceSize.w/this.resolution,this._frames[a].sourceSize.h/this.resolution);s=this._frames[a].rotated?new n.Rectangle(o.x/this.resolution,o.y/this.resolution,o.h/this.resolution,o.w/this.resolution):new n.Rectangle(o.x/this.resolution,o.y/this.resolution,o.w/this.resolution,o.h/this.resolution),this._frames[a].trimmed&&(h=new n.Rectangle(this._frames[a].spriteSourceSize.x/this.resolution,this._frames[a].spriteSourceSize.y/this.resolution,o.w/this.resolution,o.h/this.resolution)),this.textures[a]=new n.Texture(this.baseTexture,s,c,h,this._frames[a].rotated?2:0),n.Texture.addToCache(this.textures[a],a)}i++}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():e._parseComplete()},0)},t.prototype.destroy=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},t}();i.default=o},{"../":65,"../utils":124}],115:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=p(t("./BaseTexture")),a=p(t("./VideoBaseTexture")),o=p(t("./TextureUvs")),s=p(t("eventemitter3")),h=t("../math"),c=t("../utils"),u=p(t("../settings"));function p(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(i,r,n,a,o){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));if(s.noFrame=!1,r||(s.noFrame=!0,r=new h.Rectangle(0,0,1,1)),i instanceof e&&(i=i.baseTexture),s.baseTexture=i,s._frame=r,s.trim=a,s.valid=!1,s.requiresUpdate=!1,s._uvs=null,s.orig=n||r,s._rotate=Number(o||0),!0===o)s._rotate=2;else if(s._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return i.hasLoaded?(s.noFrame&&(r=new h.Rectangle(0,0,i.width,i.height),i.on("update",s.onBaseTextureUpdated,s)),s.frame=r):i.once("loaded",s.onBaseTextureLoaded,s),s._updateID=0,s.transform=null,s.textureCacheIds=[],s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.update=function(){this.baseTexture.update()},e.prototype.onBaseTextureLoaded=function(t){this._updateID++,this.frame=this.noFrame?new h.Rectangle(0,0,t.width,t.height):this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},e.prototype.onBaseTextureUpdated=function(t){this._updateID++,this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},e.prototype.destroy=function(t){this.baseTexture&&(t&&(c.TextureCache[this.baseTexture.imageUrl]&&e.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},e.prototype._updateUvs=function(){this._uvs||(this._uvs=new o.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.fromImage=function(t,i,r,a){var o=c.TextureCache[t];return o||(o=new e(n.default.fromImage(t,i,r,a)),e.addToCache(o,t)),o},e.fromFrame=function(t){var e=c.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},e.fromCanvas=function(t,i){return new e(n.default.fromCanvas(t,i,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas"))},e.fromVideo=function(t,i){return"string"==typeof t?e.fromVideoUrl(t,i):new e(a.default.fromVideo(t,i))},e.fromVideoUrl=function(t,i){return new e(a.default.fromUrl(t,i))},e.from=function(t){return"string"==typeof t?c.TextureCache[t]||(null!==t.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?e.fromVideoUrl(t):e.fromImage(t)):t instanceof HTMLImageElement?new e(n.default.from(t)):t instanceof HTMLCanvasElement?e.fromCanvas(t,u.default.SCALE_MODE,"HTMLCanvasElement"):t instanceof HTMLVideoElement?e.fromVideo(t):t instanceof n.default?new e(t):t},e.fromLoader=function(t,i,r){var a=new n.default(t,void 0,(0,c.getResolutionOfUrl)(i)),o=new e(a);return a.imageUrl=i,r||(r=i),n.default.addToCache(o.baseTexture,r),e.addToCache(o,r),r!==i&&(n.default.addToCache(o.baseTexture,i),e.addToCache(o,i)),o},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),c.TextureCache[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),c.TextureCache[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=c.TextureCache[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete c.TextureCache[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)c.TextureCache[t.textureCacheIds[r]]===t&&delete c.TextureCache[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},r(e,[{key:"frame",get:function(){return this._frame},set:function(t){if(this._frame=t,this.noFrame=!1,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: X: "+t.x+" + "+t.width+" = "+(t.x+t.width)+" > "+this.baseTexture.width+" Y: "+t.y+" + "+t.height+" = "+(t.y+t.height)+" > "+this.baseTexture.height);this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=t),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),e}(s.default);function d(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}i.default=l,l.EMPTY=new l(new n.default),d(l.EMPTY),d(l.EMPTY.baseTexture),l.WHITE=function(){var t=document.createElement("canvas");t.width=10,t.height=10;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,10,10),new l(new n.default(t))}(),d(l.WHITE),d(l.WHITE.baseTexture)},{"../math":70,"../settings":101,"../utils":124,"./BaseTexture":112,"./TextureUvs":116,"./VideoBaseTexture":117,eventemitter3:20}],116:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("../math/GroupD8"))&&r.__esModule?r:{default:r},a=function(){function t(){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return t.prototype.set=function(t,e,i){var r=e.width,a=e.height;if(i){var o=t.width/2/r,s=t.height/2/a,h=t.x/r+o,c=t.y/a+s;i=n.default.add(i,n.default.NW),this.x0=h+o*n.default.uX(i),this.y0=c+s*n.default.uY(i),i=n.default.add(i,2),this.x1=h+o*n.default.uX(i),this.y1=c+s*n.default.uY(i),i=n.default.add(i,2),this.x2=h+o*n.default.uX(i),this.y2=c+s*n.default.uY(i),i=n.default.add(i,2),this.x3=h+o*n.default.uX(i),this.y3=c+s*n.default.uY(i)}else this.x0=t.x/r,this.y0=t.y/a,this.x1=(t.x+t.width)/r,this.y1=t.y/a,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/a,this.x3=t.x/r,this.y3=(t.y+t.height)/a;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535,this.uvsUint32[1]=(65535*this.y1&65535)<<16|65535*this.x1&65535,this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535,this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535},t}();i.default=a},{"../math/GroupD8":66}],117:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=(r=t("./BaseTexture"))&&r.__esModule?r:{default:r},o=t("../utils"),s=t("../ticker"),h=t("../const"),c=function(t){function e(i,r){if(function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),!i)throw new Error("No video source element specified.");(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,r));return n.width=i.videoWidth,n.height=i.videoHeight,n._autoUpdate=!0,n._isAutoUpdating=!1,n.autoPlay=!0,n.update=n.update.bind(n),n._onCanPlay=n._onCanPlay.bind(n),i.addEventListener("play",n._onPlayStart.bind(n)),i.addEventListener("pause",n._onPlayStop.bind(n)),n.hasLoaded=!1,n.__loaded=!1,n._isSourceReady()?n._onCanPlay():(i.addEventListener("canplay",n._onCanPlay),i.addEventListener("canplaythrough",n._onCanPlay)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(s.shared.add(this.update,this,h.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},e.prototype._onPlayStop=function(){this._isAutoUpdating&&(s.shared.remove(this.update,this),this._isAutoUpdating=!1)},e.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},e.prototype.destroy=function(){this._isAutoUpdating&&s.shared.remove(this.update,this),this.source&&this.source._pixiId&&(a.default.removeFromCache(this.source._pixiId),delete this.source._pixiId),t.prototype.destroy.call(this)},e.fromVideo=function(t,i){t._pixiId||(t._pixiId="video_"+(0,o.uid)());var r=o.BaseTextureCache[t._pixiId];return r||(r=new e(t,i),a.default.addToCache(r,t._pixiId)),r},e.fromUrl=function(t,i){var r=document.createElement("video");if(r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),Array.isArray(t))for(var n=0;n<t.length;++n)r.appendChild(u(t[n].src||t[n],t[n].mime));else r.appendChild(u(t.src||t,t.mime));return r.load(),e.fromVideo(r,i)},n(e,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(s.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(s.shared.add(this.update,this,h.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),e}(a.default);function u(t,e){e||(e="video/"+t.substr(t.lastIndexOf(".")+1));var i=document.createElement("source");return i.src=t,i.type=e,i}i.default=c,c.fromUrls=c.fromUrl},{"../const":46,"../ticker":120,"../utils":124,"./BaseTexture":112}],118:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=s(t("../settings")),a=t("../const"),o=s(t("./TickerListener"));function s(t){return t&&t.__esModule?t:{default:t}}var h=function(){function t(){var e=this;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this._head=new o.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/n.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e){return this._addListener(new o.default(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.UPDATE_PRIORITY.NORMAL))},t.prototype.addOnce=function(t,e){return this._addListener(new o.default(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.UPDATE_PRIORITY.NORMAL,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null},t.prototype.update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),e=void 0;if(t>this.lastTime){(e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*n.default.TARGET_FPMS*this.speed;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=t},r(t,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,n.default.TARGET_FPMS);this._maxElapsedMS=1/e}}]),t}();i.default=h},{"../const":46,"../settings":101,"./TickerListener":119}],119:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.fn=e,this.context=i,this.priority=r,this.once=n,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return e=e||null,this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.previous;return this.next=t?null:e,this.previous=null,e},t}();i.default=r},{}],120:[function(t,e,i){"use strict";i.__esModule=!0,i.Ticker=i.shared=void 0;var r,n=(r=t("./Ticker"))&&r.__esModule?r:{default:r},a=new n.default;a.autoStart=!0,a.destroy=function(){},i.shared=a,i.Ticker=n.default},{"./Ticker":118}],121:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){return!(navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))}},{}],122:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){for(var e=6*t,i=new Uint16Array(e),r=0,n=0;r<e;r+=6,n+=4)i[r+0]=n+0,i[r+1]=n+1,i[r+2]=n+2,i[r+3]=n+0,i[r+4]=n+2,i[r+5]=n+3;return i}},{}],123:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location;if(0===t.indexOf("data:"))return"";e=e||window.location,a||(a=document.createElement("a")),a.href=t;var i=!(t=n.default.parse(a.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"};var r,n=(r=t("url"))&&r.__esModule?r:{default:r},a=void 0},{url:38}],124:[function(t,e,i){"use strict";i.__esModule=!0,i.premultiplyBlendMode=i.BaseTextureCache=i.TextureCache=i.mixins=i.pluginTarget=i.EventEmitter=i.removeItems=i.isMobile=void 0,i.uid=function(){return++d},i.hex2rgb=function(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},i.hex2string=function(t){return t=t.toString(16),"#"+("000000".substr(0,6-t.length)+t)},i.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},i.getResolutionOfUrl=function(t,e){var i=n.default.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1},i.decomposeDataUri=function(t){var e=r.DATA_URI.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,encoding:e[3]?e[3].toLowerCase():void 0,data:e[4]}},i.getUrlFileExtension=function(t){var e=r.URL_FILE_EXTENSION.exec(t);if(e)return e[1].toLowerCase()},i.getSvgSize=function(t){var e=r.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i},i.skipHello=function(){m=!0},i.sayHello=function(t){m||(navigator.userAgent.toLowerCase().indexOf("chrome")>-1?window.console.log.apply(console,["\n %c %c %c PixiJS "+r.VERSION+" - \u2730 "+t+" \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"]):window.console&&window.console.log("PixiJS "+r.VERSION+" - "+t+" - http://www.pixijs.com/"),m=!0)},i.isWebGLSupported=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!i||!i.getContextAttributes().stencil);if(i){var n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,r}catch(a){return!1}},i.sign=function(t){return 0===t?0:t<0?-1:1},i.destroyTextureCache=function(){var t=void 0;for(t in f)f[t].destroy();for(t in _)_[t].destroy()},i.clearTextureCache=function(){var t=void 0;for(t in f)delete f[t];for(t in _)delete _[t]},i.correctBlendMode=function(t,e){return y[e?1:0][t]},i.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+((255&t)*e+.5|0)},i.premultiplyRgba=function(t,e,i,r){return i=i||new Float32Array(4),r||void 0===r?(i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e):(i[0]=t[0],i[1]=t[1],i[2]=t[2]),i[3]=e,i},i.premultiplyTintToRgba=function(t,e,i,r){return(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,(r||void 0===r)&&(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e,i};var r=t("../const"),n=l(t("../settings")),a=l(t("eventemitter3")),o=l(t("./pluginTarget")),s=p(t("./mixin")),h=p(t("ismobilejs")),c=l(t("remove-array-items")),u=l(t("./mapPremultipliedBlendModes"));function p(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function l(t){return t&&t.__esModule?t:{default:t}}var d=0,m=!1;i.isMobile=h,i.removeItems=c.default,i.EventEmitter=a.default,i.pluginTarget=o.default,i.mixins=s;var f=i.TextureCache=Object.create(null),_=i.BaseTextureCache=Object.create(null),y=i.premultiplyBlendMode=(0,u.default)()},{"../const":46,"../settings":101,"./mapPremultipliedBlendModes":125,"./mixin":127,"./pluginTarget":128,eventemitter3:20,ismobilejs:21,"remove-array-items":31}],125:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){for(var t=[],e=[],i=0;i<32;i++)t[i]=i,e[i]=i;t[r.BLEND_MODES.NORMAL_NPM]=r.BLEND_MODES.NORMAL,t[r.BLEND_MODES.ADD_NPM]=r.BLEND_MODES.ADD,t[r.BLEND_MODES.SCREEN_NPM]=r.BLEND_MODES.SCREEN,e[r.BLEND_MODES.NORMAL]=r.BLEND_MODES.NORMAL_NPM,e[r.BLEND_MODES.ADD]=r.BLEND_MODES.ADD_NPM,e[r.BLEND_MODES.SCREEN]=r.BLEND_MODES.SCREEN_NPM;var n=[];return n.push(e),n.push(t),n};var r=t("../const")},{"../const":46}],126:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){return n.default.tablet||n.default.phone?4:t};var r,n=(r=t("ismobilejs"))&&r.__esModule?r:{default:r}},{ismobilejs:21}],127:[function(t,e,i){"use strict";function r(t,e){if(t&&e)for(var i=Object.keys(e),r=0;r<i.length;++r){var n=i[r];Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}}i.__esModule=!0,i.mixin=r,i.delayMixin=function(t,e){n.push(t,e)},i.performMixins=function(){for(var t=0;t<n.length;t+=2)r(n[t],n[t+1]);n.length=0};var n=[]},{}],128:[function(t,e,i){"use strict";i.__esModule=!0,i.default={mixin:function(t){!function(t){t.__plugins={},t.registerPlugin=function(e,i){t.__plugins[e]=i},t.prototype.initPlugins=function(){for(var e in this.plugins=this.plugins||{},t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}(t)}}},{}],129:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){var e=t.width,i=t.height,r=t.getContext("2d"),n=r.getImageData(0,0,e,i).data,a=n.length,o={top:null,left:null,right:null,bottom:null},s=void 0,h=void 0,c=void 0;for(s=0;s<a;s+=4)0!==n[s+3]&&(h=s/4%e,c=~~(s/4/e),null===o.top&&(o.top=c),null===o.left?o.left=h:h<o.left&&(o.left=h),null===o.right?o.right=h+1:o.right<h&&(o.right=h+1),null===o.bottom?o.bottom=c:o.bottom<c&&(o.bottom=c));var u=r.getImageData(o.left,o.top,e=o.right-o.left,i=o.bottom-o.top+1);return{height:i,width:e,data:u}}},{}],130:[function(t,e,i){"use strict";function r(t){var e=(new Error).stack;void 0===e?console.warn("Deprecation Warning: ",t):(e=e.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t),console.warn(e),console.groupEnd()):(console.warn("Deprecation Warning: ",t),console.warn(e)))}i.__esModule=!0,i.default=function(t){var e=t.mesh,i=t.particles,n=t.extras,a=t.filters,o=t.prepare,s=t.loaders,h=t.interaction;Object.defineProperties(t,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return r("You do not need to use a PIXI Stage any more, you can simply render any container."),t.Container}},DisplayObjectContainer:{get:function(){return r("DisplayObjectContainer has been shortened to Container, please use Container from now on."),t.Container}},Strip:{get:function(){return r("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),e.Mesh}},Rope:{get:function(){return r("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),e.Rope}},ParticleContainer:{get:function(){return r("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),i.ParticleContainer}},MovieClip:{get:function(){return r("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),n.AnimatedSprite}},TilingSprite:{get:function(){return r("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),n.TilingSprite}},BitmapText:{get:function(){return r("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),n.BitmapText}},blendModes:{get:function(){return r("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),t.BLEND_MODES}},scaleModes:{get:function(){return r("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),t.SCALE_MODES}},BaseTextureCache:{get:function(){return r("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),t.utils.BaseTextureCache}},TextureCache:{get:function(){return r("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),t.utils.TextureCache}},math:{get:function(){return r("The math namespace is deprecated, please access members already accessible on PIXI."),t}},AbstractFilter:{get:function(){return r("AstractFilter has been renamed to Filter, please use PIXI.Filter"),t.Filter}},TransformManual:{get:function(){return r("TransformManual has been renamed to TransformBase, please update your pixi-spine"),t.TransformBase}},TARGET_FPMS:{get:function(){return r("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),t.settings.TARGET_FPMS},set:function(e){r("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),t.settings.TARGET_FPMS=e}},FILTER_RESOLUTION:{get:function(){return r("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),t.settings.FILTER_RESOLUTION},set:function(e){r("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),t.settings.FILTER_RESOLUTION=e}},RESOLUTION:{get:function(){return r("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),t.settings.RESOLUTION},set:function(e){r("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),t.settings.RESOLUTION=e}},MIPMAP_TEXTURES:{get:function(){return r("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),t.settings.MIPMAP_TEXTURES},set:function(e){r("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),t.settings.MIPMAP_TEXTURES=e}},SPRITE_BATCH_SIZE:{get:function(){return r("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),t.settings.SPRITE_BATCH_SIZE},set:function(e){r("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),t.settings.SPRITE_BATCH_SIZE=e}},SPRITE_MAX_TEXTURES:{get:function(){return r("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),t.settings.SPRITE_MAX_TEXTURES},set:function(e){r("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),t.settings.SPRITE_MAX_TEXTURES=e}},RETINA_PREFIX:{get:function(){return r("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),t.settings.RETINA_PREFIX},set:function(e){r("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),t.settings.RETINA_PREFIX=e}},DEFAULT_RENDER_OPTIONS:{get:function(){return r("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),t.settings.RENDER_OPTIONS}}});for(var c=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],u=function(e){var i=c[e];Object.defineProperty(t[i.parent],"DEFAULT",{get:function(){return r("PIXI."+i.parent+".DEFAULT has been deprecated, please use PIXI.settings."+i.target),t.settings[i.target]},set:function(e){r("PIXI."+i.parent+".DEFAULT has been deprecated, please use PIXI.settings."+i.target),t.settings[i.target]=e}})},p=0;p<c.length;p++)u(p);Object.defineProperties(t.settings,{PRECISION:{get:function(){return r("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),t.settings.PRECISION_FRAGMENT},set:function(e){r("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),t.settings.PRECISION_FRAGMENT=e}}}),n.AnimatedSprite&&Object.defineProperties(n,{MovieClip:{get:function(){return r("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),n.AnimatedSprite}}}),t.DisplayObject.prototype.generateTexture=function(t,e,i){return r("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),t.generateTexture(this,e,i)},t.Graphics.prototype.generateTexture=function(t,e){return r("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(t,e)},t.RenderTexture.prototype.render=function(t,e,i,n){this.legacyRenderer.render(t,this,i,e,!n),r("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},t.RenderTexture.prototype.getImage=function(t){return r("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(t)},t.RenderTexture.prototype.getBase64=function(t){return r("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(t)},t.RenderTexture.prototype.getCanvas=function(t){return r("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(t)},t.RenderTexture.prototype.getPixels=function(t){return r("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(t)},t.Sprite.prototype.setTexture=function(t){this.texture=t,r("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},n.BitmapText&&(n.BitmapText.prototype.setText=function(t){this.text=t,r("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")}),t.Text.prototype.setText=function(t){this.text=t,r("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},t.Text.calculateFontProperties=function(e){return r("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),t.TextMetrics.measureFont(e)},Object.defineProperties(t.Text,{fontPropertiesCache:{get:function(){return r("Text.fontPropertiesCache is deprecated"),t.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return r("Text.fontPropertiesCanvas is deprecated"),t.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return r("Text.fontPropertiesContext is deprecated"),t.TextMetrics._context}}}),t.Text.prototype.setStyle=function(t){this.style=t,r("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},t.Text.prototype.determineFontProperties=function(e){return r("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),t.TextMetrics.measureFont(e)},t.Text.getFontStyle=function(e){return r("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),(e=e||{})instanceof t.TextStyle||(e=new t.TextStyle(e)),e.toFontString()},Object.defineProperties(t.TextStyle.prototype,{font:{get:function(){return r("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on"),this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+("number"==typeof this._fontSize?this._fontSize+"px":this._fontSize)+" "+this._fontFamily},set:function(t){r("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),this._fontStyle=t.indexOf("italic")>1?"italic":t.indexOf("oblique")>-1?"oblique":"normal",this._fontVariant=t.indexOf("small-caps")>-1?"small-caps":"normal";var e=t.split(" "),i=-1;this._fontSize=26;for(var n=0;n<e.length;++n)if(e[n].match(/(px|pt|em|%)/)){i=n,this._fontSize=e[n];break}this._fontWeight="normal";for(var a=0;a<i;++a)if(e[a].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=e[a];break}if(i>-1&&i<e.length-1){this._fontFamily="";for(var o=i+1;o<e.length;++o)this._fontFamily+=e[o]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),t.Texture.prototype.setFrame=function(t){this.frame=t,r("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},t.Texture.addTextureToCache=function(e,i){t.Texture.addToCache(e,i),r("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},t.Texture.removeTextureFromCache=function(e){return r("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),t.BaseTexture.removeFromCache(e),t.Texture.removeFromCache(e)},Object.defineProperties(a,{AbstractFilter:{get:function(){return r("AstractFilter has been renamed to Filter, please use PIXI.Filter"),t.AbstractFilter}},SpriteMaskFilter:{get:function(){return r("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),t.SpriteMaskFilter}}}),t.utils.uuid=function(){return r("utils.uuid() is deprecated, please use utils.uid() from now on."),t.utils.uid()},t.utils.canUseNewCanvasBlendModes=function(){return r("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),t.CanvasTinter.canUseMultiply};var l,d,m=!0;Object.defineProperty(t.utils,"_saidHello",{set:function(t){t&&(r("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),m=t},get:function(){return m}}),o.BasePrepare&&(o.BasePrepare.prototype.register=function(t,e){return r("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),t&&this.registerFindHook(t),e&&this.registerUploadHook(e),this}),o.canvas&&Object.defineProperty(o.canvas,"UPLOADS_PER_FRAME",{set:function(){r("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return r("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),o.webgl&&Object.defineProperty(o.webgl,"UPLOADS_PER_FRAME",{set:function(){r("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return r("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),s.Loader&&(l=s.Resource,d=s.Loader,Object.defineProperties(l.prototype,{isJson:{get:function(){return r("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===l.TYPE.JSON}},isXml:{get:function(){return r("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===l.TYPE.XML}},isImage:{get:function(){return r("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===l.TYPE.IMAGE}},isAudio:{get:function(){return r("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===l.TYPE.AUDIO}},isVideo:{get:function(){return r("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===l.TYPE.VIDEO}}}),Object.defineProperties(d.prototype,{before:{get:function(){return r("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return r("The after() method is deprecated, please use use()."),this.use}}})),h.interactiveTarget&&Object.defineProperty(h.interactiveTarget,"defaultCursor",{set:function(t){r("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=t},get:function(){return r("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}}),h.InteractionManager&&(Object.defineProperty(h.InteractionManager,"defaultCursorStyle",{set:function(t){r("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=t},get:function(){return r("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(h.InteractionManager,"currentCursorStyle",{set:function(t){r("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=t},get:function(){return r("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))}},{}],131:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),n=new r.Rectangle,a=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e,e.extract=this}return t.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,i=void 0,a=void 0,o=void 0,s=void 0;t&&(s=t instanceof r.RenderTexture?t:e.generateTexture(t)),s?(i=s.baseTexture._canvasRenderTarget.context,a=s.baseTexture._canvasRenderTarget.resolution,o=s.frame):(i=e.rootContext,(o=n).width=this.renderer.width,o.height=this.renderer.height);var h=o.width*a,c=o.height*a,u=new r.CanvasRenderTarget(h,c),p=i.getImageData(o.x*a,o.y*a,h,c);return u.context.putImageData(p,0,0),u.canvas},t.prototype.pixels=function(t){var e=this.renderer,i=void 0,a=void 0,o=void 0,s=void 0;return t&&(s=t instanceof r.RenderTexture?t:e.generateTexture(t)),s?(i=s.baseTexture._canvasRenderTarget.context,a=s.baseTexture._canvasRenderTarget.resolution,o=s.frame):(i=e.rootContext,(o=n).width=e.width,o.height=e.height),i.getImageData(0,0,o.width*a,o.height*a).data},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();i.default=a,r.CanvasRenderer.registerPlugin("extract",a)},{"../../core":65}],132:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("./webgl/WebGLExtract");Object.defineProperty(i,"webgl",{enumerable:!0,get:function(){return a(r).default}});var n=t("./canvas/CanvasExtract");function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"canvas",{enumerable:!0,get:function(){return a(n).default}})},{"./canvas/CanvasExtract":131,"./webgl/WebGLExtract":133}],133:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),n=new r.Rectangle,a=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e,e.extract=this}return t.prototype.image=function(t){var e=new Image;return e.src=this.base64(t),e},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,i=void 0,a=void 0,o=void 0,s=!1,h=void 0;t&&(h=t instanceof r.RenderTexture?t:this.renderer.generateTexture(t)),h?(a=(i=h.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,o=h.frame,s=!1):(a=(i=this.renderer.rootRenderTarget).resolution,s=!0,(o=n).width=i.size.width,o.height=i.size.height);var c=o.width*a,u=o.height*a,p=new r.CanvasRenderTarget(c,u);if(i){e.bindRenderTarget(i);var l=new Uint8Array(4*c*u),d=e.gl;d.readPixels(o.x*a,o.y*a,c,u,d.RGBA,d.UNSIGNED_BYTE,l);var m=p.context.getImageData(0,0,c,u);m.data.set(l),p.context.putImageData(m,0,0),s&&(p.context.scale(1,-1),p.context.drawImage(p.canvas,0,-u))}return p.canvas},t.prototype.pixels=function(t){var e=this.renderer,i=void 0,a=void 0,o=void 0,s=void 0;t&&(s=t instanceof r.RenderTexture?t:this.renderer.generateTexture(t)),s?(a=(i=s.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID]).resolution,o=s.frame):(a=(i=this.renderer.rootRenderTarget).resolution,(o=n).width=i.size.width,o.height=i.size.height);var h=o.width*a,c=o.height*a,u=new Uint8Array(4*h*c);if(i){e.bindRenderTarget(i);var p=e.gl;p.readPixels(o.x*a,o.y*a,h,c,p.RGBA,p.UNSIGNED_BYTE,u)}return u},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();i.default=a,r.WebGLRenderer.registerPlugin("extract",a)},{"../../core":65}],134:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),a=function(t){function e(i,r){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i[0]instanceof n.Texture?i[0]:i[0].texture));return a._textures=null,a._durations=null,a.textures=i,a._autoUpdate=!1!==r,a.animationSpeed=1,a.loop=!0,a.onComplete=null,a.onFrameChange=null,a.onLoop=null,a._currentTime=0,a.playing=!1,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&n.ticker.shared.remove(this.update,this))},e.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&n.ticker.shared.add(this.update,this,n.UPDATE_PRIORITY.HIGH))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,i=this.currentFrame;if(null!==this._durations){var r=this._currentTime%1*this._durations[this.currentFrame];for(r+=e/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];var n=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*n,this._currentTime+=n;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i?this.onLoop():this.animationSpeed<0&&this.currentFrame>i&&this.onLoop()),this.updateTexture())},e.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.onFrameChange&&this.onFrameChange(this.currentFrame)},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e)},e.fromFrames=function(t){for(var i=[],r=0;r<t.length;++r)i.push(n.Texture.fromFrame(t[r]));return new e(i)},e.fromImages=function(t){for(var i=[],r=0;r<t.length;++r)i.push(n.Texture.fromImage(t[r]));return new e(i)},r(e,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(t){if(t[0]instanceof n.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}}]),e}(n.Sprite);i.default=a},{"../core":65}],135:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),a=s(t("../core/math/ObservablePoint")),o=s(t("../core/settings"));function s(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return n._textWidth=0,n._textHeight=0,n._glyphs=[],n._font={tint:void 0!==r.tint?r.tint:16777215,align:r.align||"left",name:null,size:0},n.font=r.font,n._text=i,n._maxWidth=0,n._maxLineHeight=0,n._anchor=new a.default(function(){n.dirty=!0},n,0,0),n.dirty=!1,n.updateText(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],i=this._font.size/t.size,r=new n.Point,a=[],o=[],s=null,h=0,c=0,u=0,p=-1,l=0,d=0,m=0,f=0;f<this.text.length;f++){var _=this.text.charCodeAt(f);if(/(\s)/.test(this.text.charAt(f))&&(p=f,l=h),/(?:\r\n|\r|\n)/.test(this.text.charAt(f)))o.push(h),c=Math.max(c,h),u++,r.x=0,r.y+=t.lineHeight,s=null;else if(-1!==p&&this._maxWidth>0&&r.x*i>this._maxWidth)n.utils.removeItems(a,p-d,f-p),f=p,p=-1,++d,o.push(l),c=Math.max(c,l),u++,r.x=0,r.y+=t.lineHeight,s=null;else{var y=t.chars[_];y&&(s&&y.kerning[s]&&(r.x+=y.kerning[s]),a.push({texture:y.texture,line:u,charCode:_,position:new n.Point(r.x+y.xOffset,r.y+y.yOffset)}),h=r.x+(y.texture.width+y.xOffset),r.x+=y.xAdvance,m=Math.max(m,y.yOffset+y.texture.height),s=_)}}o.push(h),c=Math.max(c,h);for(var g=[],v=0;v<=u;v++){var w=0;"right"===this._font.align?w=c-o[v]:"center"===this._font.align&&(w=(c-o[v])/2),g.push(w)}for(var S=a.length,b=this.tint,x=0;x<S;x++){var T=this._glyphs[x];T?T.texture=a[x].texture:(T=new n.Sprite(a[x].texture),this._glyphs.push(T)),T.position.x=(a[x].position.x+g[a[x].line])*i,T.position.y=a[x].position.y*i,T.scale.x=T.scale.y=i,T.tint=b,T.parent||this.addChild(T)}for(var M=S;M<this._glyphs.length;++M)this.removeChild(this._glyphs[M]);if(this._textWidth=c*i,this._textHeight=(r.y+t.lineHeight)*i,0!==this.anchor.x||0!==this.anchor.y)for(var E=0;E<S;E++)this._glyphs[E].x-=this._textWidth*this.anchor.x,this._glyphs[E].y-=this._textHeight*this.anchor.y;this._maxLineHeight=m*i},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},e.registerFont=function(t,i){var r={},a=t.getElementsByTagName("info")[0],s=t.getElementsByTagName("common")[0],h=i.baseTexture.resolution||o.default.RESOLUTION;r.font=a.getAttribute("face"),r.size=parseInt(a.getAttribute("size"),10),r.lineHeight=parseInt(s.getAttribute("lineHeight"),10)/h,r.chars={};for(var c=t.getElementsByTagName("char"),u=0;u<c.length;u++){var p=c[u],l=parseInt(p.getAttribute("id"),10),d=new n.Rectangle(parseInt(p.getAttribute("x"),10)/h+i.frame.x/h,parseInt(p.getAttribute("y"),10)/h+i.frame.y/h,parseInt(p.getAttribute("width"),10)/h,parseInt(p.getAttribute("height"),10)/h);r.chars[l]={xOffset:parseInt(p.getAttribute("xoffset"),10)/h,yOffset:parseInt(p.getAttribute("yoffset"),10)/h,xAdvance:parseInt(p.getAttribute("xadvance"),10)/h,kerning:{},texture:new n.Texture(i.baseTexture,d)}}for(var m=t.getElementsByTagName("kerning"),f=0;f<m.length;f++){var _=m[f],y=parseInt(_.getAttribute("first"),10)/h,g=parseInt(_.getAttribute("second"),10)/h,v=parseInt(_.getAttribute("amount"),10)/h;r.chars[g]&&(r.chars[g].kerning[y]=v)}return e.fonts[r.font]=r,r},r(e,[{key:"tint",get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copy(t)}},{key:"font",get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),e}(n.Container);i.default=h,h.fonts={}},{"../core":65,"../core/math/ObservablePoint":68,"../core/settings":101}],136:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=(r=t("../core/math/Matrix"))&&r.__esModule?r:{default:r},o=new a.default,s=function(){function t(e,i){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this._texture=e,this.mapCoord=new a.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=void 0===i?.5:i}return t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2){var n=t[r],a=t[r+1];e[r]=n*i.a+a*i.c+i.tx,e[r+1]=n*i.b+a*i.d+i.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._lastTextureID===e._updateID)return!1;this._lastTextureID=e._updateID;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(o.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(o));var a=e.baseTexture,s=this.uClampFrame,h=this.clampMargin/a.resolution,c=this.clampOffset;return s[0]=(e._frame.x+h+c)/a.width,s[1]=(e._frame.y+h+c)/a.height,s[2]=(e._frame.x+e._frame.width-h+c)/a.width,s[3]=(e._frame.y+e._frame.height-h+c)/a.height,this.uClampOffset[0]=c/a.realWidth,this.uClampOffset[1]=c/a.realHeight,!0},n(t,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this._lastTextureID=-1}}]),t}();i.default=s},{"../core/math/Matrix":67}],137:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),a=s(t("../core/sprites/canvas/CanvasTinter")),o=s(t("./TextureTransform"));function s(t){return t&&t.__esModule?t:{default:t}}var h=new n.Point,c=function(t){function e(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return s.tileTransform=new n.TransformStatic,s._width=r,s._height=a,s._canvasPattern=null,s.uvTransform=i.transform||new o.default(i),s.pluginName="tilingSprite",s.uvRespectAnchor=!1,s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture)},e.prototype._renderWebGL=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var i=t.context,r=this.worldTransform,o=t.resolution,s=e.baseTexture,h=s.resolution,c=this.tilePosition.x/this.tileScale.x%e._frame.width*h,u=this.tilePosition.y/this.tileScale.y%e._frame.height*h;if(!this._canvasPattern){var p=new n.CanvasRenderTarget(e._frame.width,e._frame.height,h);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=a.default.getTintedTexture(this,this.tint)),p.context.drawImage(this.tintedTexture,0,0)):p.context.drawImage(s.source,-e._frame.x*h,-e._frame.y*h),this._canvasPattern=p.context.createPattern(p.canvas,"repeat")}i.globalAlpha=this.worldAlpha,i.setTransform(r.a*o,r.b*o,r.c*o,r.d*o,r.tx*o,r.ty*o),t.setBlendMode(this.blendMode),i.fillStyle=this._canvasPattern,i.scale(this.tileScale.x/h,this.tileScale.y/h);var l=this.anchor.x*-this._width,d=this.anchor.y*-this._height;this.uvRespectAnchor?(i.translate(c,u),i.fillRect(-c+l,-u+d,this._width/this.tileScale.x*h,this._height/this.tileScale.y*h)):(i.translate(c+l,u+d),i.fillRect(-c,-u,this._width/this.tileScale.x*h,this._height/this.tileScale.y*h))}},e.prototype._calculateBounds=function(){this._bounds.addFrame(this.transform,this._width*-this._anchor._x,this._height*-this._anchor._y,this._width*(1-this._anchor._x),this._height*(1-this._anchor._y))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._x),e||(this._localBoundsRect||(this._localBoundsRect=new n.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,h);var e=this._width,i=this._height,r=-e*this.anchor._x;if(h.x>=r&&h.x<r+e){var n=-i*this.anchor._y;if(h.y>=n&&h.y<n+i)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvTransform=null},e.from=function(t,i,r){return new e(n.Texture.from(t),i,r)},e.fromFrame=function(t,i,r){var a=n.utils.TextureCache[t];if(!a)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(a,i,r)},e.fromImage=function(t,i,r,a,o){return new e(n.Texture.fromImage(t,a,o),i,r)},r(e,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(t){this.uvTransform.clampMargin=t,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copy(t)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copy(t)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),e}(n.Sprite);i.default=c},{"../core":65,"../core/sprites/canvas/CanvasTinter":104,"./TextureTransform":136}],138:[function(t,e,i){"use strict";var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),n=s(t("../core/textures/Texture")),a=s(t("../core/textures/BaseTexture")),o=t("../core/utils");function s(t){return t&&t.__esModule?t:{default:t}}var h=r.DisplayObject,c=new r.Matrix;h.prototype._cacheAsBitmap=!1,h.prototype._cacheData=!1;var u=function t(){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(h.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap!==t){this._cacheAsBitmap=t;var e=void 0;t?(this._cacheData||(this._cacheData=new u),(e=this._cacheData).originalRenderWebGL=this.renderWebGL,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this._calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=e.originalRenderWebGL,this.renderCanvas=e.originalRenderCanvas,this._calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}}),h.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(t))},h.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.currentRenderer.flush();var i=this.getLocalBounds().clone();this._filters&&i.pad(this._filters[0].padding);var s=t._activeRenderTarget,h=t.filterManager.filterStack,u=r.RenderTexture.create(0|i.width,0|i.height),p="cacheAsBitmap_"+(0,o.uid)();this._cacheData.textureCacheId=p,a.default.addToCache(u.baseTexture,p),n.default.addToCache(u,p);var l=c;l.tx=-i.x,l.ty=-i.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,t.render(this,u,!0,l,!0),t.bindRenderTarget(s),t.filterManager.filterStack=h,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var d=new r.Sprite(u);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-i.x/i.width,d.anchor.y=-i.y/i.height,d.alpha=e,d._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=d.containsPoint.bind(d)}},h.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(t))},h.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),i=this.alpha;this.alpha=1;var s=t.context,h=r.RenderTexture.create(0|e.width,0|e.height),u="cacheAsBitmap_"+(0,o.uid)();this._cacheData.textureCacheId=u,a.default.addToCache(h.baseTexture,u),n.default.addToCache(h,u);var p=c;this.transform.localTransform.copy(p),p.invert(),p.tx-=e.x,p.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,h,!0,p,!1),t.context=s,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var l=new r.Sprite(h);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-e.x/e.width,l.anchor.y=-e.y/e.height,l._bounds=this._bounds,l.alpha=i,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=l,this.containsPoint=l.containsPoint.bind(l)}},h.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},h.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},h.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,a.default.removeFromCache(this._cacheData.textureCacheId),n.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},h.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)}},{"../core":65,"../core/textures/BaseTexture":112,"../core/textures/Texture":115,"../core/utils":124}],139:[function(t,e,i){"use strict";var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core"));r.DisplayObject.prototype.name=null,r.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":65}],140:[function(t,e,i){"use strict";var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core"));r.DisplayObject.prototype.getGlobalPosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.Point;return this.parent?this.parent.toGlobal(this.position,t,arguments.length>1&&void 0!==arguments[1]&&arguments[1]):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":65}],141:[function(t,e,i){"use strict";i.__esModule=!0,i.BitmapText=i.TilingSpriteRenderer=i.TilingSprite=i.TextureTransform=i.AnimatedSprite=void 0;var r=t("./AnimatedSprite");Object.defineProperty(i,"AnimatedSprite",{enumerable:!0,get:function(){return h(r).default}});var n=t("./TextureTransform");Object.defineProperty(i,"TextureTransform",{enumerable:!0,get:function(){return h(n).default}});var a=t("./TilingSprite");Object.defineProperty(i,"TilingSprite",{enumerable:!0,get:function(){return h(a).default}});var o=t("./webgl/TilingSpriteRenderer");Object.defineProperty(i,"TilingSpriteRenderer",{enumerable:!0,get:function(){return h(o).default}});var s=t("./BitmapText");function h(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"BitmapText",{enumerable:!0,get:function(){return h(s).default}}),t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition")},{"./AnimatedSprite":134,"./BitmapText":135,"./TextureTransform":136,"./TilingSprite":137,"./cacheAsBitmap":138,"./getChildByName":139,"./getGlobalPosition":140,"./webgl/TilingSpriteRenderer":142}],142:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),n=t("../../core/const");t("path");var a=new r.Matrix,o=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.shader=null,r.simpleShader=null,r.quad=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new r.Shader(t,"attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTransform;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","varying vec2 vTextureCoord;\r\n\r\nuniform sampler2D uSampler;\r\nuniform vec4 uColor;\r\nuniform mat3 uMapCoord;\r\nuniform vec4 uClampFrame;\r\nuniform vec2 uClampOffset;\r\n\r\nvoid main(void)\r\n{\r\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\r\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\r\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\r\n\r\n    vec4 sample = texture2D(uSampler, coord);\r\n    gl_FragColor = sample * uColor;\r\n}\r\n"),this.simpleShader=new r.Shader(t,"attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTransform;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","varying vec2 vTextureCoord;\r\n\r\nuniform sampler2D uSampler;\r\nuniform vec4 uColor;\r\n\r\nvoid main(void)\r\n{\r\n    vec4 sample = texture2D(uSampler, vTextureCoord);\r\n    gl_FragColor = sample * uColor;\r\n}\r\n"),this.renderer.bindVao(null),this.quad=new r.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},e.prototype.render=function(t){var e=this.renderer,i=this.quad;e.bindVao(i.vao);var o=i.vertices;o[0]=o[6]=t._width*-t.anchor.x,o[1]=o[3]=t._height*-t.anchor.y,o[2]=o[4]=t._width*(1-t.anchor.x),o[5]=o[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((o=i.uvs)[0]=o[6]=-t.anchor.x,o[1]=o[3]=-t.anchor.y,o[2]=o[4]=1-t.anchor.x,o[5]=o[7]=1-t.anchor.y),i.upload();var s=t._texture,h=s.baseTexture,c=t.tileTransform.localTransform,u=t.uvTransform,p=h.isPowerOfTwo&&s.frame.width===h.width&&s.frame.height===h.height;p&&(h._glTextures[e.CONTEXT_UID]?p=h.wrapMode!==n.WRAP_MODES.CLAMP:h.wrapMode===n.WRAP_MODES.CLAMP&&(h.wrapMode=n.WRAP_MODES.REPEAT));var l=p?this.simpleShader:this.shader;e.bindShader(l);var d=s.width,m=s.height,f=t._width,_=t._height;a.set(c.a*d/f,c.b*d/_,c.c*m/f,c.d*m/_,c.tx/f,c.ty/_),a.invert(),p?a.prepend(u.mapCoord):(l.uniforms.uMapCoord=u.mapCoord.toArray(!0),l.uniforms.uClampFrame=u.uClampFrame,l.uniforms.uClampOffset=u.uClampOffset),l.uniforms.uTransform=a.toArray(!0),l.uniforms.uColor=r.utils.premultiplyTintToRgba(t.tint,t.worldAlpha,l.uniforms.uColor,h.premultipliedAlpha),l.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),l.uniforms.uSampler=e.bindTexture(s),e.setBlendMode(r.utils.correctBlendMode(t.blendMode,h.premultipliedAlpha)),i.vao.draw(this.renderer.gl.TRIANGLES,6,0)},e}(r.ObjectRenderer);i.default=o,r.WebGLRenderer.registerPlugin("tilingSprite",o)},{"../../core":65,"../../core/const":46,path:25}],143:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),a=s(t("./BlurXFilter")),o=s(t("./BlurYFilter"));function s(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(i,r,s,h){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return c.blurXFilter=new a.default(i,r,s,h),c.blurYFilter=new o.default(i,r,s,h),c.padding=0,c.resolution=s||n.settings.RESOLUTION,c.quality=r||4,c.blur=i||8,c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i){var r=t.getRenderTarget(!0);this.blurXFilter.apply(t,e,r,!0),this.blurYFilter.apply(t,r,i,!1),t.returnRenderTarget(r)},r(e,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(t){this.blurYFilter._blendMode=t}}]),e}(n.Filter);i.default=h},{"../../core":65,"./BlurXFilter":144,"./BlurYFilter":145}],144:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),a=h(t("./generateBlurVertSource")),o=h(t("./generateBlurFragSource")),s=h(t("./getMaxBlurKernelSize"));function h(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(i,r,s,h){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var c=(0,a.default)(h=h||5,!0),u=(0,o.default)(h),p=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,c,u));return p.resolution=s||n.settings.RESOLUTION,p._quality=0,p.quality=r||4,p.strength=i||8,p.firstRun=!0,p}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i,r){if(this.firstRun){var n=(0,s.default)(t.renderer.gl);this.vertexSrc=(0,a.default)(n,!0),this.fragmentSrc=(0,o.default)(n),this.firstRun=!1}if(this.uniforms.strength=1/i.size.width*(i.size.width/e.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,r);else{for(var h=t.getRenderTarget(!0),c=e,u=h,p=0;p<this.passes-1;p++){t.applyFilter(this,c,u,!0);var l=u;u=c,c=l}t.applyFilter(this,c,i,r),t.returnRenderTarget(h)}},r(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(n.Filter);i.default=c},{"../../core":65,"./generateBlurFragSource":146,"./generateBlurVertSource":147,"./getMaxBlurKernelSize":148}],145:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),a=h(t("./generateBlurVertSource")),o=h(t("./generateBlurFragSource")),s=h(t("./getMaxBlurKernelSize"));function h(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(i,r,s,h){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var c=(0,a.default)(h=h||5,!1),u=(0,o.default)(h),p=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,c,u));return p.resolution=s||n.settings.RESOLUTION,p._quality=0,p.quality=r||4,p.strength=i||8,p.firstRun=!0,p}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i,r){if(this.firstRun){var n=(0,s.default)(t.renderer.gl);this.vertexSrc=(0,a.default)(n,!1),this.fragmentSrc=(0,o.default)(n),this.firstRun=!1}if(this.uniforms.strength=1/i.size.height*(i.size.height/e.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,r);else{for(var h=t.getRenderTarget(!0),c=e,u=h,p=0;p<this.passes-1;p++){t.applyFilter(this,c,u,!0);var l=u;u=c,c=l}t.applyFilter(this,c,i,r),t.returnRenderTarget(h)}},r(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(n.Filter);i.default=c},{"../../core":65,"./generateBlurFragSource":146,"./generateBlurVertSource":147,"./getMaxBlurKernelSize":148}],146:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){for(var e=r[t],i=e.length,a=n,o="",s=void 0,h=0;h<t;h++){var c="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",h);s=h,h>=i&&(s=t-h-1),o+=c=c.replace("%value%",e[s]),o+="\n"}return(a=a.replace("%blur%",o)).replace("%size%",t)};var r={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},n=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],147:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e){var i=Math.ceil(t/2),n=r,a="",o=void 0;o=e?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var s=0;s<t;s++){var h=o.replace("%index%",s);a+=h=h.replace("%sampleIndex%",s-(i-1)+".0"),a+="\n"}return(n=n.replace("%blur%",a)).replace("%size%",t)};var r=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],148:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t){for(var e=t.getParameter(t.MAX_VARYING_VECTORS),i=15;i>e;)i-=2;return i}},{}],149:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var a=function(t){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n    vTextureCoord = aTextureCoord;\r\n}","varying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nuniform float m[20];\r\nuniform float uAlpha;\r\n\r\nvoid main(void)\r\n{\r\n    vec4 c = texture2D(uSampler, vTextureCoord);\r\n\r\n    if (uAlpha == 0.0) {\r\n        gl_FragColor = c;\r\n        return;\r\n    }\r\n\r\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\r\n    if (c.a > 0.0) {\r\n      c.rgb /= c.a;\r\n    }\r\n\r\n    vec4 result;\r\n\r\n    result.r = (m[0] * c.r);\r\n        result.r += (m[1] * c.g);\r\n        result.r += (m[2] * c.b);\r\n        result.r += (m[3] * c.a);\r\n        result.r += m[4];\r\n\r\n    result.g = (m[5] * c.r);\r\n        result.g += (m[6] * c.g);\r\n        result.g += (m[7] * c.b);\r\n        result.g += (m[8] * c.a);\r\n        result.g += m[9];\r\n\r\n    result.b = (m[10] * c.r);\r\n       result.b += (m[11] * c.g);\r\n       result.b += (m[12] * c.b);\r\n       result.b += (m[13] * c.a);\r\n       result.b += m[14];\r\n\r\n    result.a = (m[15] * c.r);\r\n       result.a += (m[16] * c.g);\r\n       result.a += (m[17] * c.b);\r\n       result.a += (m[18] * c.a);\r\n       result.a += m[19];\r\n\r\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\r\n\r\n    // Premultiply alpha again.\r\n    rgb *= result.a;\r\n\r\n    gl_FragColor = vec4(rgb, result.a);\r\n}\r\n"));return i.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],i.alpha=1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._loadMatrix=function(t){var e=t;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(this._multiply(e,this.uniforms.m,t),e=this._colorMatrix(e)),this.uniforms.m=e},e.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){this._loadMatrix([t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0],e)},e.prototype.greyscale=function(t,e){this._loadMatrix([t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0],e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),r=Math.sin(t),n=1/3,a=(0,Math.sqrt)(n);this._loadMatrix([i+(1-i)*n,n*(1-i)-a*r,n*(1-i)+a*r,0,0,n*(1-i)+a*r,i+n*(1-i),n*(1-i)-a*r,0,0,n*(1-i)-a*r,n*(1-i)+a*r,i+n*(1-i),0,0,0,0,0,1,0],e)},e.prototype.contrast=function(t,e){var i=(t||0)+1,r=-.5*(i-1);this._loadMatrix([i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0],e)},e.prototype.saturate=function(){var t=2*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/3+1,e=-.5*(t-1);this._loadMatrix([t,e,e,0,0,e,t,e,0,0,e,e,t,0,0,0,0,0,1,0],arguments[1])},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,i,r,n){var a=((i=i||16770432)>>16&255)/255,o=(i>>8&255)/255,s=(255&i)/255,h=((r=r||3375104)>>16&255)/255,c=(r>>8&255)/255,u=(255&r)/255;this._loadMatrix([.3,.59,.11,0,0,a,o,s,t=t||.2,0,h,c,u,e=e||.15,0,a-h,o-c,s-u,0,0],n)},e.prototype.night=function(t,e){this._loadMatrix([-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0],e)},e.prototype.predator=function(t,e){this._loadMatrix([11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0],e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},r(e,[{key:"matrix",get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),e}(n.Filter);i.default=a,a.prototype.grayscale=a.prototype.greyscale},{"../../core":65,path:25}],150:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var a=function(t){function e(i,r){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var a=new n.Matrix;i.renderable=!1;var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 filterMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\nvarying vec2 vFilterCoord;\r\n\r\nvoid main(void)\r\n{\r\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\r\n   vTextureCoord = aTextureCoord;\r\n}","varying vec2 vFilterCoord;\r\nvarying vec2 vTextureCoord;\r\n\r\nuniform vec2 scale;\r\n\r\nuniform sampler2D uSampler;\r\nuniform sampler2D mapSampler;\r\n\r\nuniform vec4 filterClamp;\r\n\r\nvoid main(void)\r\n{\r\n   vec4 map =  texture2D(mapSampler, vFilterCoord);\r\n\r\n   map -= 0.5;\r\n   map.xy *= scale;\r\n\r\n   gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\r\n}\r\n"));return o.maskSprite=i,o.maskMatrix=a,o.uniforms.mapSampler=i._texture,o.uniforms.filterMatrix=a,o.uniforms.scale={x:1,y:1},null==r&&(r=20),o.scale=new n.Point(r,r),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.apply=function(t,e,i){var r=1/i.destinationFrame.width*(i.size.width/e.size.width);this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x*r,this.uniforms.scale.y=this.scale.y*r,t.applyFilter(this,e,i)},r(e,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t}}]),e}(n.Filter);i.default=a},{"../../core":65,path:25}],151:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var n=function(t){function e(){return function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\n\r\nvarying vec2 v_rgbNW;\r\nvarying vec2 v_rgbNE;\r\nvarying vec2 v_rgbSW;\r\nvarying vec2 v_rgbSE;\r\nvarying vec2 v_rgbM;\r\n\r\nuniform vec4 filterArea;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvec2 mapCoord( vec2 coord )\r\n{\r\n    coord *= filterArea.xy;\r\n    coord += filterArea.zw;\r\n\r\n    return coord;\r\n}\r\n\r\nvec2 unmapCoord( vec2 coord )\r\n{\r\n    coord -= filterArea.zw;\r\n    coord /= filterArea.xy;\r\n\r\n    return coord;\r\n}\r\n\r\nvoid texcoords(vec2 fragCoord, vec2 resolution,\r\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\r\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\r\n               out vec2 v_rgbM) {\r\n    vec2 inverseVP = 1.0 / resolution.xy;\r\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\r\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\r\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\r\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\r\n    v_rgbM = vec2(fragCoord * inverseVP);\r\n}\r\n\r\nvoid main(void) {\r\n\r\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n   vTextureCoord = aTextureCoord;\r\n\r\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\r\n\r\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\r\n}",'varying vec2 v_rgbNW;\r\nvarying vec2 v_rgbNE;\r\nvarying vec2 v_rgbSW;\r\nvarying vec2 v_rgbSE;\r\nvarying vec2 v_rgbM;\r\n\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\nuniform vec4 filterArea;\r\n\r\n/**\r\n Basic FXAA implementation based on the code on geeks3d.com with the\r\n modification that the texture2DLod stuff was removed since it\'s\r\n unsupported by WebGL.\r\n \r\n --\r\n \r\n From:\r\n https://github.com/mitsuhiko/webgl-meincraft\r\n \r\n Copyright (c) 2011 by Armin Ronacher.\r\n \r\n Some rights reserved.\r\n \r\n Redistribution and use in source and binary forms, with or without\r\n modification, are permitted provided that the following conditions are\r\n met:\r\n \r\n * Redistributions of source code must retain the above copyright\r\n notice, this list of conditions and the following disclaimer.\r\n \r\n * Redistributions in binary form must reproduce the above\r\n copyright notice, this list of conditions and the following\r\n disclaimer in the documentation and/or other materials provided\r\n with the distribution.\r\n \r\n * The names of the contributors may not be used to endorse or\r\n promote products derived from this software without specific\r\n prior written permission.\r\n \r\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n */\r\n\r\n#ifndef FXAA_REDUCE_MIN\r\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\r\n#endif\r\n#ifndef FXAA_REDUCE_MUL\r\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\r\n#endif\r\n#ifndef FXAA_SPAN_MAX\r\n#define FXAA_SPAN_MAX     8.0\r\n#endif\r\n\r\n//optimized version for mobile, where dependent\r\n//texture reads can be a bottleneck\r\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\r\n          vec2 v_rgbNW, vec2 v_rgbNE,\r\n          vec2 v_rgbSW, vec2 v_rgbSE,\r\n          vec2 v_rgbM) {\r\n    vec4 color;\r\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\r\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\r\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\r\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\r\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\r\n    vec4 texColor = texture2D(tex, v_rgbM);\r\n    vec3 rgbM  = texColor.xyz;\r\n    vec3 luma = vec3(0.299, 0.587, 0.114);\r\n    float lumaNW = dot(rgbNW, luma);\r\n    float lumaNE = dot(rgbNE, luma);\r\n    float lumaSW = dot(rgbSW, luma);\r\n    float lumaSE = dot(rgbSE, luma);\r\n    float lumaM  = dot(rgbM,  luma);\r\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\r\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\r\n    \r\n    mediump vec2 dir;\r\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\r\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\r\n    \r\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\r\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\r\n    \r\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\r\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\r\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\r\n                  dir * rcpDirMin)) * inverseVP;\r\n    \r\n    vec3 rgbA = 0.5 * (\r\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\r\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\r\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\r\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\r\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\r\n    \r\n    float lumaB = dot(rgbB, luma);\r\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\r\n        color = vec4(rgbA, texColor.a);\r\n    else\r\n        color = vec4(rgbB, texColor.a);\r\n    return color;\r\n}\r\n\r\nvoid main() {\r\n\r\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\r\n\r\n      vec4 color;\r\n\r\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\r\n\r\n      gl_FragColor = color;\r\n}\r\n'))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(r.Filter);i.default=n},{"../../core":65,path:25}],152:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("./fxaa/FXAAFilter");Object.defineProperty(i,"FXAAFilter",{enumerable:!0,get:function(){return p(r).default}});var n=t("./noise/NoiseFilter");Object.defineProperty(i,"NoiseFilter",{enumerable:!0,get:function(){return p(n).default}});var a=t("./displacement/DisplacementFilter");Object.defineProperty(i,"DisplacementFilter",{enumerable:!0,get:function(){return p(a).default}});var o=t("./blur/BlurFilter");Object.defineProperty(i,"BlurFilter",{enumerable:!0,get:function(){return p(o).default}});var s=t("./blur/BlurXFilter");Object.defineProperty(i,"BlurXFilter",{enumerable:!0,get:function(){return p(s).default}});var h=t("./blur/BlurYFilter");Object.defineProperty(i,"BlurYFilter",{enumerable:!0,get:function(){return p(h).default}});var c=t("./colormatrix/ColorMatrixFilter");Object.defineProperty(i,"ColorMatrixFilter",{enumerable:!0,get:function(){return p(c).default}});var u=t("./void/VoidFilter");function p(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"VoidFilter",{enumerable:!0,get:function(){return p(u).default}})},{"./blur/BlurFilter":143,"./blur/BlurXFilter":144,"./blur/BlurYFilter":145,"./colormatrix/ColorMatrixFilter":149,"./displacement/DisplacementFilter":150,"./fxaa/FXAAFilter":151,"./noise/NoiseFilter":153,"./void/VoidFilter":154}],153:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var a=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random();!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n    vTextureCoord = aTextureCoord;\r\n}","precision highp float;\r\n\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nuniform float uNoise;\r\nuniform float uSeed;\r\nuniform sampler2D uSampler;\r\n\r\nfloat rand(vec2 co)\r\n{\r\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\r\n}\r\n\r\nvoid main()\r\n{\r\n    vec4 color = texture2D(uSampler, vTextureCoord);\r\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\r\n    float diff = (randomValue - 0.5) * uNoise;\r\n\r\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\r\n    if (color.a > 0.0) {\r\n        color.rgb /= color.a;\r\n    }\r\n\r\n    color.r += diff;\r\n    color.g += diff;\r\n    color.b += diff;\r\n\r\n    // Premultiply alpha again.\r\n    color.rgb *= color.a;\r\n\r\n    gl_FragColor = color;\r\n}\r\n"));return n.noise=i,n.seed=r,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t}}]),e}(n.Filter);i.default=a},{"../../core":65,path:25}],154:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core"));t("path");var n=function(t){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,"attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n    vTextureCoord = aTextureCoord;\r\n}","varying vec2 vTextureCoord;\r\n\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void)\r\n{\r\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\r\n}\r\n"));return i.glShaderKey="void",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(r.Filter);i.default=n},{"../../core":65,path:25}],155:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),a=function(){function t(){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.global=new n.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return t.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},t.prototype._copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=t.buttons,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},t.prototype._reset=function(){this.isPrimary=!1},r(t,[{key:"pointerId",get:function(){return this.identifier}}]),t}();i.default=a},{"../core":65}],156:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0},t.prototype._reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},t}();i.default=r},{}],157:[function(t,e,i){"use strict";i.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),a=u(t("./InteractionData")),o=u(t("./InteractionEvent")),s=u(t("./InteractionTrackingData")),h=u(t("eventemitter3")),c=u(t("./interactiveTarget"));function u(t){return t&&t.__esModule?t:{default:t}}n.utils.mixins.delayMixin(n.DisplayObject.prototype,c.default);var p="MOUSE",l={target:null,data:{global:null}},d=function(t){function e(i,r){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r=r||{},s.renderer=i,s.autoPreventDefault=void 0===r.autoPreventDefault||r.autoPreventDefault,s.interactionFrequency=r.interactionFrequency||10,s.mouse=new a.default,s.mouse.identifier=p,s.mouse.global.set(-999999),s.activeInteractionData={},s.activeInteractionData[p]=s.mouse,s.interactionDataPool=[],s.eventData=new o.default,s.interactionDOMElement=null,s.moveWhenInside=!1,s.eventsAdded=!1,s.mouseOverRenderer=!1,s.supportsTouchEvents="ontouchstart"in window,s.supportsPointerEvents=!!window.PointerEvent,s.onPointerUp=s.onPointerUp.bind(s),s.processPointerUp=s.processPointerUp.bind(s),s.onPointerCancel=s.onPointerCancel.bind(s),s.processPointerCancel=s.processPointerCancel.bind(s),s.onPointerDown=s.onPointerDown.bind(s),s.processPointerDown=s.processPointerDown.bind(s),s.onPointerMove=s.onPointerMove.bind(s),s.processPointerMove=s.processPointerMove.bind(s),s.onPointerOut=s.onPointerOut.bind(s),s.processPointerOverOut=s.processPointerOverOut.bind(s),s.onPointerOver=s.onPointerOver.bind(s),s.cursorStyles={default:"inherit",pointer:"pointer"},s.currentCursorMode=null,s.cursor=null,s._tempPoint=new n.Point,s.resolution=1,s.setTargetElement(s.renderer.view,s.renderer.resolution),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.hitTest=function(t,e){return l.target=null,l.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(l,e,null,!0),l.target},e.prototype.setTargetElement=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},e.prototype.addEvents=function(){this.interactionDOMElement&&(n.ticker.shared.add(this.update,this,n.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.interactionDOMElement&&(n.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement))if(this.didMove)this.didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var i=this.activeInteractionData[e];if(i.originalEvent&&"touch"!==i.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(this.currentCursorMode!==(t=t||"default")){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(void 0===e?"undefined":r(e)){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,i){i.stopped||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},e.prototype.mapPositionToPoint=function(t,e,i){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=navigator.isCocoonJS?this.resolution:1/this.resolution;t.x=this.interactionDOMElement.width/r.width*(e-r.left)*n,t.y=this.interactionDOMElement.height/r.height*(i-r.top)*n},e.prototype.processInteractive=function(t,e,i,r,n){if(!e||!e.visible)return!1;var a=t.data.global,o=!1,s=n=e.interactive||n;if(e.hitArea?s=!1:r&&e._mask&&(e._mask.containsPoint(a)||(r=!1)),e.interactiveChildren&&e.children)for(var h=e.children,c=h.length-1;c>=0;c--){var u=h[c],p=this.processInteractive(t,u,i,r,s);if(p){if(!u.parent)continue;s=!1,p&&(t.target&&(r=!1),o=!0)}}return n&&(r&&!t.target&&(e.hitArea?(e.worldTransform.applyInverse(a,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)&&(o=!0)):e.containsPoint&&e.containsPoint(a)&&(o=!0)),e.interactive&&(o&&!t.target&&(t.target=e),i&&i(t,e,!!o))),o},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&t.preventDefault();for(var i=e.length,r=0;r<i;r++){var n=e[r],a=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,a);o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===n.pointerType?this.emit("touchstart",o):"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit(2===n.button?"rightdown":"mousedown",this.eventData)}}},e.prototype.processPointerDown=function(t,e,i){var r=t.data,n=t.data.identifier;if(i)if(e.trackedPointers[n]||(e.trackedPointers[n]=new s.default(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){var a=2===r.button;a?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,a?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,i){for(var r=this.normalizeToPointerData(t),n=r.length,a=t.target!==this.interactionDOMElement?"outside":"",o=0;o<n;o++){var s=r[o],h=this.getInteractionDataForPointerId(s),c=this.configureInteractionEventForDOMEvent(this.eventData,s,h);c.data.originalEvent=t,this.processInteractive(c,this.renderer._lastObjectRendered,i,e||!a),this.emit(e?"pointercancel":"pointerup"+a,c),"mouse"===s.pointerType||"pen"===s.pointerType?this.emit(2===s.button?"rightup"+a:"mouseup"+a,c):"touch"===s.pointerType&&(this.emit(e?"touchcancel":"touchend"+a,c),this.releaseInteractionDataForPointerId(s.pointerId,h))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var i=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,i){var r=t.data,n=t.data.identifier,a=e.trackedPointers[n],o="touch"===r.pointerType;if("mouse"===r.pointerType||"pen"===r.pointerType){var h=2===r.button,c=s.default.FLAGS,u=void 0!==a&&a.flags&(h?c.RIGHT_DOWN:c.LEFT_DOWN);i?(this.dispatchEvent(e,h?"rightup":"mouseup",t),u&&this.dispatchEvent(e,h?"rightclick":"click",t)):u&&this.dispatchEvent(e,h?"rightupoutside":"mouseupoutside",t),a&&(h?a.rightDown=!1:a.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),a&&(this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),a.over=!1))):a&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),a&&a.none&&delete e.trackedPointers[n]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"===e[0].pointerType&&(this.didMove=!0,this.cursor=null);for(var i=e.length,r=0;r<i;r++){var n=e[r],a=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,a);o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerMove,"touch"!==n.pointerType||this.moveWhenInside),this.emit("pointermove",o),"touch"===n.pointerType&&this.emit("touchmove",o),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,i){var r=t.data,n="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType;a&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),a&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(i.identifier)}},e.prototype.processPointerOverOut=function(t,e,i){var r=t.data,n=t.data.identifier,a="mouse"===r.pointerType||"pen"===r.pointerType,o=e.trackedPointers[n];i&&!o&&(o=e.trackedPointers[n]=new s.default(n)),void 0!==o&&(i&&this.mouseOverRenderer?(o.over||(o.over=!0,this.dispatchEvent(e,"pointerover",t),a&&this.dispatchEvent(e,"mouseover",t)),a&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),a&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[n]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)},e.prototype.getInteractionDataForPointerId=function(t){var e=t.pointerId,i=void 0;return e===p||"mouse"===t.pointerType?i=this.mouse:this.activeInteractionData[e]?i=this.activeInteractionData[e]:((i=this.interactionDataPool.pop()||new a.default).identifier=e,this.activeInteractionData[e]=i),i._copyEvent(t),i},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e._reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),navigator.isCocoonJS&&"touch"===e.pointerType&&(i.global.x=i.global.x/this.resolution,i.global.y=i.global.y/this.resolution),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t._reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,r=t.changedTouches.length;i<r;i++){var n=t.changedTouches[i];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),n.twist=0,n.tangentialPressure=0,void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent?e.push(t):(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=p),void 0===t.pressure&&(t.pressure=.5),t.twist=0,t.tangentialPressure=0,t.isNormalized=!0,e.push(t));return e},e.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},e}(h.default);i.default=d,n.WebGLRenderer.registerPlugin("interaction",d),n.CanvasRenderer.registerPlugin("interaction",d)},{"../core":65,"./InteractionData":155,"./InteractionEvent":156,"./InteractionTrackingData":158,"./interactiveTarget":160,eventemitter3:20}],158:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},r(t,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(t){this._flags=t}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},set:function(t){this._doSet(this.constructor.FLAGS.OVER,t)}},{key:"rightDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)}},{key:"leftDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)}}]),t}();i.default=n,n.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],159:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("./InteractionData");Object.defineProperty(i,"InteractionData",{enumerable:!0,get:function(){return h(r).default}});var n=t("./InteractionManager");Object.defineProperty(i,"InteractionManager",{enumerable:!0,get:function(){return h(n).default}});var a=t("./interactiveTarget");Object.defineProperty(i,"interactiveTarget",{enumerable:!0,get:function(){return h(a).default}});var o=t("./InteractionTrackingData");Object.defineProperty(i,"InteractionTrackingData",{enumerable:!0,get:function(){return h(o).default}});var s=t("./InteractionEvent");function h(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"InteractionEvent",{enumerable:!0,get:function(){return h(s).default}})},{"./InteractionData":155,"./InteractionEvent":156,"./InteractionManager":157,"./InteractionTrackingData":158,"./interactiveTarget":160}],160:[function(t,e,i){"use strict";i.__esModule=!0,i.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},{}],161:[function(t,e,i){"use strict";i.__esModule=!0,i.parse=s,i.default=function(){return function(t,e){if(t.data&&t.type===a.Resource.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var i=t.isDataUrl?"":r.dirname(t.url);t.isDataUrl&&("."===i&&(i=""),this.baseUrl&&i&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/")),(i=i.replace(this.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/");var o=i+t.data.getElementsByTagName("page")[0].getAttribute("file");n.utils.TextureCache[o]?(s(t,n.utils.TextureCache[o]),e()):this.add(t.name+"_image",o,{crossOrigin:t.crossOrigin,loadType:a.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t},function(i){s(t,i.texture),e()})}else e();else e()}};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("path")),n=t("../core"),a=t("resource-loader"),o=t("../extras");function s(t,e){t.bitmapFont=o.BitmapText.registerFont(t.data,e)}},{"../core":65,"../extras":141,path:25,"resource-loader":36}],162:[function(t,e,i){"use strict";i.__esModule=!0,i.shared=i.Resource=i.textureParser=i.getResourcePath=i.spritesheetParser=i.parseBitmapFontData=i.bitmapFontParser=i.Loader=void 0;var r=t("./bitmapFontParser");Object.defineProperty(i,"bitmapFontParser",{enumerable:!0,get:function(){return c(r).default}}),Object.defineProperty(i,"parseBitmapFontData",{enumerable:!0,get:function(){return r.parse}});var n=t("./spritesheetParser");Object.defineProperty(i,"spritesheetParser",{enumerable:!0,get:function(){return c(n).default}}),Object.defineProperty(i,"getResourcePath",{enumerable:!0,get:function(){return n.getResourcePath}});var a=t("./textureParser");Object.defineProperty(i,"textureParser",{enumerable:!0,get:function(){return c(a).default}});var o=t("resource-loader");Object.defineProperty(i,"Resource",{enumerable:!0,get:function(){return o.Resource}});var s=c(t("../core/Application")),h=c(t("./loader"));function c(t){return t&&t.__esModule?t:{default:t}}i.Loader=h.default;var u=new h.default;u.destroy=function(){},i.shared=u;var p=s.default.prototype;p._loader=null,Object.defineProperty(p,"loader",{get:function(){return this._loader||(this._loader=this._options.sharedLoader?u:new h.default),this._loader}}),p._parentDestroy=p.destroy,p.destroy=function(t){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(t)}},{"../core/Application":43,"./bitmapFontParser":161,"./loader":163,"./spritesheetParser":164,"./textureParser":165,"resource-loader":36}],163:[function(t,e,i){"use strict";i.__esModule=!0;var r=c(t("resource-loader")),n=t("resource-loader/lib/middlewares/parsing/blob"),a=c(t("eventemitter3")),o=c(t("./textureParser")),s=c(t("./spritesheetParser")),h=c(t("./bitmapFontParser"));function c(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(i,r){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,r));a.default.call(n);for(var o=0;o<e._pixiMiddleware.length;++o)n.use(e._pixiMiddleware[o]());return n.onStart.add(function(t){return n.emit("start",t)}),n.onProgress.add(function(t,e){return n.emit("progress",t,e)}),n.onError.add(function(t,e,i){return n.emit("error",t,e,i)}),n.onLoad.add(function(t,e){return n.emit("load",t,e)}),n.onComplete.add(function(t,e){return n.emit("complete",t,e)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.addPixiMiddleware=function(t){e._pixiMiddleware.push(t)},e.prototype.destroy=function(){this.removeAllListeners(),this.reset()},e}(r.default);for(var p in i.default=u,a.default.prototype)u.prototype[p]=a.default.prototype[p];u._pixiMiddleware=[n.blobMiddlewareFactory,o.default,s.default,h.default];var l=r.default.Resource;l.setExtensionXhrType("fnt",l.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":161,"./spritesheetParser":164,"./textureParser":165,eventemitter3:20,"resource-loader":36,"resource-loader/lib/middlewares/parsing/blob":37}],164:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){return function(t,e){var i=t.name+"_image";if(t.data&&t.type===n.Resource.TYPE.JSON&&t.data.frames&&!this.resources[i]){var r={crossOrigin:t.crossOrigin,loadType:n.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t},a=s(t,this.baseUrl);this.add(i,a,r,function(i){var r=new o.Spritesheet(i.texture.baseTexture,t.data,t.url);r.parse(function(){t.spritesheet=r,t.textures=r.textures,e()})})}else e()}},i.getResourcePath=s;var r,n=t("resource-loader"),a=(r=t("url"))&&r.__esModule?r:{default:r},o=t("../core");function s(t,e){return t.isDataUrl?t.data.meta.image:a.default.resolve(t.url.replace(e,""),t.data.meta.image)}},{"../core":65,"resource-loader":36,url:38}],165:[function(t,e,i){"use strict";i.__esModule=!0,i.default=function(){return function(t,e){t.data&&t.type===n.Resource.TYPE.IMAGE&&(t.texture=a.default.fromLoader(t.data,t.url,t.name)),e()}};var r,n=t("resource-loader"),a=(r=t("../core/textures/Texture"))&&r.__esModule?r:{default:r}},{"../core/textures/Texture":115,"resource-loader":36}],166:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),o=(r=t("../extras/TextureTransform"))&&r.__esModule?r:{default:r},s=new a.Point,h=new a.Polygon,c=function(t){function e(i,r,n,s,h){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return c._texture=i,c.uvs=n||new Float32Array([0,0,1,0,1,1,0,1]),c.vertices=r||new Float32Array([0,0,100,0,100,100,0,100]),c.indices=s||new Uint16Array([0,1,3,2]),c.dirty=0,c.indexDirty=0,c.blendMode=a.BLEND_MODES.NORMAL,c.canvasPadding=0,c.drawMode=h||e.DRAW_MODES.TRIANGLE_MESH,c.shader=null,c.tintRgb=new Float32Array([1,1,1]),c._glDatas={},c._uvTransform=new o.default(i),c.uploadUvTransform=!1,c.pluginName="mesh",c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._renderWebGL=function(t){this.refresh(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){this.refresh(),t.plugins[this.pluginName].render(this)},e.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},e.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},e.prototype.refresh=function(t){this._uvTransform.update(t)&&this._refresh()},e.prototype._refresh=function(){},e.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,s);for(var i=this.vertices,r=h.points,n=this.indices,a=this.indices.length,o=this.drawMode===e.DRAW_MODES.TRIANGLES?3:1,c=0;c+2<a;c+=o){var u=2*n[c],p=2*n[c+1],l=2*n[c+2];if(r[0]=i[u],r[1]=i[u+1],r[2]=i[p],r[3]=i[p+1],r[4]=i[l],r[5]=i[l+1],h.contains(s.x,s.y))return!0}return!1},n(e,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return a.utils.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=a.utils.hex2rgb(t,this.tintRgb)}}]),e}(a.Container);i.default=c,c.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":65,"../extras/TextureTransform":136}],167:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=(r=t("./Plane"))&&r.__esModule?r:{default:r},o=10,s=function(t){function e(i,r,n,a,s){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,4,4));return h._origWidth=i.orig.width,h._origHeight=i.orig.height,h._width=h._origWidth,h._height=h._origHeight,h.leftWidth=void 0!==r?r:o,h.rightWidth=void 0!==a?a:o,h.topHeight=void 0!==n?n:o,h.bottomHeight=void 0!==s?s:o,h.refresh(!0),h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateHorizontalVertices=function(){var t=this.vertices;t[9]=t[11]=t[13]=t[15]=this._topHeight,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices;t[2]=t[10]=t[18]=t[26]=this._leftWidth,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._renderCanvas=function(t){var e=t.context;e.globalAlpha=this.worldAlpha;var i=this.worldTransform,r=t.resolution;t.roundPixels?e.setTransform(i.a*r,i.b*r,i.c*r,i.d*r,i.tx*r|0,i.ty*r|0):e.setTransform(i.a*r,i.b*r,i.c*r,i.d*r,i.tx*r,i.ty*r);var n=this._texture.baseTexture,a=n.source,o=n.width,s=n.height;this.drawSegment(e,a,o,s,0,1,10,11),this.drawSegment(e,a,o,s,2,3,12,13),this.drawSegment(e,a,o,s,4,5,14,15),this.drawSegment(e,a,o,s,8,9,18,19),this.drawSegment(e,a,o,s,10,11,20,21),this.drawSegment(e,a,o,s,12,13,22,23),this.drawSegment(e,a,o,s,16,17,26,27),this.drawSegment(e,a,o,s,18,19,28,29),this.drawSegment(e,a,o,s,20,21,30,31)},e.prototype.drawSegment=function(t,e,i,r,n,a,o,s){var h=this.uvs,c=this.vertices,u=(h[o]-h[n])*i,p=(h[s]-h[a])*r,l=c[o]-c[n],d=c[s]-c[a];u<1&&(u=1),p<1&&(p=1),l<1&&(l=1),d<1&&(d=1),t.drawImage(e,h[n]*i,h[a]*r,u,p,c[n],c[a],l,d)},e.prototype._refresh=function(){t.prototype._refresh.call(this);var e=this.uvs,i=this._texture;this._origWidth=i.orig.width,this._origHeight=i.orig.height;var r=1/this._origWidth,n=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=r*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-r*this._rightWidth,e[9]=e[11]=e[13]=e[15]=n*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty=!0,this.multiplyUvs()},n(e,[{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._refresh()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()}}]),e}(a.default);i.default=s},{"./Plane":168}],168:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=(r=t("./Mesh"))&&r.__esModule?r:{default:r},a=function(t){function e(i,r,a){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return o._ready=!0,o.verticesX=r||10,o.verticesY=a||10,o.drawMode=n.default.DRAW_MODES.TRIANGLES,o.refresh(),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._refresh=function(){for(var t=this._texture,e=this.verticesX*this.verticesY,i=[],r=[],n=[],a=this.verticesX-1,o=this.verticesY-1,s=t.width/a,h=t.height/o,c=0;c<e;c++){var u=c%this.verticesX,p=c/this.verticesX|0;i.push(u*s,p*h),r.push(u/a,p/o)}for(var l=a*o,d=0;d<l;d++){var m=d%a,f=d/a|0,_=f*this.verticesX+m+1,y=(f+1)*this.verticesX+m,g=(f+1)*this.verticesX+m+1;n.push(f*this.verticesX+m,_,y),n.push(_,g,y)}this.vertices=new Float32Array(i),this.uvs=new Float32Array(r),this.colors=new Float32Array([]),this.indices=new Uint16Array(n),this.indexDirty=!0,this.multiplyUvs()},e.prototype._onTextureUpdate=function(){n.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},e}(n.default);i.default=a},{"./Mesh":166}],169:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(t){function e(i,r){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.points=r,n.vertices=new Float32Array(4*r.length),n.uvs=new Float32Array(4*r.length),n.colors=new Float32Array(2*r.length),n.indices=new Uint16Array(2*r.length),n.autoUpdate=!0,n.refresh(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){this.vertices.length/4!==t.length&&(this.vertices=new Float32Array(4*t.length),this.uvs=new Float32Array(4*t.length),this.colors=new Float32Array(2*t.length),this.indices=new Uint16Array(2*t.length));var e=this.uvs,i=this.indices,r=this.colors;e[0]=0,e[1]=0,e[2]=0,e[3]=1,r[0]=1,r[1]=1,i[0]=0,i[1]=1;for(var n=t.length,a=1;a<n;a++){var o=4*a,s=a/(n-1);e[o]=s,e[o+1]=0,e[o+2]=s,e[o+3]=1,r[o=2*a]=1,r[o+1]=1,i[o=2*a]=o,i[o+1]=o+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},e.prototype.refreshVertices=function(){var t=this.points;if(!(t.length<1))for(var e=t[0],i=void 0,r=0,n=0,a=this.vertices,o=t.length,s=0;s<o;s++){var h=t[s],c=4*s;n=-((i=s<t.length-1?t[s+1]:h).x-e.x),r=i.y-e.y;var u=10*(1-s/(o-1));u>1&&(u=1);var p=Math.sqrt(r*r+n*n),l=this._texture.height/2;r/=p,n/=p,n*=l,a[c]=h.x+(r*=l),a[c+1]=h.y+n,a[c+2]=h.x-r,a[c+3]=h.y-n,e=h}},e.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},e}(((r=t("./Mesh"))&&r.__esModule?r:{default:r}).default);i.default=n},{"./Mesh":166}],170:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),a=(r=t("../Mesh"))&&r.__esModule?r:{default:r},o=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,i=e.context,r=t.worldTransform,n=e.resolution;e.roundPixels?i.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n|0,r.ty*n|0):i.setTransform(r.a*n,r.b*n,r.c*n,r.d*n,r.tx*n,r.ty*n),e.setBlendMode(t.blendMode),t.drawMode===a.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(t):this._renderTriangles(t)},t.prototype._renderTriangleMesh=function(t){for(var e=t.vertices.length/2,i=0;i<e-2;i++){var r=2*i;this._renderDrawTriangle(t,r,r+2,r+4)}},t.prototype._renderTriangles=function(t){for(var e=t.indices,i=e.length,r=0;r<i;r+=3)this._renderDrawTriangle(t,2*e[r],2*e[r+1],2*e[r+2])},t.prototype._renderDrawTriangle=function(t,e,i,r){var n=this.renderer.context,a=t.uvs,o=t.vertices,s=t._texture;if(s.valid){var h=s.baseTexture,c=h.source,u=h.width,p=h.height,l=void 0,d=void 0,m=void 0,f=void 0,_=void 0,y=void 0;if(t.uploadUvTransform){var g=t._uvTransform.mapCoord;l=(a[e]*g.a+a[e+1]*g.c+g.tx)*h.width,d=(a[i]*g.a+a[i+1]*g.c+g.tx)*h.width,m=(a[r]*g.a+a[r+1]*g.c+g.tx)*h.width,f=(a[e]*g.b+a[e+1]*g.d+g.ty)*h.height,_=(a[i]*g.b+a[i+1]*g.d+g.ty)*h.height,y=(a[r]*g.b+a[r+1]*g.d+g.ty)*h.height}else l=a[e]*h.width,d=a[i]*h.width,m=a[r]*h.width,f=a[e+1]*h.height,_=a[i+1]*h.height,y=a[r+1]*h.height;var v=o[e],w=o[i],S=o[r],b=o[e+1],x=o[i+1],T=o[r+1];if(t.canvasPadding>0){var M=t.canvasPadding/t.worldTransform.a,E=t.canvasPadding/t.worldTransform.d,I=(v+w+S)/3,C=(b+x+T)/3,A=v-I,B=b-C,W=Math.sqrt(A*A+B*B);v=I+A/W*(W+M),b=C+B/W*(W+E),B=x-C,w=I+(A=w-I)/(W=Math.sqrt(A*A+B*B))*(W+M),x=C+B/W*(W+E),B=T-C,S=I+(A=S-I)/(W=Math.sqrt(A*A+B*B))*(W+M),T=C+B/W*(W+E)}n.save(),n.beginPath(),n.moveTo(v,b),n.lineTo(w,x),n.lineTo(S,T),n.closePath(),n.clip();var P=l*_+f*m+d*y-_*m-f*d-l*y;n.transform((v*_+f*S+w*y-_*S-f*w-v*y)/P,(b*_+f*T+x*y-_*T-f*x-b*y)/P,(l*w+v*m+d*S-w*m-v*d-l*S)/P,(l*x+b*m+d*T-x*m-b*d-l*T)/P,(l*_*S+f*w*m+v*d*y-v*_*m-f*d*S-l*w*y)/P,(l*_*T+f*x*m+b*d*y-b*_*m-f*d*T-l*x*y)/P),n.drawImage(c,0,0,u*h.resolution,p*h.resolution,0,0,u,p),n.restore(),this.renderer.invalidateBlendMode()}},t.prototype.renderMeshFlat=function(t){var e=this.renderer.context,i=t.vertices,r=i.length/2;e.beginPath();for(var n=1;n<r-2;++n){var a=2*n,o=i[a+2],s=i[a+3],h=i[a+4],c=i[a+5];e.moveTo(i[a],i[a+1]),e.lineTo(o,s),e.lineTo(h,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();i.default=o,n.CanvasRenderer.registerPlugin("mesh",o)},{"../../core":65,"../Mesh":166}],171:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("./Mesh");Object.defineProperty(i,"Mesh",{enumerable:!0,get:function(){return c(r).default}});var n=t("./webgl/MeshRenderer");Object.defineProperty(i,"MeshRenderer",{enumerable:!0,get:function(){return c(n).default}});var a=t("./canvas/CanvasMeshRenderer");Object.defineProperty(i,"CanvasMeshRenderer",{enumerable:!0,get:function(){return c(a).default}});var o=t("./Plane");Object.defineProperty(i,"Plane",{enumerable:!0,get:function(){return c(o).default}});var s=t("./NineSlicePlane");Object.defineProperty(i,"NineSlicePlane",{enumerable:!0,get:function(){return c(s).default}});var h=t("./Rope");function c(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"Rope",{enumerable:!0,get:function(){return c(h).default}})},{"./Mesh":166,"./NineSlicePlane":167,"./Plane":168,"./Rope":169,"./canvas/CanvasMeshRenderer":170,"./webgl/MeshRenderer":172}],172:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),n=o(t("pixi-gl-core")),a=o(t("../Mesh"));function o(t){return t&&t.__esModule?t:{default:t}}t("path");var s=r.Matrix.IDENTITY,h=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.shader=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){this.shader=new r.Shader(this.renderer.gl,"attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTransform;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","varying vec2 vTextureCoord;\r\nuniform vec4 uColor;\r\n\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void)\r\n{\r\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\r\n}\r\n")},e.prototype.render=function(t){var e=this.renderer,i=e.gl,o=t._texture;if(o.valid){var h=t._glDatas[e.CONTEXT_UID];h||(e.bindVao(null),(h={shader:this.shader,vertexBuffer:n.default.GLBuffer.createVertexBuffer(i,t.vertices,i.STREAM_DRAW),uvBuffer:n.default.GLBuffer.createVertexBuffer(i,t.uvs,i.STREAM_DRAW),indexBuffer:n.default.GLBuffer.createIndexBuffer(i,t.indices,i.STATIC_DRAW),vao:null,dirty:t.dirty,indexDirty:t.indexDirty}).vao=new n.default.VertexArrayObject(i).addIndex(h.indexBuffer).addAttribute(h.vertexBuffer,h.shader.attributes.aVertexPosition,i.FLOAT,!1,8,0).addAttribute(h.uvBuffer,h.shader.attributes.aTextureCoord,i.FLOAT,!1,8,0),t._glDatas[e.CONTEXT_UID]=h),e.bindVao(h.vao),t.dirty!==h.dirty&&(h.dirty=t.dirty,h.uvBuffer.upload(t.uvs)),t.indexDirty!==h.indexDirty&&(h.indexDirty=t.indexDirty,h.indexBuffer.upload(t.indices)),h.vertexBuffer.upload(t.vertices),e.bindShader(h.shader),h.shader.uniforms.uSampler=e.bindTexture(o),e.state.setBlendMode(r.utils.correctBlendMode(t.blendMode,o.baseTexture.premultipliedAlpha)),h.shader.uniforms.uTransform&&(h.shader.uniforms.uTransform=t.uploadUvTransform?t._uvTransform.mapCoord.toArray(!0):s.toArray(!0)),h.shader.uniforms.translationMatrix=t.worldTransform.toArray(!0),h.shader.uniforms.uColor=r.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,h.shader.uniforms.uColor,o.baseTexture.premultipliedAlpha),h.vao.draw(t.drawMode===a.default.DRAW_MODES.TRIANGLE_MESH?i.TRIANGLE_STRIP:i.TRIANGLES,t.indices.length,0)}},e}(r.ObjectRenderer);i.default=h,r.WebGLRenderer.registerPlugin("mesh",h)},{"../../core":65,"../Mesh":166,path:25,"pixi-gl-core":7}],173:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),a=t("../core/utils"),o=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,r=arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384;!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return a>16384&&(a=16384),a>i&&(a=i),o._properties=[!1,!0,!1,!1,!1],o._maxSize=i,o._batchSize=a,o._glBuffers={},o._bufferToUpdate=0,o.interactiveChildren=!1,o.blendMode=n.BLEND_MODES.NORMAL,o.roundPixels=!0,o.baseTexture=null,o.setProperties(r),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t?!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},e.prototype.renderWebGL=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){var e=Math.floor(t/this._batchSize);e<this._bufferToUpdate&&(this._bufferToUpdate=e)},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,i=this.worldTransform,r=!0,n=0,a=0,o=0,s=0;t.setBlendMode(this.blendMode),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var h=0;h<this.children.length;++h){var c=this.children[h];if(c.visible){var u=c._texture.frame;if(e.globalAlpha=this.worldAlpha*c.alpha,c.rotation%(2*Math.PI)==0)r&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx*t.resolution,i.ty*t.resolution),r=!1),n=c.anchor.x*(-u.width*c.scale.x)+c.position.x+.5,a=c.anchor.y*(-u.height*c.scale.y)+c.position.y+.5,o=u.width*c.scale.x,s=u.height*c.scale.y;else{r||(r=!0),c.displayObjectUpdateTransform();var p=c.worldTransform;t.roundPixels?e.setTransform(p.a,p.b,p.c,p.d,p.tx*t.resolution|0,p.ty*t.resolution|0):e.setTransform(p.a,p.b,p.c,p.d,p.tx*t.resolution,p.ty*t.resolution),n=c.anchor.x*-u.width+.5,a=c.anchor.y*-u.height+.5,o=u.width,s=u.height}var l=c._texture.baseTexture.resolution;e.drawImage(c._texture.baseTexture.source,u.x*l,u.y*l,u.width*l,u.height*l,n*t.resolution,a*t.resolution,o*t.resolution,s*t.resolution)}}}},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._buffers)for(var i=0;i<this._buffers.length;++i)this._buffers[i].destroy();this._properties=null,this._buffers=null},r(e,[{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,(0,a.hex2rgb)(t,this.tintRgb)}}]),e}(n.Container);i.default=o},{"../core":65,"../core/utils":124}],174:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("./ParticleContainer");Object.defineProperty(i,"ParticleContainer",{enumerable:!0,get:function(){return a(r).default}});var n=t("./webgl/ParticleRenderer");function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"ParticleRenderer",{enumerable:!0,get:function(){return a(n).default}})},{"./ParticleContainer":173,"./webgl/ParticleRenderer":176}],175:[function(t,e,i){"use strict";i.__esModule=!0;var r=a(t("pixi-gl-core")),n=a(t("../../core/utils/createIndicesForQuads"));function a(t){return t&&t.__esModule?t:{default:t}}var o=function(){function t(e,i,r,n){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.gl=e,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var a=0;a<i.length;++a){var o=i[a];o={attribute:o.attribute,size:o.size,uploadFunction:o.uploadFunction,offset:o.offset},r[a]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.gl,e=0;this.indices=(0,n.default)(this.size),this.indexBuffer=r.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var a=this.dynamicProperties[i];a.offset=e,e+=a.size,this.dynamicStride+=a.size}this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=r.default.GLBuffer.createVertexBuffer(t,this.dynamicData,t.STREAM_DRAW);var o=0;this.staticStride=0;for(var s=0;s<this.staticProperties.length;++s){var h=this.staticProperties[s];h.offset=o,o+=h.size,this.staticStride+=h.size}this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=r.default.GLBuffer.createVertexBuffer(t,this.staticData,t.STATIC_DRAW),this.vao=new r.default.VertexArrayObject(t).addIndex(this.indexBuffer);for(var c=0;c<this.dynamicProperties.length;++c){var u=this.dynamicProperties[c];this.vao.addAttribute(this.dynamicBuffer,u.attribute,t.FLOAT,!1,4*this.dynamicStride,4*u.offset)}for(var p=0;p<this.staticProperties.length;++p){var l=this.staticProperties[p];this.vao.addAttribute(this.staticBuffer,l.attribute,t.FLOAT,!1,4*this.staticStride,4*l.offset)}},t.prototype.uploadDynamic=function(t,e,i){for(var r=0;r<this.dynamicProperties.length;r++){var n=this.dynamicProperties[r];n.uploadFunction(t,e,i,this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer.upload()},t.prototype.uploadStatic=function(t,e,i){for(var r=0;r<this.staticProperties.length;r++){var n=this.staticProperties[r];n.uploadFunction(t,e,i,this.staticData,this.staticStride,n.offset)}this.staticBuffer.upload()},t.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.dynamicBuffer.destroy(),this.staticProperties=null,this.staticData=null,this.staticBuffer.destroy()},t}();i.default=o},{"../../core/utils/createIndicesForQuads":122,"pixi-gl-core":7}],176:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),n=o(t("./ParticleShader")),a=o(t("./ParticleBuffer"));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return n.shader=null,n.indexBuffer=null,n.properties=null,n.tempMatrix=new r.Matrix,n.CONTEXT_UID=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new n.default(t),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},e.prototype.start=function(){this.renderer.bindShader(this.shader)},e.prototype.render=function(t){var e=t.children,i=t._maxSize,n=t._batchSize,a=this.renderer,o=e.length;if(0!==o){o>i&&(o=i);var s=t._glBuffers[a.CONTEXT_UID];s||(s=t._glBuffers[a.CONTEXT_UID]=this.generateBuffers(t));var h=e[0]._texture.baseTexture;this.renderer.setBlendMode(r.utils.correctBlendMode(t.blendMode,h.premultipliedAlpha));var c=a.gl,u=t.worldTransform.copy(this.tempMatrix);u.prepend(a._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=u.toArray(!0),this.shader.uniforms.uColor=r.utils.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,h.premultipliedAlpha),this.shader.uniforms.uSampler=a.bindTexture(h);for(var p=0,l=0;p<o;p+=n,l+=1){var d=o-p;d>n&&(d=n);var m=s[l];m.uploadDynamic(e,p,d),t._bufferToUpdate===l&&(m.uploadStatic(e,p,d),t._bufferToUpdate=l+1),a.bindVao(m.vao),m.vao.draw(c.TRIANGLES,6*d)}}},e.prototype.generateBuffers=function(t){for(var e=this.renderer.gl,i=[],r=t._maxSize,n=t._batchSize,o=t._properties,s=0;s<r;s+=n)i.push(new a.default(e,this.properties,o,n));return i},e.prototype.uploadVertices=function(t,e,i,r,n,a){for(var o=0,s=0,h=0,c=0,u=0;u<i;++u){var p=t[e+u],l=p._texture,d=p.scale.x,m=p.scale.y,f=l.trim,_=l.orig;f?(o=(s=f.x-p.anchor.x*_.width)+f.width,h=(c=f.y-p.anchor.y*_.height)+f.height):(o=_.width*(1-p.anchor.x),s=_.width*-p.anchor.x,h=_.height*(1-p.anchor.y),c=_.height*-p.anchor.y),r[a]=s*d,r[a+1]=c*m,r[a+n]=o*d,r[a+n+1]=c*m,r[a+2*n]=o*d,r[a+2*n+1]=h*m,r[a+3*n]=s*d,r[a+3*n+1]=h*m,a+=4*n}},e.prototype.uploadPosition=function(t,e,i,r,n,a){for(var o=0;o<i;o++){var s=t[e+o].position;r[a]=s.x,r[a+1]=s.y,r[a+n]=s.x,r[a+n+1]=s.y,r[a+2*n]=s.x,r[a+2*n+1]=s.y,r[a+3*n]=s.x,r[a+3*n+1]=s.y,a+=4*n}},e.prototype.uploadRotation=function(t,e,i,r,n,a){for(var o=0;o<i;o++){var s=t[e+o].rotation;r[a]=s,r[a+n]=s,r[a+2*n]=s,r[a+3*n]=s,a+=4*n}},e.prototype.uploadUvs=function(t,e,i,r,n,a){for(var o=0;o<i;++o){var s=t[e+o]._texture._uvs;s?(r[a]=s.x0,r[a+1]=s.y0,r[a+n]=s.x1,r[a+n+1]=s.y1,r[a+2*n]=s.x2,r[a+2*n+1]=s.y2,r[a+3*n]=s.x3,r[a+3*n+1]=s.y3,a+=4*n):(r[a]=0,r[a+1]=0,r[a+n]=0,r[a+n+1]=0,r[a+2*n]=0,r[a+2*n+1]=0,r[a+3*n]=0,r[a+3*n+1]=0,a+=4*n)}},e.prototype.uploadAlpha=function(t,e,i,r,n,a){for(var o=0;o<i;o++){var s=t[e+o].alpha;r[a]=s,r[a+n]=s,r[a+2*n]=s,r[a+3*n]=s,a+=4*n}},e.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),t.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},e}(r.ObjectRenderer);i.default=s,r.WebGLRenderer.registerPlugin("particle",s)},{"../../core":65,"./ParticleBuffer":175,"./ParticleShader":177}],177:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(t){function e(i){return function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform vec4 uColor;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uColor;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n")))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((r=t("../../core/Shader"))&&r.__esModule?r:{default:r}).default);i.default=n},{"../../core/Shader":44}],178:[function(t,e,i){"use strict";Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1})},{}],179:[function(t,e,i){"use strict";var r,n=(r=t("object-assign"))&&r.__esModule?r:{default:r};Object.assign||(Object.assign=n.default)},{"object-assign":23}],180:[function(t,e,i){"use strict";t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":178,"./Object.assign":179,"./requestAnimationFrame":181}],181:[function(t,e,i){(function(t){"use strict";var e;Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),t.performance&&t.performance.now||(e=Date.now(),t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e});for(var i=Date.now(),r=["ms","moz","webkit","o"],n=0;n<r.length&&!t.requestAnimationFrame;++n){var a=r[n];t.requestAnimationFrame=t[a+"RequestAnimationFrame"],t.cancelAnimationFrame=t[a+"CancelAnimationFrame"]||t[a+"CancelRequestAnimationFrame"]}t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),r=16+i-e;return r<0&&(r=0),i=e,setTimeout(function(){i=Date.now(),t(performance.now())},r)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){return clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],182:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../core")),a=(r=t("./limiters/CountLimiter"))&&r.__esModule?r:{default:r},o=n.ticker.shared;n.settings.UPLOADS_PER_FRAME=4;var s=function(){function t(e){var i=this;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.limiter=new a.default(n.settings.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){i.queue&&i.prepareItems()},this.registerFindHook(d),this.registerFindHook(m),this.registerFindHook(h),this.registerFindHook(c),this.registerFindHook(u),this.registerUploadHook(p),this.registerUploadHook(l)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,o.addOnce(this.tick,this,n.UPDATE_PRIORITY.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)o.addOnce(this.tick,this,n.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var a=this.completes.slice(0);this.completes.length=0;for(var s=0,h=a.length;s<h;s++)a[s]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof n.Container)for(var r=t.children.length-1;r>=0;r--)this.add(t.children[r]);return this},t.prototype.destroy=function(){this.ticking&&o.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function h(t,e){var i=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof n.Texture){var a=t._textures[r].baseTexture;-1===e.indexOf(a)&&(e.push(a),i=!0)}return i}function c(t,e){return t instanceof n.BaseTexture&&(-1===e.indexOf(t)&&e.push(t),!0)}function u(t,e){if(t._texture&&t._texture instanceof n.Texture){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function p(t,e){return e instanceof n.Text&&(e.updateText(!0),!0)}function l(t,e){if(e instanceof n.TextStyle){var i=e.toFontString();return n.TextMetrics.measureFont(i),!0}return!1}function d(t,e){if(t instanceof n.Text){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function m(t,e){return t instanceof n.TextStyle&&(-1===e.indexOf(t)&&e.push(t),!0)}i.default=s},{"../core":65,"./limiters/CountLimiter":185}],183:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),a=(r=t("../BasePrepare"))&&r.__esModule?r:{default:r},o=16,s=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.uploadHookHelper=r,r.canvas=document.createElement("canvas"),r.canvas.width=o,r.canvas.height=o,r.ctx=r.canvas.getContext("2d"),r.registerUploadHook(h),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ctx=null,this.canvas=null},e}(a.default);function h(t,e){if(e instanceof n.BaseTexture){var i=e.source,r=0===i.width?t.canvas.width:Math.min(t.canvas.width,i.width),a=0===i.height?t.canvas.height:Math.min(t.canvas.height,i.height);return t.ctx.drawImage(i,0,0,r,a,0,0,t.canvas.width,t.canvas.height),!0}return!1}i.default=s,n.CanvasRenderer.registerPlugin("prepare",s)},{"../../core":65,"../BasePrepare":182}],184:[function(t,e,i){"use strict";i.__esModule=!0;var r=t("./webgl/WebGLPrepare");Object.defineProperty(i,"webgl",{enumerable:!0,get:function(){return h(r).default}});var n=t("./canvas/CanvasPrepare");Object.defineProperty(i,"canvas",{enumerable:!0,get:function(){return h(n).default}});var a=t("./BasePrepare");Object.defineProperty(i,"BasePrepare",{enumerable:!0,get:function(){return h(a).default}});var o=t("./limiters/CountLimiter");Object.defineProperty(i,"CountLimiter",{enumerable:!0,get:function(){return h(o).default}});var s=t("./limiters/TimeLimiter");function h(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(i,"TimeLimiter",{enumerable:!0,get:function(){return h(s).default}})},{"./BasePrepare":182,"./canvas/CanvasPrepare":183,"./limiters/CountLimiter":185,"./limiters/TimeLimiter":186,"./webgl/WebGLPrepare":187}],185:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.maxItemsPerFrame=e,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();i.default=r},{}],186:[function(t,e,i){"use strict";i.__esModule=!0;var r=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.maxMilliseconds=e,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}();i.default=r},{}],187:[function(t,e,i){"use strict";i.__esModule=!0;var r,n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(t("../../core")),a=function(t){function e(i){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,i));return r.uploadHookHelper=r.renderer,r.registerFindHook(h),r.registerUploadHook(o),r.registerUploadHook(s),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((r=t("../BasePrepare"))&&r.__esModule?r:{default:r}).default);function o(t,e){return e instanceof n.BaseTexture&&(e._glTextures[t.CONTEXT_UID]||t.textureManager.updateTexture(e),!0)}function s(t,e){return e instanceof n.Graphics&&((e.dirty||e.clearDirty||!e._webGL[t.plugins.graphics.CONTEXT_UID])&&t.plugins.graphics.updateGraphics(e),!0)}function h(t,e){return t instanceof n.Graphics&&(e.push(t),!0)}i.default=a,n.WebGLRenderer.registerPlugin("prepare",a)},{"../../core":65,"../BasePrepare":182}],188:[function(t,e,i){(function(e){"use strict";i.__esModule=!0,i.loader=i.prepare=i.particles=i.mesh=i.loaders=i.interaction=i.filters=i.extras=i.extract=i.accessibility=void 0;var r=t("./polyfill");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return r[t]}})});var n=t("./core");Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return n[t]}})});var a,o=(a=t("./deprecation"))&&a.__esModule?a:{default:a},s=_(t("./accessibility")),h=_(t("./extract")),c=_(t("./extras")),u=_(t("./filters")),p=_(t("./interaction")),l=_(t("./loaders")),d=_(t("./mesh")),m=_(t("./particles")),f=_(t("./prepare"));function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}n.utils.mixins.performMixins();var y=l.shared||null;i.accessibility=s,i.extract=h,i.extras=c,i.filters=u,i.interaction=p,i.loaders=l,i.mesh=d,i.particles=m,i.prepare=f,i.loader=y,"function"==typeof o.default&&(0,o.default)(i),e.PIXI=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":42,"./core":65,"./deprecation":130,"./extract":132,"./extras":141,"./filters":152,"./interaction":159,"./loaders":162,"./mesh":171,"./particles":174,"./polyfill":180,"./prepare":184}]},{},[188])(188)}),function(t){var e;e=function(t){this.tileAnim=[0,0],this.dontUseTransform=!1,this.renderer=t,this.tileAnim=[0,0]},(t.tilemap||(t.tilemap={})).CanvasTileRenderer=e,t.CanvasRenderer.registerPlugin("tilemap",e)}(PIXI||(PIXI={}));var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),PIXI,PIXI,PIXI,PIXI,PIXI,PIXI,PIXI,PIXI;!function(t){!function(e){var i=function(i){function r(t,e,r,n){var a=i.call(this)||this;return a.shadowColor=new Float32Array([0,0,0,.5]),a.modificationMarker=0,a._globalMat=null,a._tempScale=null,a.initialize.apply(a,arguments),a}return __extends(r,i),r.prototype.updateTransform=function(){i.prototype.displayObjectUpdateTransform.call(this)},r.prototype.initialize=function(t,e,i,r){this.z=this.zIndex=t,this.useSquare=i,this.texPerChild=r||16,e&&this.setBitmaps(e)},r.prototype.setBitmaps=function(t){var i,r=this.texPerChild,n=this.children.length,a=Math.ceil(t.length/r);for(i=0;i<n;i++)this.children[i].textures=t.slice(i*r,(i+1)*r);for(i=n;i<a;i++)this.addChild(new e.RectTileLayer(this.zIndex,t.slice(i*r,(i+1)*r)))},r.prototype.clear=function(){for(var t=0;t<this.children.length;t++)this.children[t].clear();this.modificationMarker=0},r.prototype.addRect=function(t,e,i,r,n,a,o){this.children[t]&&this.children[t].textures&&this.children[t].addRect(0,e,i,r,n,a,o)},r.prototype.addFrame=function(i,r,n,a,o){var s,h=null,c=0,u=this.children;if("number"==typeof i){if(h=u[i/this.texPerChild>>0])c=i%this.texPerChild;else{if(!(h=u[0]))return!1;c=0}s=h.textures[c]}else if("string"==typeof i)s=t.Texture.fromImage(i);else{s=i;for(var p=0;p<u.length;p++){for(var l=(m=u[p]).textures,d=0;d<l.length;d++)if(l[d].baseTexture==s.baseTexture){h=m,c=d;break}if(h)break}if(!h){for(p=0;p<u.length;p++){var m;if((m=u[p]).textures.length<this.texPerChild){h=m,c=m.textures.length,m.textures.push(s);break}}h||(u.push(h=new e.RectTileLayer(this.zIndex,s)),c=0)}}return h.addRect(c,s.frame.x,s.frame.y,r,n,s.frame.width,s.frame.height,a,o),!0},r.prototype.renderCanvas=function(t){if(!t.plugins.tilemap.dontUseTransform){var e=this.worldTransform;t.context.setTransform(e.a,e.b,e.c,e.d,e.tx*t.resolution,e.ty*t.resolution)}for(var i=this.children,r=0;r<i.length;r++)i[r].renderCanvas(t)},r.prototype.renderWebGL=function(e){var i=e.plugins.tilemap.getShader(this.useSquare);if(e.setObjectRenderer(e.plugins.tilemap),e.bindShader(i),this._globalMat=this._globalMat||new t.Matrix,e._activeRenderTarget.projectionMatrix.copy(this._globalMat).append(this.worldTransform),i.uniforms.projectionMatrix=this._globalMat.toArray(!0),i.uniforms.shadowColor=this.shadowColor,this.useSquare){var r=this._tempScale=this._tempScale||[0,0];r[0]=this._globalMat.a>=0?1:-1,r[1]=this._globalMat.d<0?1:-1,i.uniforms.pointScale=r,i.uniforms.projectionScale=Math.abs(this.worldTransform.a)*e.resolution}i.uniforms.animationFrame=e.plugins.tilemap.tileAnim;for(var n=this.children,a=0;a<n.length;a++)n[a].renderWebGL(e,this.useSquare)},r.prototype.isModified=function(t){var e=this.children;if(this.modificationMarker!=e.length)return!0;for(var i=0;i<e.length;i++){var r=e[i];if(r.modificationMarker!=r.pointsBuf.length||t&&r.hasAnim)return!0}return!1},r.prototype.clearModify=function(){var t=this.children;this.modificationMarker=t.length;for(var e=0;e<t.length;e++){var i=t[e];i.modificationMarker=i.pointsBuf.length}},r}(t.Container);e.CompositeRectTileLayer=i}(t.tilemap||(t.tilemap={}))}(PIXI||(PIXI={})),function(t){t.tilemap||(t.tilemap={}),function(e){function i(t){var i=e.call(this)||this;return i.z=i.zIndex=t,i}__extends(i,e),i.prototype.renderCanvas=function(e){var i=null;e.plugins.tilemap.dontUseTransform&&(i=this.transform.worldTransform,this.transform.worldTransform=t.Matrix.IDENTITY),e.plugins.graphics.render(this),e.plugins.tilemap.dontUseTransform&&(this.transform.worldTransform=i),e.context.globalAlpha=1},i.prototype.renderWebGL=function(t){this._webGL[t.CONTEXT_UID]||(this.dirty=!0),e.prototype.renderWebGL.call(this,t)},i.prototype.isModified=function(t){return!1},i.prototype.clearModify=function(){}}(t.Graphics)}(PIXI||(PIXI={})),function(t){!function(e){var i=function(t){function e(e,i){var r=t.call(this)||this;return r.z=0,r.zIndex=0,r.pointsBuf=[],r._tempSize=new Float32Array([0,0]),r._tempTexSize=1,r.modificationMarker=0,r.hasAnim=!1,r.vbId=0,r.vbBuffer=null,r.vbArray=null,r.vbInts=null,r.initialize(e,i),r}return __extends(e,t),e.prototype.initialize=function(t,e){e?e instanceof Array||!e.baseTexture||(e=[e]):e=[],this.textures=e,this.z=this.zIndex=t,this.visible=!1},e.prototype.clear=function(){this.pointsBuf.length=0,this.modificationMarker=0,this.hasAnim=!1},e.prototype.renderCanvas=function(t){if(0!==this.textures.length){var e=this.pointsBuf;t.context.fillStyle="#000000";for(var i=0,r=e.length;i<r;i+=9){var n=e[i],a=e[i+1],o=e[i+2],s=e[i+3],h=e[i+4],c=e[i+5];n+=e[i+6]*t.plugins.tilemap.tileAnim[0],a+=e[i+7]*t.plugins.tilemap.tileAnim[1];var u=e[i+8];u>=0?t.context.drawImage(this.textures[u].baseTexture.source,n,a,h,c,o,s,h,c):(t.context.globalAlpha=.5,t.context.fillRect(o,s,h,c),t.context.globalAlpha=1)}}},e.prototype.addRect=function(t,e,i,r,n,a,o,s,h){void 0===s&&(s=0),void 0===h&&(h=0);var c,u=this.pointsBuf;if(this.hasAnim=this.hasAnim||s>0||h>0,a==o)u.push(e),u.push(i),u.push(r),u.push(n),u.push(a),u.push(o),u.push(0|s),u.push(0|h),u.push(t);else if(a%o==0)for(c=0;c<a/o;c++)u.push(e+c*o),u.push(i),u.push(r+c*o),u.push(n),u.push(o),u.push(o),u.push(0|s),u.push(0|h),u.push(t);else if(o%a==0)for(c=0;c<o/a;c++)u.push(e),u.push(i+c*a),u.push(r),u.push(n+c*a),u.push(a),u.push(a),u.push(0|s),u.push(0|h),u.push(t);else u.push(e),u.push(i),u.push(r),u.push(n),u.push(a),u.push(o),u.push(0|s),u.push(0|h),u.push(t)},e.prototype.renderWebGL=function(t,e){void 0===e&&(e=!1);var i=this.pointsBuf;if(0!==i.length){var r=i.length/9,n=t.plugins.tilemap,a=t.gl;e||n.checkIndexBuffer(r);var o=n.getShader(e),s=this.textures;if(0!==s.length){var h=s.length;this._tempTexSize<o.maxTextures&&(this._tempTexSize=o.maxTextures,this._tempSize=new Float32Array(2*o.maxTextures));for(var c=0;c<h;c++)if(!s[c]||!s[c].valid)return;n.bindTextures(t,o,s);var u=n.getVb(this.vbId);u||(u=n.createVb(e),this.vbId=u.id,this.vbBuffer=null,this.modificationMarker=0),t.bindVao(u.vao);var p=u.vb;p.bind();var l=r*o.vertPerQuad;if(0!==l){if(this.modificationMarker!=l){this.modificationMarker=l;var d=o.stride*l;if(!this.vbBuffer||this.vbBuffer.byteLength<d){for(var m=o.stride;m<d;)m*=2;this.vbBuffer=new ArrayBuffer(m),this.vbArray=new Float32Array(this.vbBuffer),this.vbInts=new Uint32Array(this.vbBuffer),p.upload(this.vbBuffer,0,!0)}var f,_,y,g=this.vbArray,v=0;if(e)for(c=0;c<i.length;c+=9)f=i[c+8]>>2,_=1024*(1&i[c+8]),y=1024*(i[c+8]>>1&1),g[v++]=i[c+2],g[v++]=i[c+3],g[v++]=i[c+0]+_,g[v++]=i[c+1]+y,g[v++]=i[c+4],g[v++]=i[c+6],g[v++]=i[c+7],g[v++]=f;else for(c=0;c<i.length;c+=9){f=i[c+8]>>2;var w=i[c+2],S=i[c+3],b=i[c+4],x=i[c+5],T=i[c]+(_=1024*(1&i[c+8])),M=i[c+1]+(y=1024*(i[c+8]>>1&1)),E=i[c+6],I=i[c+7];g[v++]=w,g[v++]=S,g[v++]=T,g[v++]=M,g[v++]=T+.5,g[v++]=M+.5,g[v++]=T+b-.5,g[v++]=M+x-.5,g[v++]=E,g[v++]=I,g[v++]=f,g[v++]=w+b,g[v++]=S,g[v++]=T+b,g[v++]=M,g[v++]=T+.5,g[v++]=M+.5,g[v++]=T+b-.5,g[v++]=M+x-.5,g[v++]=E,g[v++]=I,g[v++]=f,g[v++]=w+b,g[v++]=S+x,g[v++]=T+b,g[v++]=M+x,g[v++]=T+.5,g[v++]=M+.5,g[v++]=T+b-.5,g[v++]=M+x-.5,g[v++]=E,g[v++]=I,g[v++]=f,g[v++]=w,g[v++]=S+x,g[v++]=T,g[v++]=M+x,g[v++]=T+.5,g[v++]=M+.5,g[v++]=T+b-.5,g[v++]=M+x-.5,g[v++]=E,g[v++]=I,g[v++]=f}p.upload(g,0,!0)}e?a.drawArrays(a.POINTS,0,l):a.drawElements(a.TRIANGLES,6*r,a.UNSIGNED_SHORT,0)}}}},e}(t.Container);e.RectTileLayer=i}(t.tilemap||(t.tilemap={}))}(PIXI||(PIXI={})),function(t){!function(e){var i="varying vec2 vTextureCoord;\nvarying vec4 vFrame;\nvarying float vTextureId;\nuniform vec4 shadowColor;\nuniform sampler2D uSamplers[%count%];\nuniform vec2 uSamplerSize[%count%];\n\nvoid main(void){\n   vec2 textureCoord = clamp(vTextureCoord, vFrame.xy, vFrame.zw);\n   float textureId = floor(vTextureId + 0.5);\n\n   vec4 color;\n   %forloop%\n   gl_FragColor = color;\n}",r="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aFrame;\nattribute vec2 aAnim;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform vec2 animationFrame;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vFrame;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vec2 anim = aAnim * animationFrame;\n   vTextureCoord = aTextureCoord + anim;\n   vFrame = aFrame + vec4(anim, anim);\n   vTextureId = aTextureId;\n}\n",n=function(t){function i(i,r,n,a){var o=t.call(this,i,n,a)||this;return o.maxTextures=0,o.maxTextures=r,e.shaderGenerator.fillSamplers(o,o.maxTextures),o}return __extends(i,t),i}(t.Shader);e.TilemapShader=n;var a=function(t){function n(n,a){var o=t.call(this,n,a,r,e.shaderGenerator.generateFragmentSrc(a,i))||this;return o.vertSize=11,o.vertPerQuad=4,o.stride=4*o.vertSize,e.shaderGenerator.fillSamplers(o,o.maxTextures),o}return __extends(n,t),n.prototype.createVao=function(t,e){var i=t.gl;return t.createVao().addIndex(this.indexBuffer).addAttribute(e,this.attributes.aVertexPosition,i.FLOAT,!1,this.stride,0).addAttribute(e,this.attributes.aTextureCoord,i.FLOAT,!1,this.stride,8).addAttribute(e,this.attributes.aFrame,i.FLOAT,!1,this.stride,16).addAttribute(e,this.attributes.aAnim,i.FLOAT,!1,this.stride,32).addAttribute(e,this.attributes.aTextureId,i.FLOAT,!1,this.stride,40)},n}(n);e.RectTileShader=a}(t.tilemap||(t.tilemap={}))}(PIXI||(PIXI={})),function(t){!function(t){var e;(e=t.shaderGenerator||(t.shaderGenerator={})).fillSamplers=function(t,e){for(var i=[],r=0;r<e;r++)i[r]=r;t.bind(),t.uniforms.uSamplers=i;var n=[];for(r=0;r<e;r++)n.push(1/2048),n.push(1/2048);t.uniforms.uSamplerSize=n},e.generateFragmentSrc=function(t,e){return e.replace(/%count%/gi,t+"").replace(/%forloop%/gi,this.generateSampleSrc(t))},e.generateSampleSrc=function(t){var e="";e+="\n",e+="\n",e+="if(vTextureId <= -1.0) {",e+="\n\tcolor = shadowColor;",e+="\n}";for(var i=0;i<t;i++)e+="\nelse ",i<t-1&&(e+="if(textureId == "+i+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], textureCoord * uSamplerSize["+i+"]);",e+="\n}";return(e+="\n")+"\n"}}(t.tilemap||(t.tilemap={}))}(PIXI||(PIXI={})),function(t){!function(t){var e="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aAnim;\nattribute float aTextureId;\nattribute float aSize;\n\nuniform mat3 projectionMatrix;\nuniform vec2 samplerSize;\nuniform vec2 animationFrame;\nuniform float projectionScale;\n\nvarying vec2 vTextureCoord;\nvarying float vSize;\nvarying float vTextureId;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition + aSize * 0.5, 1.0)).xy, 0.0, 1.0);\n   gl_PointSize = aSize * projectionScale;\n   vTextureCoord = aTextureCoord + aAnim * animationFrame;\n   vTextureId = aTextureId;\n   vSize = aSize;\n}\n",i="\nvarying vec2 vTextureCoord;\nvarying float vSize;\nvarying float vTextureId;\n\nuniform vec4 shadowColor;\nuniform sampler2D uSamplers[%count%];\nuniform vec2 uSamplerSize[%count%];\nuniform vec2 pointScale;\n\nvoid main(void){\n   float margin = 0.5 / vSize;\n   vec2 pointCoord = (gl_PointCoord - 0.5) * pointScale + 0.5;\n   vec2 clamped = vec2(clamp(pointCoord.x, margin, 1.0 - margin), clamp(pointCoord.y, margin, 1.0 - margin));\n   vec2 textureCoord = pointCoord * vSize + vTextureCoord;\n   float textureId = vTextureId;\n   vec4 color;\n   %forloop%\n   gl_FragColor = color;\n}\n\n",r=function(r){function n(n,a){var o=r.call(this,n,a,e,t.shaderGenerator.generateFragmentSrc(a,i))||this;return o.vertSize=8,o.vertPerQuad=1,o.stride=4*o.vertSize,o.maxTextures=a,t.shaderGenerator.fillSamplers(o,o.maxTextures),o}return __extends(n,r),n.prototype.createVao=function(t,e){var i=t.gl;return t.createVao().addIndex(this.indexBuffer).addAttribute(e,this.attributes.aVertexPosition,i.FLOAT,!1,this.stride,0).addAttribute(e,this.attributes.aTextureCoord,i.FLOAT,!1,this.stride,8).addAttribute(e,this.attributes.aSize,i.FLOAT,!1,this.stride,16).addAttribute(e,this.attributes.aAnim,i.FLOAT,!1,this.stride,20).addAttribute(e,this.attributes.aTextureId,i.FLOAT,!1,this.stride,28)},n}(t.TilemapShader);t.SquareTileShader=r}(t.tilemap||(t.tilemap={}))}(PIXI||(PIXI={})),function(t){!function(e){var i=t.glCore;function r(t,e,i,r,n){var a=t.gl,o=e.texture.baseTexture;i&&r>0&&n>0&&a.texSubImage2D(a.TEXTURE_2D,0,e.position.x,e.position.y,r,n,t.format,t.type,i),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a.texSubImage2D(a.TEXTURE_2D,0,e.position.x,e.position.y,t.format,t.type,o.source)}var n=function(n){function a(t){var e=n.call(this,t)||this;return e.vbs={},e.indices=new Uint16Array(0),e.lastTimeCheck=0,e.tileAnim=[0,0],e.maxTextures=4,e.texLoc=[],e}return __extends(a,n),a.prototype.onContextChange=function(){var t=this.renderer.gl,i=this.maxTextures;this.rectShader=new e.RectTileShader(t,i),this.squareShader=new e.SquareTileShader(t,i),this.checkIndexBuffer(2e3),this.rectShader.indexBuffer=this.indexBuffer,this.squareShader.indexBuffer=this.indexBuffer,this.vbs={},this.glTextures=[],this.boundSprites=[],this.initBounds()},a.prototype.initBounds=function(){var e=document.createElement("canvas");e.width=2048,e.height=2048;for(var i=0;i<this.maxTextures;i++){var r=t.RenderTexture.create(2048,2048);r.baseTexture.premultipliedAlpha=!0,r.baseTexture.scaleMode=a.SCALE_MODE,r.baseTexture.wrapMode=t.WRAP_MODES.CLAMP,this.renderer.textureManager.updateTexture(r),this.glTextures.push(r);for(var n=[],o=0;o<4;o++){var s=new t.Sprite;s.position.x=1024*(1&o),s.position.y=1024*(o>>1),n.push(s)}this.boundSprites.push(n)}},a.prototype.bindTextures=function(t,e,i){var n=this.boundSprites,o=this.glTextures,s=i.length,h=this.maxTextures;if(!(s>4*h)){var c,u=a.DO_CLEAR;for(u&&!this._clearBuffer&&(this._clearBuffer=new Uint8Array(4194304)),c=0;c<s;c++){var p=i[c];if(p&&i[c].valid){var l=n[c>>2][3&c];if(!l.texture||l.texture.baseTexture!==p.baseTexture){l.texture=p;var d=o[c>>2];t.bindTexture(d,0,!0),u?r(d.baseTexture._glTextures[t.CONTEXT_UID],l,this._clearBuffer,1024,1024):r(d.baseTexture._glTextures[t.CONTEXT_UID],l)}}}for(this.texLoc.length=0,c=0;c<h;c++)this.texLoc.push(t.bindTexture(o[c],c,!0));e.uniforms.uSamplers=this.texLoc}},a.prototype.checkLeaks=function(){var t=Date.now(),e=t-1e4;if(this.lastTimeCheck<e||this.lastTimeCheck>t){this.lastTimeCheck=t;var i=this.vbs;for(var r in i)i[r].lastTimeAccess<e&&this.removeVb(r)}},a.prototype.start=function(){this.renderer.state.setBlendMode(t.BLEND_MODES.NORMAL)},a.prototype.getVb=function(t){this.checkLeaks();var e=this.vbs[t];return e?(e.lastAccessTime=Date.now(),e):null},a.prototype.createVb=function(e){var i=++a.vbAutoincrement,r=this.getShader(e),n=this.renderer.gl,o=t.glCore.GLBuffer.createVertexBuffer(n,null,n.STREAM_DRAW),s={id:i,vb:o,vao:r.createVao(this.renderer,o),lastTimeAccess:Date.now(),useSquare:e,shader:r};return this.vbs[i]=s,s},a.prototype.removeVb=function(t){this.vbs[t]&&(this.vbs[t].vb.destroy(),this.vbs[t].vao.destroy(),delete this.vbs[t])},a.prototype.checkIndexBuffer=function(t){var e=6*t,r=this.indices;if(!(e<=r.length)){for(var n=r.length||e;n<e;)n<<=1;r=new Uint16Array(n),this.indices=r;for(var a=0,o=0;a+5<r.length;a+=6,o+=4)r[a+0]=o+0,r[a+1]=o+1,r[a+2]=o+2,r[a+3]=o+0,r[a+4]=o+2,r[a+5]=o+3;if(this.indexBuffer)this.indexBuffer.upload(r);else{var s=this.renderer.gl;this.indexBuffer=i.GLBuffer.createIndexBuffer(s,this.indices,s.STATIC_DRAW)}}},a.prototype.getShader=function(t){return t?this.squareShader:this.rectShader},a.prototype.destroy=function(){n.prototype.destroy.call(this),this.rectShader.destroy(),this.squareShader.destroy(),this.rectShader=null,this.squareShader=null},a}(t.ObjectRenderer);n.vbAutoincrement=0,n.SCALE_MODE=t.SCALE_MODES.LINEAR,n.DO_CLEAR=!1,e.TileRenderer=n,t.WebGLRenderer.registerPlugin("tilemap",n)}(t.tilemap||(t.tilemap={}))}(PIXI||(PIXI={})),function(t){var e,i;e=t.tilemap||(t.tilemap={}),i=function(e){function i(t,i){var r=e.call(this)||this;return r._lastAnimationFrame=-1,r.tilemap=t,r.z=i,r}return __extends(i,e),i.prototype.clear=function(){for(var t=this.children,e=0;e<t.length;e++)t[e].clear();this._previousLayers=0},i.prototype.cacheIfDirty=function(){var e=this.tilemap,i=this.children,r=this._previousLayers!=i.length;this._previousLayers=i.length;var n,a=this.canvasBuffer,o=this._tempRender;if(a||(a=this.canvasBuffer=document.createElement("canvas"),(o=this._tempRender=new t.CanvasRenderer(100,100,{view:a})).context=o.rootContext,o.plugins.tilemap.dontUseTransform=!0),a.width==e._layerWidth&&a.height==e._layerHeight||(a.width=e._layerWidth,a.height=e._layerHeight,r=!0),!r)for(n=0;n<i.length;n++)if(i[n].isModified(this._lastAnimationFrame!=e.animationFrame)){r=!0;break}if(this._lastAnimationFrame=e.animationFrame,r)for(e._hackRenderer&&e._hackRenderer(o),o.context.clearRect(0,0,a.width,a.height),n=0;n<i.length;n++)i[n].clearModify(),i[n].renderCanvas(o);for(this.layerTransform=this.worldTransform,n=0;n<i.length;n++){this.layerTransform=i[n].worldTransform;break}},i.prototype.renderCanvas=function(t){this.cacheIfDirty();var e=this.layerTransform;t.context.setTransform(e.a,e.b,e.c,e.d,e.tx*t.resolution,e.ty*t.resolution),t.context.drawImage(this.canvasBuffer,0,0)},i}(t.Container),e.ZLayer=i}(PIXI||(PIXI={}));var __extends=this&&this.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},PIXI,PIXI,PIXI,PIXI,PIXI,PIXI,PIXI,PIXI;!function(t){!function(e){var i=[{vertUniforms:"",vertCode:"vTextureCoord = aTextureCoord;",fragUniforms:"uniform vec4 uTextureClamp;",fragCode:"vec2 textureCoord = clamp(vTextureCoord, uTextureClamp.xy, uTextureClamp.zw);"},{vertUniforms:"uniform mat3 uTransform;",vertCode:"vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;",fragUniforms:"",fragCode:"vec2 textureCoord = vTextureCoord;"},{vertUniforms:"uniform mat3 uTransform;",vertCode:"vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;",fragUniforms:"uniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;",fragCode:"vec2 textureCoord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\ntextureCoord = (uMapCoord * vec3(textureCoord, 1.0)).xy;\ntextureCoord = clamp(textureCoord, uClampFrame.xy, uClampFrame.zw);"}],r=function(e){function r(r,n,a,o){var s=i[o];e.call(this,r,n.replace(/%SPRITE_UNIFORMS%/gi,s.vertUniforms).replace(/%SPRITE_CODE%/gi,s.vertCode),a.replace(/%SPRITE_UNIFORMS%/gi,s.fragUniforms).replace(/%SPRITE_CODE%/gi,s.fragCode)),this.bind(),this.tilingMode=o,this.tempQuad=new t.Quad(r),this.tempQuad.initVao(this),this.uniforms.uColor=new Float32Array([1,1,1,1]),this.uniforms.uSampler=[0,1]}return __extends(r,e),r.blendVert="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 mapMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vMapCoord;\n%SPRITE_UNIFORMS%\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    %SPRITE_CODE%\n    vMapCoord = (mapMatrix * vec3(aVertexPosition, 1.0)).xy;\n}\n",r}(t.Shader);e.PictureShader=r}(t.extras||(t.extras={}))}(PIXI||(PIXI={})),function(t){!function(t){var e="\nvarying vec2 vTextureCoord;\nvarying vec2 vMapCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler[2];\nuniform vec4 uColor;\n%SPRITE_UNIFORMS%\n\nvoid main(void)\n{\n    %SPRITE_CODE%\n    vec4 source = texture2D(uSampler[0], textureCoord) * uColor;\n    vec4 target = texture2D(uSampler[1], vMapCoord);\n\n    //reverse hardlight\n    if (source.a == 0.0) {\n        gl_FragColor = vec4(0, 0, 0, 0);\n        return;\n    }\n    //yeah, premultiplied\n    vec3 Cb = source.rgb/source.a, Cs;\n    if (target.a > 0.0) {\n        Cs = target.rgb / target.a;\n    }\n    vec3 multiply = Cb * Cs * 2.0;\n    vec3 Cs2 = Cs * 2.0 - 1.0;\n    vec3 screen = Cb + Cs2 - Cb * Cs2;\n    vec3 B;\n    if (Cb.r <= 0.5) {\n        B.r = multiply.r;\n    } else {\n        B.r = screen.r;\n    }\n    if (Cb.g <= 0.5) {\n        B.g = multiply.g;\n    } else {\n        B.g = screen.g;\n    }\n    if (Cb.b <= 0.5) {\n        B.b = multiply.b;\n    } else {\n        B.b = screen.b;\n    }\n    vec4 res;\n    res.xyz = (1.0 - source.a) * Cs + source.a * B;\n    res.a = source.a + target.a * (1.0-source.a);\n    gl_FragColor = vec4(res.xyz * res.a, res.a);\n}\n",i=function(i){function r(r,n){i.call(this,r,t.PictureShader.blendVert,e,n)}return __extends(r,i),r}(t.PictureShader);t.HardLightShader=i}(t.extras||(t.extras={}))}(PIXI||(PIXI={})),function(t){var e;(e=t.extras||(t.extras={})).mapFilterBlendModesToPixi=function(i,r){return void 0===r&&(r=[]),r[t.BLEND_MODES.OVERLAY]=[new e.OverlayShader(i,0),new e.OverlayShader(i,1),new e.OverlayShader(i,2)],r[t.BLEND_MODES.HARD_LIGHT]=[new e.HardLightShader(i,0),new e.HardLightShader(i,1),new e.HardLightShader(i,2)],r}}(PIXI||(PIXI={})),function(t){!function(t){var e="\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler[2];\nuniform vec4 uColor;\n%SPRITE_UNIFORMS%\n\nvoid main(void)\n{\n    %SPRITE_CODE%\n\n    vec4 sample = texture2D(uSampler[0], textureCoord);\n    gl_FragColor = sample * uColor;\n}\n",i="\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n%SPRITE_UNIFORMS%\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    %SPRITE_CODE%\n}\n",r=function(t){function r(r,n){t.call(this,r,i,e,n)}return __extends(r,t),r}(t.PictureShader);t.NormalShader=r}(t.extras||(t.extras={}))}(PIXI||(PIXI={})),function(t){!function(t){var e="\nvarying vec2 vTextureCoord;\nvarying vec2 vMapCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler[2];\nuniform vec4 uColor;\n%SPRITE_UNIFORMS%\n\nvoid main(void)\n{\n    %SPRITE_CODE%\n    vec4 source = texture2D(uSampler[0], textureCoord) * uColor;\n    vec4 target = texture2D(uSampler[1], vMapCoord);\n\n    //reverse hardlight\n    if (source.a == 0.0) {\n        gl_FragColor = vec4(0, 0, 0, 0);\n        return;\n    }\n    //yeah, premultiplied\n    vec3 Cb = source.rgb/source.a, Cs;\n    if (target.a > 0.0) {\n        Cs = target.rgb / target.a;\n    }\n    vec3 multiply = Cb * Cs * 2.0;\n    vec3 Cb2 = Cb * 2.0 - 1.0;\n    vec3 screen = Cb2 + Cs - Cb2 * Cs;\n    vec3 B;\n    if (Cs.r <= 0.5) {\n        B.r = multiply.r;\n    } else {\n        B.r = screen.r;\n    }\n    if (Cs.g <= 0.5) {\n        B.g = multiply.g;\n    } else {\n        B.g = screen.g;\n    }\n    if (Cs.b <= 0.5) {\n        B.b = multiply.b;\n    } else {\n        B.b = screen.b;\n    }\n    vec4 res;\n    res.xyz = (1.0 - source.a) * Cs + source.a * B;\n    res.a = source.a + target.a * (1.0-source.a);\n    gl_FragColor = vec4(res.xyz * res.a, res.a);\n}\n",i=function(i){function r(r,n){i.call(this,r,t.PictureShader.blendVert,e,n)}return __extends(r,i),r}(t.PictureShader);t.OverlayShader=i}(t.extras||(t.extras={}))}(PIXI||(PIXI={})),function(t){!function(e){function i(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,1+((t|=t>>>8)|t>>>16)}var r=function(r){function n(t){r.call(this,t)}return __extends(n,r),n.prototype.onContextChange=function(){var i=this.renderer.gl;this.drawModes=e.mapFilterBlendModesToPixi(i),this.normalShader=[new e.NormalShader(i,0),new e.NormalShader(i,1),new e.NormalShader(i,2)],this._tempClamp=new Float32Array(4),this._tempColor=new Float32Array(4),this._tempRect=new t.Rectangle,this._tempRect2=new t.Rectangle,this._tempRect3=new t.Rectangle,this._tempMatrix=new t.Matrix,this._tempMatrix2=new t.Matrix,this._bigBuf=new Uint8Array(1<<20),this._renderTexture=new t.BaseRenderTexture(1024,1024)},n.prototype.start=function(){},n.prototype.flush=function(){},n.prototype._getRenderTexture=function(t,e){return(this._renderTexture.width<t||this._renderTexture.height<e)&&(e=i(t),e=i(e),this._renderTexture.resize(t,e)),this._renderTexture},n.prototype._getBuf=function(t){var e=this._bigBuf;return e.length<t&&(t=i(t),e=new Uint8Array(t),this._bigBuf=e),e},n.prototype.render=function(t){if(t.texture.valid){var e=0;t.tileTransform&&(e=this._isSimpleSprite(t)?1:2);var i=this.drawModes[t.blendMode];i?this._renderBlend(t,i[e]):this._renderNormal(t,this.normalShader[e])}},n.prototype._renderNormal=function(t,e){var i=this.renderer;i.bindShader(e),i.state.setBlendMode(t.blendMode),this._renderInner(t,e)},n.prototype._renderBlend=function(e,i){var r=this.renderer,n=e.getBounds(),a=r._activeRenderTarget,o=a.projectionMatrix,s=o.a<0,h=o.d<0,c=a.resolution,u=this._tempRect,p=a.sourceFrame||a.destinationFrame;u.x=0,u.y=0,u.width=p.width,u.height=p.height;var l=this._tempRect2,d=p.width*c,m=p.height*c;l.x=(n.x+o.tx/o.a)*c+d/2,l.y=(n.y+o.ty/o.d)*c+m/2,l.width=n.width*c,l.height=n.height*c,s&&(l.y=d-l.width-l.x),h&&(l.y=m-l.height-l.y);var f=Math.floor(Math.max(u.x,l.x)),_=Math.ceil(Math.min(u.x+u.width,l.x+l.width)),y=Math.floor(Math.max(u.y,l.y)),g=_-f,v=Math.ceil(Math.min(u.y+u.height,l.y+l.height))-y;if(!(g<=0||v<=0)){var w=this._getRenderTexture(g,v);r.bindTexture(w,1,!0);var S=r.gl;if(r.renderingToScreen&&a.root?(this._getBuf(g*v*4),S.readPixels(f,y,g,v,S.RGBA,S.UNSIGNED_BYTE,this._bigBuf),S.texSubImage2D(S.TEXTURE_2D,0,0,0,g,v,S.RGBA,S.UNSIGNED_BYTE,this._bigBuf)):S.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,f,y,g,v),r.bindShader(i),r.state.setBlendMode(t.BLEND_MODES.NORMAL),i.uniforms.mapMatrix){var b=this._tempMatrix;b.a=l.width/w.width/n.width,s?(b.a=-b.a,b.tx=(l.x-f)/w.width-(n.x+n.width)*b.a):b.tx=(l.x-f)/w.width-n.x*b.a,b.d=l.height/w.height/n.height,h?(b.d=-b.d,b.ty=(l.y-y)/w.height-(n.y+n.height)*b.d):b.ty=(l.y-y)/w.height-n.y*b.d,i.uniforms.mapMatrix=b.toArray(!0)}this._renderInner(e,i)}},n.prototype._renderInner=function(t,e){e.tilingMode>0?this._renderWithShader(t,1===e.tilingMode,e):this._renderSprite(t,e)},n.prototype._renderWithShader=function(e,i,r){var n=r.tempQuad,a=this.renderer;a.bindVao(n.vao);var o=n.vertices,s=e._width,h=e._height,c=e._anchor._x,u=e._anchor._y,p=s*(1-c),l=s*-c,d=h*(1-u),m=h*-u,f=e.transform.worldTransform,_=f.a,y=f.b,g=f.c,v=f.d,w=f.tx,S=f.ty;o[0]=_*l+g*m+w,o[1]=v*m+y*l+S,o[2]=_*p+g*m+w,o[3]=v*m+y*p+S,o[4]=_*p+g*d+w,o[5]=v*d+y*p+S,o[6]=_*l+g*d+w,o[7]=v*d+y*l+S,(o=n.uvs)[0]=o[6]=-e.anchor.x,o[1]=o[3]=-e.anchor.y,o[2]=o[4]=1-e.anchor.x,o[5]=o[7]=1-e.anchor.y,n.upload();var b=e._texture,x=e.tileTransform.localTransform,T=e.uvTransform,M=T.mapCoord,E=T.uClampFrame,I=T.uClampOffset,C=b.width,A=b.height,B=this._tempMatrix2;B.set(x.a*C/s,x.b*C/h,x.c*A/s,x.d*A/h,x.tx/s,x.ty/h),B.invert(),i?B.append(M):(r.uniforms.uMapCoord=M.toArray(!0),r.uniforms.uClampFrame=E,r.uniforms.uClampOffset=I),r.uniforms.uTransform=B.toArray(!0);var W=this._tempColor,P=e.worldAlpha;t.utils.hex2rgb(e.tint,W),W[0]*=P,W[1]*=P,W[2]*=P,W[3]=P,r.uniforms.uColor=W,a.bindTexture(b,0,!0),n.vao.draw(this.renderer.gl.TRIANGLES,6,0)},n.prototype._renderSprite=function(e,i){var r=this.renderer,n=i.tempQuad;r.bindVao(n.vao);for(var a=e.texture._uvs,o=e.vertexData,s=0;s<8;s++)n.vertices[s]=o[s];n.uvs[0]=a.x0,n.uvs[1]=a.y0,n.uvs[2]=a.x1,n.uvs[3]=a.y1,n.uvs[4]=a.x2,n.uvs[5]=a.y2,n.uvs[6]=a.x3,n.uvs[7]=a.y3,n.upload();var h=e.texture.frame,c=e.texture.baseTexture,u=this._tempClamp,p=.5/c.resolution;u[0]=(h.x+p)/c.width,u[1]=(h.y+p)/c.height,u[2]=(h.x+h.width-p)/c.width,u[3]=(h.y+h.height-p)/c.height,i.uniforms.uTextureClamp=u;var l=this._tempColor;t.utils.hex2rgb(e.tint,l);var d=e.worldAlpha;l[0]*=d,l[1]*=d,l[2]*=d,l[3]=d,i.uniforms.uColor=l,r.bindTexture(c,0,!0),n.vao.draw(this.renderer.gl.TRIANGLES,6,0)},n.prototype._isSimpleSprite=function(e){var i=e._texture,r=i.baseTexture,n=r.isPowerOfTwo&&i.frame.width===r.width&&i.frame.height===r.height;return n&&(r._glTextures[this.renderer.CONTEXT_UID]?n=r.wrapMode!==t.WRAP_MODES.CLAMP:r.wrapMode===t.WRAP_MODES.CLAMP&&(r.wrapMode=t.WRAP_MODES.REPEAT)),n},n}(t.ObjectRenderer);e.PictureRenderer=r,t.WebGLRenderer.registerPlugin("picture",r),t.CanvasRenderer.registerPlugin("picture",t.CanvasSpriteRenderer)}(t.extras||(t.extras={}))}(PIXI||(PIXI={})),function(t){!function(e){var i=function(t){function e(e){t.call(this,e),this.pluginName="picture"}return __extends(e,t),e}(t.Sprite);e.PictureSprite=i}(t.extras||(t.extras={}))}(PIXI||(PIXI={})),function(t){!function(t){var e=function(t){function e(e){t.call(this,e),this.pluginName="picture"}return __extends(e,t),e}(t.TilingSprite);t.PictureTilingSprite=e}(t.extras||(t.extras={}))}(PIXI||(PIXI={})),function(t,e){function i(t,i){for(var r in i)try{t.style[r]=i[r]}catch(e){}return t}function r(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function n(t,e){if("array"!==r(e))return-1;if(e.indexOf)return e.indexOf(t);for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}function a(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(r(e[1][t])){case"object":e[0][t]=a({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?a.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function o(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function s(t,e,i,r){t.addEventListener?t[r?"removeEventListener":"addEventListener"](e,i,!1):t.attachEvent&&t[r?"detachEvent":"attachEvent"]("on"+e,i)}function h(t,u){function d(t,e,i,r){return T[0|t][Math.round(Math.min((e-i)/(r-i)*k,k))]}function m(){G.legend.fps!==H&&(G.legend.fps=H,G.legend[_]=H?"FPS":"ms"),G.count[_]=999<(A=H?P.fps:P.duration)?"999+":A.toFixed(99<A?0:O.decimals)}function f(){for(M=c(),N<M-O.threshold&&(P.fps-=P.fps/Math.max(1,60*O.smoothing/O.interval),P.duration=1e3/P.fps),B=O.history;B--;)U[B]=0===B?P.fps:U[B-1],j[B]=0===B?P.duration:j[B-1];if(m(),O.heat){if(D.length)for(B=D.length;B--;)D[B].el.style[x[D[B].name].heatOn]=H?d(x[D[B].name].heatmap,P.fps,0,O.maxFps):d(x[D[B].name].heatmap,P.duration,O.threshold,0);if(G.graph&&x.column.heatOn)for(B=R.length;B--;)R[B].style[x.column.heatOn]=H?d(x.column.heatmap,U[B],0,O.maxFps):d(x.column.heatmap,j[B],O.threshold,0)}if(G.graph)for(W=0;W<O.history;W++)R[W].style.height=(H?U[W]?Math.round(C/O.maxFps*Math.min(U[W],O.maxFps)):0:j[W]?Math.round(C/O.threshold*Math.min(j[W],O.threshold)):0)+"px"}function v(){20>O.interval?(E=l(v),f()):(E=setTimeout(v,O.interval),I=l(f))}function w(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),P.toggle()}function S(){O.toggleOn&&s(G.container,O.toggleOn,w,1),t.removeChild(G.container)}function b(){if(G.container&&S(),!(T=(x=h.theme[O.theme]).compiledHeatmaps||[]).length&&x.heatmaps.length){for(W=0;W<x.heatmaps.length;W++)for(T[W]=[],B=0;B<=k;B++){var e,r=T[W],n=B;e=.33/k*B;var a=x.heatmaps[W].saturation,c=x.heatmaps[W].lightness,u=void 0,p=void 0,l=void 0,d=l=void 0,f=u=p=void 0;f=void 0,0==(l=.5>=c?c*(1+a):c+a-c*a)?e="#000":(p=(l-(d=2*c-l))/l,f=(e*=6)-(u=Math.floor(e)),f*=l*p,0===u||6===u?(u=l,p=d+f,l=d):1===u?(u=l-f,p=l,l=d):2===u?(u=d,p=l,l=d+f):3===u?(u=d,p=l-f):4===u?(u=d+f,p=d):(u=l,p=d,l-=f),e="#"+o(u)+o(p)+o(l)),r[n]=e}x.compiledHeatmaps=T}for(var _ in G.container=i(document.createElement("div"),x.container),G.count=G.container.appendChild(i(document.createElement("div"),x.count)),G.legend=G.container.appendChild(i(document.createElement("div"),x.legend)),G.graph=O.graph?G.container.appendChild(i(document.createElement("div"),x.graph)):0,D.length=0,G)G[_]&&x[_].heatOn&&D.push({name:_,el:G[_]});if(R.length=0,G.graph)for(G.graph.style.width=O.history*x.column.width+(O.history-1)*x.column.spacing+"px",B=0;B<O.history;B++)R[B]=G.graph.appendChild(i(document.createElement("div"),x.column)),R[B].style.position="absolute",R[B].style.bottom=0,R[B].style.right=B*x.column.width+B*x.column.spacing+"px",R[B].style.width=x.column.width+"px",R[B].style.height="0px";i(G.container,O),m(),t.appendChild(G.container),G.graph&&(C=G.graph.clientHeight),O.toggleOn&&("click"===O.toggleOn&&(G.container.style.cursor="pointer"),s(G.container,O.toggleOn,w))}"object"===r(t)&&t.nodeType===e&&(u=t,t=document.body),t||(t=document.body);var x,T,M,E,I,C,A,B,W,P=this,O=a({},h.defaults,u||{}),G={},R=[],k=100,D=[],L=O.threshold,F=0,N=c()-L,U=[],j=[],H="fps"===O.show;P.options=O,P.fps=0,P.duration=0,P.isPaused=0,P.tickStart=function(){F=c()},P.tick=function(){M=c(),P.fps=1e3/(L+=(M-N-L)/O.smoothing),P.duration=F<N?L:M-F,N=M},P.pause=function(){return E&&(P.isPaused=1,clearTimeout(E),p(E),p(I),E=I=0),P},P.resume=function(){return E||(P.isPaused=0,v()),P},P.set=function(t,e){return O[t]=e,H="fps"===O.show,-1!==n(t,y)&&b(),-1!==n(t,g)&&i(G.container,O),P},P.showDuration=function(){return P.set("show","ms"),P},P.showFps=function(){return P.set("show","fps"),P},P.toggle=function(){return P.set("show",H?"ms":"fps"),P},P.hide=function(){return P.pause(),G.container.style.display="none",P},P.show=function(){return P.resume(),G.container.style.display="block",P},P.destroy=function(){P.pause(),S(),P.tick=P.tickStart=function(){}},b(),v()}var c;c=(u=t.performance)&&(u.now||u.webkitNow)?u[u.now?"now":"webkitNow"].bind(u):function(){return+new Date};for(var u,p=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,l=t.requestAnimationFrame,d=0,m=0,f=(u=["moz","webkit","o"]).length;m<f&&!p;++m)l=(p=t[u[m]+"CancelAnimationFrame"]||t[u[m]+"CancelRequestAnimationFrame"])&&t[u[m]+"RequestAnimationFrame"];p||(l=function(e){var i=c(),r=Math.max(0,16-(i-d));return d=i+r,t.setTimeout(function(){e(i+r)},r)},p=function(t){clearTimeout(t)});var _="string"===r(document.createElement("div").textContent)?"textContent":"innerText";h.extend=a,window.FPSMeter=h,h.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var y=["toggleOn","theme","heat","graph","history"],g="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var i=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},i,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},i,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},i,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},i,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter);var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(t){if(null==t)return"";var e,i,r,n,a,o,s,h="",c=0;for(t=LZString.compress(t);c<2*t.length;)c%2==0?(e=t.charCodeAt(c/2)>>8,i=255&t.charCodeAt(c/2),r=c/2+1<t.length?t.charCodeAt(c/2+1)>>8:NaN):(e=255&t.charCodeAt((c-1)/2),(c+1)/2<t.length?(i=t.charCodeAt((c+1)/2)>>8,r=255&t.charCodeAt((c+1)/2)):i=r=NaN),c+=3,n=e>>2,a=(3&e)<<4|i>>4,o=(15&i)<<2|r>>6,s=63&r,isNaN(i)?o=s=64:isNaN(r)&&(s=64),h=h+LZString._keyStr.charAt(n)+LZString._keyStr.charAt(a)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(s);return h},decompressFromBase64:function(t){if(null==t)return"";var e,i,r,n,a,o,s,h="",c=0,u=0,p=LZString._f;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<t.length;)i=LZString._keyStr.indexOf(t.charAt(u++))<<2|(a=LZString._keyStr.indexOf(t.charAt(u++)))>>4,r=(15&a)<<4|(o=LZString._keyStr.indexOf(t.charAt(u++)))>>2,n=(3&o)<<6|(s=LZString._keyStr.indexOf(t.charAt(u++))),c%2==0?(e=i<<8,64!=o&&(h+=p(e|r)),64!=s&&(e=n<<8)):(h+=p(e|i),64!=o&&(e=r<<8),64!=s&&(h+=p(e|n))),c+=3;return LZString.decompress(h)},compressToUTF16:function(t){if(null==t)return"";var e,i,r,n="",a=0,o=LZString._f;for(t=LZString.compress(t),e=0;e<t.length;e++)switch(i=t.charCodeAt(e),a++){case 0:n+=o(32+(i>>1)),r=(1&i)<<14;break;case 1:n+=o(r+(i>>2)+32),r=(3&i)<<13;break;case 2:n+=o(r+(i>>3)+32),r=(7&i)<<12;break;case 3:n+=o(r+(i>>4)+32),r=(15&i)<<11;break;case 4:n+=o(r+(i>>5)+32),r=(31&i)<<10;break;case 5:n+=o(r+(i>>6)+32),r=(63&i)<<9;break;case 6:n+=o(r+(i>>7)+32),r=(127&i)<<8;break;case 7:n+=o(r+(i>>8)+32),r=(255&i)<<7;break;case 8:n+=o(r+(i>>9)+32),r=(511&i)<<6;break;case 9:n+=o(r+(i>>10)+32),r=(1023&i)<<5;break;case 10:n+=o(r+(i>>11)+32),r=(2047&i)<<4;break;case 11:n+=o(r+(i>>12)+32),r=(4095&i)<<3;break;case 12:n+=o(r+(i>>13)+32),r=(8191&i)<<2;break;case 13:n+=o(r+(i>>14)+32),r=(16383&i)<<1;break;case 14:n+=o(r+(i>>15)+32,32+(32767&i)),a=0}return n+o(r+32)},decompressFromUTF16:function(t){if(null==t)return"";for(var e,i,r="",n=0,a=0,o=LZString._f;a<t.length;){switch(i=t.charCodeAt(a)-32,n++){case 0:e=i<<1;break;case 1:r+=o(e|i>>14),e=(16383&i)<<2;break;case 2:r+=o(e|i>>13),e=(8191&i)<<3;break;case 3:r+=o(e|i>>12),e=(4095&i)<<4;break;case 4:r+=o(e|i>>11),e=(2047&i)<<5;break;case 5:r+=o(e|i>>10),e=(1023&i)<<6;break;case 6:r+=o(e|i>>9),e=(511&i)<<7;break;case 7:r+=o(e|i>>8),e=(255&i)<<8;break;case 8:r+=o(e|i>>7),e=(127&i)<<9;break;case 9:r+=o(e|i>>6),e=(63&i)<<10;break;case 10:r+=o(e|i>>5),e=(31&i)<<11;break;case 11:r+=o(e|i>>4),e=(15&i)<<12;break;case 12:r+=o(e|i>>3),e=(7&i)<<13;break;case 13:r+=o(e|i>>2),e=(3&i)<<14;break;case 14:r+=o(e|i>>1),e=(1&i)<<15;break;case 15:r+=o(e|i),n=0}a++}return LZString.decompress(r)},compressToUint8Array:function(t){for(var e=LZString.compress(t),i=new Uint8Array(2*e.length),r=0,n=e.length;r<n;r++){var a=e.charCodeAt(r);i[2*r]=a>>>8,i[2*r+1]=a%256}return i},decompressFromUint8Array:function(t){if(null==t)return LZString.decompress(t);for(var e=new Array(t.length/2),i=0,r=e.length;i<r;i++)e[i]=256*t[2*i]+t[2*i+1];return LZString.decompress(String.fromCharCode.apply(null,e))},compressToEncodedURIComponent:function(t){return LZString.compressToBase64(t).replace(/=/g,"$").replace(/\//g,"-")},decompressFromEncodedURIComponent:function(t){return t&&(t=t.replace(/$/g,"=").replace(/-/g,"/")),LZString.decompressFromBase64(t)},compress:function(t){if(null==t)return"";var e,i,r,n={},a={},o="",s="",h="",c=2,u=3,p=2,l="",d=0,m=0,f=LZString._f;for(r=0;r<t.length;r+=1)if(o=t.charAt(r),Object.prototype.hasOwnProperty.call(n,o)||(n[o]=u++,a[o]=!0),s=h+o,Object.prototype.hasOwnProperty.call(n,s))h=s;else{if(Object.prototype.hasOwnProperty.call(a,h)){if(h.charCodeAt(0)<256){for(e=0;e<p;e++)d<<=1,15==m?(m=0,l+=f(d),d=0):m++;for(i=h.charCodeAt(0),e=0;e<8;e++)d=d<<1|1&i,15==m?(m=0,l+=f(d),d=0):m++,i>>=1}else{for(i=1,e=0;e<p;e++)d=d<<1|i,15==m?(m=0,l+=f(d),d=0):m++,i=0;for(i=h.charCodeAt(0),e=0;e<16;e++)d=d<<1|1&i,15==m?(m=0,l+=f(d),d=0):m++,i>>=1}0==--c&&(c=Math.pow(2,p),p++),delete a[h]}else for(i=n[h],e=0;e<p;e++)d=d<<1|1&i,15==m?(m=0,l+=f(d),d=0):m++,i>>=1;0==--c&&(c=Math.pow(2,p),p++),n[s]=u++,h=String(o)}if(""!==h){if(Object.prototype.hasOwnProperty.call(a,h)){if(h.charCodeAt(0)<256){for(e=0;e<p;e++)d<<=1,15==m?(m=0,l+=f(d),d=0):m++;for(i=h.charCodeAt(0),e=0;e<8;e++)d=d<<1|1&i,15==m?(m=0,l+=f(d),d=0):m++,i>>=1}else{for(i=1,e=0;e<p;e++)d=d<<1|i,15==m?(m=0,l+=f(d),d=0):m++,i=0;for(i=h.charCodeAt(0),e=0;e<16;e++)d=d<<1|1&i,15==m?(m=0,l+=f(d),d=0):m++,i>>=1}0==--c&&(c=Math.pow(2,p),p++),delete a[h]}else for(i=n[h],e=0;e<p;e++)d=d<<1|1&i,15==m?(m=0,l+=f(d),d=0):m++,i>>=1;0==--c&&(c=Math.pow(2,p),p++)}for(i=2,e=0;e<p;e++)d=d<<1|1&i,15==m?(m=0,l+=f(d),d=0):m++,i>>=1;for(;;){if(d<<=1,15==m){l+=f(d);break}m++}return l},decompress:function(t){if(null==t)return"";if(""==t)return null;var e,i,r,n,a,o,s,h=[],c=4,u=4,p=3,l="",d="",m=LZString._f,f={string:t,val:t.charCodeAt(0),position:32768,index:1};for(e=0;e<3;e+=1)h[e]=e;for(r=0,a=Math.pow(2,2),o=1;o!=a;)n=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),r|=(n>0?1:0)*o,o<<=1;switch(r){case 0:for(r=0,a=Math.pow(2,8),o=1;o!=a;)n=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),r|=(n>0?1:0)*o,o<<=1;s=m(r);break;case 1:for(r=0,a=Math.pow(2,16),o=1;o!=a;)n=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),r|=(n>0?1:0)*o,o<<=1;s=m(r);break;case 2:return""}for(h[3]=s,i=d=s;;){if(f.index>f.string.length)return"";for(r=0,a=Math.pow(2,p),o=1;o!=a;)n=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),r|=(n>0?1:0)*o,o<<=1;switch(s=r){case 0:for(r=0,a=Math.pow(2,8),o=1;o!=a;)n=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),r|=(n>0?1:0)*o,o<<=1;h[u++]=m(r),s=u-1,c--;break;case 1:for(r=0,a=Math.pow(2,16),o=1;o!=a;)n=f.val&f.position,f.position>>=1,0==f.position&&(f.position=32768,f.val=f.string.charCodeAt(f.index++)),r|=(n>0?1:0)*o,o<<=1;h[u++]=m(r),s=u-1,c--;break;case 2:return d}if(0==c&&(c=Math.pow(2,p),p++),h[s])l=h[s];else{if(s!==u)return null;l=i+i.charAt(0)}d+=l,h[u++]=i+l.charAt(0),i=l,0==--c&&(c=Math.pow(2,p),p++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=LZString);var makeVideoPlayableInline=function(){"use strict";function t(t,e,i,r){function n(e){Boolean(t[i])===Boolean(r)&&e.stopImmediatePropagation(),delete t[i]}return t.addEventListener(e,n,!1),n}function e(t,e,i,r){function n(t){i[e]=t}r&&n(t[e]),Object.defineProperty(t,e,{get:function(){return i[e]},set:n})}function i(t,e,i){i.addEventListener(e,function(){return t.dispatchEvent(new Event(e))})}function r(t,e){Promise.resolve().then(function(){t.dispatchEvent(new Event(e))})}function n(t,e,i){(u||0)+200<Date.now()&&(t[m]=!0,u=Date.now()),i||(t.currentTime=e),y[++g%3]=100*e|0}function a(t){return t.driver.currentTime>=t.video.duration}function o(){var t=this,e=t[d];return t.webkitDisplayingFullscreen?void t[f]():("data:"!==e.driver.src&&e.driver.src!==t.src&&(n(t,0,!0),e.driver.src=t.src),void(t.paused&&(e.paused=!1,t.buffered.length||t.load(),e.driver.play(),e.updater.start(),e.hasAudio||(r(t,"play"),e.video.readyState>=e.video.HAVE_ENOUGH_DATA&&r(t,"playing")))))}function s(t){var e=this,i=e[d];i.driver.pause(),i.updater.stop(),e.webkitDisplayingFullscreen&&e[_](),i.paused&&!t||(i.paused=!0,i.hasAudio||r(e,"pause"),e.ended&&(e[m]=!0,r(e,"ended")))}function h(i){var r=i[d];i[f]=i.play,i[_]=i.pause,i.play=o,i.pause=s,e(i,"paused",r.driver),e(i,"muted",r.driver,!0),e(i,"playbackRate",r.driver,!0),e(i,"ended",r.driver),e(i,"loop",r.driver,!0),t(i,"seeking"),t(i,"seeked"),t(i,"timeupdate",m,!1),t(i,"ended",m,!1)}function c(t,e,o){void 0===e&&(e=!0),void 0===o&&(o=!0),o&&!l||t[d]||(function(t,e){var o=t[d]={};o.paused=!0,o.hasAudio=e,o.video=t,o.updater=function(t,e,i,r){function n(i){a=e(n,r),t(i-(o||i)),o=i}var a,o;return{start:function(){a||n(0)},stop:function(){i(a),a=null,o=0}}}((function(t){var e=this;e.video.readyState>=e.video.HAVE_FUTURE_DATA?(e.hasAudio||(e.driver.currentTime=e.video.currentTime+t*e.video.playbackRate/1e3,e.video.loop&&a(e)&&(e.driver.currentTime=0)),n(e.video,e.driver.currentTime)):e.video.networkState!==e.video.NETWORK_IDLE||e.video.buffered.length||e.video.load(),e.video.ended&&(delete e.video[m],e.video.pause(!0))}).bind(o),requestAnimationFrame,cancelAnimationFrame),e?o.driver=function(t){var e=new Audio;return i(t,"play",e),i(t,"playing",e),i(t,"pause",e),e.crossOrigin=t.crossOrigin,e.src=t.src||t.currentSrc||"data:",e}(t):(t.addEventListener("canplay",function(){t.paused||r(t,"playing")}),o.driver={src:t.src||t.currentSrc||"data:",muted:!0,paused:!0,pause:function(){o.driver.paused=!0},play:function(){o.driver.paused=!1,a(o)&&n(t,0)},get ended(){return a(o)}}),t.addEventListener("emptied",function(){var e=!o.driver.src||"data:"===o.driver.src;o.driver.src&&o.driver.src!==t.src&&(n(t,0,!0),o.driver.src=t.src,e?o.driver.play():o.updater.stop())},!1),t.addEventListener("webkitbeginfullscreen",function(){t.paused?e&&!o.driver.buffered.length&&o.driver.load():(t.pause(),t[f]())}),e&&(t.addEventListener("webkitendfullscreen",function(){o.driver.currentTime=t.currentTime}),t.addEventListener("seeking",function(){y.indexOf(100*t.currentTime|0)<0&&(o.driver.currentTime=t.currentTime)}))}(t,e),h(t),t.classList.add("IIV"),!e&&t.autoplay&&t.play(),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments"))}var u,p="undefined"==typeof Symbol?function(t){return"@"+(t||"@")+Math.random()}:Symbol,l="object-fit"in document.head.style&&/iPhone|iPod/i.test(navigator.userAgent)&&!matchMedia("(-webkit-video-playable-inline)").matches,d=p(),m=p(),f=p("nativeplay"),_=p("nativepause"),y=[],g=0;return c.isWhitelisted=l,c}(),$plugins=[{name:"Community_Basic",status:!0,description:"\u57fa\u672c\u7684\u306a\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3092\u8a2d\u5b9a\u3059\u308b\u30d7\u30e9\u30b0\u30a4\u30f3\u3067\u3059\u3002",parameters:{cacheLimit:"20",screenWidth:"816",screenHeight:"624",changeWindowWidthTo:"",changeWindowHeightTo:"",renderingMode:"auto",alwaysDash:"off"}},{name:"MadeWithMv",status:!0,description:'\u30e1\u30a4\u30f3\u753b\u9762\u3078\u9032\u3080\u524d\u306b\u3001"Made with MV"\u306e\u30b9\u30d7\u30e9\u30c3\u30b7\u30e5\u753b\u9762\u3082\u3057\u304f\u306f\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3055\u308c\u305f\u30b9\u30d7\u30e9\u30c3\u30b7\u30e5\u753b\u9762\u3092\u8868\u793a\u3057\u307e\u3059\u3002',parameters:{"Show Made With MV":"true","Made with MV Image":"MadeWithMv","Show Custom Splash":"false","Custom Image":"","Fade Out Time":"120","Fade In Time":"120","Wait Time":"160"}}];function JsExtensions(){throw new Error("This is not a class")}function Utils(){throw new Error("This is a static class")}function CacheEntry(t,e,i){this.cache=t,this.key=e,this.item=i,this.cached=!1,this.touchTicks=0,this.touchSeconds=0,this.ttlTicks=0,this.ttlSeconds=0,this.freedByTTL=!1}function CacheMap(t){this.manager=t,this._inner={},this._lastRemovedEntries={},this.updateTicks=0,this.lastCheckTTL=0,this.delayCheckTTL=100,this.updateSeconds=Date.now()}function ImageCache(){this.initialize.apply(this,arguments)}function RequestQueue(){this.initialize.apply(this,arguments)}function Point(){this.initialize.apply(this,arguments)}function Rectangle(){this.initialize.apply(this,arguments)}function Bitmap(){this.initialize.apply(this,arguments)}function Graphics(){throw new Error("This is a static class")}function Input(){throw new Error("This is a static class")}function TouchInput(){throw new Error("This is a static class")}function Sprite(){this.initialize.apply(this,arguments)}function Tilemap(){this.initialize.apply(this,arguments)}function ShaderTilemap(){Tilemap.apply(this,arguments),this.roundPixels=!0}function TilingSprite(){this.initialize.apply(this,arguments)}function ScreenSprite(){this.initialize.apply(this,arguments)}function Window(){this.initialize.apply(this,arguments)}function WindowLayer(){this.initialize.apply(this,arguments)}function Weather(){this.initialize.apply(this,arguments)}function ToneFilter(){PIXI.filters.ColorMatrixFilter.call(this)}function ToneSprite(){this.initialize.apply(this,arguments)}function Stage(){this.initialize.apply(this,arguments)}function WebAudio(){this.initialize.apply(this,arguments)}function Html5Audio(){throw new Error("This is a static class")}function JsonEx(){throw new Error("This is a static class")}function Decrypter(){throw new Error("This is a static class")}function ResourceHandler(){throw new Error("This is a static class")}function DataManager(){throw new Error("This is a static class")}Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)},Number.prototype.mod=function(t){return(this%t+t)%t},String.prototype.format=function(){var t=arguments;return this.replace(/%([0-9]+)/g,function(e,i){return t[Number(i)-1]})},String.prototype.padZero=function(t){for(var e=this;e.length<t;)e="0"+e;return e},Number.prototype.padZero=function(t){return String(this).padZero(t)},Object.defineProperties(Array.prototype,{equals:{enumerable:!1,value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.length;e++)if(this[e]instanceof Array&&t[e]instanceof Array){if(!this[e].equals(t[e]))return!1}else if(this[e]!==t[e])return!1;return!0}},clone:{enumerable:!1,value:function(){return this.slice(0)}},contains:{enumerable:!1,value:function(t){return this.indexOf(t)>=0}}}),String.prototype.contains=function(t){return this.indexOf(t)>=0},Math.randomInt=function(t){return Math.floor(t*Math.random())},Utils.RPGMAKER_NAME="MV",Utils.RPGMAKER_VERSION="1.6.1",Utils.isOptionValid=function(t){return location.search.slice(1).split("&").contains(t)?1:"undefined"!=typeof nw&&nw.App.argv.length>0&&nw.App.argv[0].split("&").contains(t)?1:0},Utils.isNwjs=function(){return"function"==typeof require&&"object"==typeof process},Utils.isMobileDevice=function(){return!!navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i)},Utils.isMobileSafari=function(){var t=navigator.userAgent;return!(!t.match(/iPhone|iPad|iPod/)||!t.match(/AppleWebKit/)||t.match("CriOS"))},Utils.isAndroidChrome=function(){var t=navigator.userAgent;return!(!t.match(/Android/)||!t.match(/Chrome/))},Utils.canReadGameFiles=function(){var t=document.getElementsByTagName("script"),e=t[t.length-1],i=new XMLHttpRequest;try{return i.open("GET",e.src),i.overrideMimeType("text/javascript"),i.send(),!0}catch(r){return!1}},Utils.rgbToCssColor=function(t,e,i){return"rgb("+(t=Math.round(t))+","+(e=Math.round(e))+","+(i=Math.round(i))+")"},Utils._id=1,Utils.generateRuntimeId=function(){return Utils._id++},Utils._supportPassiveEvent=null,Utils.isSupportPassiveEvent=function(){if("boolean"==typeof Utils._supportPassiveEvent)return Utils._supportPassiveEvent;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return window.addEventListener("test",null,e),Utils._supportPassiveEvent=t,t},CacheEntry.prototype.free=function(t){this.freedByTTL=t||!1,this.cached&&(this.cached=!1,delete this.cache._inner[this.key])},CacheEntry.prototype.allocate=function(){return this.cached||(this.cache._inner[this.key]=this,this.cached=!0),this.touch(),this},CacheEntry.prototype.setTimeToLive=function(t,e){return this.ttlTicks=t||0,this.ttlSeconds=e||0,this},CacheEntry.prototype.isStillAlive=function(){var t=this.cache;return(0==this.ttlTicks||this.touchTicks+this.ttlTicks<t.updateTicks)&&(0==this.ttlSeconds||this.touchSeconds+this.ttlSeconds<t.updateSeconds)},CacheEntry.prototype.touch=function(){var t=this.cache;this.cached?(this.touchTicks=t.updateTicks,this.touchSeconds=t.updateSeconds):this.freedByTTL&&(this.freedByTTL=!1,t._inner[this.key]||(t._inner[this.key]=this))},CacheMap.prototype.checkTTL=function(){var t=this._inner,e=this._lastRemovedEntries;for(var i in e||(this._lastRemovedEntries=e=[]),t){var r=t[i];r.isStillAlive()||e.push(r)}for(var n=0;n<e.length;n++)e[n].free(!0);e.length=0},CacheMap.prototype.getItem=function(t){var e=this._inner[t];return e?e.item:null},CacheMap.prototype.clear=function(){for(var t=Object.keys(this._inner),e=0;e<t.length;e++)this._inner[t[e]].free()},CacheMap.prototype.setItem=function(t,e){return new CacheEntry(this,t,e).allocate()},CacheMap.prototype.update=function(t,e){this.updateTicks+=t,this.updateSeconds+=e,this.updateSeconds>=this.delayCheckTTL+this.lastCheckTTL&&(this.lastCheckTTL=this.updateSeconds,this.checkTTL())},ImageCache.limit=1e7,ImageCache.prototype.initialize=function(){this._items={}},ImageCache.prototype.add=function(t,e){this._items[t]={bitmap:e,touch:Date.now(),key:t},this._truncateCache()},ImageCache.prototype.get=function(t){if(this._items[t]){var e=this._items[t];return e.touch=Date.now(),e.bitmap}return null},ImageCache.prototype.reserve=function(t,e,i){this._items[t]||(this._items[t]={bitmap:e,touch:Date.now(),key:t}),this._items[t].reservationId=i},ImageCache.prototype.releaseReservation=function(t){var e=this._items;Object.keys(e).map(function(t){return e[t]}).forEach(function(e){e.reservationId===t&&delete e.reservationId})},ImageCache.prototype._truncateCache=function(){var t=this._items,e=ImageCache.limit;Object.keys(t).map(function(e){return t[e]}).sort(function(t,e){return e.touch-t.touch}).forEach((function(i){if(e>0||this._mustBeHeld(i)){var r=i.bitmap;e-=r.width*r.height}else delete t[i.key]}).bind(this))},ImageCache.prototype._mustBeHeld=function(t){return!(t.bitmap.isRequestOnly()||!t.reservationId&&t.bitmap.isReady())},ImageCache.prototype.isReady=function(){var t=this._items;return!Object.keys(t).some(function(e){return!t[e].bitmap.isRequestOnly()&&!t[e].bitmap.isReady()})},ImageCache.prototype.getErrorBitmap=function(){var t=this._items,e=null;return Object.keys(t).some(function(i){return!!t[i].bitmap.isError()&&(e=t[i].bitmap,!0)})?e:null},RequestQueue.prototype.initialize=function(){this._queue=[]},RequestQueue.prototype.enqueue=function(t,e){this._queue.push({key:t,value:e})},RequestQueue.prototype.update=function(){if(0!==this._queue.length){var t=this._queue[0];t.value.isRequestReady()?(this._queue.shift(),0!==this._queue.length&&this._queue[0].value.startRequest()):t.value.startRequest()}},RequestQueue.prototype.raisePriority=function(t){for(var e=0;e<this._queue.length;e++){var i=this._queue[e];if(i.key===t){this._queue.splice(e,1),this._queue.unshift(i);break}}},RequestQueue.prototype.clear=function(){this._queue.splice(0)},Point.prototype=Object.create(PIXI.Point.prototype),Point.prototype.constructor=Point,Point.prototype.initialize=function(t,e){PIXI.Point.call(this,t,e)},Rectangle.prototype=Object.create(PIXI.Rectangle.prototype),Rectangle.prototype.constructor=Rectangle,Rectangle.prototype.initialize=function(t,e,i,r){PIXI.Rectangle.call(this,t,e,i,r)},Rectangle.emptyRectangle=new Rectangle(0,0,0,0),Bitmap._reuseImages=[],Bitmap.prototype._createCanvas=function(t,e){if(this.__canvas=this.__canvas||document.createElement("canvas"),this.__context=this.__canvas.getContext("2d"),this.__canvas.width=Math.max(t||0,1),this.__canvas.height=Math.max(e||0,1),this._image){var i=Math.max(this._image.width||0,1),r=Math.max(this._image.height||0,1);this.__canvas.width=i,this.__canvas.height=r,this._createBaseTexture(this._canvas),this.__context.drawImage(this._image,0,0)}this._setDirty()},Bitmap.prototype._createBaseTexture=function(t){this.__baseTexture=new PIXI.BaseTexture(t),this.__baseTexture.mipmap=!1,this.__baseTexture.width=t.width,this.__baseTexture.height=t.height,this._baseTexture.scaleMode=this._smooth?PIXI.SCALE_MODES.LINEAR:PIXI.SCALE_MODES.NEAREST},Bitmap.prototype._clearImgInstance=function(){this._image.src="",this._image.onload=null,this._image.onerror=null,this._errorListener=null,this._loadListener=null,Bitmap._reuseImages.push(this._image),this._image=null},Object.defineProperties(Bitmap.prototype,{_canvas:{get:function(){return this.__canvas||this._createCanvas(),this.__canvas}},_context:{get:function(){return this.__context||this._createCanvas(),this.__context}},_baseTexture:{get:function(){return this.__baseTexture||this._createBaseTexture(this._image||this.__canvas),this.__baseTexture}}}),Bitmap.prototype._renewCanvas=function(){var t=this._image;t&&this.__canvas&&(this.__canvas.width<t.width||this.__canvas.height<t.height)&&this._createCanvas()},Bitmap.prototype.initialize=function(t,e){this._defer||this._createCanvas(t,e),this._image=null,this._url="",this._paintOpacity=255,this._smooth=!1,this._loadListeners=[],this._loadingState="none",this._decodeAfterRequest=!1,this.cacheEntry=null,this.fontFace="GameFont",this.fontSize=28,this.fontItalic=!1,this.textColor="#ffffff",this.outlineColor="rgba(0, 0, 0, 0.5)",this.outlineWidth=4},Bitmap.load=function(t){var e=Object.create(Bitmap.prototype);return e._defer=!0,e.initialize(),e._decodeAfterRequest=!0,e._requestImage(t),e},Bitmap.snap=function(t){var e,i=Graphics.width,r=Graphics.height,n=new Bitmap(i,r),a=n._context,o=PIXI.RenderTexture.create(i,r);t&&(Graphics._renderer.render(t,o),t.worldTransform.identity(),e=Graphics.isWebGL()?Graphics._renderer.extract.canvas(o):o.baseTexture._canvasRenderTarget.canvas,a.drawImage(e,0,0));return o.destroy({destroyBase:!0}),n._setDirty(),n},Bitmap.prototype.isReady=function(){return"loaded"===this._loadingState||"none"===this._loadingState},Bitmap.prototype.isError=function(){return"error"===this._loadingState},Bitmap.prototype.touch=function(){this.cacheEntry&&this.cacheEntry.touch()},Object.defineProperty(Bitmap.prototype,"url",{get:function(){return this._url},configurable:!0}),Object.defineProperty(Bitmap.prototype,"baseTexture",{get:function(){return this._baseTexture},configurable:!0}),Object.defineProperty(Bitmap.prototype,"canvas",{get:function(){return this._canvas},configurable:!0}),Object.defineProperty(Bitmap.prototype,"context",{get:function(){return this._context},configurable:!0}),Object.defineProperty(Bitmap.prototype,"width",{get:function(){return this.isReady()?this._image?this._image.width:this._canvas.width:0},configurable:!0}),Object.defineProperty(Bitmap.prototype,"height",{get:function(){return this.isReady()?this._image?this._image.height:this._canvas.height:0},configurable:!0}),Object.defineProperty(Bitmap.prototype,"rect",{get:function(){return new Rectangle(0,0,this.width,this.height)},configurable:!0}),Object.defineProperty(Bitmap.prototype,"smooth",{get:function(){return this._smooth},set:function(t){this._smooth!==t&&(this._smooth=t,this.__baseTexture&&(this._baseTexture.scaleMode=this._smooth?PIXI.SCALE_MODES.LINEAR:PIXI.SCALE_MODES.NEAREST))},configurable:!0}),Object.defineProperty(Bitmap.prototype,"paintOpacity",{get:function(){return this._paintOpacity},set:function(t){this._paintOpacity!==t&&(this._paintOpacity=t,this._context.globalAlpha=this._paintOpacity/255)},configurable:!0}),Bitmap.prototype.resize=function(t,e){t=Math.max(t||0,1),e=Math.max(e||0,1),this._canvas.width=t,this._canvas.height=e,this._baseTexture.width=t,this._baseTexture.height=e},Bitmap.prototype.blt=function(t,e,i,r,n,a,o,s,h){s=s||r,h=h||n,e>=0&&i>=0&&r>0&&n>0&&s>0&&h>0&&e+r<=t.width&&i+n<=t.height&&(this._context.globalCompositeOperation="source-over",this._context.drawImage(t._canvas,e,i,r,n,a,o,s,h),this._setDirty())},Bitmap.prototype.bltImage=function(t,e,i,r,n,a,o,s,h){s=s||r,h=h||n,e>=0&&i>=0&&r>0&&n>0&&s>0&&h>0&&e+r<=t.width&&i+n<=t.height&&(this._context.globalCompositeOperation="source-over",this._context.drawImage(t._image,e,i,r,n,a,o,s,h),this._setDirty())},Bitmap.prototype.getPixel=function(t,e){for(var i=this._context.getImageData(t,e,1,1).data,r="#",n=0;n<3;n++)r+=i[n].toString(16).padZero(2);return r},Bitmap.prototype.getAlphaPixel=function(t,e){return this._context.getImageData(t,e,1,1).data[3]},Bitmap.prototype.clearRect=function(t,e,i,r){this._context.clearRect(t,e,i,r),this._setDirty()},Bitmap.prototype.clear=function(){this.clearRect(0,0,this.width,this.height)},Bitmap.prototype.fillRect=function(t,e,i,r,n){var a=this._context;a.save(),a.fillStyle=n,a.fillRect(t,e,i,r),a.restore(),this._setDirty()},Bitmap.prototype.fillAll=function(t){this.fillRect(0,0,this.width,this.height,t)},Bitmap.prototype.gradientFillRect=function(t,e,i,r,n,a,o){var s,h=this._context;(s=o?h.createLinearGradient(t,e,t,e+r):h.createLinearGradient(t,e,t+i,e)).addColorStop(0,n),s.addColorStop(1,a),h.save(),h.fillStyle=s,h.fillRect(t,e,i,r),h.restore(),this._setDirty()},Bitmap.prototype.drawCircle=function(t,e,i,r){var n=this._context;n.save(),n.fillStyle=r,n.beginPath(),n.arc(t,e,i,0,2*Math.PI,!1),n.fill(),n.restore(),this._setDirty()},Bitmap.prototype.drawText=function(t,e,i,r,n,a){if(void 0!==t){var o=e,s=i+n-(n-.7*this.fontSize)/2,h=this._context,c=h.globalAlpha;r=r||4294967295,"center"===a&&(o+=r/2),"right"===a&&(o+=r),h.save(),h.font=this._makeFontNameText(),h.textAlign=a,h.textBaseline="alphabetic",h.globalAlpha=1,this._drawTextOutline(t,o,s,r),h.globalAlpha=c,this._drawTextBody(t,o,s,r),h.restore(),this._setDirty()}},Bitmap.prototype.measureTextWidth=function(t){var e=this._context;e.save(),e.font=this._makeFontNameText();var i=e.measureText(t).width;return e.restore(),i},Bitmap.prototype.adjustTone=function(t,e,i){if((t||e||i)&&this.width>0&&this.height>0){for(var r=this._context,n=r.getImageData(0,0,this.width,this.height),a=n.data,o=0;o<a.length;o+=4)a[o+0]+=t,a[o+1]+=e,a[o+2]+=i;r.putImageData(n,0,0),this._setDirty()}},Bitmap.prototype.rotateHue=function(t){function e(t,e,i){var r=Math.min(t,e,i),n=Math.max(t,e,i),a=0,o=0,s=(r+n)/2,h=n-r;return h>0&&(a=t===n?((e-i)/h+6)%6*60:e===n?60*((i-t)/h+2):60*((t-e)/h+4),o=h/(255-Math.abs(2*s-255))),[a,o,s]}function i(t,e,i){var r=(255-Math.abs(2*i-255))*e,n=i-r/2,a=r+n,o=r*(1-Math.abs(t/60%2-1))+n;return t<60?[a,o,n]:t<120?[o,a,n]:t<180?[n,a,o]:t<240?[n,o,a]:t<300?[o,n,a]:[a,n,o]}if(t&&this.width>0&&this.height>0){t=(t%360+360)%360;for(var r=this._context,n=r.getImageData(0,0,this.width,this.height),a=n.data,o=0;o<a.length;o+=4){var s=e(a[o+0],a[o+1],a[o+2]),h=i((s[0]+t)%360,s[1],s[2]);a[o+0]=h[0],a[o+1]=h[1],a[o+2]=h[2]}r.putImageData(n,0,0),this._setDirty()}},Bitmap.prototype.blur=function(){for(var t=0;t<2;t++){var e=this.width,i=this.height,r=this._canvas,n=this._context,a=document.createElement("canvas"),o=a.getContext("2d");a.width=e+2,a.height=i+2,o.drawImage(r,0,0,e,i,1,1,e,i),o.drawImage(r,0,0,e,1,1,0,e,1),o.drawImage(r,0,0,1,i,0,1,1,i),o.drawImage(r,0,i-1,e,1,1,i+1,e,1),o.drawImage(r,e-1,0,1,i,e+1,1,1,i),n.save(),n.fillStyle="black",n.fillRect(0,0,e,i),n.globalCompositeOperation="lighter",n.globalAlpha=1/9;for(var s=0;s<3;s++)for(var h=0;h<3;h++)n.drawImage(a,h,s,e,i,0,0,e,i);n.restore()}this._setDirty()},Bitmap.prototype.addLoadListener=function(t){this.isReady()?t(this):this._loadListeners.push(t)},Bitmap.prototype._makeFontNameText=function(){return(this.fontItalic?"Italic ":"")+this.fontSize+"px "+this.fontFace},Bitmap.prototype._drawTextOutline=function(t,e,i,r){var n=this._context;n.strokeStyle=this.outlineColor,n.lineWidth=this.outlineWidth,n.lineJoin="round",n.strokeText(t,e,i,r)},Bitmap.prototype._drawTextBody=function(t,e,i,r){var n=this._context;n.fillStyle=this.textColor,n.fillText(t,e,i,r)},Bitmap.prototype._onLoad=function(){switch(this._image.removeEventListener("load",this._loadListener),this._image.removeEventListener("error",this._errorListener),this._renewCanvas(),this._loadingState){case"requesting":this._loadingState="requestCompleted",this._decodeAfterRequest?this.decode():(this._loadingState="purged",this._clearImgInstance());break;case"decrypting":window.URL.revokeObjectURL(this._image.src),this._loadingState="decryptCompleted",this._decodeAfterRequest?this.decode():(this._loadingState="purged",this._clearImgInstance())}},Bitmap.prototype.decode=function(){switch(this._loadingState){case"requestCompleted":case"decryptCompleted":this._loadingState="loaded",this.__canvas||this._createBaseTexture(this._image),this._setDirty(),this._callLoadListeners();break;case"requesting":case"decrypting":this._decodeAfterRequest=!0,this._loader||(this._loader=ResourceHandler.createLoader(this._url,this._requestImage.bind(this,this._url),this._onError.bind(this)),this._image.removeEventListener("error",this._errorListener),this._image.addEventListener("error",this._errorListener=this._loader));break;case"pending":case"purged":case"error":this._decodeAfterRequest=!0,this._requestImage(this._url)}},Bitmap.prototype._callLoadListeners=function(){for(;this._loadListeners.length>0;)this._loadListeners.shift()(this)},Bitmap.prototype._onError=function(){this._image.removeEventListener("load",this._loadListener),this._image.removeEventListener("error",this._errorListener),this._loadingState="error"},Bitmap.prototype._setDirty=function(){this._dirty=!0},Bitmap.prototype.checkDirty=function(){this._dirty&&(this._baseTexture.update(),this._dirty=!1)},Bitmap.request=function(t){var e=Object.create(Bitmap.prototype);return e._defer=!0,e.initialize(),e._url=t,e._loadingState="pending",e},Bitmap.prototype._requestImage=function(t){this._image=0!==Bitmap._reuseImages.length?Bitmap._reuseImages.pop():new Image,this._decodeAfterRequest&&!this._loader&&(this._loader=ResourceHandler.createLoader(t,this._requestImage.bind(this,t),this._onError.bind(this))),this._image=new Image,this._url=t,this._loadingState="requesting",!Decrypter.checkImgIgnore(t)&&Decrypter.hasEncryptedImages?(this._loadingState="decrypting",Decrypter.decryptImg(t,this)):(this._image.src=t,this._image.addEventListener("load",this._loadListener=Bitmap.prototype._onLoad.bind(this)),this._image.addEventListener("error",this._errorListener=this._loader||Bitmap.prototype._onError.bind(this)))},Bitmap.prototype.isRequestOnly=function(){return!(this._decodeAfterRequest||this.isReady())},Bitmap.prototype.isRequestReady=function(){return"pending"!==this._loadingState&&"requesting"!==this._loadingState&&"decrypting"!==this._loadingState},Bitmap.prototype.startRequest=function(){"pending"===this._loadingState&&(this._decodeAfterRequest=!1,this._requestImage(this._url))},Graphics._cssFontLoading=document.fonts&&document.fonts.ready,Graphics._fontLoaded=null,Graphics._videoVolume=1,Graphics.initialize=function(t,e,i){this._width=t||800,this._height=e||600,this._rendererType=i||"auto",this._boxWidth=this._width,this._boxHeight=this._height,this._scale=1,this._realScale=1,this._errorShowed=!1,this._errorPrinter=null,this._canvas=null,this._video=null,this._videoUnlocked=!1,this._videoLoading=!1,this._upperCanvas=null,this._renderer=null,this._fpsMeter=null,this._modeBox=null,this._skipCount=0,this._maxSkip=3,this._rendered=!1,this._loadingImage=null,this._loadingCount=0,this._fpsMeterToggled=!1,this._stretchEnabled=this._defaultStretchMode(),this._canUseDifferenceBlend=!1,this._canUseSaturationBlend=!1,this._hiddenCanvas=null,this._testCanvasBlendModes(),this._modifyExistingElements(),this._updateRealScale(),this._createAllElements(),this._disableTextSelection(),this._disableContextMenu(),this._setupEventHandlers(),this._setupCssFontLoading()},Graphics._setupCssFontLoading=function(){Graphics._cssFontLoading&&document.fonts.ready.then(function(t){Graphics._fontLoaded=t}).catch(function(t){SceneManager.onError(t)})},Graphics.canUseCssFontLoading=function(){return!!this._cssFontLoading},Graphics.frameCount=0,Graphics.BLEND_NORMAL=0,Graphics.BLEND_ADD=1,Graphics.BLEND_MULTIPLY=2,Graphics.BLEND_SCREEN=3,Graphics.tickStart=function(){this._fpsMeter&&this._fpsMeter.tickStart()},Graphics.tickEnd=function(){this._fpsMeter&&this._rendered&&this._fpsMeter.tick()},Graphics.render=function(t){if(0===this._skipCount){var e=Date.now();t&&(this._renderer.render(t),this._renderer.gl&&this._renderer.gl.flush&&this._renderer.gl.flush());var i=Date.now();this._skipCount=Math.min(Math.floor((i-e)/15),this._maxSkip),this._rendered=!0}else this._skipCount--,this._rendered=!1;this.frameCount++},Graphics.isWebGL=function(){return this._renderer&&this._renderer.type===PIXI.RENDERER_TYPE.WEBGL},Graphics.hasWebGL=function(){try{var t=document.createElement("canvas");return!(!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(e){return!1}},Graphics.canUseDifferenceBlend=function(){return this._canUseDifferenceBlend},Graphics.canUseSaturationBlend=function(){return this._canUseSaturationBlend},Graphics.setLoadingImage=function(t){this._loadingImage=new Image,this._loadingImage.src=t},Graphics.startLoading=function(){this._loadingCount=0},Graphics.updateLoading=function(){this._loadingCount++,this._paintUpperCanvas(),this._upperCanvas.style.opacity=1},Graphics.endLoading=function(){this._clearUpperCanvas(),this._upperCanvas.style.opacity=0},Graphics.printLoadingError=function(t){if(this._errorPrinter&&!this._errorShowed){this._errorPrinter.innerHTML=this._makeErrorHtml("Loading Error","Failed to load: "+t);var e=document.createElement("button");e.innerHTML="Retry",e.style.fontSize="24px",e.style.color="#ffffff",e.style.backgroundColor="#000000",e.onmousedown=e.ontouchstart=function(t){ResourceHandler.retry(),t.stopPropagation()},this._errorPrinter.appendChild(e),this._loadingCount=-1/0}},Graphics.eraseLoadingError=function(){this._errorPrinter&&!this._errorShowed&&(this._errorPrinter.innerHTML="",this.startLoading())},Graphics.printError=function(t,e){this._errorShowed=!0,this._errorPrinter&&(this._errorPrinter.innerHTML=this._makeErrorHtml(t,e)),this._applyCanvasFilter(),this._clearUpperCanvas()},Graphics.showFps=function(){this._fpsMeter&&(this._fpsMeter.show(),this._modeBox.style.opacity=1)},Graphics.hideFps=function(){this._fpsMeter&&(this._fpsMeter.hide(),this._modeBox.style.opacity=0)},Graphics.loadFont=function(t,e){var i=document.createElement("style"),r=document.getElementsByTagName("head"),n='@font-face { font-family: "'+t+'"; src: url("'+e+'"); }';i.type="text/css",r.item(0).appendChild(i),i.sheet.insertRule(n,0),this._createFontLoader(t)},Graphics.isFontLoaded=function(t){if(Graphics._cssFontLoading)return!!Graphics._fontLoaded&&Graphics._fontLoaded.check('10px "'+t+'"');this._hiddenCanvas||(this._hiddenCanvas=document.createElement("canvas"));var e,i=this._hiddenCanvas.getContext("2d"),r="abcdefghijklmnopqrstuvwxyz";return i.font="40px "+t+", sans-serif",e=i.measureText(r).width,i.font="40px sans-serif",e!==i.measureText(r).width},Graphics.playVideo=function(t){this._videoLoader=ResourceHandler.createLoader(null,this._playVideo.bind(this,t),this._onVideoError.bind(this)),this._playVideo(t)},Graphics._playVideo=function(t){this._video.src=t,this._video.onloadeddata=this._onVideoLoad.bind(this),this._video.onerror=this._videoLoader,this._video.onended=this._onVideoEnd.bind(this),this._video.load(),this._videoLoading=!0},Graphics.isVideoPlaying=function(){return this._videoLoading||this._isVideoVisible()},Graphics.canPlayVideoType=function(t){return this._video&&this._video.canPlayType(t)},Graphics.setVideoVolume=function(t){this._videoVolume=t,this._video&&(this._video.volume=this._videoVolume)},Graphics.pageToCanvasX=function(t){return this._canvas?Math.round((t-this._canvas.offsetLeft)/this._realScale):0},Graphics.pageToCanvasY=function(t){return this._canvas?Math.round((t-this._canvas.offsetTop)/this._realScale):0},Graphics.isInsideCanvas=function(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height},Graphics.callGC=function(){Graphics.isWebGL()&&Graphics._renderer.textureGC.run()},Object.defineProperty(Graphics,"width",{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._updateAllElements())},configurable:!0}),Object.defineProperty(Graphics,"height",{get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this._updateAllElements())},configurable:!0}),Object.defineProperty(Graphics,"boxWidth",{get:function(){return this._boxWidth},set:function(t){this._boxWidth=t},configurable:!0}),Object.defineProperty(Graphics,"boxHeight",{get:function(){return this._boxHeight},set:function(t){this._boxHeight=t},configurable:!0}),Object.defineProperty(Graphics,"scale",{get:function(){return this._scale},set:function(t){this._scale!==t&&(this._scale=t,this._updateAllElements())},configurable:!0}),Graphics._createAllElements=function(){this._createErrorPrinter(),this._createCanvas(),this._createVideo(),this._createUpperCanvas(),this._createRenderer(),this._createFPSMeter(),this._createModeBox(),this._createGameFontLoader()},Graphics._updateAllElements=function(){this._updateRealScale(),this._updateErrorPrinter(),this._updateCanvas(),this._updateVideo(),this._updateUpperCanvas(),this._updateRenderer(),this._paintUpperCanvas()},Graphics._updateRealScale=function(){if(this._stretchEnabled){var t=window.innerWidth/this._width,e=window.innerHeight/this._height;t>=1&&t-.01<=1&&(t=1),e>=1&&e-.01<=1&&(e=1),this._realScale=Math.min(t,e)}else this._realScale=this._scale},Graphics._makeErrorHtml=function(t,e){return'<font color="yellow"><b>'+t+'</b></font><br><font color="white">'+e+"</font><br>"},Graphics._defaultStretchMode=function(){return Utils.isNwjs()||Utils.isMobileDevice()},Graphics._testCanvasBlendModes=function(){var t,e,i,r;(t=document.createElement("canvas")).width=1,t.height=1,(e=t.getContext("2d")).globalCompositeOperation="source-over",e.fillStyle="white",e.fillRect(0,0,1,1),e.globalCompositeOperation="difference",e.fillStyle="white",e.fillRect(0,0,1,1),i=e.getImageData(0,0,1,1),e.globalCompositeOperation="source-over",e.fillStyle="black",e.fillRect(0,0,1,1),e.globalCompositeOperation="saturation",e.fillStyle="white",e.fillRect(0,0,1,1),r=e.getImageData(0,0,1,1),this._canUseDifferenceBlend=0===i.data[0],this._canUseSaturationBlend=0===r.data[0]},Graphics._modifyExistingElements=function(){for(var t=document.getElementsByTagName("*"),e=0;e<t.length;e++)t[e].style.zIndex>0&&(t[e].style.zIndex=0)},Graphics._createErrorPrinter=function(){this._errorPrinter=document.createElement("p"),this._errorPrinter.id="ErrorPrinter",this._updateErrorPrinter(),document.body.appendChild(this._errorPrinter)},Graphics._updateErrorPrinter=function(){this._errorPrinter.width=.9*this._width,this._errorPrinter.height=40,this._errorPrinter.style.textAlign="center",this._errorPrinter.style.textShadow="1px 1px 3px #000",this._errorPrinter.style.fontSize="20px",this._errorPrinter.style.zIndex=99,this._centerElement(this._errorPrinter)},Graphics._createCanvas=function(){this._canvas=document.createElement("canvas"),this._canvas.id="GameCanvas",this._updateCanvas(),document.body.appendChild(this._canvas)},Graphics._updateCanvas=function(){this._canvas.width=this._width,this._canvas.height=this._height,this._canvas.style.zIndex=1,this._centerElement(this._canvas)},Graphics._createVideo=function(){this._video=document.createElement("video"),this._video.id="GameVideo",this._video.style.opacity=0,this._video.setAttribute("playsinline",""),this._video.volume=this._videoVolume,this._updateVideo(),makeVideoPlayableInline(this._video),document.body.appendChild(this._video)},Graphics._updateVideo=function(){this._video.width=this._width,this._video.height=this._height,this._video.style.zIndex=2,this._centerElement(this._video)},Graphics._createUpperCanvas=function(){this._upperCanvas=document.createElement("canvas"),this._upperCanvas.id="UpperCanvas",this._updateUpperCanvas(),document.body.appendChild(this._upperCanvas)},Graphics._updateUpperCanvas=function(){this._upperCanvas.width=this._width,this._upperCanvas.height=this._height,this._upperCanvas.style.zIndex=3,this._centerElement(this._upperCanvas)},Graphics._clearUpperCanvas=function(){this._upperCanvas.getContext("2d").clearRect(0,0,this._width,this._height)},Graphics._paintUpperCanvas=function(){if(this._clearUpperCanvas(),this._loadingImage&&this._loadingCount>=20){var t=this._upperCanvas.getContext("2d"),e=(this._width-this._loadingImage.width)/2,i=(this._height-this._loadingImage.height)/2,r=((this._loadingCount-20)/30).clamp(0,1);t.save(),t.globalAlpha=r,t.drawImage(this._loadingImage,e,i),t.restore()}},Graphics._createRenderer=function(){PIXI.dontSayHello=!0;var t=this._width,e=this._height,i={view:this._canvas};try{switch(this._rendererType){case"canvas":this._renderer=new PIXI.CanvasRenderer(t,e,i);break;case"webgl":this._renderer=new PIXI.WebGLRenderer(t,e,i);break;default:this._renderer=PIXI.autoDetectRenderer(t,e,i)}this._renderer&&this._renderer.textureGC&&(this._renderer.textureGC.maxIdle=1)}catch(r){this._renderer=null}},Graphics._updateRenderer=function(){this._renderer&&this._renderer.resize(this._width,this._height)},Graphics._createFPSMeter=function(){this._fpsMeter=new FPSMeter({graph:1,decimals:0,theme:"transparent",toggleOn:null}),this._fpsMeter.hide()},Graphics._createModeBox=function(){var t=document.createElement("div");t.id="modeTextBack",t.style.position="absolute",t.style.left="5px",t.style.top="5px",t.style.width="119px",t.style.height="58px",t.style.background="rgba(0,0,0,0.2)",t.style.zIndex=9,t.style.opacity=0;var e=document.createElement("div");e.id="modeText",e.style.position="absolute",e.style.left="0px",e.style.top="41px",e.style.width="119px",e.style.fontSize="12px",e.style.fontFamily="monospace",e.style.color="white",e.style.textAlign="center",e.style.textShadow="1px 1px 0 rgba(0,0,0,0.5)",e.innerHTML=this.isWebGL()?"WebGL mode":"Canvas mode",document.body.appendChild(t),t.appendChild(e),this._modeBox=t},Graphics._createGameFontLoader=function(){this._createFontLoader("GameFont")},Graphics._createFontLoader=function(t){var e=document.createElement("div"),i=document.createTextNode(".");e.style.fontFamily=t,e.style.fontSize="0px",e.style.color="transparent",e.style.position="absolute",e.style.margin="auto",e.style.top="0px",e.style.left="0px",e.style.width="1px",e.style.height="1px",e.appendChild(i),document.body.appendChild(e)},Graphics._centerElement=function(t){var e=t.width*this._realScale,i=t.height*this._realScale;t.style.position="absolute",t.style.margin="auto",t.style.top=0,t.style.left=0,t.style.right=0,t.style.bottom=0,t.style.width=e+"px",t.style.height=i+"px"},Graphics._disableTextSelection=function(){var t=document.body;t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.msUserSelect="none",t.style.mozUserSelect="none"},Graphics._disableContextMenu=function(){for(var t=document.body.getElementsByTagName("*"),e=function(){return!1},i=0;i<t.length;i++)t[i].oncontextmenu=e},Graphics._applyCanvasFilter=function(){this._canvas&&(this._canvas.style.opacity=.5,this._canvas.style.filter="blur(8px)",this._canvas.style.webkitFilter="blur(8px)")},Graphics._onVideoLoad=function(){this._video.play(),this._updateVisibility(!0),this._videoLoading=!1},Graphics._onVideoError=function(){this._updateVisibility(!1),this._videoLoading=!1},Graphics._onVideoEnd=function(){this._updateVisibility(!1)},Graphics._updateVisibility=function(t){this._video.style.opacity=t?1:0,this._canvas.style.opacity=t?0:1},Graphics._isVideoVisible=function(){return this._video.style.opacity>0},Graphics._setupEventHandlers=function(){window.addEventListener("resize",this._onWindowResize.bind(this)),document.addEventListener("keydown",this._onKeyDown.bind(this)),document.addEventListener("keydown",this._onTouchEnd.bind(this)),document.addEventListener("mousedown",this._onTouchEnd.bind(this)),document.addEventListener("touchend",this._onTouchEnd.bind(this))},Graphics._onWindowResize=function(){this._updateAllElements()},Graphics._onKeyDown=function(t){if(!t.ctrlKey&&!t.altKey)switch(t.keyCode){case 113:t.preventDefault(),this._switchFPSMeter();break;case 114:t.preventDefault(),this._switchStretchMode();break;case 115:t.preventDefault(),this._switchFullScreen()}},Graphics._onTouchEnd=function(t){this._videoUnlocked||(this._video.play(),this._videoUnlocked=!0),this._isVideoVisible()&&this._video.paused&&this._video.play()},Graphics._switchFPSMeter=function(){this._fpsMeter.isPaused?(this.showFps(),this._fpsMeter.showFps(),this._fpsMeterToggled=!1):this._fpsMeterToggled?this.hideFps():(this._fpsMeter.showDuration(),this._fpsMeterToggled=!0)},Graphics._switchStretchMode=function(){this._stretchEnabled=!this._stretchEnabled,this._updateAllElements()},Graphics._switchFullScreen=function(){this._isFullScreen()?this._requestFullScreen():this._cancelFullScreen()},Graphics._isFullScreen=function(){return document.fullScreenElement&&null!==document.fullScreenElement||!document.mozFullScreen&&!document.webkitFullscreenElement&&!document.msFullscreenElement},Graphics._requestFullScreen=function(){var t=document.body;t.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):t.msRequestFullscreen&&t.msRequestFullscreen()},Graphics._cancelFullScreen=function(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},Input.initialize=function(){this.clear(),this._wrapNwjsAlert(),this._setupEventHandlers()},Input.keyRepeatWait=24,Input.keyRepeatInterval=6,Input.keyMapper={9:"tab",13:"ok",16:"shift",17:"control",18:"control",27:"escape",32:"ok",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",45:"escape",81:"pageup",87:"pagedown",88:"escape",90:"ok",96:"escape",98:"down",100:"left",102:"right",104:"up",120:"debug"},Input.gamepadMapper={0:"ok",1:"cancel",2:"shift",3:"menu",4:"pageup",5:"pagedown",12:"up",13:"down",14:"left",15:"right"},Input.clear=function(){this._currentState={},this._previousState={},this._gamepadStates=[],this._latestButton=null,this._pressedTime=0,this._dir4=0,this._dir8=0,this._preferredAxis="",this._date=0},Input.update=function(){for(var t in this._pollGamepads(),this._currentState[this._latestButton]?this._pressedTime++:this._latestButton=null,this._currentState)this._currentState[t]&&!this._previousState[t]&&(this._latestButton=t,this._pressedTime=0,this._date=Date.now()),this._previousState[t]=this._currentState[t];this._updateDirection()},Input.isPressed=function(t){return!(!this._isEscapeCompatible(t)||!this.isPressed("escape"))||!!this._currentState[t]},Input.isTriggered=function(t){return!(!this._isEscapeCompatible(t)||!this.isTriggered("escape"))||this._latestButton===t&&0===this._pressedTime},Input.isRepeated=function(t){return!(!this._isEscapeCompatible(t)||!this.isRepeated("escape"))||this._latestButton===t&&(0===this._pressedTime||this._pressedTime>=this.keyRepeatWait&&this._pressedTime%this.keyRepeatInterval==0)},Input.isLongPressed=function(t){return!(!this._isEscapeCompatible(t)||!this.isLongPressed("escape"))||this._latestButton===t&&this._pressedTime>=this.keyRepeatWait},Object.defineProperty(Input,"dir4",{get:function(){return this._dir4},configurable:!0}),Object.defineProperty(Input,"dir8",{get:function(){return this._dir8},configurable:!0}),Object.defineProperty(Input,"date",{get:function(){return this._date},configurable:!0}),Input._wrapNwjsAlert=function(){if(Utils.isNwjs()){var t=window.alert;window.alert=function(){var e=require("nw.gui").Window.get();t.apply(this,arguments),e.focus(),Input.clear()}}},Input._setupEventHandlers=function(){document.addEventListener("keydown",this._onKeyDown.bind(this)),document.addEventListener("keyup",this._onKeyUp.bind(this)),window.addEventListener("blur",this._onLostFocus.bind(this))},Input._onKeyDown=function(t){this._shouldPreventDefault(t.keyCode)&&t.preventDefault(),144===t.keyCode&&this.clear();var e=this.keyMapper[t.keyCode];ResourceHandler.exists()&&"ok"===e?ResourceHandler.retry():e&&(this._currentState[e]=!0)},Input._shouldPreventDefault=function(t){switch(t){case 8:case 33:case 34:case 37:case 38:case 39:case 40:return!0}return!1},Input._onKeyUp=function(t){var e=this.keyMapper[t.keyCode];e&&(this._currentState[e]=!1),0===t.keyCode&&this.clear()},Input._onLostFocus=function(){this.clear()},Input._pollGamepads=function(){if(navigator.getGamepads){var t=navigator.getGamepads();if(t)for(var e=0;e<t.length;e++){var i=t[e];i&&i.connected&&this._updateGamepadState(i)}}},Input._updateGamepadState=function(t){var e=this._gamepadStates[t.index]||[],i=[],r=t.buttons,n=t.axes;i[12]=!1,i[13]=!1,i[14]=!1,i[15]=!1;for(var a=0;a<r.length;a++)i[a]=r[a].pressed;n[1]<-.5?i[12]=!0:n[1]>.5&&(i[13]=!0),n[0]<-.5?i[14]=!0:n[0]>.5&&(i[15]=!0);for(var o=0;o<i.length;o++)if(i[o]!==e[o]){var s=this.gamepadMapper[o];s&&(this._currentState[s]=i[o])}this._gamepadStates[t.index]=i},Input._updateDirection=function(){var t=this._signX(),e=this._signY();this._dir8=this._makeNumpadDirection(t,e),0!==t&&0!==e?"x"===this._preferredAxis?e=0:t=0:0!==t?this._preferredAxis="y":0!==e&&(this._preferredAxis="x"),this._dir4=this._makeNumpadDirection(t,e)},Input._signX=function(){var t=0;return this.isPressed("left")&&t--,this.isPressed("right")&&t++,t},Input._signY=function(){var t=0;return this.isPressed("up")&&t--,this.isPressed("down")&&t++,t},Input._makeNumpadDirection=function(t,e){return 0!==t||0!==e?5-3*e+t:0},Input._isEscapeCompatible=function(t){return"cancel"===t||"menu"===t},TouchInput.initialize=function(){this.clear(),this._setupEventHandlers()},TouchInput.keyRepeatWait=24,TouchInput.keyRepeatInterval=6,TouchInput.clear=function(){this._mousePressed=!1,this._screenPressed=!1,this._pressedTime=0,this._events={},this._events.triggered=!1,this._events.cancelled=!1,this._events.moved=!1,this._events.released=!1,this._events.wheelX=0,this._events.wheelY=0,this._triggered=!1,this._cancelled=!1,this._moved=!1,this._released=!1,this._wheelX=0,this._wheelY=0,this._x=0,this._y=0,this._date=0},TouchInput.update=function(){this._triggered=this._events.triggered,this._cancelled=this._events.cancelled,this._moved=this._events.moved,this._released=this._events.released,this._wheelX=this._events.wheelX,this._wheelY=this._events.wheelY,this._events.triggered=!1,this._events.cancelled=!1,this._events.moved=!1,this._events.released=!1,this._events.wheelX=0,this._events.wheelY=0,this.isPressed()&&this._pressedTime++},TouchInput.isPressed=function(){return this._mousePressed||this._screenPressed},TouchInput.isTriggered=function(){return this._triggered},TouchInput.isRepeated=function(){return this.isPressed()&&(this._triggered||this._pressedTime>=this.keyRepeatWait&&this._pressedTime%this.keyRepeatInterval==0)},TouchInput.isLongPressed=function(){return this.isPressed()&&this._pressedTime>=this.keyRepeatWait},TouchInput.isCancelled=function(){return this._cancelled},TouchInput.isMoved=function(){return this._moved},TouchInput.isReleased=function(){return this._released},Object.defineProperty(TouchInput,"wheelX",{get:function(){return this._wheelX},configurable:!0}),Object.defineProperty(TouchInput,"wheelY",{get:function(){return this._wheelY},configurable:!0}),Object.defineProperty(TouchInput,"x",{get:function(){return this._x},configurable:!0}),Object.defineProperty(TouchInput,"y",{get:function(){return this._y},configurable:!0}),Object.defineProperty(TouchInput,"date",{get:function(){return this._date},configurable:!0}),TouchInput._setupEventHandlers=function(){var t=Utils.isSupportPassiveEvent();document.addEventListener("mousedown",this._onMouseDown.bind(this)),document.addEventListener("mousemove",this._onMouseMove.bind(this)),document.addEventListener("mouseup",this._onMouseUp.bind(this)),document.addEventListener("wheel",this._onWheel.bind(this)),document.addEventListener("touchstart",this._onTouchStart.bind(this),!!t&&{passive:!1}),document.addEventListener("touchmove",this._onTouchMove.bind(this),!!t&&{passive:!1}),document.addEventListener("touchend",this._onTouchEnd.bind(this)),document.addEventListener("touchcancel",this._onTouchCancel.bind(this)),document.addEventListener("pointerdown",this._onPointerDown.bind(this))},TouchInput._onMouseDown=function(t){0===t.button?this._onLeftButtonDown(t):1===t.button?this._onMiddleButtonDown(t):2===t.button&&this._onRightButtonDown(t)},TouchInput._onLeftButtonDown=function(t){var e=Graphics.pageToCanvasX(t.pageX),i=Graphics.pageToCanvasY(t.pageY);Graphics.isInsideCanvas(e,i)&&(this._mousePressed=!0,this._pressedTime=0,this._onTrigger(e,i))},TouchInput._onMiddleButtonDown=function(t){},TouchInput._onRightButtonDown=function(t){var e=Graphics.pageToCanvasX(t.pageX),i=Graphics.pageToCanvasY(t.pageY);Graphics.isInsideCanvas(e,i)&&this._onCancel(e,i)},TouchInput._onMouseMove=function(t){if(this._mousePressed){var e=Graphics.pageToCanvasX(t.pageX),i=Graphics.pageToCanvasY(t.pageY);this._onMove(e,i)}},TouchInput._onMouseUp=function(t){if(0===t.button){var e=Graphics.pageToCanvasX(t.pageX),i=Graphics.pageToCanvasY(t.pageY);this._mousePressed=!1,this._onRelease(e,i)}},TouchInput._onWheel=function(t){this._events.wheelX+=t.deltaX,this._events.wheelY+=t.deltaY,t.preventDefault()},TouchInput._onTouchStart=function(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],r=Graphics.pageToCanvasX(i.pageX),n=Graphics.pageToCanvasY(i.pageY);Graphics.isInsideCanvas(r,n)&&(this._screenPressed=!0,this._pressedTime=0,t.touches.length>=2?this._onCancel(r,n):this._onTrigger(r,n),t.preventDefault())}(window.cordova||window.navigator.standalone)&&t.preventDefault()},TouchInput._onTouchMove=function(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],r=Graphics.pageToCanvasX(i.pageX),n=Graphics.pageToCanvasY(i.pageY);this._onMove(r,n)}},TouchInput._onTouchEnd=function(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],r=Graphics.pageToCanvasX(i.pageX),n=Graphics.pageToCanvasY(i.pageY);this._screenPressed=!1,this._onRelease(r,n)}},TouchInput._onTouchCancel=function(t){this._screenPressed=!1},TouchInput._onPointerDown=function(t){if("touch"===t.pointerType&&!t.isPrimary){var e=Graphics.pageToCanvasX(t.pageX),i=Graphics.pageToCanvasY(t.pageY);Graphics.isInsideCanvas(e,i)&&(this._onCancel(e,i),t.preventDefault())}},TouchInput._onTrigger=function(t,e){this._events.triggered=!0,this._x=t,this._y=e,this._date=Date.now()},TouchInput._onCancel=function(t,e){this._events.cancelled=!0,this._x=t,this._y=e},TouchInput._onMove=function(t,e){this._events.moved=!0,this._x=t,this._y=e},TouchInput._onRelease=function(t,e){this._events.released=!0,this._x=t,this._y=e},Sprite.prototype=Object.create(PIXI.Sprite.prototype),Sprite.prototype.constructor=Sprite,Sprite.voidFilter=new PIXI.filters.VoidFilter,Sprite.prototype.initialize=function(t){var e=new PIXI.Texture(new PIXI.BaseTexture);PIXI.Sprite.call(this,e),this._bitmap=null,this._frame=new Rectangle,this._realFrame=new Rectangle,this._blendColor=[0,0,0,0],this._colorTone=[0,0,0,0],this._canvas=null,this._context=null,this._tintTexture=null,this._isPicture=!1,this.spriteId=Sprite._counter++,this.opaque=!1,this.bitmap=t},Sprite._counter=0,Object.defineProperty(Sprite.prototype,"bitmap",{get:function(){return this._bitmap},set:function(t){this._bitmap!==t&&(this._bitmap=t,t?(this._refreshFrame=!0,t.addLoadListener(this._onBitmapLoad.bind(this))):(this._refreshFrame=!1,this.texture.frame=Rectangle.emptyRectangle))},configurable:!0}),Object.defineProperty(Sprite.prototype,"width",{get:function(){return this._frame.width},set:function(t){this._frame.width=t,this._refresh()},configurable:!0}),Object.defineProperty(Sprite.prototype,"height",{get:function(){return this._frame.height},set:function(t){this._frame.height=t,this._refresh()},configurable:!0}),Object.defineProperty(Sprite.prototype,"opacity",{get:function(){return 255*this.alpha},set:function(t){this.alpha=t.clamp(0,255)/255},configurable:!0}),Sprite.prototype.update=function(){this.children.forEach(function(t){t.update&&t.update()})},Sprite.prototype.move=function(t,e){this.x=t,this.y=e},Sprite.prototype.setFrame=function(t,e,i,r){this._refreshFrame=!1;var n=this._frame;t===n.x&&e===n.y&&i===n.width&&r===n.height||(n.x=t,n.y=e,n.width=i,n.height=r,this._refresh())},Sprite.prototype.getBlendColor=function(){return this._blendColor.clone()},Sprite.prototype.setBlendColor=function(t){if(!(t instanceof Array))throw new Error("Argument must be an array");this._blendColor.equals(t)||(this._blendColor=t.clone(),this._refresh())},Sprite.prototype.getColorTone=function(){return this._colorTone.clone()},Sprite.prototype.setColorTone=function(t){if(!(t instanceof Array))throw new Error("Argument must be an array");this._colorTone.equals(t)||(this._colorTone=t.clone(),this._refresh())},Sprite.prototype._onBitmapLoad=function(t){t===this._bitmap&&this._refreshFrame&&this._bitmap&&(this._refreshFrame=!1,this._frame.width=this._bitmap.width,this._frame.height=this._bitmap.height),this._refresh()},Sprite.prototype._refresh=function(){var t=Math.floor(this._frame.x),e=Math.floor(this._frame.y),i=Math.floor(this._frame.width),r=Math.floor(this._frame.height),n=this._bitmap?this._bitmap.width:0,a=this._bitmap?this._bitmap.height:0,o=t.clamp(0,n),s=e.clamp(0,a),h=(i-o+t).clamp(0,n-o),c=(r-s+e).clamp(0,a-s);this._realFrame.x=o,this._realFrame.y=s,this._realFrame.width=h,this._realFrame.height=c,this.pivot.x=t-o,this.pivot.y=e-s,h>0&&c>0?this._needsTint()?(this._createTinter(h,c),this._executeTint(o,s,h,c),this._tintTexture.update(),this.texture.baseTexture=this._tintTexture,this.texture.frame=new Rectangle(0,0,h,c)):(this._bitmap&&(this.texture.baseTexture=this._bitmap.baseTexture),this.texture.frame=this._realFrame):this._bitmap?this.texture.frame=Rectangle.emptyRectangle:(this.texture.baseTexture.width=Math.max(this.texture.baseTexture.width,this._frame.x+this._frame.width),this.texture.baseTexture.height=Math.max(this.texture.baseTexture.height,this._frame.y+this._frame.height),this.texture.frame=this._frame),this.texture._updateID++},Sprite.prototype._isInBitmapRect=function(t,e,i,r){return this._bitmap&&t+i>0&&e+r>0&&t<this._bitmap.width&&e<this._bitmap.height},Sprite.prototype._needsTint=function(){var t=this._colorTone;return t[0]||t[1]||t[2]||t[3]||this._blendColor[3]>0},Sprite.prototype._createTinter=function(t,e){this._canvas||(this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d")),this._canvas.width=t,this._canvas.height=e,this._tintTexture||(this._tintTexture=new PIXI.BaseTexture(this._canvas)),this._tintTexture.width=t,this._tintTexture.height=e,this._tintTexture.scaleMode=this._bitmap.baseTexture.scaleMode},Sprite.prototype._executeTint=function(t,e,i,r){var n=this._context,a=this._colorTone,o=this._blendColor;if(n.globalCompositeOperation="copy",n.drawImage(this._bitmap.canvas,t,e,i,r,0,0,i,r),Graphics.canUseSaturationBlend()){var s=Math.max(0,a[3]);n.globalCompositeOperation="saturation",n.fillStyle="rgba(255,255,255,"+s/255+")",n.fillRect(0,0,i,r)}var h=Math.max(0,a[0]),c=Math.max(0,a[1]),u=Math.max(0,a[2]);if(n.globalCompositeOperation="lighter",n.fillStyle=Utils.rgbToCssColor(h,c,u),n.fillRect(0,0,i,r),Graphics.canUseDifferenceBlend()){n.globalCompositeOperation="difference",n.fillStyle="white",n.fillRect(0,0,i,r);var p=Math.max(0,-a[0]),l=Math.max(0,-a[1]),d=Math.max(0,-a[2]);n.globalCompositeOperation="lighter",n.fillStyle=Utils.rgbToCssColor(p,l,d),n.fillRect(0,0,i,r),n.globalCompositeOperation="difference",n.fillStyle="white",n.fillRect(0,0,i,r)}var m=Math.max(0,o[0]),f=Math.max(0,o[1]),_=Math.max(0,o[2]),y=Math.max(0,o[3]);n.globalCompositeOperation="source-atop",n.fillStyle=Utils.rgbToCssColor(m,f,_),n.globalAlpha=y/255,n.fillRect(0,0,i,r),n.globalCompositeOperation="destination-in",n.globalAlpha=1,n.drawImage(this._bitmap.canvas,t,e,i,r,0,0,i,r)},Sprite.prototype._renderCanvas_PIXI=PIXI.Sprite.prototype._renderCanvas,Sprite.prototype._renderWebGL_PIXI=PIXI.Sprite.prototype._renderWebGL,Sprite.prototype._renderCanvas=function(t){this.bitmap&&this.bitmap.touch(),this.bitmap&&!this.bitmap.isReady()||this.texture.frame.width>0&&this.texture.frame.height>0&&this._renderCanvas_PIXI(t)},Sprite.prototype._speedUpCustomBlendModes=function(t){if(t.renderingToScreen&&t._activeRenderTarget.root&&t.plugins.picture.drawModes[this.blendMode]){var e=t._lastObjectRendered,i=e._filters;i&&i[0]||setTimeout(function(){var t=e._filters;t&&t[0]||(e.filters=[Sprite.voidFilter],e.filterArea=new PIXI.Rectangle(0,0,Graphics.width,Graphics.height))},0)}},Sprite.prototype._renderWebGL=function(t){this.bitmap&&this.bitmap.touch(),this.bitmap&&!this.bitmap.isReady()||this.texture.frame.width>0&&this.texture.frame.height>0&&(this._bitmap&&this._bitmap.checkDirty(),this.calculateVertices(),"sprite"===this.pluginName&&this._isPicture?(this._speedUpCustomBlendModes(t),t.setObjectRenderer(t.plugins.picture),t.plugins.picture.render(this)):(t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)))},Tilemap.prototype=Object.create(PIXI.Container.prototype),Tilemap.prototype.constructor=Tilemap,Tilemap.prototype.initialize=function(){PIXI.Container.call(this),this._margin=20,this._width=Graphics.width+2*this._margin,this._height=Graphics.height+2*this._margin,this._tileWidth=48,this._tileHeight=48,this._mapWidth=0,this._mapHeight=0,this._mapData=null,this._layerWidth=0,this._layerHeight=0,this._lastTiles=[],this.bitmaps=[],this.origin=new Point,this.flags=[],this.animationCount=0,this.horizontalWrap=!1,this.verticalWrap=!1,this._createLayers(),this.refresh()},Object.defineProperty(Tilemap.prototype,"width",{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._createLayers())}}),Object.defineProperty(Tilemap.prototype,"height",{get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this._createLayers())}}),Object.defineProperty(Tilemap.prototype,"tileWidth",{get:function(){return this._tileWidth},set:function(t){this._tileWidth!==t&&(this._tileWidth=t,this._createLayers())}}),Object.defineProperty(Tilemap.prototype,"tileHeight",{get:function(){return this._tileHeight},set:function(t){this._tileHeight!==t&&(this._tileHeight=t,this._createLayers())}}),Tilemap.prototype.setData=function(t,e,i){this._mapWidth=t,this._mapHeight=e,this._mapData=i},Tilemap.prototype.isReady=function(){for(var t=0;t<this.bitmaps.length;t++)if(this.bitmaps[t]&&!this.bitmaps[t].isReady())return!1;return!0},Tilemap.prototype.update=function(){this.animationCount++,this.animationFrame=Math.floor(this.animationCount/30),this.children.forEach(function(t){t.update&&t.update()});for(var t=0;t<this.bitmaps.length;t++)this.bitmaps[t]&&this.bitmaps[t].touch()},Tilemap.prototype.refresh=function(){this._lastTiles.length=0},Tilemap.prototype.refreshTileset=function(){},Tilemap.prototype.updateTransform=function(){var t=Math.floor(this.origin.x),e=Math.floor(this.origin.y),i=Math.floor((t-this._margin)/this._tileWidth),r=Math.floor((e-this._margin)/this._tileHeight);this._updateLayerPositions(i,r),(this._needsRepaint||this._lastAnimationFrame!==this.animationFrame||this._lastStartX!==i||this._lastStartY!==r)&&(this._frameUpdated=this._lastAnimationFrame!==this.animationFrame,this._lastAnimationFrame=this.animationFrame,this._lastStartX=i,this._lastStartY=r,this._paintAllTiles(i,r),this._needsRepaint=!1),this._sortChildren(),PIXI.Container.prototype.updateTransform.call(this)},Tilemap.prototype._createLayers=function(){var t=this._width,e=this._height,i=this._margin,r=Math.ceil(t/this._tileWidth)+1,n=Math.ceil(e/this._tileHeight)+1,a=r*this._tileWidth,o=n*this._tileHeight;this._lowerBitmap=new Bitmap(a,o),this._upperBitmap=new Bitmap(a,o),this._layerWidth=a,this._layerHeight=o,this._lowerLayer=new Sprite,this._lowerLayer.move(-i,-i,t,e),this._lowerLayer.z=0,this._upperLayer=new Sprite,this._upperLayer.move(-i,-i,t,e),this._upperLayer.z=4;for(var s=0;s<4;s++)this._lowerLayer.addChild(new Sprite(this._lowerBitmap)),this._upperLayer.addChild(new Sprite(this._upperBitmap));this.addChild(this._lowerLayer),this.addChild(this._upperLayer)},Tilemap.prototype._updateLayerPositions=function(t,e){for(var i=this._margin,r=Math.floor(this.origin.x),n=Math.floor(this.origin.y),a=(r-i).mod(this._layerWidth),o=(n-i).mod(this._layerHeight),s=this._layerWidth-a,h=this._layerHeight-o,c=this._width-s,u=this._height-h,p=0;p<2;p++){var l;(l=0===p?this._lowerLayer.children:this._upperLayer.children)[0].move(0,0,s,h),l[0].setFrame(a,o,s,h),l[1].move(s,0,c,h),l[1].setFrame(0,o,c,h),l[2].move(0,h,s,u),l[2].setFrame(a,0,s,u),l[3].move(s,h,c,u),l[3].setFrame(0,0,c,u)}},Tilemap.prototype._paintAllTiles=function(t,e){for(var i=Math.ceil(this._width/this._tileWidth)+1,r=Math.ceil(this._height/this._tileHeight)+1,n=0;n<r;n++)for(var a=0;a<i;a++)this._paintTiles(t,e,a,n)},Tilemap.prototype._paintTiles=function(t,e,i,r){var n=t+i,a=e+r,o=(n*this._tileWidth).mod(this._layerWidth),s=(a*this._tileHeight).mod(this._layerHeight),h=o/this._tileWidth,c=s/this._tileHeight,u=this._readMapData(n,a,0),p=this._readMapData(n,a,1),l=this._readMapData(n,a,2),d=this._readMapData(n,a,3),m=this._readMapData(n,a,4),f=this._readMapData(n,a-1,1),_=[],y=[];this._isHigherTile(u)?y.push(u):_.push(u),this._isHigherTile(p)?y.push(p):_.push(p),_.push(-m),this._isTableTile(f)&&!this._isTableTile(p)&&(Tilemap.isShadowingTile(u)||_.push(1e4+f)),this._isOverpassPosition(n,a)?(y.push(l),y.push(d)):(this._isHigherTile(l)?y.push(l):_.push(l),this._isHigherTile(d)?y.push(d):_.push(d));var g=this._readLastTiles(0,h,c);if(!_.equals(g)||Tilemap.isTileA1(u)&&this._frameUpdated){this._lowerBitmap.clearRect(o,s,this._tileWidth,this._tileHeight);for(var v=0;v<_.length;v++){var w=_[v];w<0?this._drawShadow(this._lowerBitmap,m,o,s):w>=1e4?this._drawTableEdge(this._lowerBitmap,f,o,s):this._drawTile(this._lowerBitmap,w,o,s)}this._writeLastTiles(0,h,c,_)}var S=this._readLastTiles(1,h,c);if(!y.equals(S)){this._upperBitmap.clearRect(o,s,this._tileWidth,this._tileHeight);for(var b=0;b<y.length;b++)this._drawTile(this._upperBitmap,y[b],o,s);this._writeLastTiles(1,h,c,y)}},Tilemap.prototype._readLastTiles=function(t,e,i){var r=this._lastTiles[t];if(r){var n=r[i];if(n){var a=n[e];if(a)return a}}return[]},Tilemap.prototype._writeLastTiles=function(t,e,i,r){var n=this._lastTiles[t];n||(n=this._lastTiles[t]=[]);var a=n[i];a||(a=n[i]=[]),a[e]=r},Tilemap.prototype._drawTile=function(t,e,i,r){Tilemap.isVisibleTile(e)&&(Tilemap.isAutotile(e)?this._drawAutotile(t,e,i,r):this._drawNormalTile(t,e,i,r))},Tilemap.prototype._drawNormalTile=function(t,e,i,r){var n;n=Tilemap.isTileA5(e)?4:5+Math.floor(e/256);var a=this._tileWidth,o=this._tileHeight,s=(Math.floor(e/128)%2*8+e%8)*a,h=Math.floor(e%256/8)%16*o,c=this.bitmaps[n];c&&t.bltImage(c,s,h,a,o,i,r,a,o)},Tilemap.prototype._drawAutotile=function(t,e,i,r){var n=Tilemap.FLOOR_AUTOTILE_TABLE,a=Tilemap.getAutotileKind(e),o=Tilemap.getAutotileShape(e),s=a%8,h=Math.floor(a/8),c=0,u=0,p=0,l=!1;if(Tilemap.isTileA1(e)){var d=[0,1,2,1][this.animationFrame%4];p=0,0===a?(c=2*d,u=0):1===a?(c=2*d,u=3):2===a?(c=6,u=0):3===a?(c=6,u=3):(c=8*Math.floor(s/4),u=6*h+Math.floor(s/2)%2*3,a%2==0?c+=2*d:(c+=6,n=Tilemap.WATERFALL_AUTOTILE_TABLE,u+=this.animationFrame%3))}else Tilemap.isTileA2(e)?(p=1,c=2*s,u=3*(h-2),l=this._isTableTile(e)):Tilemap.isTileA3(e)?(p=2,c=2*s,u=2*(h-6),n=Tilemap.WALL_AUTOTILE_TABLE):Tilemap.isTileA4(e)&&(p=3,c=2*s,u=Math.floor(2.5*(h-10)+(h%2==1?.5:0)),h%2==1&&(n=Tilemap.WALL_AUTOTILE_TABLE));var m=n[o],f=this.bitmaps[p];if(m&&f)for(var _=this._tileWidth/2,y=this._tileHeight/2,g=0;g<4;g++){var v=m[g][0],w=m[g][1],S=(2*c+v)*_,b=(2*u+w)*y,x=i+g%2*_,T=r+Math.floor(g/2)*y;if(!l||1!==w&&5!==w)t.bltImage(f,S,b,_,y,x,T,_,y);else{var M=v;1===w&&(M=[0,3,2,1][v]),t.bltImage(f,(2*c+M)*_,(2*u+3)*y,_,y,x,T,_,y),t.bltImage(f,S,b,_,y/2,x,T+=y/2,_,y/2)}}},Tilemap.prototype._drawTableEdge=function(t,e,i,r){if(Tilemap.isTileA2(e)){var n=Tilemap.FLOOR_AUTOTILE_TABLE,a=Tilemap.getAutotileKind(e),o=Tilemap.getAutotileShape(e),s=a%8*2,h=3*(Math.floor(a/8)-2),c=n[o];if(c)for(var u=this.bitmaps[1],p=this._tileWidth/2,l=this._tileHeight/2,d=0;d<2;d++){var m=(2*s+c[2+d][0])*p,f=(2*h+c[2+d][1])*l+l/2,_=i+d%2*p,y=r+Math.floor(d/2)*l;t.bltImage(u,m,f,p,l/2,_,y,p,l/2)}}},Tilemap.prototype._drawShadow=function(t,e,i,r){if(15&e)for(var n=this._tileWidth/2,a=this._tileHeight/2,o=0;o<4;o++)if(e&1<<o){var s=i+o%2*n,h=r+Math.floor(o/2)*a;t.fillRect(s,h,n,a,"rgba(0,0,0,0.5)")}},Tilemap.prototype._readMapData=function(t,e,i){if(this._mapData){var r=this._mapWidth,n=this._mapHeight;return this.horizontalWrap&&(t=t.mod(r)),this.verticalWrap&&(e=e.mod(n)),t>=0&&t<r&&e>=0&&e<n&&this._mapData[(i*n+e)*r+t]||0}return 0},Tilemap.prototype._isHigherTile=function(t){return 16&this.flags[t]},Tilemap.prototype._isTableTile=function(t){return Tilemap.isTileA2(t)&&128&this.flags[t]},Tilemap.prototype._isOverpassPosition=function(t,e){return!1},Tilemap.prototype._sortChildren=function(){this.children.sort(this._compareChildOrder.bind(this))},Tilemap.prototype._compareChildOrder=function(t,e){return t.z!==e.z?t.z-e.z:t.y!==e.y?t.y-e.y:t.spriteId-e.spriteId},Tilemap.TILE_ID_B=0,Tilemap.TILE_ID_C=256,Tilemap.TILE_ID_D=512,Tilemap.TILE_ID_E=768,Tilemap.TILE_ID_A5=1536,Tilemap.TILE_ID_A1=2048,Tilemap.TILE_ID_A2=2816,Tilemap.TILE_ID_A3=4352,Tilemap.TILE_ID_A4=5888,Tilemap.TILE_ID_MAX=8192,Tilemap.isVisibleTile=function(t){return t>0&&t<this.TILE_ID_MAX},Tilemap.isAutotile=function(t){return t>=this.TILE_ID_A1},Tilemap.getAutotileKind=function(t){return Math.floor((t-this.TILE_ID_A1)/48)},Tilemap.getAutotileShape=function(t){return(t-this.TILE_ID_A1)%48},Tilemap.makeAutotileId=function(t,e){return this.TILE_ID_A1+48*t+e},Tilemap.isSameKindTile=function(t,e){return this.isAutotile(t)&&this.isAutotile(e)?this.getAutotileKind(t)===this.getAutotileKind(e):t===e},Tilemap.isTileA1=function(t){return t>=this.TILE_ID_A1&&t<this.TILE_ID_A2},Tilemap.isTileA2=function(t){return t>=this.TILE_ID_A2&&t<this.TILE_ID_A3},Tilemap.isTileA3=function(t){return t>=this.TILE_ID_A3&&t<this.TILE_ID_A4},Tilemap.isTileA4=function(t){return t>=this.TILE_ID_A4&&t<this.TILE_ID_MAX},Tilemap.isTileA5=function(t){return t>=this.TILE_ID_A5&&t<this.TILE_ID_A1},Tilemap.isWaterTile=function(t){return!(!this.isTileA1(t)||t>=this.TILE_ID_A1+96&&t<this.TILE_ID_A1+192)},Tilemap.isWaterfallTile=function(t){return t>=this.TILE_ID_A1+192&&t<this.TILE_ID_A2&&this.getAutotileKind(t)%2==1},Tilemap.isGroundTile=function(t){return this.isTileA1(t)||this.isTileA2(t)||this.isTileA5(t)},Tilemap.isShadowingTile=function(t){return this.isTileA3(t)||this.isTileA4(t)},Tilemap.isRoofTile=function(t){return this.isTileA3(t)&&this.getAutotileKind(t)%16<8},Tilemap.isWallTopTile=function(t){return this.isTileA4(t)&&this.getAutotileKind(t)%16<8},Tilemap.isWallSideTile=function(t){return(this.isTileA3(t)||this.isTileA4(t))&&this.getAutotileKind(t)%16>=8},Tilemap.isWallTile=function(t){return this.isWallTopTile(t)||this.isWallSideTile(t)},Tilemap.isFloorTypeAutotile=function(t){return this.isTileA1(t)&&!this.isWaterfallTile(t)||this.isTileA2(t)||this.isWallTopTile(t)},Tilemap.isWallTypeAutotile=function(t){return this.isRoofTile(t)||this.isWallSideTile(t)},Tilemap.isWaterfallTypeAutotile=function(t){return this.isWaterfallTile(t)},Tilemap.FLOOR_AUTOTILE_TABLE=[[[2,4],[1,4],[2,3],[1,3]],[[2,0],[1,4],[2,3],[1,3]],[[2,4],[3,0],[2,3],[1,3]],[[2,0],[3,0],[2,3],[1,3]],[[2,4],[1,4],[2,3],[3,1]],[[2,0],[1,4],[2,3],[3,1]],[[2,4],[3,0],[2,3],[3,1]],[[2,0],[3,0],[2,3],[3,1]],[[2,4],[1,4],[2,1],[1,3]],[[2,0],[1,4],[2,1],[1,3]],[[2,4],[3,0],[2,1],[1,3]],[[2,0],[3,0],[2,1],[1,3]],[[2,4],[1,4],[2,1],[3,1]],[[2,0],[1,4],[2,1],[3,1]],[[2,4],[3,0],[2,1],[3,1]],[[2,0],[3,0],[2,1],[3,1]],[[0,4],[1,4],[0,3],[1,3]],[[0,4],[3,0],[0,3],[1,3]],[[0,4],[1,4],[0,3],[3,1]],[[0,4],[3,0],[0,3],[3,1]],[[2,2],[1,2],[2,3],[1,3]],[[2,2],[1,2],[2,3],[3,1]],[[2,2],[1,2],[2,1],[1,3]],[[2,2],[1,2],[2,1],[3,1]],[[2,4],[3,4],[2,3],[3,3]],[[2,4],[3,4],[2,1],[3,3]],[[2,0],[3,4],[2,3],[3,3]],[[2,0],[3,4],[2,1],[3,3]],[[2,4],[1,4],[2,5],[1,5]],[[2,0],[1,4],[2,5],[1,5]],[[2,4],[3,0],[2,5],[1,5]],[[2,0],[3,0],[2,5],[1,5]],[[0,4],[3,4],[0,3],[3,3]],[[2,2],[1,2],[2,5],[1,5]],[[0,2],[1,2],[0,3],[1,3]],[[0,2],[1,2],[0,3],[3,1]],[[2,2],[3,2],[2,3],[3,3]],[[2,2],[3,2],[2,1],[3,3]],[[2,4],[3,4],[2,5],[3,5]],[[2,0],[3,4],[2,5],[3,5]],[[0,4],[1,4],[0,5],[1,5]],[[0,4],[3,0],[0,5],[1,5]],[[0,2],[3,2],[0,3],[3,3]],[[0,2],[1,2],[0,5],[1,5]],[[0,4],[3,4],[0,5],[3,5]],[[2,2],[3,2],[2,5],[3,5]],[[0,2],[3,2],[0,5],[3,5]],[[0,0],[1,0],[0,1],[1,1]]],Tilemap.WALL_AUTOTILE_TABLE=[[[2,2],[1,2],[2,1],[1,1]],[[0,2],[1,2],[0,1],[1,1]],[[2,0],[1,0],[2,1],[1,1]],[[0,0],[1,0],[0,1],[1,1]],[[2,2],[3,2],[2,1],[3,1]],[[0,2],[3,2],[0,1],[3,1]],[[2,0],[3,0],[2,1],[3,1]],[[0,0],[3,0],[0,1],[3,1]],[[2,2],[1,2],[2,3],[1,3]],[[0,2],[1,2],[0,3],[1,3]],[[2,0],[1,0],[2,3],[1,3]],[[0,0],[1,0],[0,3],[1,3]],[[2,2],[3,2],[2,3],[3,3]],[[0,2],[3,2],[0,3],[3,3]],[[2,0],[3,0],[2,3],[3,3]],[[0,0],[3,0],[0,3],[3,3]]],Tilemap.WATERFALL_AUTOTILE_TABLE=[[[2,0],[1,0],[2,1],[1,1]],[[0,0],[1,0],[0,1],[1,1]],[[2,0],[3,0],[2,1],[3,1]],[[0,0],[3,0],[0,1],[3,1]]],ShaderTilemap.prototype=Object.create(Tilemap.prototype),ShaderTilemap.prototype.constructor=ShaderTilemap,PIXI.glCore.VertexArrayObject.FORCE_NATIVE=!0,PIXI.settings.GC_MODE=PIXI.GC_MODES.AUTO,PIXI.tilemap.TileRenderer.SCALE_MODE=PIXI.SCALE_MODES.NEAREST,PIXI.tilemap.TileRenderer.DO_CLEAR=!0,ShaderTilemap.prototype._hackRenderer=function(t){var e=this.animationFrame%4;return 3==e&&(e=1),t.plugins.tilemap.tileAnim[0]=e*this._tileWidth,t.plugins.tilemap.tileAnim[1]=this.animationFrame%3*this._tileHeight,t},ShaderTilemap.prototype.renderCanvas=function(t){this._hackRenderer(t),PIXI.Container.prototype.renderCanvas.call(this,t)},ShaderTilemap.prototype.renderWebGL=function(t){this._hackRenderer(t),PIXI.Container.prototype.renderWebGL.call(this,t)},ShaderTilemap.prototype.refresh=function(){this._lastBitmapLength!==this.bitmaps.length&&(this._lastBitmapLength=this.bitmaps.length,this.refreshTileset()),this._needsRepaint=!0},ShaderTilemap.prototype.refreshTileset=function(){var t=this.bitmaps.map(function(t){return t._baseTexture?new PIXI.Texture(t._baseTexture):t});this.lowerLayer.setBitmaps(t),this.upperLayer.setBitmaps(t)},ShaderTilemap.prototype.updateTransform=function(){if(this.roundPixels)var t=Math.floor(this.origin.x),e=Math.floor(this.origin.y);else t=this.origin.x,e=this.origin.y;var i=Math.floor((t-this._margin)/this._tileWidth),r=Math.floor((e-this._margin)/this._tileHeight);this._updateLayerPositions(i,r),(this._needsRepaint||this._lastStartX!==i||this._lastStartY!==r)&&(this._lastStartX=i,this._lastStartY=r,this._paintAllTiles(i,r),this._needsRepaint=!1),this._sortChildren(),PIXI.Container.prototype.updateTransform.call(this)},ShaderTilemap.prototype._createLayers=function(){var t=this._height,e=Math.ceil(this._width/this._tileWidth)+1,i=Math.ceil(t/this._tileHeight)+1;if(this._layerWidth=e*this._tileWidth,this._layerHeight=i*this._tileHeight,this._needsRepaint=!0,!this.lowerZLayer){this.addChild(this.lowerZLayer=new PIXI.tilemap.ZLayer(this,0)),this.addChild(this.upperZLayer=new PIXI.tilemap.ZLayer(this,4));var r=PluginManager.parameters("ShaderTilemap"),n=Number(r.hasOwnProperty("squareShader")?r.squareShader:0);this.lowerZLayer.addChild(this.lowerLayer=new PIXI.tilemap.CompositeRectTileLayer(0,[],n)),this.lowerLayer.shadowColor=new Float32Array([0,0,0,.5]),this.upperZLayer.addChild(this.upperLayer=new PIXI.tilemap.CompositeRectTileLayer(4,[],n))}},ShaderTilemap.prototype._updateLayerPositions=function(t,e){if(this.roundPixels)var i=Math.floor(this.origin.x),r=Math.floor(this.origin.y);else i=this.origin.x,r=this.origin.y;this.lowerZLayer.position.x=t*this._tileWidth-i,this.lowerZLayer.position.y=e*this._tileHeight-r,this.upperZLayer.position.x=t*this._tileWidth-i,this.upperZLayer.position.y=e*this._tileHeight-r},ShaderTilemap.prototype._paintAllTiles=function(t,e){this.lowerZLayer.clear(),this.upperZLayer.clear();for(var i=Math.ceil(this._width/this._tileWidth)+1,r=Math.ceil(this._height/this._tileHeight)+1,n=0;n<r;n++)for(var a=0;a<i;a++)this._paintTiles(t,e,a,n)},ShaderTilemap.prototype._paintTiles=function(t,e,i,r){var n=t+i,a=e+r,o=i*this._tileWidth,s=r*this._tileHeight,h=this._readMapData(n,a,0),c=this._readMapData(n,a,1),u=this._readMapData(n,a,2),p=this._readMapData(n,a,3),l=this._readMapData(n,a,4),d=this._readMapData(n,a-1,1),m=this.lowerLayer.children[0],f=this.upperLayer.children[0];this._isHigherTile(h)?this._drawTile(f,h,o,s):this._drawTile(m,h,o,s),this._isHigherTile(c)?this._drawTile(f,c,o,s):this._drawTile(m,c,o,s),this._drawShadow(m,l,o,s),this._isTableTile(d)&&!this._isTableTile(c)&&(Tilemap.isShadowingTile(h)||this._drawTableEdge(m,d,o,s)),this._isOverpassPosition(n,a)?(this._drawTile(f,u,o,s),this._drawTile(f,p,o,s)):(this._isHigherTile(u)?this._drawTile(f,u,o,s):this._drawTile(m,u,o,s),this._isHigherTile(p)?this._drawTile(f,p,o,s):this._drawTile(m,p,o,s))},ShaderTilemap.prototype._drawTile=function(t,e,i,r){Tilemap.isVisibleTile(e)&&(Tilemap.isAutotile(e)?this._drawAutotile(t,e,i,r):this._drawNormalTile(t,e,i,r))},ShaderTilemap.prototype._drawNormalTile=function(t,e,i,r){var n;n=Tilemap.isTileA5(e)?4:5+Math.floor(e/256);var a=this._tileWidth,o=this._tileHeight,s=(Math.floor(e/128)%2*8+e%8)*a,h=Math.floor(e%256/8)%16*o;t.addRect(n,s,h,i,r,a,o)},ShaderTilemap.prototype._drawAutotile=function(t,e,i,r){var n=Tilemap.FLOOR_AUTOTILE_TABLE,a=Tilemap.getAutotileKind(e),o=Tilemap.getAutotileShape(e),s=a%8,h=Math.floor(a/8),c=0,u=0,p=0,l=!1,d=0,m=0;Tilemap.isTileA1(e)?(p=0,0===a?(d=2,u=0):1===a?(d=2,u=3):2===a?(c=6,u=0):3===a?(c=6,u=3):(c=8*Math.floor(s/4),u=6*h+Math.floor(s/2)%2*3,a%2==0?d=2:(c+=6,n=Tilemap.WATERFALL_AUTOTILE_TABLE,m=1))):Tilemap.isTileA2(e)?(p=1,c=2*s,u=3*(h-2),l=this._isTableTile(e)):Tilemap.isTileA3(e)?(p=2,c=2*s,u=2*(h-6),n=Tilemap.WALL_AUTOTILE_TABLE):Tilemap.isTileA4(e)&&(p=3,c=2*s,u=Math.floor(2.5*(h-10)+(h%2==1?.5:0)),h%2==1&&(n=Tilemap.WALL_AUTOTILE_TABLE));for(var f=n[o],_=this._tileWidth/2,y=this._tileHeight/2,g=0;g<4;g++){var v=f[g][0],w=f[g][1],S=(2*c+v)*_,b=(2*u+w)*y,x=i+g%2*_,T=r+Math.floor(g/2)*y;if(!l||1!==w&&5!==w)t.addRect(p,S,b,x,T,_,y,d,m);else{var M=v;1===w&&(M=(4-v)%4),t.addRect(p,(2*c+M)*_,(2*u+3)*y,x,T,_,y,d,m),t.addRect(p,S,b,x,T+y/2,_,y/2,d,m)}}},ShaderTilemap.prototype._drawTableEdge=function(t,e,i,r){if(Tilemap.isTileA2(e))for(var n=Tilemap.FLOOR_AUTOTILE_TABLE,a=Tilemap.getAutotileKind(e),o=Tilemap.getAutotileShape(e),s=a%8*2,h=3*(Math.floor(a/8)-2),c=n[o],u=this._tileWidth/2,p=this._tileHeight/2,l=0;l<2;l++){var d=(2*s+c[2+l][0])*u,m=(2*h+c[2+l][1])*p+p/2,f=i+l%2*u,_=r+Math.floor(l/2)*p;t.addRect(1,d,m,f,_,u,p/2)}},ShaderTilemap.prototype._drawShadow=function(t,e,i,r){if(15&e)for(var n=this._tileWidth/2,a=this._tileHeight/2,o=0;o<4;o++)if(e&1<<o){var s=i+o%2*n,h=r+Math.floor(o/2)*a;t.addRect(-1,0,0,s,h,n,a)}},TilingSprite.prototype=Object.create(PIXI.extras.PictureTilingSprite.prototype),TilingSprite.prototype.constructor=TilingSprite,TilingSprite.prototype.initialize=function(t){var e=new PIXI.Texture(new PIXI.BaseTexture);PIXI.extras.PictureTilingSprite.call(this,e),this._bitmap=null,this._width=0,this._height=0,this._frame=new Rectangle,this.spriteId=Sprite._counter++,this.origin=new Point,this.bitmap=t},TilingSprite.prototype._renderCanvas_PIXI=PIXI.extras.PictureTilingSprite.prototype._renderCanvas,TilingSprite.prototype._renderWebGL_PIXI=PIXI.extras.PictureTilingSprite.prototype._renderWebGL,TilingSprite.prototype._renderCanvas=function(t){this._bitmap&&this._bitmap.touch(),this.texture.frame.width>0&&this.texture.frame.height>0&&this._renderCanvas_PIXI(t)},TilingSprite.prototype._renderWebGL=function(t){this._bitmap&&this._bitmap.touch(),this.texture.frame.width>0&&this.texture.frame.height>0&&(this._bitmap&&this._bitmap.checkDirty(),this._renderWebGL_PIXI(t))},Object.defineProperty(TilingSprite.prototype,"bitmap",{get:function(){return this._bitmap},set:function(t){this._bitmap!==t&&(this._bitmap=t,this._bitmap?this._bitmap.addLoadListener(this._onBitmapLoad.bind(this)):this.texture.frame=Rectangle.emptyRectangle)},configurable:!0}),Object.defineProperty(TilingSprite.prototype,"opacity",{get:function(){return 255*this.alpha},set:function(t){this.alpha=t.clamp(0,255)/255},configurable:!0}),TilingSprite.prototype.update=function(){this.children.forEach(function(t){t.update&&t.update()})},TilingSprite.prototype.move=function(t,e,i,r){this.x=t||0,this.y=e||0,this._width=i||0,this._height=r||0},TilingSprite.prototype.setFrame=function(t,e,i,r){this._frame.x=t,this._frame.y=e,this._frame.width=i,this._frame.height=r,this._refresh()},TilingSprite.prototype.updateTransform=function(){this.tilePosition.x=Math.round(-this.origin.x),this.tilePosition.y=Math.round(-this.origin.y),this.updateTransformTS()},TilingSprite.prototype.updateTransformTS=PIXI.extras.TilingSprite.prototype.updateTransform,TilingSprite.prototype._onBitmapLoad=function(){this.texture.baseTexture=this._bitmap.baseTexture,this._refresh()},TilingSprite.prototype._refresh=function(){var t=this._frame.clone();0===t.width&&0===t.height&&this._bitmap&&(t.width=this._bitmap.width,t.height=this._bitmap.height),this.texture.frame=t,this.texture._updateID++,this.tilingTexture=null},TilingSprite.prototype._speedUpCustomBlendModes=Sprite.prototype._speedUpCustomBlendModes,TilingSprite.prototype._renderWebGL=function(t){this._bitmap&&(this._bitmap.touch(),this._bitmap.checkDirty()),this._speedUpCustomBlendModes(t),this._renderWebGL_PIXI(t)},ScreenSprite.prototype=Object.create(PIXI.Container.prototype),ScreenSprite.prototype.constructor=ScreenSprite,ScreenSprite.prototype.initialize=function(){PIXI.Container.call(this),this._graphics=new PIXI.Graphics,this.addChild(this._graphics),this.opacity=0,this._red=-1,this._green=-1,this._blue=-1,this._colorText="",this.setBlack()},Object.defineProperty(ScreenSprite.prototype,"opacity",{get:function(){return 255*this.alpha},set:function(t){this.alpha=t.clamp(0,255)/255},configurable:!0}),ScreenSprite.YEPWarned=!1,ScreenSprite.warnYep=function(){ScreenSprite.YEPWarned||(console.log("Deprecation warning. Please update YEP_CoreEngine. ScreenSprite is not a sprite, it has graphics inside."),ScreenSprite.YEPWarned=!0)},Object.defineProperty(ScreenSprite.prototype,"anchor",{get:function(){return ScreenSprite.warnYep(),this.scale.x=1,this.scale.y=1,{x:0,y:0}},set:function(t){this.alpha=t.clamp(0,255)/255},configurable:!0}),Object.defineProperty(ScreenSprite.prototype,"blendMode",{get:function(){return this._graphics.blendMode},set:function(t){this._graphics.blendMode=t},configurable:!0}),ScreenSprite.prototype.setBlack=function(){this.setColor(0,0,0)},ScreenSprite.prototype.setWhite=function(){this.setColor(255,255,255)},ScreenSprite.prototype.setColor=function(t,e,i){if(this._red!==t||this._green!==e||this._blue!==i){t=Math.round(t||0).clamp(0,255),e=Math.round(e||0).clamp(0,255),i=Math.round(i||0).clamp(0,255),this._red=t,this._green=e,this._blue=i,this._colorText=Utils.rgbToCssColor(t,e,i);var r=this._graphics;r.clear(),r.beginFill(t<<16|e<<8|i,1),r.drawRect(5*-Graphics.width,5*-Graphics.height,10*Graphics.width,10*Graphics.height)}},Window.prototype=Object.create(PIXI.Container.prototype),Window.prototype.constructor=Window,Window.prototype.initialize=function(){PIXI.Container.call(this),this._isWindow=!0,this._windowskin=null,this._width=0,this._height=0,this._cursorRect=new Rectangle,this._openness=255,this._animationCount=0,this._padding=18,this._margin=4,this._colorTone=[0,0,0],this._windowSpriteContainer=null,this._windowBackSprite=null,this._windowCursorSprite=null,this._windowFrameSprite=null,this._windowContentsSprite=null,this._windowArrowSprites=[],this._windowPauseSignSprite=null,this._createAllParts(),this.origin=new Point,this.active=!0,this.downArrowVisible=!1,this.upArrowVisible=!1,this.pause=!1},Object.defineProperty(Window.prototype,"windowskin",{get:function(){return this._windowskin},set:function(t){this._windowskin!==t&&(this._windowskin=t,this._windowskin.addLoadListener(this._onWindowskinLoad.bind(this)))},configurable:!0}),Object.defineProperty(Window.prototype,"contents",{get:function(){return this._windowContentsSprite.bitmap},set:function(t){this._windowContentsSprite.bitmap=t},configurable:!0}),Object.defineProperty(Window.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refreshAllParts()},configurable:!0}),Object.defineProperty(Window.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refreshAllParts()},configurable:!0}),Object.defineProperty(Window.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding=t,this._refreshAllParts()},configurable:!0}),Object.defineProperty(Window.prototype,"margin",{get:function(){return this._margin},set:function(t){this._margin=t,this._refreshAllParts()},configurable:!0}),Object.defineProperty(Window.prototype,"opacity",{get:function(){return 255*this._windowSpriteContainer.alpha},set:function(t){this._windowSpriteContainer.alpha=t.clamp(0,255)/255},configurable:!0}),Object.defineProperty(Window.prototype,"backOpacity",{get:function(){return 255*this._windowBackSprite.alpha},set:function(t){this._windowBackSprite.alpha=t.clamp(0,255)/255},configurable:!0}),Object.defineProperty(Window.prototype,"contentsOpacity",{get:function(){return 255*this._windowContentsSprite.alpha},set:function(t){this._windowContentsSprite.alpha=t.clamp(0,255)/255},configurable:!0}),Object.defineProperty(Window.prototype,"openness",{get:function(){return this._openness},set:function(t){this._openness!==t&&(this._openness=t.clamp(0,255),this._windowSpriteContainer.scale.y=this._openness/255,this._windowSpriteContainer.y=this.height/2*(1-this._openness/255))},configurable:!0}),Window.prototype.update=function(){this.active&&this._animationCount++,this.children.forEach(function(t){t.update&&t.update()})},Window.prototype.move=function(t,e,i,r){this.x=t||0,this.y=e||0,this._width===i&&this._height===r||(this._width=i||0,this._height=r||0,this._refreshAllParts())},Window.prototype.isOpen=function(){return this._openness>=255},Window.prototype.isClosed=function(){return this._openness<=0},Window.prototype.setCursorRect=function(t,e,i,r){var n=Math.floor(t||0),a=Math.floor(e||0),o=Math.floor(i||0),s=Math.floor(r||0),h=this._cursorRect;h.x===n&&h.y===a&&h.width===o&&h.height===s||(this._cursorRect.x=n,this._cursorRect.y=a,this._cursorRect.width=o,this._cursorRect.height=s,this._refreshCursor())},Window.prototype.setTone=function(t,e,i){var r=this._colorTone;t===r[0]&&e===r[1]&&i===r[2]||(this._colorTone=[t,e,i],this._refreshBack())},Window.prototype.addChildToBack=function(t){var e=this.children.indexOf(this._windowSpriteContainer);return this.addChildAt(t,e+1)},Window.prototype.updateTransform=function(){this._updateCursor(),this._updateArrows(),this._updatePauseSign(),this._updateContents(),PIXI.Container.prototype.updateTransform.call(this)},Window.prototype._createAllParts=function(){this._windowSpriteContainer=new PIXI.Container,this._windowBackSprite=new Sprite,this._windowCursorSprite=new Sprite,this._windowFrameSprite=new Sprite,this._windowContentsSprite=new Sprite,this._downArrowSprite=new Sprite,this._upArrowSprite=new Sprite,this._windowPauseSignSprite=new Sprite,this._windowBackSprite.bitmap=new Bitmap(1,1),this._windowBackSprite.alpha=192/255,this.addChild(this._windowSpriteContainer),this._windowSpriteContainer.addChild(this._windowBackSprite),this._windowSpriteContainer.addChild(this._windowFrameSprite),this.addChild(this._windowCursorSprite),this.addChild(this._windowContentsSprite),this.addChild(this._downArrowSprite),this.addChild(this._upArrowSprite),this.addChild(this._windowPauseSignSprite)},Window.prototype._onWindowskinLoad=function(){this._refreshAllParts()},Window.prototype._refreshAllParts=function(){this._refreshBack(),this._refreshFrame(),this._refreshCursor(),this._refreshContents(),this._refreshArrows(),this._refreshPauseSign()},Window.prototype._refreshBack=function(){var t=this._margin,e=this._width-2*t,i=this._height-2*t,r=new Bitmap(e,i);if(this._windowBackSprite.bitmap=r,this._windowBackSprite.setFrame(0,0,e,i),this._windowBackSprite.move(t,t),e>0&&i>0&&this._windowskin){var n=96;r.blt(this._windowskin,0,0,n,n,0,0,e,i);for(var a=0;a<i;a+=n)for(var o=0;o<e;o+=n)r.blt(this._windowskin,0,n,n,n,o,a,n,n);var s=this._colorTone;r.adjustTone(s[0],s[1],s[2])}},Window.prototype._refreshFrame=function(){var t=this._width,e=this._height,i=24,r=new Bitmap(t,e);if(this._windowFrameSprite.bitmap=r,this._windowFrameSprite.setFrame(0,0,t,e),t>0&&e>0&&this._windowskin){var n=this._windowskin;r.blt(n,120,0,48,i,i,0,t-48,i),r.blt(n,120,72,48,i,i,e-i,t-48,i),r.blt(n,96,24,i,48,0,i,i,e-48),r.blt(n,168,24,i,48,t-i,i,i,e-48),r.blt(n,96,0,i,i,0,0,i,i),r.blt(n,168,0,i,i,t-i,0,i,i),r.blt(n,96,72,i,i,0,e-i,i,i),r.blt(n,168,72,i,i,t-i,e-i,i,i)}},Window.prototype._refreshCursor=function(){var t=this._padding,e=this._cursorRect.x+t-this.origin.x,i=this._cursorRect.y+t-this.origin.y,r=this._cursorRect.width,n=this._cursorRect.height,a=Math.max(e,t),o=Math.max(i,t),s=e-a,h=i-o,c=Math.min(r,this._width-t-a),u=Math.min(n,this._height-t-o),p=new Bitmap(c,u);if(this._windowCursorSprite.bitmap=p,this._windowCursorSprite.setFrame(0,0,c,u),this._windowCursorSprite.move(a,o),r>0&&n>0&&this._windowskin){var l=this._windowskin;p.blt(l,100,100,40,40,s+4,h+4,r-8,n-8),p.blt(l,100,96,40,4,s+4,h+0,r-8,4),p.blt(l,100,140,40,4,s+4,h+n-4,r-8,4),p.blt(l,96,100,4,40,s+0,h+4,4,n-8),p.blt(l,140,100,4,40,s+r-4,h+4,4,n-8),p.blt(l,96,96,4,4,s+0,h+0,4,4),p.blt(l,140,96,4,4,s+r-4,h+0,4,4),p.blt(l,96,140,4,4,s+0,h+n-4,4,4),p.blt(l,140,140,4,4,s+r-4,h+n-4,4,4)}},Window.prototype._refreshContents=function(){this._windowContentsSprite.move(this.padding,this.padding)},Window.prototype._refreshArrows=function(){var t=this._width,e=this._height;this._downArrowSprite.bitmap=this._windowskin,this._downArrowSprite.anchor.x=.5,this._downArrowSprite.anchor.y=.5,this._downArrowSprite.setFrame(132,60,24,12),this._downArrowSprite.move(t/2,e-12),this._upArrowSprite.bitmap=this._windowskin,this._upArrowSprite.anchor.x=.5,this._upArrowSprite.anchor.y=.5,this._upArrowSprite.setFrame(132,24,24,12),this._upArrowSprite.move(t/2,12)},Window.prototype._refreshPauseSign=function(){this._windowPauseSignSprite.bitmap=this._windowskin,this._windowPauseSignSprite.anchor.x=.5,this._windowPauseSignSprite.anchor.y=1,this._windowPauseSignSprite.move(this._width/2,this._height),this._windowPauseSignSprite.setFrame(144,96,24,24),this._windowPauseSignSprite.alpha=0},Window.prototype._updateCursor=function(){var t=this._animationCount%40,e=this.contentsOpacity;this.active&&(e-=t<20?8*t:8*(40-t)),this._windowCursorSprite.alpha=e/255,this._windowCursorSprite.visible=this.isOpen()},Window.prototype._updateContents=function(){var t=this._width-2*this._padding,e=this._height-2*this._padding;t>0&&e>0?(this._windowContentsSprite.setFrame(this.origin.x,this.origin.y,t,e),this._windowContentsSprite.visible=this.isOpen()):this._windowContentsSprite.visible=!1},Window.prototype._updateArrows=function(){this._downArrowSprite.visible=this.isOpen()&&this.downArrowVisible,this._upArrowSprite.visible=this.isOpen()&&this.upArrowVisible},Window.prototype._updatePauseSign=function(){var t=this._windowPauseSignSprite,e=Math.floor(this._animationCount/16)%2,i=Math.floor(this._animationCount/16/2)%2;this.pause?t.alpha<1&&(t.alpha=Math.min(t.alpha+.1,1)):t.alpha=0,t.setFrame(144+24*e,96+24*i,24,24),t.visible=this.isOpen()},WindowLayer.prototype=Object.create(PIXI.Container.prototype),WindowLayer.prototype.constructor=WindowLayer,WindowLayer.prototype.initialize=function(){PIXI.Container.call(this),this._width=0,this._height=0,this._tempCanvas=null,this._translationMatrix=[1,0,0,0,1,0,0,0,1],this._windowMask=new PIXI.Graphics,this._windowMask.beginFill(16777215,1),this._windowMask.drawRect(0,0,0,0),this._windowMask.endFill(),this._windowRect=this._windowMask.graphicsData[0].shape,this._renderSprite=null,this.filterArea=new PIXI.Rectangle,this.filters=[WindowLayer.voidFilter],this.on("removed",this.onRemoveAsAChild)},WindowLayer.prototype.onRemoveAsAChild=function(){this.removeChildren()},WindowLayer.voidFilter=new PIXI.filters.VoidFilter,Object.defineProperty(WindowLayer.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},configurable:!0}),Object.defineProperty(WindowLayer.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},configurable:!0}),WindowLayer.prototype.move=function(t,e,i,r){this.x=t,this.y=e,this.width=i,this.height=r},WindowLayer.prototype.update=function(){this.children.forEach(function(t){t.update&&t.update()})},WindowLayer.prototype.renderCanvas=function(t){if(this.visible&&this.renderable){this._tempCanvas||(this._tempCanvas=document.createElement("canvas")),this._tempCanvas.width=Graphics.width,this._tempCanvas.height=Graphics.height;var e=t.context,i=this._tempCanvas.getContext("2d");i.save(),i.clearRect(0,0,Graphics.width,Graphics.height),i.beginPath(),i.rect(this.x,this.y,this.width,this.height),i.closePath(),i.clip(),t.context=i;for(var r=0;r<this.children.length;r++){var n=this.children[r];n._isWindow&&n.visible&&n.openness>0&&(this._canvasClearWindowRect(t,n),i.save(),n.renderCanvas(t),i.restore())}i.restore(),t.context=e,t.context.setTransform(1,0,0,1,0,0),t.context.globalCompositeOperation="source-over",t.context.globalAlpha=1,t.context.drawImage(this._tempCanvas,0,0);for(var a=0;a<this.children.length;a++)this.children[a]._isWindow||this.children[a].renderCanvas(t)}},WindowLayer.prototype._canvasClearWindowRect=function(t,e){t.context.clearRect(this.x+e.x,this.y+e.y+e.height/2*(1-e._openness/255),e.width,e.height*e._openness/255)},WindowLayer.prototype.renderWebGL=function(t){if(this.visible&&this.renderable&&0!=this.children.length){t.flush(),this.filterArea.copy(this),t.filterManager.pushFilter(this,this.filters),t.currentRenderer.start();var e=new PIXI.Point,i=t._activeRenderTarget,r=i.projectionMatrix;e.x=Math.round((r.tx+1)/2*i.sourceFrame.width),e.y=Math.round((r.ty+1)/2*i.sourceFrame.height);for(var n=0;n<this.children.length;n++){var a=this.children[n];a._isWindow&&a.visible&&a.openness>0&&(this._maskWindow(a,e),t.maskManager.pushScissorMask(this,this._windowMask),t.clear(),t.maskManager.popScissorMask(),t.currentRenderer.start(),a.renderWebGL(t),t.currentRenderer.flush())}t.flush(),t.filterManager.popFilter(),t.maskManager.popScissorMask();for(var o=0;o<this.children.length;o++)this.children[o]._isWindow||this.children[o].renderWebGL(t)}},WindowLayer.prototype._maskWindow=function(t,e){this._windowMask._currentBounds=null,this._windowMask.boundsDirty=!0;var i=this._windowRect;i.x=this.x+e.x+t.x,i.y=this.x+e.y+t.y+t.height/2*(1-t._openness/255),i.width=t.width,i.height=t.height*t._openness/255},Weather.prototype=Object.create(PIXI.Container.prototype),Weather.prototype.constructor=Weather,Weather.prototype.initialize=function(){PIXI.Container.call(this),this._width=Graphics.width,this._height=Graphics.height,this._sprites=[],this._createBitmaps(),this._createDimmer(),this.type="none",this.power=0,this.origin=new Point},Weather.prototype.update=function(){this._updateDimmer(),this._updateAllSprites()},Weather.prototype._createBitmaps=function(){this._rainBitmap=new Bitmap(1,60),this._rainBitmap.fillAll("white"),this._stormBitmap=new Bitmap(2,100),this._stormBitmap.fillAll("white"),this._snowBitmap=new Bitmap(9,9),this._snowBitmap.drawCircle(4,4,4,"white")},Weather.prototype._createDimmer=function(){this._dimmerSprite=new ScreenSprite,this._dimmerSprite.setColor(80,80,80),this.addChild(this._dimmerSprite)},Weather.prototype._updateDimmer=function(){this._dimmerSprite.opacity=Math.floor(6*this.power)},Weather.prototype._updateAllSprites=function(){for(var t=Math.floor(10*this.power);this._sprites.length<t;)this._addSprite();for(;this._sprites.length>t;)this._removeSprite();this._sprites.forEach(function(t){this._updateSprite(t),t.x=t.ax-this.origin.x,t.y=t.ay-this.origin.y},this)},Weather.prototype._addSprite=function(){var t=new Sprite(this.viewport);t.opacity=0,this._sprites.push(t),this.addChild(t)},Weather.prototype._removeSprite=function(){this.removeChild(this._sprites.pop())},Weather.prototype._updateSprite=function(t){switch(this.type){case"rain":this._updateRainSprite(t);break;case"storm":this._updateStormSprite(t);break;case"snow":this._updateSnowSprite(t)}t.opacity<40&&this._rebornSprite(t)},Weather.prototype._updateRainSprite=function(t){t.bitmap=this._rainBitmap,t.rotation=Math.PI/16,t.ax-=6*Math.sin(t.rotation),t.ay+=6*Math.cos(t.rotation),t.opacity-=6},Weather.prototype._updateStormSprite=function(t){t.bitmap=this._stormBitmap,t.rotation=Math.PI/8,t.ax-=8*Math.sin(t.rotation),t.ay+=8*Math.cos(t.rotation),t.opacity-=8},Weather.prototype._updateSnowSprite=function(t){t.bitmap=this._snowBitmap,t.rotation=Math.PI/16,t.ax-=3*Math.sin(t.rotation),t.ay+=3*Math.cos(t.rotation),t.opacity-=3},Weather.prototype._rebornSprite=function(t){t.ax=Math.randomInt(Graphics.width+100)-100+this.origin.x,t.ay=Math.randomInt(Graphics.height+200)-200+this.origin.y,t.opacity=160+Math.randomInt(60)},ToneFilter.prototype=Object.create(PIXI.filters.ColorMatrixFilter.prototype),ToneFilter.prototype.constructor=ToneFilter,ToneFilter.prototype.adjustHue=function(t){this.hue(t,!0)},ToneFilter.prototype.adjustSaturation=function(t){t=(t||0).clamp(-255,255)/255,this.saturate(t,!0)},ToneFilter.prototype.adjustTone=function(t,e,i){t=(t||0).clamp(-255,255)/255,e=(e||0).clamp(-255,255)/255,i=(i||0).clamp(-255,255)/255,(0!==t||0!==e||0!==i)&&this._loadMatrix([1,0,0,t,0,0,1,0,e,0,0,0,1,i,0,0,0,0,1,0],!0)},ToneSprite.prototype=Object.create(PIXI.Container.prototype),ToneSprite.prototype.constructor=ToneSprite,ToneSprite.prototype.initialize=function(){PIXI.Container.call(this),this.clear()},ToneSprite.prototype.clear=function(){this._red=0,this._green=0,this._blue=0,this._gray=0},ToneSprite.prototype.setTone=function(t,e,i,r){this._red=Math.round(t||0).clamp(-255,255),this._green=Math.round(e||0).clamp(-255,255),this._blue=Math.round(i||0).clamp(-255,255),this._gray=Math.round(r||0).clamp(0,255)},ToneSprite.prototype._renderCanvas=function(t){if(this.visible){var e=t.context,i=this.worldTransform,r=t.resolution,n=Graphics.width,a=Graphics.height;e.save(),e.setTransform(i.a,i.b,i.c,i.d,i.tx*r,i.ty*r),Graphics.canUseSaturationBlend()&&this._gray>0&&(e.globalCompositeOperation="saturation",e.globalAlpha=this._gray/255,e.fillStyle="#ffffff",e.fillRect(0,0,n,a)),e.globalAlpha=1;var o=Math.max(0,this._red),s=Math.max(0,this._green),h=Math.max(0,this._blue);if((o||s||h)&&(e.globalCompositeOperation="lighter",e.fillStyle=Utils.rgbToCssColor(o,s,h),e.fillRect(0,0,n,a)),Graphics.canUseDifferenceBlend()){var c=Math.max(0,-this._red),u=Math.max(0,-this._green),p=Math.max(0,-this._blue);(c||u||p)&&(e.globalCompositeOperation="difference",e.fillStyle="#ffffff",e.fillRect(0,0,n,a),e.globalCompositeOperation="lighter",e.fillStyle=Utils.rgbToCssColor(c,u,p),e.fillRect(0,0,n,a),e.globalCompositeOperation="difference",e.fillStyle="#ffffff",e.fillRect(0,0,n,a))}e.restore()}},ToneSprite.prototype._renderWebGL=function(t){},Stage.prototype=Object.create(PIXI.Container.prototype),Stage.prototype.constructor=Stage,Stage.prototype.initialize=function(){PIXI.Container.call(this),this.interactive=!1},WebAudio._standAlone=function(t){return!t.ResourceHandler}(this),WebAudio.prototype.initialize=function(t){WebAudio._initialized||WebAudio.initialize(),this.clear(),WebAudio._standAlone||(this._loader=ResourceHandler.createLoader(t,this._load.bind(this,t),(function(){this._hasError=!0}).bind(this))),this._load(t),this._url=t},WebAudio._masterVolume=1,WebAudio._context=null,WebAudio._masterGainNode=null,WebAudio._initialized=!1,WebAudio._unlocked=!1,WebAudio.initialize=function(t){return this._initialized||(t||(this._createContext(),this._detectCodecs(),this._createMasterGainNode(),this._setupEventHandlers()),this._initialized=!0),!!this._context},WebAudio.canPlayOgg=function(){return this._initialized||this.initialize(),!!this._canPlayOgg},WebAudio.canPlayM4a=function(){return this._initialized||this.initialize(),!!this._canPlayM4a},WebAudio.setMasterVolume=function(t){this._masterVolume=t,this._masterGainNode&&this._masterGainNode.gain.setValueAtTime(this._masterVolume,this._context.currentTime)},WebAudio._createContext=function(){try{"undefined"!=typeof AudioContext?this._context=new AudioContext:"undefined"!=typeof webkitAudioContext&&(this._context=new webkitAudioContext)}catch(t){this._context=null}},WebAudio._detectCodecs=function(){var t=document.createElement("audio");t.canPlayType&&(this._canPlayOgg=t.canPlayType("audio/ogg"),this._canPlayM4a=t.canPlayType("audio/mp4"))},WebAudio._createMasterGainNode=function(){var t=WebAudio._context;t&&(this._masterGainNode=t.createGain(),this._masterGainNode.gain.setValueAtTime(this._masterVolume,t.currentTime),this._masterGainNode.connect(t.destination))},WebAudio._setupEventHandlers=function(){var t=function(){var t=WebAudio._context;t&&"suspended"===t.state&&"function"==typeof t.resume?t.resume().then(function(){WebAudio._onTouchStart()}):WebAudio._onTouchStart()};document.addEventListener("keydown",t),document.addEventListener("mousedown",t),document.addEventListener("touchend",t),document.addEventListener("touchstart",this._onTouchStart.bind(this)),document.addEventListener("visibilitychange",this._onVisibilityChange.bind(this))},WebAudio._onTouchStart=function(){var t=WebAudio._context;t&&!this._unlocked&&(t.createBufferSource().start(0),this._unlocked=!0)},WebAudio._onVisibilityChange=function(){"hidden"===document.visibilityState?this._onHide():this._onShow()},WebAudio._onHide=function(){this._shouldMuteOnHide()&&this._fadeOut(1)},WebAudio._onShow=function(){this._shouldMuteOnHide()&&this._fadeIn(.5)},WebAudio._shouldMuteOnHide=function(){return Utils.isMobileDevice()},WebAudio._fadeIn=function(t){if(this._masterGainNode){var e=this._masterGainNode.gain,i=WebAudio._context.currentTime;e.setValueAtTime(0,i),e.linearRampToValueAtTime(this._masterVolume,i+t)}},WebAudio._fadeOut=function(t){if(this._masterGainNode){var e=this._masterGainNode.gain,i=WebAudio._context.currentTime;e.setValueAtTime(this._masterVolume,i),e.linearRampToValueAtTime(0,i+t)}},WebAudio.prototype.clear=function(){this.stop(),this._buffer=null,this._sourceNode=null,this._gainNode=null,this._pannerNode=null,this._totalTime=0,this._sampleRate=0,this._loopStart=0,this._loopLength=0,this._startTime=0,this._volume=1,this._pitch=1,this._pan=0,this._endTimer=null,this._loadListeners=[],this._stopListeners=[],this._hasError=!1,this._autoPlay=!1},Object.defineProperty(WebAudio.prototype,"url",{get:function(){return this._url},configurable:!0}),Object.defineProperty(WebAudio.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this._gainNode&&this._gainNode.gain.setValueAtTime(this._volume,WebAudio._context.currentTime)},configurable:!0}),Object.defineProperty(WebAudio.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._pitch!==t&&(this._pitch=t,this.isPlaying()&&this.play(this._sourceNode.loop,0))},configurable:!0}),Object.defineProperty(WebAudio.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=t,this._updatePanner()},configurable:!0}),WebAudio.prototype.isReady=function(){return!!this._buffer},WebAudio.prototype.isError=function(){return this._hasError},WebAudio.prototype.isPlaying=function(){return!!this._sourceNode},WebAudio.prototype.play=function(t,e){this.isReady()?this._startPlaying(t,e=e||0):WebAudio._context&&(this._autoPlay=!0,this.addLoadListener((function(){this._autoPlay&&this.play(t,e)}).bind(this)))},WebAudio.prototype.stop=function(){if(this._autoPlay=!1,this._removeEndTimer(),this._removeNodes(),this._stopListeners)for(;this._stopListeners.length>0;)this._stopListeners.shift()()},WebAudio.prototype.fadeIn=function(t){if(this.isReady()){if(this._gainNode){var e=this._gainNode.gain,i=WebAudio._context.currentTime;e.setValueAtTime(0,i),e.linearRampToValueAtTime(this._volume,i+t)}}else this._autoPlay&&this.addLoadListener((function(){this.fadeIn(t)}).bind(this))},WebAudio.prototype.fadeOut=function(t){if(this._gainNode){var e=this._gainNode.gain,i=WebAudio._context.currentTime;e.setValueAtTime(this._volume,i),e.linearRampToValueAtTime(0,i+t)}this._autoPlay=!1},WebAudio.prototype.seek=function(){if(WebAudio._context){var t=(WebAudio._context.currentTime-this._startTime)*this._pitch;if(this._loopLength>0)for(;t>=this._loopStart+this._loopLength;)t-=this._loopLength;return t}return 0},WebAudio.prototype.addLoadListener=function(t){this._loadListeners.push(t)},WebAudio.prototype.addStopListener=function(t){this._stopListeners.push(t)},WebAudio.prototype._load=function(t){if(WebAudio._context){var e=new XMLHttpRequest;Decrypter.hasEncryptedAudio&&(t=Decrypter.extToEncryptExt(t)),e.open("GET",t),e.responseType="arraybuffer",e.onload=(function(){e.status<400&&this._onXhrLoad(e)}).bind(this),e.onerror=this._loader||(function(){this._hasError=!0}).bind(this),e.send()}},WebAudio.prototype._onXhrLoad=function(t){var e=t.response;Decrypter.hasEncryptedAudio&&(e=Decrypter.decryptArrayBuffer(e)),this._readLoopComments(new Uint8Array(e)),WebAudio._context.decodeAudioData(e,(function(t){this._buffer=t,this._totalTime=t.duration,this._loopLength>0&&this._sampleRate>0?(this._loopStart/=this._sampleRate,this._loopLength/=this._sampleRate):(this._loopStart=0,this._loopLength=this._totalTime),this._onLoad()}).bind(this))},WebAudio.prototype._startPlaying=function(t,e){if(this._loopLength>0)for(;e>=this._loopStart+this._loopLength;)e-=this._loopLength;this._removeEndTimer(),this._removeNodes(),this._createNodes(),this._connectNodes(),this._sourceNode.loop=t,this._sourceNode.start(0,e),this._startTime=WebAudio._context.currentTime-e/this._pitch,this._createEndTimer()},WebAudio.prototype._createNodes=function(){var t=WebAudio._context;this._sourceNode=t.createBufferSource(),this._sourceNode.buffer=this._buffer,this._sourceNode.loopStart=this._loopStart,this._sourceNode.loopEnd=this._loopStart+this._loopLength,this._sourceNode.playbackRate.setValueAtTime(this._pitch,t.currentTime),this._gainNode=t.createGain(),this._gainNode.gain.setValueAtTime(this._volume,t.currentTime),this._pannerNode=t.createPanner(),this._pannerNode.panningModel="equalpower",this._updatePanner()},WebAudio.prototype._connectNodes=function(){this._sourceNode.connect(this._gainNode),this._gainNode.connect(this._pannerNode),this._pannerNode.connect(WebAudio._masterGainNode)},WebAudio.prototype._removeNodes=function(){this._sourceNode&&(this._sourceNode.stop(0),this._sourceNode=null,this._gainNode=null,this._pannerNode=null)},WebAudio.prototype._createEndTimer=function(){if(this._sourceNode&&!this._sourceNode.loop){var t=this._startTime+this._totalTime/this._pitch-WebAudio._context.currentTime;this._endTimer=setTimeout((function(){this.stop()}).bind(this),1e3*t)}},WebAudio.prototype._removeEndTimer=function(){this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null)},WebAudio.prototype._updatePanner=function(){if(this._pannerNode){var t=this._pan,e=1-Math.abs(t);this._pannerNode.setPosition(t,0,e)}},WebAudio.prototype._onLoad=function(){for(;this._loadListeners.length>0;)this._loadListeners.shift()()},WebAudio.prototype._readLoopComments=function(t){this._readOgg(t),this._readMp4(t)},WebAudio.prototype._readOgg=function(t){for(var e=0;e<t.length&&"OggS"===this._readFourCharacters(t,e);){e+=26;for(var i=!1,r=t[e++],n=[],a=0;a<r;a++)n.push(t[e++]);for(a=0;a<r;a++){if("vorb"===this._readFourCharacters(t,e+1)){var o=t[e];1===o?this._sampleRate=this._readLittleEndian(t,e+12):3===o&&this._readMetaData(t,e,n[a]),i=!0}e+=n[a]}if(!i)break}},WebAudio.prototype._readMp4=function(t){if("ftyp"===this._readFourCharacters(t,4))for(var e=0;e<t.length;){var i=this._readBigEndian(t,e),r=this._readFourCharacters(t,e+4);if("moov"===r)e+=8;else if("mvhd"===r&&(this._sampleRate=this._readBigEndian(t,e+20)),"udta"!==r&&"meta"!==r||this._readMetaData(t,e,i),e+=i,i<=1)break}},WebAudio.prototype._readMetaData=function(t,e,i){for(var r=e;r<e+i-10;r++)if("LOOP"===this._readFourCharacters(t,r)){for(var n="";t[r]>0;)n+=String.fromCharCode(t[r++]);if(n.match(/LOOPSTART=([0-9]+)/)&&(this._loopStart=parseInt(RegExp.$1)),n.match(/LOOPLENGTH=([0-9]+)/)&&(this._loopLength=parseInt(RegExp.$1)),"LOOPSTART"==n||"LOOPLENGTH"==n){var a="";for(r+=16;t[r]>0;)a+=String.fromCharCode(t[r++]);"LOOPSTART"==n?this._loopStart=parseInt(a):this._loopLength=parseInt(a)}}},WebAudio.prototype._readLittleEndian=function(t,e){return 16777216*t[e+3]+65536*t[e+2]+256*t[e+1]+t[e+0]},WebAudio.prototype._readBigEndian=function(t,e){return 16777216*t[e+0]+65536*t[e+1]+256*t[e+2]+t[e+3]},WebAudio.prototype._readFourCharacters=function(t,e){for(var i="",r=0;r<4;r++)i+=String.fromCharCode(t[e+r]);return i},Html5Audio._initialized=!1,Html5Audio._unlocked=!1,Html5Audio._audioElement=null,Html5Audio._gainTweenInterval=null,Html5Audio._tweenGain=0,Html5Audio._tweenTargetGain=0,Html5Audio._tweenGainStep=0,Html5Audio._staticSePath=null,Html5Audio.setup=function(t){this._initialized||this.initialize(),this.clear(),Decrypter.hasEncryptedAudio&&this._audioElement.src&&window.URL.revokeObjectURL(this._audioElement.src),this._url=t},Html5Audio.initialize=function(){if(!this._initialized){if(!this._audioElement)try{this._audioElement=new Audio}catch(t){this._audioElement=null}this._audioElement&&this._setupEventHandlers(),this._initialized=!0}return!!this._audioElement},Html5Audio._setupEventHandlers=function(){document.addEventListener("touchstart",this._onTouchStart.bind(this)),document.addEventListener("visibilitychange",this._onVisibilityChange.bind(this)),this._audioElement.addEventListener("loadeddata",this._onLoadedData.bind(this)),this._audioElement.addEventListener("error",this._onError.bind(this)),this._audioElement.addEventListener("ended",this._onEnded.bind(this))},Html5Audio._onTouchStart=function(){this._audioElement&&!this._unlocked&&(this._isLoading?(this._load(this._url),this._unlocked=!0):this._staticSePath&&(this._audioElement.src=this._staticSePath,this._audioElement.volume=0,this._audioElement.loop=!1,this._audioElement.play(),this._unlocked=!0))},Html5Audio._onVisibilityChange=function(){"hidden"===document.visibilityState?this._onHide():this._onShow()},Html5Audio._onLoadedData=function(){this._buffered=!0,this._unlocked&&this._onLoad()},Html5Audio._onError=function(){this._hasError=!0},Html5Audio._onEnded=function(){this._audioElement.loop||this.stop()},Html5Audio._onHide=function(){this._audioElement.volume=0,this._tweenGain=0},Html5Audio._onShow=function(){this.fadeIn(.5)},Html5Audio.clear=function(){this.stop(),this._volume=1,this._loadListeners=[],this._hasError=!1,this._autoPlay=!1,this._isLoading=!1,this._buffered=!1},Html5Audio.setStaticSe=function(t){this._initialized||(this.initialize(),this.clear()),this._staticSePath=t},Object.defineProperty(Html5Audio,"url",{get:function(){return Html5Audio._url},configurable:!0}),Object.defineProperty(Html5Audio,"volume",{get:(function(){return Html5Audio._volume}).bind(this),set:function(t){Html5Audio._volume=t,Html5Audio._audioElement&&(Html5Audio._audioElement.volume=this._volume)},configurable:!0}),Html5Audio.isReady=function(){return this._buffered},Html5Audio.isError=function(){return this._hasError},Html5Audio.isPlaying=function(){return!this._audioElement.paused},Html5Audio.play=function(t,e){this.isReady()?this._startPlaying(t,e=e||0):Html5Audio._audioElement&&(this._autoPlay=!0,this.addLoadListener((function(){this._autoPlay&&(this.play(t,e),this._gainTweenInterval&&(clearInterval(this._gainTweenInterval),this._gainTweenInterval=null))}).bind(this)),this._isLoading||this._load(this._url))},Html5Audio.stop=function(){this._audioElement&&this._audioElement.pause(),this._autoPlay=!1,this._tweenInterval&&(clearInterval(this._tweenInterval),this._tweenInterval=null,this._audioElement.volume=0)},Html5Audio.fadeIn=function(t){this.isReady()?this._audioElement&&(this._tweenTargetGain=this._volume,this._tweenGain=0,this._startGainTween(t)):this._autoPlay&&this.addLoadListener((function(){this.fadeIn(t)}).bind(this))},Html5Audio.fadeOut=function(t){this._audioElement&&(this._tweenTargetGain=0,this._tweenGain=this._volume,this._startGainTween(t))},Html5Audio.seek=function(){return this._audioElement?this._audioElement.currentTime:0},Html5Audio.addLoadListener=function(t){this._loadListeners.push(t)},Html5Audio._load=function(t){this._audioElement&&(this._isLoading=!0,this._audioElement.src=t,this._audioElement.load())},Html5Audio._startPlaying=function(t,e){this._audioElement.loop=t,this._gainTweenInterval&&(clearInterval(this._gainTweenInterval),this._gainTweenInterval=null),this._audioElement&&(this._audioElement.volume=this._volume,this._audioElement.currentTime=e,this._audioElement.play())},Html5Audio._onLoad=function(){for(this._isLoading=!1;this._loadListeners.length>0;)this._loadListeners.shift()()},Html5Audio._startGainTween=function(t){this._audioElement.volume=this._tweenGain,this._gainTweenInterval&&(clearInterval(this._gainTweenInterval),this._gainTweenInterval=null),this._tweenGainStep=(this._tweenTargetGain-this._tweenGain)/(60*t),this._gainTweenInterval=setInterval(function(){Html5Audio._applyTweenValue(Html5Audio._tweenTargetGain)},1e3/60)},Html5Audio._applyTweenValue=function(t){Html5Audio._tweenGain+=Html5Audio._tweenGainStep,Html5Audio._tweenGain<0&&Html5Audio._tweenGainStep<0?Html5Audio._tweenGain=0:Html5Audio._tweenGain>t&&Html5Audio._tweenGainStep>0&&(Html5Audio._tweenGain=t),Math.abs(Html5Audio._tweenTargetGain-Html5Audio._tweenGain)<.01&&(Html5Audio._tweenGain=Html5Audio._tweenTargetGain,clearInterval(Html5Audio._gainTweenInterval),Html5Audio._gainTweenInterval=null),Html5Audio._audioElement.volume=Html5Audio._tweenGain},JsonEx.maxDepth=100,JsonEx._id=1,JsonEx._generateId=function(){return JsonEx._id++},JsonEx.stringify=function(t){var e=[];JsonEx._id=1;var i=JSON.stringify(this._encode(t,e,0));return this._cleanMetadata(t),this._restoreCircularReference(e),i},JsonEx._restoreCircularReference=function(t){t.forEach(function(t){t[1][t[0]]=t[2]})},JsonEx.parse=function(t){var e=[],i={},r=this._decode(JSON.parse(t),e,i);return this._cleanMetadata(r),this._linkCircularReference(r,e,i),r},JsonEx._linkCircularReference=function(t,e,i){e.forEach(function(t){t[1][t[0]]=i[t[2]]})},JsonEx._cleanMetadata=function(t){t&&(delete t["@"],delete t["@c"],"object"==typeof t&&Object.keys(t).forEach(function(e){var i=t[e];"object"==typeof i&&JsonEx._cleanMetadata(i)}))},JsonEx.makeDeepCopy=function(t){return this.parse(this.stringify(t))},JsonEx._encode=function(t,e,i){if(i=i||0,++i>=this.maxDepth)throw new Error("Object too deep");var r=Object.prototype.toString.call(t);if("[object Object]"===r||"[object Array]"===r){t["@c"]=JsonEx._generateId();var n=this._getConstructorName(t);for(var a in"Object"!==n&&"Array"!==n&&(t["@"]=n),t)t.hasOwnProperty(a)&&!a.match(/^@./)&&(t[a]&&"object"==typeof t[a]?t[a]["@c"]?(e.push([a,t,t[a]]),t[a]={"@r":t[a]["@c"]}):(t[a]=this._encode(t[a],e,i+1),t[a]instanceof Array&&(e.push([a,t,t[a]]),t[a]={"@c":t[a]["@c"],"@a":t[a]})):t[a]=this._encode(t[a],e,i+1))}return i--,t},JsonEx._decode=function(t,e,i){var r=Object.prototype.toString.call(t);if("[object Object]"===r||"[object Array]"===r){if(i[t["@c"]]=t,t["@"]){var n=window[t["@"]];n&&(t=this._resetPrototype(t,n.prototype))}for(var a in t)if(t.hasOwnProperty(a)){if(t[a]&&t[a]["@a"]){var o=t[a]["@a"];o["@c"]=t[a]["@c"],t[a]=o}t[a]&&t[a]["@r"]&&e.push([a,t,t[a]["@r"]]),t[a]=this._decode(t[a],e,i)}}return t},JsonEx._getConstructorName=function(t){var e=t.constructor.name;return void 0===e&&(e=/^\s*function\s*([A-Za-z0-9_$]*)/.exec(t.constructor)[1]),e},JsonEx._resetPrototype=function(t,e){if(void 0!==Object.setPrototypeOf)Object.setPrototypeOf(t,e);else if("__proto__"in t)t.__proto__=e;else{var i=Object.create(e);for(var r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);t=i}return t},Decrypter.hasEncryptedImages=!1,Decrypter.hasEncryptedAudio=!1,Decrypter._requestImgFile=[],Decrypter._headerlength=16,Decrypter._xhrOk=400,Decrypter._encryptionKey="",Decrypter._ignoreList=["img/system/Window.png"],Decrypter.SIGNATURE="5250474d56000000",Decrypter.VER="000301",Decrypter.REMAIN="0000000000",Decrypter.checkImgIgnore=function(t){for(var e=0;e<this._ignoreList.length;e++)if(t===this._ignoreList[e])return!0;return!1},Decrypter.decryptImg=function(t,e){t=this.extToEncryptExt(t);var i=new XMLHttpRequest;i.open("GET",t),i.responseType="arraybuffer",i.send(),i.onload=function(){if(this.status<Decrypter._xhrOk){var t=Decrypter.decryptArrayBuffer(i.response);e._image.src=Decrypter.createBlobUrl(t),e._image.addEventListener("load",e._loadListener=Bitmap.prototype._onLoad.bind(e)),e._image.addEventListener("error",e._errorListener=e._loader||Bitmap.prototype._onError.bind(e))}},i.onerror=function(){e._loader?e._loader():e._onError()}},Decrypter.decryptHTML5Audio=function(t,e,i){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="arraybuffer",r.send(),r.onload=function(){if(this.status<Decrypter._xhrOk){var t=Decrypter.decryptArrayBuffer(r.response),n=Decrypter.createBlobUrl(t);AudioManager.createDecryptBuffer(n,e,i)}}},Decrypter.cutArrayHeader=function(t,e){return t.slice(e)},Decrypter.decryptArrayBuffer=function(t){if(!t)return null;var e,i=new Uint8Array(t,0,this._headerlength),r=this.SIGNATURE+this.VER+this.REMAIN,n=new Uint8Array(16);for(e=0;e<this._headerlength;e++)n[e]=parseInt("0x"+r.substr(2*e,2),16);for(e=0;e<this._headerlength;e++)if(i[e]!==n[e])throw new Error("Header is wrong");t=this.cutArrayHeader(t,Decrypter._headerlength);var a=new DataView(t);if(this.readEncryptionkey(),t){var o=new Uint8Array(t);for(e=0;e<this._headerlength;e++)o[e]=o[e]^parseInt(Decrypter._encryptionKey[e],16),a.setUint8(e,o[e])}return t},Decrypter.createBlobUrl=function(t){var e=new Blob([t]);return window.URL.createObjectURL(e)},Decrypter.extToEncryptExt=function(t){var e,i=t.split(".").pop();return e="ogg"===i?".rpgmvo":"m4a"===i?".rpgmvm":"png"===i?".rpgmvp":i,t.slice(0,t.lastIndexOf(i)-1)+e},Decrypter.readEncryptionkey=function(){this._encryptionKey=$dataSystem.encryptionKey.split(/(.{2})/).filter(Boolean)},ResourceHandler._reloaders=[],ResourceHandler._defaultRetryInterval=[500,1e3,3e3],ResourceHandler.createLoader=function(t,e,i,r){r=r||this._defaultRetryInterval;var n=this._reloaders,a=0;return function(){a<r.length?(setTimeout(e,r[a]),a++):(i&&i(),t&&(0===n.length&&(Graphics.printLoadingError(t),SceneManager.stop()),n.push(function(){a=0,e()})))}},ResourceHandler.exists=function(){return this._reloaders.length>0},ResourceHandler.retry=function(){this._reloaders.length>0&&(Graphics.eraseLoadingError(),SceneManager.resume(),this._reloaders.forEach(function(t){t()}),this._reloaders.length=0)};var $dataActors=null,$dataClasses=null,$dataSkills=null,$dataItems=null,$dataWeapons=null,$dataArmors=null,$dataEnemies=null,$dataTroops=null,$dataStates=null,$dataAnimations=null,$dataTilesets=null,$dataCommonEvents=null,$dataSystem=null,$dataMapInfos=null,$dataMap=null,$gameTemp=null,$gameSystem=null,$gameScreen=null,$gameTimer=null,$gameMessage=null,$gameSwitches=null,$gameVariables=null,$gameSelfSwitches=null,$gameActors=null,$gameParty=null,$gameTroop=null,$gameMap=null,$gamePlayer=null,$testEvent=null;function ConfigManager(){throw new Error("This is a static class")}function StorageManager(){throw new Error("This is a static class")}function ImageManager(){throw new Error("This is a static class")}function AudioManager(){throw new Error("This is a static class")}function SoundManager(){throw new Error("This is a static class")}function TextManager(){throw new Error("This is a static class")}function SceneManager(){throw new Error("This is a static class")}function BattleManager(){throw new Error("This is a static class")}function PluginManager(){throw new Error("This is a static class")}function Game_Temp(){this.initialize.apply(this,arguments)}function Game_System(){this.initialize.apply(this,arguments)}function Game_Timer(){this.initialize.apply(this,arguments)}function Game_Message(){this.initialize.apply(this,arguments)}function Game_Switches(){this.initialize.apply(this,arguments)}function Game_Variables(){this.initialize.apply(this,arguments)}function Game_SelfSwitches(){this.initialize.apply(this,arguments)}function Game_Screen(){this.initialize.apply(this,arguments)}function Game_Picture(){this.initialize.apply(this,arguments)}function Game_Item(){this.initialize.apply(this,arguments)}function Game_Action(){this.initialize.apply(this,arguments)}function Game_ActionResult(){this.initialize.apply(this,arguments)}function Game_BattlerBase(){this.initialize.apply(this,arguments)}function Game_Battler(){this.initialize.apply(this,arguments)}function Game_Actor(){this.initialize.apply(this,arguments)}function Game_Enemy(){this.initialize.apply(this,arguments)}function Game_Actors(){this.initialize.apply(this,arguments)}function Game_Unit(){this.initialize.apply(this,arguments)}function Game_Party(){this.initialize.apply(this,arguments)}function Game_Troop(){this.initialize.apply(this,arguments)}function Game_Map(){this.initialize.apply(this,arguments)}function Game_CommonEvent(){this.initialize.apply(this,arguments)}function Game_CharacterBase(){this.initialize.apply(this,arguments)}function Game_Character(){this.initialize.apply(this,arguments)}function Game_Player(){this.initialize.apply(this,arguments)}function Game_Follower(){this.initialize.apply(this,arguments)}function Game_Followers(){this.initialize.apply(this,arguments)}function Game_Vehicle(){this.initialize.apply(this,arguments)}function Game_Event(){this.initialize.apply(this,arguments)}function Game_Interpreter(){this.initialize.apply(this,arguments)}function Scene_Base(){this.initialize.apply(this,arguments)}function Scene_Boot(){this.initialize.apply(this,arguments)}function Scene_Title(){this.initialize.apply(this,arguments)}function Scene_Map(){this.initialize.apply(this,arguments)}function Scene_MenuBase(){this.initialize.apply(this,arguments)}function Scene_Menu(){this.initialize.apply(this,arguments)}function Scene_ItemBase(){this.initialize.apply(this,arguments)}function Scene_Item(){this.initialize.apply(this,arguments)}function Scene_Skill(){this.initialize.apply(this,arguments)}function Scene_Equip(){this.initialize.apply(this,arguments)}function Scene_Status(){this.initialize.apply(this,arguments)}function Scene_Options(){this.initialize.apply(this,arguments)}function Scene_File(){this.initialize.apply(this,arguments)}function Scene_Save(){this.initialize.apply(this,arguments)}function Scene_Load(){this.initialize.apply(this,arguments)}function Scene_GameEnd(){this.initialize.apply(this,arguments)}function Scene_Shop(){this.initialize.apply(this,arguments)}function Scene_Name(){this.initialize.apply(this,arguments)}function Scene_Debug(){this.initialize.apply(this,arguments)}function Scene_Battle(){this.initialize.apply(this,arguments)}function Scene_Gameover(){this.initialize.apply(this,arguments)}function Sprite_Base(){this.initialize.apply(this,arguments)}function Sprite_Button(){this.initialize.apply(this,arguments)}function Sprite_Character(){this.initialize.apply(this,arguments)}function Sprite_Battler(){this.initialize.apply(this,arguments)}function Sprite_Actor(){this.initialize.apply(this,arguments)}function Sprite_Enemy(){this.initialize.apply(this,arguments)}function Sprite_Animation(){this.initialize.apply(this,arguments)}function Sprite_Damage(){this.initialize.apply(this,arguments)}function Sprite_StateIcon(){this.initialize.apply(this,arguments)}function Sprite_StateOverlay(){this.initialize.apply(this,arguments)}function Sprite_Weapon(){this.initialize.apply(this,arguments)}function Sprite_Balloon(){this.initialize.apply(this,arguments)}function Sprite_Picture(){this.initialize.apply(this,arguments)}function Sprite_Timer(){this.initialize.apply(this,arguments)}function Sprite_Destination(){this.initialize.apply(this,arguments)}function Spriteset_Base(){this.initialize.apply(this,arguments)}function Spriteset_Map(){this.initialize.apply(this,arguments)}function Spriteset_Battle(){this.initialize.apply(this,arguments)}function Window_Base(){this.initialize.apply(this,arguments)}function Window_Selectable(){this.initialize.apply(this,arguments)}function Window_Command(){this.initialize.apply(this,arguments)}function Window_HorzCommand(){this.initialize.apply(this,arguments)}function Window_Help(){this.initialize.apply(this,arguments)}function Window_Gold(){this.initialize.apply(this,arguments)}function Window_MenuCommand(){this.initialize.apply(this,arguments)}function Window_MenuStatus(){this.initialize.apply(this,arguments)}function Window_MenuActor(){this.initialize.apply(this,arguments)}function Window_ItemCategory(){this.initialize.apply(this,arguments)}function Window_ItemList(){this.initialize.apply(this,arguments)}function Window_SkillType(){this.initialize.apply(this,arguments)}function Window_SkillStatus(){this.initialize.apply(this,arguments)}function Window_SkillList(){this.initialize.apply(this,arguments)}function Window_EquipStatus(){this.initialize.apply(this,arguments)}function Window_EquipCommand(){this.initialize.apply(this,arguments)}function Window_EquipSlot(){this.initialize.apply(this,arguments)}function Window_EquipItem(){this.initialize.apply(this,arguments)}function Window_Status(){this.initialize.apply(this,arguments)}function Window_Options(){this.initialize.apply(this,arguments)}function Window_SavefileList(){this.initialize.apply(this,arguments)}function Window_ShopCommand(){this.initialize.apply(this,arguments)}function Window_ShopBuy(){this.initialize.apply(this,arguments)}function Window_ShopSell(){this.initialize.apply(this,arguments)}function Window_ShopNumber(){this.initialize.apply(this,arguments)}function Window_ShopStatus(){this.initialize.apply(this,arguments)}function Window_NameEdit(){this.initialize.apply(this,arguments)}function Window_NameInput(){this.initialize.apply(this,arguments)}function Window_ChoiceList(){this.initialize.apply(this,arguments)}function Window_NumberInput(){this.initialize.apply(this,arguments)}DataManager._globalId="RPGMV",DataManager._lastAccessedId=1,DataManager._errorUrl=null,DataManager._databaseFiles=[{name:"$dataActors",src:"Actors.json"},{name:"$dataClasses",src:"Classes.json"},{name:"$dataSkills",src:"Skills.json"},{name:"$dataItems",src:"Items.json"},{name:"$dataWeapons",src:"Weapons.json"},{name:"$dataArmors",src:"Armors.json"},{name:"$dataEnemies",src:"Enemies.json"},{name:"$dataTroops",src:"Troops.json"},{name:"$dataStates",src:"States.json"},{name:"$dataAnimations",src:"Animations.json"},{name:"$dataTilesets",src:"Tilesets.json"},{name:"$dataCommonEvents",src:"CommonEvents.json"},{name:"$dataSystem",src:"System.json"},{name:"$dataMapInfos",src:"MapInfos.json"}],DataManager.loadDatabase=function(){for(var t=this.isBattleTest()||this.isEventTest()?"Test_":"",e=0;e<this._databaseFiles.length;e++)this.loadDataFile(this._databaseFiles[e].name,t+this._databaseFiles[e].src);this.isEventTest()&&this.loadDataFile("$testEvent",t+"Event.json")},DataManager.loadDataFile=function(t,e){var i=new XMLHttpRequest,r="data/"+e;i.open("GET",r),i.overrideMimeType("application/json"),i.onload=function(){i.status<400&&(window[t]=JSON.parse(i.responseText),DataManager.onLoad(window[t]))},i.onerror=this._mapLoader||function(){DataManager._errorUrl=DataManager._errorUrl||r},window[t]=null,i.send()},DataManager.isDatabaseLoaded=function(){this.checkError();for(var t=0;t<this._databaseFiles.length;t++)if(!window[this._databaseFiles[t].name])return!1;return!0},DataManager.loadMapData=function(t){if(t>0){var e="Map%1.json".format(t.padZero(3));this._mapLoader=ResourceHandler.createLoader("data/"+e,this.loadDataFile.bind(this,"$dataMap",e)),this.loadDataFile("$dataMap",e)}else this.makeEmptyMap()},DataManager.makeEmptyMap=function(){($dataMap={}).data=[],$dataMap.events=[],$dataMap.width=100,$dataMap.height=100,$dataMap.scrollType=3},DataManager.isMapLoaded=function(){return this.checkError(),!!$dataMap},DataManager.onLoad=function(t){var e;if(t===$dataMap?(this.extractMetadata(t),e=t.events):e=t,Array.isArray(e))for(var i=0;i<e.length;i++){var r=e[i];r&&void 0!==r.note&&this.extractMetadata(r)}t===$dataSystem&&(Decrypter.hasEncryptedImages=!!t.hasEncryptedImages,Decrypter.hasEncryptedAudio=!!t.hasEncryptedAudio,Scene_Boot.loadSystemImages())},DataManager.extractMetadata=function(t){var e=/<([^<>:]+)(:?)([^>]*)>/g;for(t.meta={};;){var i=e.exec(t.note);if(!i)break;t.meta[i[1]]=":"!==i[2]||i[3]}},DataManager.checkError=function(){if(DataManager._errorUrl)throw new Error("Failed to load: "+DataManager._errorUrl)},DataManager.isBattleTest=function(){return Utils.isOptionValid("btest")},DataManager.isEventTest=function(){return Utils.isOptionValid("etest")},DataManager.isSkill=function(t){return t&&$dataSkills.contains(t)},DataManager.isItem=function(t){return t&&$dataItems.contains(t)},DataManager.isWeapon=function(t){return t&&$dataWeapons.contains(t)},DataManager.isArmor=function(t){return t&&$dataArmors.contains(t)},DataManager.createGameObjects=function(){$gameTemp=new Game_Temp,$gameSystem=new Game_System,$gameScreen=new Game_Screen,$gameTimer=new Game_Timer,$gameMessage=new Game_Message,$gameSwitches=new Game_Switches,$gameVariables=new Game_Variables,$gameSelfSwitches=new Game_SelfSwitches,$gameActors=new Game_Actors,$gameParty=new Game_Party,$gameTroop=new Game_Troop,$gameMap=new Game_Map,$gamePlayer=new Game_Player},DataManager.setupNewGame=function(){this.createGameObjects(),this.selectSavefileForNewGame(),$gameParty.setupStartingMembers(),$gamePlayer.reserveTransfer($dataSystem.startMapId,$dataSystem.startX,$dataSystem.startY),Graphics.frameCount=0},DataManager.setupBattleTest=function(){this.createGameObjects(),$gameParty.setupBattleTest(),BattleManager.setup($dataSystem.testTroopId,!0,!1),BattleManager.setBattleTest(!0),BattleManager.playBattleBgm()},DataManager.setupEventTest=function(){this.createGameObjects(),this.selectSavefileForNewGame(),$gameParty.setupStartingMembers(),$gamePlayer.reserveTransfer(-1,8,6),$gamePlayer.setTransparent(!1)},DataManager.loadGlobalInfo=function(){var t;try{t=StorageManager.load(0)}catch(r){return console.error(r),[]}if(t){for(var e=JSON.parse(t),i=1;i<=this.maxSavefiles();i++)StorageManager.exists(i)||delete e[i];return e}return[]},DataManager.saveGlobalInfo=function(t){StorageManager.save(0,JSON.stringify(t))},DataManager.isThisGameFile=function(t){var e=this.loadGlobalInfo();if(e&&e[t]){if(StorageManager.isLocalMode())return!0;var i=e[t];return i.globalId===this._globalId&&i.title===$dataSystem.gameTitle}return!1},DataManager.isAnySavefileExists=function(){var t=this.loadGlobalInfo();if(t)for(var e=1;e<t.length;e++)if(this.isThisGameFile(e))return!0;return!1},DataManager.latestSavefileId=function(){var t=this.loadGlobalInfo(),e=1,i=0;if(t)for(var r=1;r<t.length;r++)this.isThisGameFile(r)&&t[r].timestamp>i&&(i=t[r].timestamp,e=r);return e},DataManager.loadAllSavefileImages=function(){var t=this.loadGlobalInfo();if(t)for(var e=1;e<t.length;e++)this.isThisGameFile(e)&&this.loadSavefileImages(t[e])},DataManager.loadSavefileImages=function(t){if(t.characters)for(var e=0;e<t.characters.length;e++)ImageManager.reserveCharacter(t.characters[e][0]);if(t.faces)for(var i=0;i<t.faces.length;i++)ImageManager.reserveFace(t.faces[i][0])},DataManager.maxSavefiles=function(){return 20},DataManager.saveGame=function(t){try{return StorageManager.backup(t),this.saveGameWithoutRescue(t)}catch(e){console.error(e);try{StorageManager.remove(t),StorageManager.restoreBackup(t)}catch(i){}return!1}},DataManager.loadGame=function(t){try{return this.loadGameWithoutRescue(t)}catch(e){return console.error(e),!1}},DataManager.loadSavefileInfo=function(t){var e=this.loadGlobalInfo();return e&&e[t]?e[t]:null},DataManager.lastAccessedSavefileId=function(){return this._lastAccessedId},DataManager.saveGameWithoutRescue=function(t){var e=JsonEx.stringify(this.makeSaveContents());e.length>=2e5&&console.warn("Save data too big!"),StorageManager.save(t,e),this._lastAccessedId=t;var i=this.loadGlobalInfo()||[];return i[t]=this.makeSavefileInfo(),this.saveGlobalInfo(i),!0},DataManager.loadGameWithoutRescue=function(t){if(this.loadGlobalInfo(),this.isThisGameFile(t)){var e=StorageManager.load(t);return this.createGameObjects(),this.extractSaveContents(JsonEx.parse(e)),this._lastAccessedId=t,!0}return!1},DataManager.selectSavefileForNewGame=function(){var t=this.loadGlobalInfo();if(this._lastAccessedId=1,t){var e=Math.max(0,t.length-1);if(e<this.maxSavefiles())this._lastAccessedId=e+1;else for(var i=Number.MAX_VALUE,r=1;r<t.length;r++){if(!t[r]){this._lastAccessedId=r;break}t[r].timestamp<i&&(i=t[r].timestamp,this._lastAccessedId=r)}}},DataManager.makeSavefileInfo=function(){var t={};return t.globalId=this._globalId,t.title=$dataSystem.gameTitle,t.characters=$gameParty.charactersForSavefile(),t.faces=$gameParty.facesForSavefile(),t.playtime=$gameSystem.playtimeText(),t.timestamp=Date.now(),t},DataManager.makeSaveContents=function(){var t={};return t.system=$gameSystem,t.screen=$gameScreen,t.timer=$gameTimer,t.switches=$gameSwitches,t.variables=$gameVariables,t.selfSwitches=$gameSelfSwitches,t.actors=$gameActors,t.party=$gameParty,t.map=$gameMap,t.player=$gamePlayer,t},DataManager.extractSaveContents=function(t){$gameSystem=t.system,$gameScreen=t.screen,$gameTimer=t.timer,$gameSwitches=t.switches,$gameVariables=t.variables,$gameSelfSwitches=t.selfSwitches,$gameActors=t.actors,$gameParty=t.party,$gameMap=t.map,$gamePlayer=t.player},ConfigManager.alwaysDash=!1,ConfigManager.commandRemember=!1,Object.defineProperty(ConfigManager,"bgmVolume",{get:function(){return AudioManager._bgmVolume},set:function(t){AudioManager.bgmVolume=t},configurable:!0}),Object.defineProperty(ConfigManager,"bgsVolume",{get:function(){return AudioManager.bgsVolume},set:function(t){AudioManager.bgsVolume=t},configurable:!0}),Object.defineProperty(ConfigManager,"meVolume",{get:function(){return AudioManager.meVolume},set:function(t){AudioManager.meVolume=t},configurable:!0}),Object.defineProperty(ConfigManager,"seVolume",{get:function(){return AudioManager.seVolume},set:function(t){AudioManager.seVolume=t},configurable:!0}),ConfigManager.load=function(){var t,e={};try{t=StorageManager.load(-1)}catch(i){console.error(i)}t&&(e=JSON.parse(t)),this.applyData(e)},ConfigManager.save=function(){StorageManager.save(-1,JSON.stringify(this.makeData()))},ConfigManager.makeData=function(){var t={};return t.alwaysDash=this.alwaysDash,t.commandRemember=this.commandRemember,t.bgmVolume=this.bgmVolume,t.bgsVolume=this.bgsVolume,t.meVolume=this.meVolume,t.seVolume=this.seVolume,t},ConfigManager.applyData=function(t){this.alwaysDash=this.readFlag(t,"alwaysDash"),this.commandRemember=this.readFlag(t,"commandRemember"),this.bgmVolume=this.readVolume(t,"bgmVolume"),this.bgsVolume=this.readVolume(t,"bgsVolume"),this.meVolume=this.readVolume(t,"meVolume"),this.seVolume=this.readVolume(t,"seVolume")},ConfigManager.readFlag=function(t,e){return!!t[e]},ConfigManager.readVolume=function(t,e){var i=t[e];return void 0!==i?Number(i).clamp(0,100):100},StorageManager.save=function(t,e){this.isLocalMode()?this.saveToLocalFile(t,e):this.saveToWebStorage(t,e)},StorageManager.load=function(t){return this.isLocalMode()?this.loadFromLocalFile(t):this.loadFromWebStorage(t)},StorageManager.exists=function(t){return this.isLocalMode()?this.localFileExists(t):this.webStorageExists(t)},StorageManager.remove=function(t){this.isLocalMode()?this.removeLocalFile(t):this.removeWebStorage(t)},StorageManager.backup=function(t){if(this.exists(t))if(this.isLocalMode()){var e=this.loadFromLocalFile(t),i=LZString.compressToBase64(e),r=require("fs"),n=this.localFileDirectoryPath(),a=this.localFilePath(t)+".bak";r.existsSync(n)||r.mkdirSync(n),r.writeFileSync(a,i)}else{e=this.loadFromWebStorage(t),i=LZString.compressToBase64(e);var o=this.webStorageKey(t)+"bak";localStorage.setItem(o,i)}},StorageManager.backupExists=function(t){return this.isLocalMode()?this.localFileBackupExists(t):this.webStorageBackupExists(t)},StorageManager.cleanBackup=function(t){if(this.backupExists(t))if(this.isLocalMode()){var e=require("fs"),i=(this.localFileDirectoryPath(),this.localFilePath(t));e.unlinkSync(i+".bak")}else{var r=this.webStorageKey(t);localStorage.removeItem(r+"bak")}},StorageManager.restoreBackup=function(t){if(this.backupExists(t))if(this.isLocalMode()){var e=this.loadFromLocalBackupFile(t),i=LZString.compressToBase64(e),r=require("fs"),n=this.localFileDirectoryPath(),a=this.localFilePath(t);r.existsSync(n)||r.mkdirSync(n),r.writeFileSync(a,i),r.unlinkSync(a+".bak")}else{e=this.loadFromWebStorageBackup(t),i=LZString.compressToBase64(e);var o=this.webStorageKey(t);localStorage.setItem(o,i),localStorage.removeItem(o+"bak")}},StorageManager.isLocalMode=function(){return Utils.isNwjs()},StorageManager.saveToLocalFile=function(t,e){var i=LZString.compressToBase64(e),r=require("fs"),n=this.localFileDirectoryPath(),a=this.localFilePath(t);r.existsSync(n)||r.mkdirSync(n),r.writeFileSync(a,i)},StorageManager.loadFromLocalFile=function(t){var e=null,i=require("fs"),r=this.localFilePath(t);return i.existsSync(r)&&(e=i.readFileSync(r,{encoding:"utf8"})),LZString.decompressFromBase64(e)},StorageManager.loadFromLocalBackupFile=function(t){var e=null,i=require("fs"),r=this.localFilePath(t)+".bak";return i.existsSync(r)&&(e=i.readFileSync(r,{encoding:"utf8"})),LZString.decompressFromBase64(e)},StorageManager.localFileBackupExists=function(t){return require("fs").existsSync(this.localFilePath(t)+".bak")},StorageManager.localFileExists=function(t){return require("fs").existsSync(this.localFilePath(t))},StorageManager.removeLocalFile=function(t){var e=require("fs"),i=this.localFilePath(t);e.existsSync(i)&&e.unlinkSync(i)},StorageManager.saveToWebStorage=function(t,e){var i=this.webStorageKey(t),r=LZString.compressToBase64(e);localStorage.setItem(i,r)},StorageManager.loadFromWebStorage=function(t){var e=this.webStorageKey(t),i=localStorage.getItem(e);return LZString.decompressFromBase64(i)},StorageManager.loadFromWebStorageBackup=function(t){var e=this.webStorageKey(t)+"bak",i=localStorage.getItem(e);return LZString.decompressFromBase64(i)},StorageManager.webStorageBackupExists=function(t){var e=this.webStorageKey(t)+"bak";return!!localStorage.getItem(e)},StorageManager.webStorageExists=function(t){var e=this.webStorageKey(t);return!!localStorage.getItem(e)},StorageManager.removeWebStorage=function(t){var e=this.webStorageKey(t);localStorage.removeItem(e)},StorageManager.localFileDirectoryPath=function(){var t=require("path"),e=t.dirname(process.mainModule.filename);return t.join(e,"save/")},StorageManager.localFilePath=function(t){var e;return e=t<0?"config.rpgsave":0===t?"global.rpgsave":"file%1.rpgsave".format(t),this.localFileDirectoryPath()+e},StorageManager.webStorageKey=function(t){return t<0?"RPG Config":0===t?"RPG Global":"RPG File%1".format(t)},ImageManager.cache=new CacheMap(ImageManager),ImageManager._imageCache=new ImageCache,ImageManager._requestQueue=new RequestQueue,ImageManager._systemReservationId=Utils.generateRuntimeId(),ImageManager._generateCacheKey=function(t,e){return t+":"+e},ImageManager.loadAnimation=function(t,e){return this.loadBitmap("img/animations/",t,e,!0)},ImageManager.loadBattleback1=function(t,e){return this.loadBitmap("img/battlebacks1/",t,e,!0)},ImageManager.loadBattleback2=function(t,e){return this.loadBitmap("img/battlebacks2/",t,e,!0)},ImageManager.loadEnemy=function(t,e){return this.loadBitmap("img/enemies/",t,e,!0)},ImageManager.loadCharacter=function(t,e){return this.loadBitmap("img/characters/",t,e,!1)},ImageManager.loadFace=function(t,e){return this.loadBitmap("img/faces/",t,e,!0)},ImageManager.loadParallax=function(t,e){return this.loadBitmap("img/parallaxes/",t,e,!0)},ImageManager.loadPicture=function(t,e){return this.loadBitmap("img/pictures/",t,e,!0)},ImageManager.loadSvActor=function(t,e){return this.loadBitmap("img/sv_actors/",t,e,!1)},ImageManager.loadSvEnemy=function(t,e){return this.loadBitmap("img/sv_enemies/",t,e,!0)},ImageManager.loadSystem=function(t,e){return this.loadBitmap("img/system/",t,e,!1)},ImageManager.loadTileset=function(t,e){return this.loadBitmap("img/tilesets/",t,e,!1)},ImageManager.loadTitle1=function(t,e){return this.loadBitmap("img/titles1/",t,e,!0)},ImageManager.loadTitle2=function(t,e){return this.loadBitmap("img/titles2/",t,e,!0)},ImageManager.loadBitmap=function(t,e,i,r){if(e){var n=t+encodeURIComponent(e)+".png",a=this.loadNormalBitmap(n,i||0);return a.smooth=r,a}return this.loadEmptyBitmap()},ImageManager.loadEmptyBitmap=function(){var t=this._imageCache.get("empty");return t||(t=new Bitmap,this._imageCache.add("empty",t),this._imageCache.reserve("empty",t,this._systemReservationId)),t},ImageManager.loadNormalBitmap=function(t,e){var i=this._generateCacheKey(t,e),r=this._imageCache.get(i);return r?r.isReady()||r.decode():((r=Bitmap.load(decodeURIComponent(t))).addLoadListener(function(){r.rotateHue(e)}),this._imageCache.add(i,r)),r},ImageManager.clear=function(){this._imageCache=new ImageCache},ImageManager.isReady=function(){return this._imageCache.isReady()},ImageManager.isObjectCharacter=function(t){var e=t.match(/^[\!\$]+/);return e&&e[0].contains("!")},ImageManager.isBigCharacter=function(t){var e=t.match(/^[\!\$]+/);return e&&e[0].contains("$")},ImageManager.isZeroParallax=function(t){return"!"===t.charAt(0)},ImageManager.reserveAnimation=function(t,e,i){return this.reserveBitmap("img/animations/",t,e,!0,i)},ImageManager.reserveBattleback1=function(t,e,i){return this.reserveBitmap("img/battlebacks1/",t,e,!0,i)},ImageManager.reserveBattleback2=function(t,e,i){return this.reserveBitmap("img/battlebacks2/",t,e,!0,i)},ImageManager.reserveEnemy=function(t,e,i){return this.reserveBitmap("img/enemies/",t,e,!0,i)},ImageManager.reserveCharacter=function(t,e,i){return this.reserveBitmap("img/characters/",t,e,!1,i)},ImageManager.reserveFace=function(t,e,i){return this.reserveBitmap("img/faces/",t,e,!0,i)},ImageManager.reserveParallax=function(t,e,i){return this.reserveBitmap("img/parallaxes/",t,e,!0,i)},ImageManager.reservePicture=function(t,e,i){return this.reserveBitmap("img/pictures/",t,e,!0,i)},ImageManager.reserveSvActor=function(t,e,i){return this.reserveBitmap("img/sv_actors/",t,e,!1,i)},ImageManager.reserveSvEnemy=function(t,e,i){return this.reserveBitmap("img/sv_enemies/",t,e,!0,i)},ImageManager.reserveSystem=function(t,e,i){return this.reserveBitmap("img/system/",t,e,!1,i||this._systemReservationId)},ImageManager.reserveTileset=function(t,e,i){return this.reserveBitmap("img/tilesets/",t,e,!1,i)},ImageManager.reserveTitle1=function(t,e,i){return this.reserveBitmap("img/titles1/",t,e,!0,i)},ImageManager.reserveTitle2=function(t,e,i){return this.reserveBitmap("img/titles2/",t,e,!0,i)},ImageManager.reserveBitmap=function(t,e,i,r,n){if(e){var a=t+encodeURIComponent(e)+".png",o=this.reserveNormalBitmap(a,i||0,n||this._defaultReservationId);return o.smooth=r,o}return this.loadEmptyBitmap()},ImageManager.reserveNormalBitmap=function(t,e,i){var r=this.loadNormalBitmap(t,e);return this._imageCache.reserve(this._generateCacheKey(t,e),r,i),r},ImageManager.releaseReservation=function(t){this._imageCache.releaseReservation(t)},ImageManager.setDefaultReservationId=function(t){this._defaultReservationId=t},ImageManager.requestAnimation=function(t,e){return this.requestBitmap("img/animations/",t,e,!0)},ImageManager.requestBattleback1=function(t,e){return this.requestBitmap("img/battlebacks1/",t,e,!0)},ImageManager.requestBattleback2=function(t,e){return this.requestBitmap("img/battlebacks2/",t,e,!0)},ImageManager.requestEnemy=function(t,e){return this.requestBitmap("img/enemies/",t,e,!0)},ImageManager.requestCharacter=function(t,e){return this.requestBitmap("img/characters/",t,e,!1)},ImageManager.requestFace=function(t,e){return this.requestBitmap("img/faces/",t,e,!0)},ImageManager.requestParallax=function(t,e){return this.requestBitmap("img/parallaxes/",t,e,!0)},ImageManager.requestPicture=function(t,e){return this.requestBitmap("img/pictures/",t,e,!0)},ImageManager.requestSvActor=function(t,e){return this.requestBitmap("img/sv_actors/",t,e,!1)},ImageManager.requestSvEnemy=function(t,e){return this.requestBitmap("img/sv_enemies/",t,e,!0)},ImageManager.requestSystem=function(t,e){return this.requestBitmap("img/system/",t,e,!1)},ImageManager.requestTileset=function(t,e){return this.requestBitmap("img/tilesets/",t,e,!1)},ImageManager.requestTitle1=function(t,e){return this.requestBitmap("img/titles1/",t,e,!0)},ImageManager.requestTitle2=function(t,e){return this.requestBitmap("img/titles2/",t,e,!0)},ImageManager.requestBitmap=function(t,e,i,r){if(e){var n=t+encodeURIComponent(e)+".png",a=this.requestNormalBitmap(n,i||0);return a.smooth=r,a}return this.loadEmptyBitmap()},ImageManager.requestNormalBitmap=function(t,e){var i=this._generateCacheKey(t,e),r=this._imageCache.get(i);return r?this._requestQueue.raisePriority(i):((r=Bitmap.request(t)).addLoadListener(function(){r.rotateHue(e)}),this._imageCache.add(i,r),this._requestQueue.enqueue(i,r)),r},ImageManager.update=function(){this._requestQueue.update()},ImageManager.clearRequest=function(){this._requestQueue.clear()},AudioManager._masterVolume=1,AudioManager._bgmVolume=100,AudioManager._bgsVolume=100,AudioManager._meVolume=100,AudioManager._seVolume=100,AudioManager._currentBgm=null,AudioManager._currentBgs=null,AudioManager._bgmBuffer=null,AudioManager._bgsBuffer=null,AudioManager._meBuffer=null,AudioManager._seBuffers=[],AudioManager._staticBuffers=[],AudioManager._replayFadeTime=.5,AudioManager._path="audio/",AudioManager._blobUrl=null,Object.defineProperty(AudioManager,"masterVolume",{get:function(){return this._masterVolume},set:function(t){this._masterVolume=t,WebAudio.setMasterVolume(this._masterVolume),Graphics.setVideoVolume(this._masterVolume)},configurable:!0}),Object.defineProperty(AudioManager,"bgmVolume",{get:function(){return this._bgmVolume},set:function(t){this._bgmVolume=t,this.updateBgmParameters(this._currentBgm)},configurable:!0}),Object.defineProperty(AudioManager,"bgsVolume",{get:function(){return this._bgsVolume},set:function(t){this._bgsVolume=t,this.updateBgsParameters(this._currentBgs)},configurable:!0}),Object.defineProperty(AudioManager,"meVolume",{get:function(){return this._meVolume},set:function(t){this._meVolume=t,this.updateMeParameters(this._currentMe)},configurable:!0}),Object.defineProperty(AudioManager,"seVolume",{get:function(){return this._seVolume},set:function(t){this._seVolume=t},configurable:!0}),AudioManager.playBgm=function(t,e){this.isCurrentBgm(t)?this.updateBgmParameters(t):(this.stopBgm(),t.name&&(Decrypter.hasEncryptedAudio&&this.shouldUseHtml5Audio()?this.playEncryptedBgm(t,e):(this._bgmBuffer=this.createBuffer("bgm",t.name),this.updateBgmParameters(t),this._meBuffer||this._bgmBuffer.play(!0,e||0)))),this.updateCurrentBgm(t,e)},AudioManager.playEncryptedBgm=function(t,e){var i=this.audioFileExt(),r=this._path+"bgm/"+encodeURIComponent(t.name)+i;r=Decrypter.extToEncryptExt(r),Decrypter.decryptHTML5Audio(r,t,e)},AudioManager.createDecryptBuffer=function(t,e,i){this._blobUrl=t,this._bgmBuffer=this.createBuffer("bgm",e.name),this.updateBgmParameters(e),this._meBuffer||this._bgmBuffer.play(!0,i||0),this.updateCurrentBgm(e,i)},AudioManager.replayBgm=function(t){this.isCurrentBgm(t)?this.updateBgmParameters(t):(this.playBgm(t,t.pos),this._bgmBuffer&&this._bgmBuffer.fadeIn(this._replayFadeTime))},AudioManager.isCurrentBgm=function(t){return this._currentBgm&&this._bgmBuffer&&this._currentBgm.name===t.name},AudioManager.updateBgmParameters=function(t){this.updateBufferParameters(this._bgmBuffer,this._bgmVolume,t)},AudioManager.updateCurrentBgm=function(t,e){this._currentBgm={name:t.name,volume:t.volume,pitch:t.pitch,pan:t.pan,pos:e}},AudioManager.stopBgm=function(){this._bgmBuffer&&(this._bgmBuffer.stop(),this._bgmBuffer=null,this._currentBgm=null)},AudioManager.fadeOutBgm=function(t){this._bgmBuffer&&this._currentBgm&&(this._bgmBuffer.fadeOut(t),this._currentBgm=null)},AudioManager.fadeInBgm=function(t){this._bgmBuffer&&this._currentBgm&&this._bgmBuffer.fadeIn(t)},AudioManager.playBgs=function(t,e){this.isCurrentBgs(t)?this.updateBgsParameters(t):(this.stopBgs(),t.name&&(this._bgsBuffer=this.createBuffer("bgs",t.name),this.updateBgsParameters(t),this._bgsBuffer.play(!0,e||0))),this.updateCurrentBgs(t,e)},AudioManager.replayBgs=function(t){this.isCurrentBgs(t)?this.updateBgsParameters(t):(this.playBgs(t,t.pos),this._bgsBuffer&&this._bgsBuffer.fadeIn(this._replayFadeTime))},AudioManager.isCurrentBgs=function(t){return this._currentBgs&&this._bgsBuffer&&this._currentBgs.name===t.name},AudioManager.updateBgsParameters=function(t){this.updateBufferParameters(this._bgsBuffer,this._bgsVolume,t)},AudioManager.updateCurrentBgs=function(t,e){this._currentBgs={name:t.name,volume:t.volume,pitch:t.pitch,pan:t.pan,pos:e}},AudioManager.stopBgs=function(){this._bgsBuffer&&(this._bgsBuffer.stop(),this._bgsBuffer=null,this._currentBgs=null)},AudioManager.fadeOutBgs=function(t){this._bgsBuffer&&this._currentBgs&&(this._bgsBuffer.fadeOut(t),this._currentBgs=null)},AudioManager.fadeInBgs=function(t){this._bgsBuffer&&this._currentBgs&&this._bgsBuffer.fadeIn(t)},AudioManager.playMe=function(t){this.stopMe(),t.name&&(this._bgmBuffer&&this._currentBgm&&(this._currentBgm.pos=this._bgmBuffer.seek(),this._bgmBuffer.stop()),this._meBuffer=this.createBuffer("me",t.name),this.updateMeParameters(t),this._meBuffer.play(!1),this._meBuffer.addStopListener(this.stopMe.bind(this)))},AudioManager.updateMeParameters=function(t){this.updateBufferParameters(this._meBuffer,this._meVolume,t)},AudioManager.fadeOutMe=function(t){this._meBuffer&&this._meBuffer.fadeOut(t)},AudioManager.stopMe=function(){this._meBuffer&&(this._meBuffer.stop(),this._meBuffer=null,this._bgmBuffer&&this._currentBgm&&!this._bgmBuffer.isPlaying()&&(this._bgmBuffer.play(!0,this._currentBgm.pos),this._bgmBuffer.fadeIn(this._replayFadeTime)))},AudioManager.playSe=function(t){if(t.name){this._seBuffers=this._seBuffers.filter(function(t){return t.isPlaying()});var e=this.createBuffer("se",t.name);this.updateSeParameters(e,t),e.play(!1),this._seBuffers.push(e)}},AudioManager.updateSeParameters=function(t,e){this.updateBufferParameters(t,this._seVolume,e)},AudioManager.stopSe=function(){this._seBuffers.forEach(function(t){t.stop()}),this._seBuffers=[]},AudioManager.playStaticSe=function(t){if(t.name){this.loadStaticSe(t);for(var e=0;e<this._staticBuffers.length;e++){var i=this._staticBuffers[e];if(i._reservedSeName===t.name){i.stop(),this.updateSeParameters(i,t),i.play(!1);break}}}},AudioManager.loadStaticSe=function(t){if(t.name&&!this.isStaticSe(t)){var e=this.createBuffer("se",t.name);e._reservedSeName=t.name,this._staticBuffers.push(e),this.shouldUseHtml5Audio()&&Html5Audio.setStaticSe(e._url)}},AudioManager.isStaticSe=function(t){for(var e=0;e<this._staticBuffers.length;e++)if(this._staticBuffers[e]._reservedSeName===t.name)return!0;return!1},AudioManager.stopAll=function(){this.stopMe(),this.stopBgm(),this.stopBgs(),this.stopSe()},AudioManager.saveBgm=function(){if(this._currentBgm){var t=this._currentBgm;return{name:t.name,volume:t.volume,pitch:t.pitch,pan:t.pan,pos:this._bgmBuffer?this._bgmBuffer.seek():0}}return this.makeEmptyAudioObject()},AudioManager.saveBgs=function(){if(this._currentBgs){var t=this._currentBgs;return{name:t.name,volume:t.volume,pitch:t.pitch,pan:t.pan,pos:this._bgsBuffer?this._bgsBuffer.seek():0}}return this.makeEmptyAudioObject()},AudioManager.makeEmptyAudioObject=function(){return{name:"",volume:0,pitch:0}},AudioManager.createBuffer=function(t,e){var i=this.audioFileExt(),r=this._path+t+"/"+encodeURIComponent(e)+i;return this.shouldUseHtml5Audio()&&"bgm"===t?(Html5Audio.setup(this._blobUrl?this._blobUrl:r),Html5Audio):new WebAudio(r)},AudioManager.updateBufferParameters=function(t,e,i){t&&i&&(t.volume=e*(i.volume||0)/1e4,t.pitch=(i.pitch||0)/100,t.pan=(i.pan||0)/100)},AudioManager.audioFileExt=function(){return WebAudio.canPlayOgg()&&!Utils.isMobileDevice()?".ogg":".m4a"},AudioManager.shouldUseHtml5Audio=function(){return!1},AudioManager.checkErrors=function(){this.checkWebAudioError(this._bgmBuffer),this.checkWebAudioError(this._bgsBuffer),this.checkWebAudioError(this._meBuffer),this._seBuffers.forEach((function(t){this.checkWebAudioError(t)}).bind(this)),this._staticBuffers.forEach((function(t){this.checkWebAudioError(t)}).bind(this))},AudioManager.checkWebAudioError=function(t){if(t&&t.isError())throw new Error("Failed to load: "+t.url)},SoundManager.preloadImportantSounds=function(){this.loadSystemSound(0),this.loadSystemSound(1),this.loadSystemSound(2),this.loadSystemSound(3)},SoundManager.loadSystemSound=function(t){$dataSystem&&AudioManager.loadStaticSe($dataSystem.sounds[t])},SoundManager.playSystemSound=function(t){$dataSystem&&AudioManager.playStaticSe($dataSystem.sounds[t])},SoundManager.playCursor=function(){this.playSystemSound(0)},SoundManager.playOk=function(){this.playSystemSound(1)},SoundManager.playCancel=function(){this.playSystemSound(2)},SoundManager.playBuzzer=function(){this.playSystemSound(3)},SoundManager.playEquip=function(){this.playSystemSound(4)},SoundManager.playSave=function(){this.playSystemSound(5)},SoundManager.playLoad=function(){this.playSystemSound(6)},SoundManager.playBattleStart=function(){this.playSystemSound(7)},SoundManager.playEscape=function(){this.playSystemSound(8)},SoundManager.playEnemyAttack=function(){this.playSystemSound(9)},SoundManager.playEnemyDamage=function(){this.playSystemSound(10)},SoundManager.playEnemyCollapse=function(){this.playSystemSound(11)},SoundManager.playBossCollapse1=function(){this.playSystemSound(12)},SoundManager.playBossCollapse2=function(){this.playSystemSound(13)},SoundManager.playActorDamage=function(){this.playSystemSound(14)},SoundManager.playActorCollapse=function(){this.playSystemSound(15)},SoundManager.playRecovery=function(){this.playSystemSound(16)},SoundManager.playMiss=function(){this.playSystemSound(17)},SoundManager.playEvasion=function(){this.playSystemSound(18)},SoundManager.playMagicEvasion=function(){this.playSystemSound(19)},SoundManager.playReflection=function(){this.playSystemSound(20)},SoundManager.playShop=function(){this.playSystemSound(21)},SoundManager.playUseItem=function(){this.playSystemSound(22)},SoundManager.playUseSkill=function(){this.playSystemSound(23)},TextManager.basic=function(t){return $dataSystem.terms.basic[t]||""},TextManager.param=function(t){return $dataSystem.terms.params[t]||""},TextManager.command=function(t){return $dataSystem.terms.commands[t]||""},TextManager.message=function(t){return $dataSystem.terms.messages[t]||""},TextManager.getter=function(t,e){return{get:function(){return this[t](e)},configurable:!0}},Object.defineProperty(TextManager,"currencyUnit",{get:function(){return $dataSystem.currencyUnit},configurable:!0}),Object.defineProperties(TextManager,{level:TextManager.getter("basic",0),levelA:TextManager.getter("basic",1),hp:TextManager.getter("basic",2),hpA:TextManager.getter("basic",3),mp:TextManager.getter("basic",4),mpA:TextManager.getter("basic",5),tp:TextManager.getter("basic",6),tpA:TextManager.getter("basic",7),exp:TextManager.getter("basic",8),expA:TextManager.getter("basic",9),fight:TextManager.getter("command",0),escape:TextManager.getter("command",1),attack:TextManager.getter("command",2),guard:TextManager.getter("command",3),item:TextManager.getter("command",4),skill:TextManager.getter("command",5),equip:TextManager.getter("command",6),status:TextManager.getter("command",7),formation:TextManager.getter("command",8),save:TextManager.getter("command",9),gameEnd:TextManager.getter("command",10),options:TextManager.getter("command",11),weapon:TextManager.getter("command",12),armor:TextManager.getter("command",13),keyItem:TextManager.getter("command",14),equip2:TextManager.getter("command",15),optimize:TextManager.getter("command",16),clear:TextManager.getter("command",17),newGame:TextManager.getter("command",18),continue_:TextManager.getter("command",19),toTitle:TextManager.getter("command",21),cancel:TextManager.getter("command",22),buy:TextManager.getter("command",24),sell:TextManager.getter("command",25),alwaysDash:TextManager.getter("message","alwaysDash"),commandRemember:TextManager.getter("message","commandRemember"),bgmVolume:TextManager.getter("message","bgmVolume"),bgsVolume:TextManager.getter("message","bgsVolume"),meVolume:TextManager.getter("message","meVolume"),seVolume:TextManager.getter("message","seVolume"),possession:TextManager.getter("message","possession"),expTotal:TextManager.getter("message","expTotal"),expNext:TextManager.getter("message","expNext"),saveMessage:TextManager.getter("message","saveMessage"),loadMessage:TextManager.getter("message","loadMessage"),file:TextManager.getter("message","file"),partyName:TextManager.getter("message","partyName"),emerge:TextManager.getter("message","emerge"),preemptive:TextManager.getter("message","preemptive"),surprise:TextManager.getter("message","surprise"),escapeStart:TextManager.getter("message","escapeStart"),escapeFailure:TextManager.getter("message","escapeFailure"),victory:TextManager.getter("message","victory"),defeat:TextManager.getter("message","defeat"),obtainExp:TextManager.getter("message","obtainExp"),obtainGold:TextManager.getter("message","obtainGold"),obtainItem:TextManager.getter("message","obtainItem"),levelUp:TextManager.getter("message","levelUp"),obtainSkill:TextManager.getter("message","obtainSkill"),useItem:TextManager.getter("message","useItem"),criticalToEnemy:TextManager.getter("message","criticalToEnemy"),criticalToActor:TextManager.getter("message","criticalToActor"),actorDamage:TextManager.getter("message","actorDamage"),actorRecovery:TextManager.getter("message","actorRecovery"),actorGain:TextManager.getter("message","actorGain"),actorLoss:TextManager.getter("message","actorLoss"),actorDrain:TextManager.getter("message","actorDrain"),actorNoDamage:TextManager.getter("message","actorNoDamage"),actorNoHit:TextManager.getter("message","actorNoHit"),enemyDamage:TextManager.getter("message","enemyDamage"),enemyRecovery:TextManager.getter("message","enemyRecovery"),enemyGain:TextManager.getter("message","enemyGain"),enemyLoss:TextManager.getter("message","enemyLoss"),enemyDrain:TextManager.getter("message","enemyDrain"),enemyNoDamage:TextManager.getter("message","enemyNoDamage"),enemyNoHit:TextManager.getter("message","enemyNoHit"),evasion:TextManager.getter("message","evasion"),magicEvasion:TextManager.getter("message","magicEvasion"),magicReflection:TextManager.getter("message","magicReflection"),counterAttack:TextManager.getter("message","counterAttack"),substitute:TextManager.getter("message","substitute"),buffAdd:TextManager.getter("message","buffAdd"),debuffAdd:TextManager.getter("message","debuffAdd"),buffRemove:TextManager.getter("message","buffRemove"),actionFailure:TextManager.getter("message","actionFailure")}),SceneManager._getTimeInMsWithoutMobileSafari=function(){return performance.now()},SceneManager._scene=null,SceneManager._nextScene=null,SceneManager._stack=[],SceneManager._stopped=!1,SceneManager._sceneStarted=!1,SceneManager._exiting=!1,SceneManager._previousClass=null,SceneManager._backgroundBitmap=null,SceneManager._screenWidth=816,SceneManager._screenHeight=624,SceneManager._boxWidth=816,SceneManager._boxHeight=624,SceneManager._deltaTime=1/60,Utils.isMobileSafari()||(SceneManager._currentTime=SceneManager._getTimeInMsWithoutMobileSafari()),SceneManager._accumulator=0,SceneManager.run=function(t){try{this.initialize(),this.goto(t),this.requestUpdate()}catch(e){this.catchException(e)}},SceneManager.initialize=function(){this.initGraphics(),this.checkFileAccess(),this.initAudio(),this.initInput(),this.initNwjs(),this.checkPluginErrors(),this.setupErrorHandlers()},SceneManager.initGraphics=function(){var t=this.preferableRendererType();Graphics.initialize(this._screenWidth,this._screenHeight,t),Graphics.boxWidth=this._boxWidth,Graphics.boxHeight=this._boxHeight,Graphics.setLoadingImage("img/system/Loading.png"),Utils.isOptionValid("showfps")&&Graphics.showFps(),"webgl"===t&&this.checkWebGL()},SceneManager.preferableRendererType=function(){return Utils.isOptionValid("canvas")?"canvas":Utils.isOptionValid("webgl")?"webgl":"auto"},SceneManager.shouldUseCanvasRenderer=function(){return Utils.isMobileDevice()},SceneManager.checkWebGL=function(){if(!Graphics.hasWebGL())throw new Error("Your browser does not support WebGL.")},SceneManager.checkFileAccess=function(){if(!Utils.canReadGameFiles())throw new Error("Your browser does not allow to read local files.")},SceneManager.initAudio=function(){var t=Utils.isOptionValid("noaudio");if(!WebAudio.initialize(t)&&!t)throw new Error("Your browser does not support Web Audio API.")},SceneManager.initInput=function(){Input.initialize(),TouchInput.initialize()},SceneManager.initNwjs=function(){if(Utils.isNwjs()){var t=require("nw.gui"),e=t.Window.get();if("darwin"===process.platform&&!e.menu){var i=new t.Menu({type:"menubar"});i.createMacBuiltin("Game",{hideEdit:!0,hideWindow:!0}),e.menu=i}}},SceneManager.checkPluginErrors=function(){PluginManager.checkErrors()},SceneManager.setupErrorHandlers=function(){window.addEventListener("error",this.onError.bind(this)),document.addEventListener("keydown",this.onKeyDown.bind(this))},SceneManager.requestUpdate=function(){this._stopped||requestAnimationFrame(this.update.bind(this))},SceneManager.update=function(){try{this.tickStart(),Utils.isMobileSafari()&&this.updateInputData(),this.updateManagers(),this.updateMain(),this.tickEnd()}catch(t){this.catchException(t)}},SceneManager.terminate=function(){window.close()},SceneManager.onError=function(t){console.error(t.message),console.error(t.filename,t.lineno);try{this.stop(),Graphics.printError("Error",t.message),AudioManager.stopAll()}catch(e){}},SceneManager.onKeyDown=function(t){if(!t.ctrlKey&&!t.altKey)switch(t.keyCode){case 116:Utils.isNwjs()&&location.reload();break;case 119:Utils.isNwjs()&&Utils.isOptionValid("test")&&require("nw.gui").Window.get().showDevTools()}},SceneManager.catchException=function(t){t instanceof Error?(Graphics.printError(t.name,t.message),console.error(t.stack)):Graphics.printError("UnknownError",t),AudioManager.stopAll(),this.stop()},SceneManager.tickStart=function(){Graphics.tickStart()},SceneManager.tickEnd=function(){Graphics.tickEnd()},SceneManager.updateInputData=function(){Input.update(),TouchInput.update()},SceneManager.updateMain=function(){if(Utils.isMobileSafari())this.changeScene(),this.updateScene();else{var t=this._getTimeInMsWithoutMobileSafari(),e=(t-this._currentTime)/1e3;for(e>.25&&(e=.25),this._currentTime=t,this._accumulator+=e;this._accumulator>=this._deltaTime;)this.updateInputData(),this.changeScene(),this.updateScene(),this._accumulator-=this._deltaTime}this.renderScene(),this.requestUpdate()},SceneManager.updateManagers=function(){ImageManager.update()},SceneManager.changeScene=function(){this.isSceneChanging()&&!this.isCurrentSceneBusy()&&(this._scene&&(this._scene.terminate(),this._scene.detachReservation(),this._previousClass=this._scene.constructor),this._scene=this._nextScene,this._scene&&(this._scene.attachReservation(),this._scene.create(),this._nextScene=null,this._sceneStarted=!1,this.onSceneCreate()),this._exiting&&this.terminate())},SceneManager.updateScene=function(){this._scene&&(!this._sceneStarted&&this._scene.isReady()&&(this._scene.start(),this._sceneStarted=!0,this.onSceneStart()),this.isCurrentSceneStarted()&&this._scene.update())},SceneManager.renderScene=function(){this.isCurrentSceneStarted()?Graphics.render(this._scene):this._scene&&this.onSceneLoading()},SceneManager.onSceneCreate=function(){Graphics.startLoading()},SceneManager.onSceneStart=function(){Graphics.endLoading()},SceneManager.onSceneLoading=function(){Graphics.updateLoading()},SceneManager.isSceneChanging=function(){return this._exiting||!!this._nextScene},SceneManager.isCurrentSceneBusy=function(){return this._scene&&this._scene.isBusy()},SceneManager.isCurrentSceneStarted=function(){return this._scene&&this._sceneStarted},SceneManager.isNextScene=function(t){return this._nextScene&&this._nextScene.constructor===t},SceneManager.isPreviousScene=function(t){return this._previousClass===t},SceneManager.goto=function(t){t&&(this._nextScene=new t),this._scene&&this._scene.stop()},SceneManager.push=function(t){this._stack.push(this._scene.constructor),this.goto(t)},SceneManager.pop=function(){this._stack.length>0?this.goto(this._stack.pop()):this.exit()},SceneManager.exit=function(){this.goto(null),this._exiting=!0},SceneManager.clearStack=function(){this._stack=[]},SceneManager.stop=function(){this._stopped=!0},SceneManager.prepareNextScene=function(){this._nextScene.prepare.apply(this._nextScene,arguments)},SceneManager.snap=function(){return Bitmap.snap(this._scene)},SceneManager.snapForBackground=function(){this._backgroundBitmap=this.snap(),this._backgroundBitmap.blur()},SceneManager.backgroundBitmap=function(){return this._backgroundBitmap},SceneManager.resume=function(){this._stopped=!1,this.requestUpdate(),Utils.isMobileSafari()||(this._currentTime=this._getTimeInMsWithoutMobileSafari(),this._accumulator=0)},BattleManager.setup=function(t,e,i){this.initMembers(),this._canEscape=e,this._canLose=i,$gameTroop.setup(t),$gameScreen.onBattleStart(),this.makeEscapeRatio()},BattleManager.initMembers=function(){this._phase="init",this._canEscape=!1,this._canLose=!1,this._battleTest=!1,this._eventCallback=null,this._preemptive=!1,this._surprise=!1,this._actorIndex=-1,this._actionForcedBattler=null,this._mapBgm=null,this._mapBgs=null,this._actionBattlers=[],this._subject=null,this._action=null,this._targets=[],this._logWindow=null,this._statusWindow=null,this._spriteset=null,this._escapeRatio=0,this._escaped=!1,this._rewards={},this._turnForced=!1},BattleManager.isBattleTest=function(){return this._battleTest},BattleManager.setBattleTest=function(t){this._battleTest=t},BattleManager.setEventCallback=function(t){this._eventCallback=t},BattleManager.setLogWindow=function(t){this._logWindow=t},BattleManager.setStatusWindow=function(t){this._statusWindow=t},BattleManager.setSpriteset=function(t){this._spriteset=t},BattleManager.onEncounter=function(){this._preemptive=Math.random()<this.ratePreemptive(),this._surprise=Math.random()<this.rateSurprise()&&!this._preemptive},BattleManager.ratePreemptive=function(){return $gameParty.ratePreemptive($gameTroop.agility())},BattleManager.rateSurprise=function(){return $gameParty.rateSurprise($gameTroop.agility())},BattleManager.saveBgmAndBgs=function(){this._mapBgm=AudioManager.saveBgm(),this._mapBgs=AudioManager.saveBgs()},BattleManager.playBattleBgm=function(){AudioManager.playBgm($gameSystem.battleBgm()),AudioManager.stopBgs()},BattleManager.playVictoryMe=function(){AudioManager.playMe($gameSystem.victoryMe())},BattleManager.playDefeatMe=function(){AudioManager.playMe($gameSystem.defeatMe())},BattleManager.replayBgmAndBgs=function(){this._mapBgm?AudioManager.replayBgm(this._mapBgm):AudioManager.stopBgm(),this._mapBgs&&AudioManager.replayBgs(this._mapBgs)},BattleManager.makeEscapeRatio=function(){this._escapeRatio=.5*$gameParty.agility()/$gameTroop.agility()},BattleManager.update=function(){if(!this.isBusy()&&!this.updateEvent())switch(this._phase){case"start":this.startInput();break;case"turn":this.updateTurn();break;case"action":this.updateAction();break;case"turnEnd":this.updateTurnEnd();break;case"battleEnd":this.updateBattleEnd()}},BattleManager.updateEvent=function(){switch(this._phase){case"start":case"turn":case"turnEnd":return this.isActionForced()?(this.processForcedAction(),!0):this.updateEventMain()}return this.checkAbort()},BattleManager.updateEventMain=function(){return $gameTroop.updateInterpreter(),$gameParty.requestMotionRefresh(),!!($gameTroop.isEventRunning()||this.checkBattleEnd()||($gameTroop.setupBattleEvent(),$gameTroop.isEventRunning()||SceneManager.isSceneChanging()))},BattleManager.isBusy=function(){return $gameMessage.isBusy()||this._spriteset.isBusy()||this._logWindow.isBusy()},BattleManager.isInputting=function(){return"input"===this._phase},BattleManager.isInTurn=function(){return"turn"===this._phase},BattleManager.isTurnEnd=function(){return"turnEnd"===this._phase},BattleManager.isAborting=function(){return"aborting"===this._phase},BattleManager.isBattleEnd=function(){return"battleEnd"===this._phase},BattleManager.canEscape=function(){return this._canEscape},BattleManager.canLose=function(){return this._canLose},BattleManager.isEscaped=function(){return this._escaped},BattleManager.actor=function(){return this._actorIndex>=0?$gameParty.members()[this._actorIndex]:null},BattleManager.clearActor=function(){this.changeActor(-1,"")},BattleManager.changeActor=function(t,e){var i=this.actor();this._actorIndex=t;var r=this.actor();i&&i.setActionState(e),r&&r.setActionState("inputting")},BattleManager.startBattle=function(){this._phase="start",$gameSystem.onBattleStart(),$gameParty.onBattleStart(),$gameTroop.onBattleStart(),this.displayStartMessages()},BattleManager.displayStartMessages=function(){$gameTroop.enemyNames().forEach(function(t){$gameMessage.add(TextManager.emerge.format(t))}),this._preemptive?$gameMessage.add(TextManager.preemptive.format($gameParty.name())):this._surprise&&$gameMessage.add(TextManager.surprise.format($gameParty.name()))},BattleManager.startInput=function(){this._phase="input",$gameParty.makeActions(),$gameTroop.makeActions(),this.clearActor(),!this._surprise&&$gameParty.canInput()||this.startTurn()},BattleManager.inputtingAction=function(){return this.actor()?this.actor().inputtingAction():null},BattleManager.selectNextCommand=function(){do{if((!this.actor()||!this.actor().selectNextCommand())&&(this.changeActor(this._actorIndex+1,"waiting"),this._actorIndex>=$gameParty.size())){this.startTurn();break}}while(!this.actor().canInput())},BattleManager.selectPreviousCommand=function(){do{if((!this.actor()||!this.actor().selectPreviousCommand())&&(this.changeActor(this._actorIndex-1,"undecided"),this._actorIndex<0))return}while(!this.actor().canInput())},BattleManager.refreshStatus=function(){this._statusWindow.refresh()},BattleManager.startTurn=function(){this._phase="turn",this.clearActor(),$gameTroop.increaseTurn(),this.makeActionOrders(),$gameParty.requestMotionRefresh(),this._logWindow.startTurn()},BattleManager.updateTurn=function(){$gameParty.requestMotionRefresh(),this._subject||(this._subject=this.getNextSubject()),this._subject?this.processTurn():this.endTurn()},BattleManager.processTurn=function(){var t=this._subject,e=t.currentAction();e?(e.prepare(),e.isValid()&&this.startAction(),t.removeCurrentAction()):(t.onAllActionsEnd(),this.refreshStatus(),this._logWindow.displayAutoAffectedStatus(t),this._logWindow.displayCurrentState(t),this._logWindow.displayRegeneration(t),this._subject=this.getNextSubject())},BattleManager.endTurn=function(){this._phase="turnEnd",this._preemptive=!1,this._surprise=!1,this.allBattleMembers().forEach(function(t){t.onTurnEnd(),this.refreshStatus(),this._logWindow.displayAutoAffectedStatus(t),this._logWindow.displayRegeneration(t)},this),this.isForcedTurn()&&(this._turnForced=!1)},BattleManager.isForcedTurn=function(){return this._turnForced},BattleManager.updateTurnEnd=function(){this.startInput()},BattleManager.getNextSubject=function(){for(;;){var t=this._actionBattlers.shift();if(!t)return null;if(t.isBattleMember()&&t.isAlive())return t}},BattleManager.allBattleMembers=function(){return $gameParty.members().concat($gameTroop.members())},BattleManager.makeActionOrders=function(){var t=[];this._surprise||(t=t.concat($gameParty.members())),this._preemptive||(t=t.concat($gameTroop.members())),t.forEach(function(t){t.makeSpeed()}),t.sort(function(t,e){return e.speed()-t.speed()}),this._actionBattlers=t},BattleManager.startAction=function(){var t=this._subject,e=t.currentAction(),i=e.makeTargets();this._phase="action",this._action=e,this._targets=i,t.useItem(e.item()),this._action.applyGlobal(),this.refreshStatus(),this._logWindow.startAction(t,e,i)},BattleManager.updateAction=function(){var t=this._targets.shift();t?this.invokeAction(this._subject,t):this.endAction()},BattleManager.endAction=function(){this._logWindow.endAction(this._subject),this._phase="turn"},BattleManager.invokeAction=function(t,e){this._logWindow.push("pushBaseLine"),Math.random()<this._action.itemCnt(e)?this.invokeCounterAttack(t,e):Math.random()<this._action.itemMrf(e)?this.invokeMagicReflection(t,e):this.invokeNormalAction(t,e),t.setLastTarget(e),this._logWindow.push("popBaseLine"),this.refreshStatus()},BattleManager.invokeNormalAction=function(t,e){var i=this.applySubstitute(e);this._action.apply(i),this._logWindow.displayActionResults(t,i)},BattleManager.invokeCounterAttack=function(t,e){var i=new Game_Action(e);i.setAttack(),i.apply(t),this._logWindow.displayCounter(e),this._logWindow.displayActionResults(e,t)},BattleManager.invokeMagicReflection=function(t,e){this._action._reflectionTarget=e,this._logWindow.displayReflection(e),this._action.apply(t),this._logWindow.displayActionResults(e,t)},BattleManager.applySubstitute=function(t){if(this.checkSubstitute(t)){var e=t.friendsUnit().substituteBattler();if(e&&t!==e)return this._logWindow.displaySubstitute(e,t),e}return t},BattleManager.checkSubstitute=function(t){return t.isDying()&&!this._action.isCertainHit()},BattleManager.isActionForced=function(){return!!this._actionForcedBattler},BattleManager.forceAction=function(t){this._actionForcedBattler=t;var e=this._actionBattlers.indexOf(t);e>=0&&this._actionBattlers.splice(e,1)},BattleManager.processForcedAction=function(){this._actionForcedBattler&&(this._turnForced=!0,this._subject=this._actionForcedBattler,this._actionForcedBattler=null,this.startAction(),this._subject.removeCurrentAction())},BattleManager.abort=function(){this._phase="aborting"},BattleManager.checkBattleEnd=function(){if(this._phase){if(this.checkAbort())return!0;if($gameParty.isAllDead())return this.processDefeat(),!0;if($gameTroop.isAllDead())return this.processVictory(),!0}return!1},BattleManager.checkAbort=function(){return($gameParty.isEmpty()||this.isAborting())&&(SoundManager.playEscape(),this._escaped=!0,this.processAbort()),!1},BattleManager.processVictory=function(){$gameParty.removeBattleStates(),$gameParty.performVictory(),this.playVictoryMe(),this.replayBgmAndBgs(),this.makeRewards(),this.displayVictoryMessage(),this.displayRewards(),this.gainRewards(),this.endBattle(0)},BattleManager.processEscape=function(){$gameParty.performEscape(),SoundManager.playEscape();var t=!!this._preemptive||Math.random()<this._escapeRatio;return t?(this.displayEscapeSuccessMessage(),this._escaped=!0,this.processAbort()):(this.displayEscapeFailureMessage(),this._escapeRatio+=.1,$gameParty.clearActions(),this.startTurn()),t},BattleManager.processAbort=function(){$gameParty.removeBattleStates(),this.replayBgmAndBgs(),this.endBattle(1)},BattleManager.processDefeat=function(){this.displayDefeatMessage(),this.playDefeatMe(),this._canLose?this.replayBgmAndBgs():AudioManager.stopBgm(),this.endBattle(2)},BattleManager.endBattle=function(t){this._phase="battleEnd",this._eventCallback&&this._eventCallback(t),0===t?$gameSystem.onBattleWin():this._escaped&&$gameSystem.onBattleEscape()},BattleManager.updateBattleEnd=function(){this.isBattleTest()?(AudioManager.stopBgm(),SceneManager.exit()):!this._escaped&&$gameParty.isAllDead()?this._canLose?($gameParty.reviveBattleMembers(),SceneManager.pop()):SceneManager.goto(Scene_Gameover):SceneManager.pop(),this._phase=null},BattleManager.makeRewards=function(){this._rewards={},this._rewards.gold=$gameTroop.goldTotal(),this._rewards.exp=$gameTroop.expTotal(),this._rewards.items=$gameTroop.makeDropItems()},BattleManager.displayVictoryMessage=function(){$gameMessage.add(TextManager.victory.format($gameParty.name()))},BattleManager.displayDefeatMessage=function(){$gameMessage.add(TextManager.defeat.format($gameParty.name()))},BattleManager.displayEscapeSuccessMessage=function(){$gameMessage.add(TextManager.escapeStart.format($gameParty.name()))},BattleManager.displayEscapeFailureMessage=function(){$gameMessage.add(TextManager.escapeStart.format($gameParty.name())),$gameMessage.add("\\."+TextManager.escapeFailure)},BattleManager.displayRewards=function(){this.displayExp(),this.displayGold(),this.displayDropItems()},BattleManager.displayExp=function(){var t=this._rewards.exp;if(t>0){var e=TextManager.obtainExp.format(t,TextManager.exp);$gameMessage.add("\\."+e)}},BattleManager.displayGold=function(){var t=this._rewards.gold;t>0&&$gameMessage.add("\\."+TextManager.obtainGold.format(t))},BattleManager.displayDropItems=function(){var t=this._rewards.items;t.length>0&&($gameMessage.newPage(),t.forEach(function(t){$gameMessage.add(TextManager.obtainItem.format(t.name))}))},BattleManager.gainRewards=function(){this.gainExp(),this.gainGold(),this.gainDropItems()},BattleManager.gainExp=function(){var t=this._rewards.exp;$gameParty.allMembers().forEach(function(e){e.gainExp(t)})},BattleManager.gainGold=function(){$gameParty.gainGold(this._rewards.gold)},BattleManager.gainDropItems=function(){this._rewards.items.forEach(function(t){$gameParty.gainItem(t,1)})},PluginManager._path="src/app/games-src/game-eq/js/plugins/",PluginManager._scripts=[],PluginManager._errorUrls=[],PluginManager._parameters={},PluginManager.setup=function(t){t.forEach(function(t){t.status&&!this._scripts.contains(t.name)&&(this.setParameters(t.name,t.parameters),this.loadScript(t.name+".js"),this._scripts.push(t.name))},this)},PluginManager.checkErrors=function(){var t=this._errorUrls.shift();if(t)throw new Error("Failed to load: "+t)},PluginManager.parameters=function(t){return this._parameters[t.toLowerCase()]||{}},PluginManager.setParameters=function(t,e){this._parameters[t.toLowerCase()]=e},PluginManager.loadScript=function(t){var e=this._path+t,i=document.createElement("script");i.type="text/javascript",i.src=e,i.async=!1,i.onerror=this.onError.bind(this),i._url=e,document.body.appendChild(i)},PluginManager.onError=function(t){this._errorUrls.push(t.target._url)},Game_Temp.prototype.initialize=function(){this._isPlaytest=Utils.isOptionValid("test"),this._commonEventId=0,this._destinationX=null,this._destinationY=null},Game_Temp.prototype.isPlaytest=function(){return this._isPlaytest},Game_Temp.prototype.reserveCommonEvent=function(t){this._commonEventId=t},Game_Temp.prototype.clearCommonEvent=function(){this._commonEventId=0},Game_Temp.prototype.isCommonEventReserved=function(){return this._commonEventId>0},Game_Temp.prototype.reservedCommonEvent=function(){return $dataCommonEvents[this._commonEventId]},Game_Temp.prototype.setDestination=function(t,e){this._destinationX=t,this._destinationY=e},Game_Temp.prototype.clearDestination=function(){this._destinationX=null,this._destinationY=null},Game_Temp.prototype.isDestinationValid=function(){return null!==this._destinationX},Game_Temp.prototype.destinationX=function(){return this._destinationX},Game_Temp.prototype.destinationY=function(){return this._destinationY},Game_System.prototype.initialize=function(){this._saveEnabled=!0,this._menuEnabled=!0,this._encounterEnabled=!0,this._formationEnabled=!0,this._battleCount=0,this._winCount=0,this._escapeCount=0,this._saveCount=0,this._versionId=0,this._framesOnSave=0,this._bgmOnSave=null,this._bgsOnSave=null,this._windowTone=null,this._battleBgm=null,this._victoryMe=null,this._defeatMe=null,this._savedBgm=null,this._walkingBgm=null},Game_System.prototype.isJapanese=function(){return $dataSystem.locale.match(/^ja/)},Game_System.prototype.isChinese=function(){return $dataSystem.locale.match(/^zh/)},Game_System.prototype.isKorean=function(){return $dataSystem.locale.match(/^ko/)},Game_System.prototype.isCJK=function(){return $dataSystem.locale.match(/^(ja|zh|ko)/)},Game_System.prototype.isRussian=function(){return $dataSystem.locale.match(/^ru/)},Game_System.prototype.isSideView=function(){return $dataSystem.optSideView},Game_System.prototype.isSaveEnabled=function(){return this._saveEnabled},Game_System.prototype.disableSave=function(){this._saveEnabled=!1},Game_System.prototype.enableSave=function(){this._saveEnabled=!0},Game_System.prototype.isMenuEnabled=function(){return this._menuEnabled},Game_System.prototype.disableMenu=function(){this._menuEnabled=!1},Game_System.prototype.enableMenu=function(){this._menuEnabled=!0},Game_System.prototype.isEncounterEnabled=function(){return this._encounterEnabled},Game_System.prototype.disableEncounter=function(){this._encounterEnabled=!1},Game_System.prototype.enableEncounter=function(){this._encounterEnabled=!0},Game_System.prototype.isFormationEnabled=function(){return this._formationEnabled},Game_System.prototype.disableFormation=function(){this._formationEnabled=!1},Game_System.prototype.enableFormation=function(){this._formationEnabled=!0},Game_System.prototype.battleCount=function(){return this._battleCount},Game_System.prototype.winCount=function(){return this._winCount},Game_System.prototype.escapeCount=function(){return this._escapeCount},Game_System.prototype.saveCount=function(){return this._saveCount},Game_System.prototype.versionId=function(){return this._versionId},Game_System.prototype.windowTone=function(){return this._windowTone||$dataSystem.windowTone},Game_System.prototype.setWindowTone=function(t){this._windowTone=t},Game_System.prototype.battleBgm=function(){return this._battleBgm||$dataSystem.battleBgm},Game_System.prototype.setBattleBgm=function(t){this._battleBgm=t},Game_System.prototype.victoryMe=function(){return this._victoryMe||$dataSystem.victoryMe},Game_System.prototype.setVictoryMe=function(t){this._victoryMe=t},Game_System.prototype.defeatMe=function(){return this._defeatMe||$dataSystem.defeatMe},Game_System.prototype.setDefeatMe=function(t){this._defeatMe=t},Game_System.prototype.onBattleStart=function(){this._battleCount++},Game_System.prototype.onBattleWin=function(){this._winCount++},Game_System.prototype.onBattleEscape=function(){this._escapeCount++},Game_System.prototype.onBeforeSave=function(){this._saveCount++,this._versionId=$dataSystem.versionId,this._framesOnSave=Graphics.frameCount,this._bgmOnSave=AudioManager.saveBgm(),this._bgsOnSave=AudioManager.saveBgs()},Game_System.prototype.onAfterLoad=function(){Graphics.frameCount=this._framesOnSave,AudioManager.playBgm(this._bgmOnSave),AudioManager.playBgs(this._bgsOnSave)},Game_System.prototype.playtime=function(){return Math.floor(Graphics.frameCount/60)},Game_System.prototype.playtimeText=function(){var t=Math.floor(this.playtime()/60/60),e=Math.floor(this.playtime()/60)%60,i=this.playtime()%60;return t.padZero(2)+":"+e.padZero(2)+":"+i.padZero(2)},Game_System.prototype.saveBgm=function(){this._savedBgm=AudioManager.saveBgm()},Game_System.prototype.replayBgm=function(){this._savedBgm&&AudioManager.replayBgm(this._savedBgm)},Game_System.prototype.saveWalkingBgm=function(){this._walkingBgm=AudioManager.saveBgm()},Game_System.prototype.replayWalkingBgm=function(){this._walkingBgm&&AudioManager.playBgm(this._walkingBgm)},Game_System.prototype.saveWalkingBgm2=function(){this._walkingBgm=$dataMap.bgm},Game_Timer.prototype.initialize=function(){this._frames=0,this._working=!1},Game_Timer.prototype.update=function(t){t&&this._working&&this._frames>0&&(this._frames--,0===this._frames&&this.onExpire())},Game_Timer.prototype.start=function(t){this._frames=t,this._working=!0},Game_Timer.prototype.stop=function(){this._working=!1},Game_Timer.prototype.isWorking=function(){return this._working},Game_Timer.prototype.seconds=function(){return Math.floor(this._frames/60)},Game_Timer.prototype.onExpire=function(){BattleManager.abort()},Game_Message.prototype.initialize=function(){this.clear()},Game_Message.prototype.clear=function(){this._texts=[],this._choices=[],this._faceName="",this._faceIndex=0,this._background=0,this._positionType=2,this._choiceDefaultType=0,this._choiceCancelType=0,this._choiceBackground=0,this._choicePositionType=2,this._numInputVariableId=0,this._numInputMaxDigits=0,this._itemChoiceVariableId=0,this._itemChoiceItypeId=0,this._scrollMode=!1,this._scrollSpeed=2,this._scrollNoFast=!1,this._choiceCallback=null},Game_Message.prototype.choices=function(){return this._choices},Game_Message.prototype.faceName=function(){return this._faceName},Game_Message.prototype.faceIndex=function(){return this._faceIndex},Game_Message.prototype.background=function(){return this._background},Game_Message.prototype.positionType=function(){return this._positionType},Game_Message.prototype.choiceDefaultType=function(){return this._choiceDefaultType},Game_Message.prototype.choiceCancelType=function(){return this._choiceCancelType},Game_Message.prototype.choiceBackground=function(){return this._choiceBackground},Game_Message.prototype.choicePositionType=function(){return this._choicePositionType},Game_Message.prototype.numInputVariableId=function(){return this._numInputVariableId},Game_Message.prototype.numInputMaxDigits=function(){return this._numInputMaxDigits},Game_Message.prototype.itemChoiceVariableId=function(){return this._itemChoiceVariableId},Game_Message.prototype.itemChoiceItypeId=function(){return this._itemChoiceItypeId},Game_Message.prototype.scrollMode=function(){return this._scrollMode},Game_Message.prototype.scrollSpeed=function(){return this._scrollSpeed},Game_Message.prototype.scrollNoFast=function(){return this._scrollNoFast},Game_Message.prototype.add=function(t){this._texts.push(t)},Game_Message.prototype.setFaceImage=function(t,e){this._faceName=t,this._faceIndex=e},Game_Message.prototype.setBackground=function(t){this._background=t},Game_Message.prototype.setPositionType=function(t){this._positionType=t},Game_Message.prototype.setChoices=function(t,e,i){this._choices=t,this._choiceDefaultType=e,this._choiceCancelType=i},Game_Message.prototype.setChoiceBackground=function(t){this._choiceBackground=t},Game_Message.prototype.setChoicePositionType=function(t){this._choicePositionType=t},Game_Message.prototype.setNumberInput=function(t,e){this._numInputVariableId=t,this._numInputMaxDigits=e},Game_Message.prototype.setItemChoice=function(t,e){this._itemChoiceVariableId=t,this._itemChoiceItypeId=e},Game_Message.prototype.setScroll=function(t,e){this._scrollMode=!0,this._scrollSpeed=t,this._scrollNoFast=e},Game_Message.prototype.setChoiceCallback=function(t){this._choiceCallback=t},Game_Message.prototype.onChoice=function(t){this._choiceCallback&&(this._choiceCallback(t),this._choiceCallback=null)},Game_Message.prototype.hasText=function(){return this._texts.length>0},Game_Message.prototype.isChoice=function(){return this._choices.length>0},Game_Message.prototype.isNumberInput=function(){return this._numInputVariableId>0},Game_Message.prototype.isItemChoice=function(){return this._itemChoiceVariableId>0},Game_Message.prototype.isBusy=function(){return this.hasText()||this.isChoice()||this.isNumberInput()||this.isItemChoice()},Game_Message.prototype.newPage=function(){this._texts.length>0&&(this._texts[this._texts.length-1]+="\f")},Game_Message.prototype.allText=function(){return this._texts.join("\n")},Game_Switches.prototype.initialize=function(){this.clear()},Game_Switches.prototype.clear=function(){this._data=[]},Game_Switches.prototype.value=function(t){return!!this._data[t]},Game_Switches.prototype.setValue=function(t,e){t>0&&t<$dataSystem.switches.length&&(this._data[t]=e,this.onChange())},Game_Switches.prototype.onChange=function(){$gameMap.requestRefresh()},Game_Variables.prototype.initialize=function(){this.clear()},Game_Variables.prototype.clear=function(){this._data=[]},Game_Variables.prototype.value=function(t){return this._data[t]||0},Game_Variables.prototype.setValue=function(t,e){t>0&&t<$dataSystem.variables.length&&("number"==typeof e&&(e=Math.floor(e)),this._data[t]=e,this.onChange())},Game_Variables.prototype.onChange=function(){$gameMap.requestRefresh()},Game_SelfSwitches.prototype.initialize=function(){this.clear()},Game_SelfSwitches.prototype.clear=function(){this._data={}},Game_SelfSwitches.prototype.value=function(t){return!!this._data[t]},Game_SelfSwitches.prototype.setValue=function(t,e){e?this._data[t]=!0:delete this._data[t],this.onChange()},Game_SelfSwitches.prototype.onChange=function(){$gameMap.requestRefresh()},Game_Screen.prototype.initialize=function(){this.clear()},Game_Screen.prototype.clear=function(){this.clearFade(),this.clearTone(),this.clearFlash(),this.clearShake(),this.clearZoom(),this.clearWeather(),this.clearPictures()},Game_Screen.prototype.onBattleStart=function(){this.clearFade(),this.clearFlash(),this.clearShake(),this.clearZoom(),this.eraseBattlePictures()},Game_Screen.prototype.brightness=function(){return this._brightness},Game_Screen.prototype.tone=function(){return this._tone},Game_Screen.prototype.flashColor=function(){return this._flashColor},Game_Screen.prototype.shake=function(){return this._shake},Game_Screen.prototype.zoomX=function(){return this._zoomX},Game_Screen.prototype.zoomY=function(){return this._zoomY},Game_Screen.prototype.zoomScale=function(){return this._zoomScale},Game_Screen.prototype.weatherType=function(){return this._weatherType},Game_Screen.prototype.weatherPower=function(){return this._weatherPower},Game_Screen.prototype.picture=function(t){var e=this.realPictureId(t);return this._pictures[e]},Game_Screen.prototype.realPictureId=function(t){return $gameParty.inBattle()?t+this.maxPictures():t},Game_Screen.prototype.clearFade=function(){this._brightness=255,this._fadeOutDuration=0,this._fadeInDuration=0},Game_Screen.prototype.clearTone=function(){this._tone=[0,0,0,0],this._toneTarget=[0,0,0,0],this._toneDuration=0},Game_Screen.prototype.clearFlash=function(){this._flashColor=[0,0,0,0],this._flashDuration=0},Game_Screen.prototype.clearShake=function(){this._shakePower=0,this._shakeSpeed=0,this._shakeDuration=0,this._shakeDirection=1,this._shake=0},Game_Screen.prototype.clearZoom=function(){this._zoomX=0,this._zoomY=0,this._zoomScale=1,this._zoomScaleTarget=1,this._zoomDuration=0},Game_Screen.prototype.clearWeather=function(){this._weatherType="none",this._weatherPower=0,this._weatherPowerTarget=0,this._weatherDuration=0},Game_Screen.prototype.clearPictures=function(){this._pictures=[]},Game_Screen.prototype.eraseBattlePictures=function(){this._pictures=this._pictures.slice(0,this.maxPictures()+1)},Game_Screen.prototype.maxPictures=function(){return 100},Game_Screen.prototype.startFadeOut=function(t){this._fadeOutDuration=t,this._fadeInDuration=0},Game_Screen.prototype.startFadeIn=function(t){this._fadeInDuration=t,this._fadeOutDuration=0},Game_Screen.prototype.startTint=function(t,e){this._toneTarget=t.clone(),this._toneDuration=e,0===this._toneDuration&&(this._tone=this._toneTarget.clone())},Game_Screen.prototype.startFlash=function(t,e){this._flashColor=t.clone(),this._flashDuration=e},Game_Screen.prototype.startShake=function(t,e,i){this._shakePower=t,this._shakeSpeed=e,this._shakeDuration=i},Game_Screen.prototype.startZoom=function(t,e,i,r){this._zoomX=t,this._zoomY=e,this._zoomScaleTarget=i,this._zoomDuration=r},Game_Screen.prototype.setZoom=function(t,e,i){this._zoomX=t,this._zoomY=e,this._zoomScale=i},Game_Screen.prototype.changeWeather=function(t,e,i){"none"===t&&0!==i||(this._weatherType=t),this._weatherPowerTarget="none"===t?0:e,this._weatherDuration=i,0===i&&(this._weatherPower=this._weatherPowerTarget)},Game_Screen.prototype.update=function(){this.updateFadeOut(),this.updateFadeIn(),this.updateTone(),this.updateFlash(),this.updateShake(),this.updateZoom(),this.updateWeather(),this.updatePictures()},Game_Screen.prototype.updateFadeOut=function(){if(this._fadeOutDuration>0){var t=this._fadeOutDuration;this._brightness=this._brightness*(t-1)/t,this._fadeOutDuration--}},Game_Screen.prototype.updateFadeIn=function(){if(this._fadeInDuration>0){var t=this._fadeInDuration;this._brightness=(this._brightness*(t-1)+255)/t,this._fadeInDuration--}},Game_Screen.prototype.updateTone=function(){if(this._toneDuration>0){for(var t=this._toneDuration,e=0;e<4;e++)this._tone[e]=(this._tone[e]*(t-1)+this._toneTarget[e])/t;this._toneDuration--}},Game_Screen.prototype.updateFlash=function(){if(this._flashDuration>0){var t=this._flashDuration;this._flashColor[3]*=(t-1)/t,this._flashDuration--}},Game_Screen.prototype.updateShake=function(){if(this._shakeDuration>0||0!==this._shake){var t=this._shakePower*this._shakeSpeed*this._shakeDirection/10;this._shakeDuration<=1&&this._shake*(this._shake+t)<0?this._shake=0:this._shake+=t,this._shake>2*this._shakePower&&(this._shakeDirection=-1),this._shake<2*-this._shakePower&&(this._shakeDirection=1),this._shakeDuration--}},Game_Screen.prototype.updateZoom=function(){if(this._zoomDuration>0){var t=this._zoomDuration;this._zoomScale=(this._zoomScale*(t-1)+this._zoomScaleTarget)/t,this._zoomDuration--}},Game_Screen.prototype.updateWeather=function(){if(this._weatherDuration>0){var t=this._weatherDuration;this._weatherPower=(this._weatherPower*(t-1)+this._weatherPowerTarget)/t,this._weatherDuration--,0===this._weatherDuration&&0===this._weatherPowerTarget&&(this._weatherType="none")}},Game_Screen.prototype.updatePictures=function(){this._pictures.forEach(function(t){t&&t.update()})},Game_Screen.prototype.startFlashForDamage=function(){this.startFlash([255,0,0,128],8)},Game_Screen.prototype.showPicture=function(t,e,i,r,n,a,o,s,h){var c=this.realPictureId(t),u=new Game_Picture;u.show(e,i,r,n,a,o,s,h),this._pictures[c]=u},Game_Screen.prototype.movePicture=function(t,e,i,r,n,a,o,s,h){var c=this.picture(t);c&&c.move(e,i,r,n,a,o,s,h)},Game_Screen.prototype.rotatePicture=function(t,e){var i=this.picture(t);i&&i.rotate(e)},Game_Screen.prototype.tintPicture=function(t,e,i){var r=this.picture(t);r&&r.tint(e,i)},Game_Screen.prototype.erasePicture=function(t){var e=this.realPictureId(t);this._pictures[e]=null},Game_Picture.prototype.initialize=function(){this.initBasic(),this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.name=function(){return this._name},Game_Picture.prototype.origin=function(){return this._origin},Game_Picture.prototype.x=function(){return this._x},Game_Picture.prototype.y=function(){return this._y},Game_Picture.prototype.scaleX=function(){return this._scaleX},Game_Picture.prototype.scaleY=function(){return this._scaleY},Game_Picture.prototype.opacity=function(){return this._opacity},Game_Picture.prototype.blendMode=function(){return this._blendMode},Game_Picture.prototype.tone=function(){return this._tone},Game_Picture.prototype.angle=function(){return this._angle},Game_Picture.prototype.initBasic=function(){this._name="",this._origin=0,this._x=0,this._y=0,this._scaleX=100,this._scaleY=100,this._opacity=255,this._blendMode=0},Game_Picture.prototype.initTarget=function(){this._targetX=this._x,this._targetY=this._y,this._targetScaleX=this._scaleX,this._targetScaleY=this._scaleY,this._targetOpacity=this._opacity,this._duration=0},Game_Picture.prototype.initTone=function(){this._tone=null,this._toneTarget=null,this._toneDuration=0},Game_Picture.prototype.initRotation=function(){this._angle=0,this._rotationSpeed=0},Game_Picture.prototype.show=function(t,e,i,r,n,a,o,s){this._name=t,this._origin=e,this._x=i,this._y=r,this._scaleX=n,this._scaleY=a,this._opacity=o,this._blendMode=s,this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.move=function(t,e,i,r,n,a,o,s){this._origin=t,this._targetX=e,this._targetY=i,this._targetScaleX=r,this._targetScaleY=n,this._targetOpacity=a,this._blendMode=o,this._duration=s},Game_Picture.prototype.rotate=function(t){this._rotationSpeed=t},Game_Picture.prototype.tint=function(t,e){this._tone||(this._tone=[0,0,0,0]),this._toneTarget=t.clone(),this._toneDuration=e,0===this._toneDuration&&(this._tone=this._toneTarget.clone())},Game_Picture.prototype.erase=function(){this._name="",this._origin=0,this.initTarget(),this.initTone(),this.initRotation()},Game_Picture.prototype.update=function(){this.updateMove(),this.updateTone(),this.updateRotation()},Game_Picture.prototype.updateMove=function(){if(this._duration>0){var t=this._duration;this._x=(this._x*(t-1)+this._targetX)/t,this._y=(this._y*(t-1)+this._targetY)/t,this._scaleX=(this._scaleX*(t-1)+this._targetScaleX)/t,this._scaleY=(this._scaleY*(t-1)+this._targetScaleY)/t,this._opacity=(this._opacity*(t-1)+this._targetOpacity)/t,this._duration--}},Game_Picture.prototype.updateTone=function(){if(this._toneDuration>0){for(var t=this._toneDuration,e=0;e<4;e++)this._tone[e]=(this._tone[e]*(t-1)+this._toneTarget[e])/t;this._toneDuration--}},Game_Picture.prototype.updateRotation=function(){0!==this._rotationSpeed&&(this._angle+=this._rotationSpeed/2)},Game_Item.prototype.initialize=function(t){this._dataClass="",this._itemId=0,t&&this.setObject(t)},Game_Item.prototype.isSkill=function(){return"skill"===this._dataClass},Game_Item.prototype.isItem=function(){return"item"===this._dataClass},Game_Item.prototype.isUsableItem=function(){return this.isSkill()||this.isItem()},Game_Item.prototype.isWeapon=function(){return"weapon"===this._dataClass},Game_Item.prototype.isArmor=function(){return"armor"===this._dataClass},Game_Item.prototype.isEquipItem=function(){return this.isWeapon()||this.isArmor()},Game_Item.prototype.isNull=function(){return""===this._dataClass},Game_Item.prototype.itemId=function(){return this._itemId},Game_Item.prototype.object=function(){return this.isSkill()?$dataSkills[this._itemId]:this.isItem()?$dataItems[this._itemId]:this.isWeapon()?$dataWeapons[this._itemId]:this.isArmor()?$dataArmors[this._itemId]:null},Game_Item.prototype.setObject=function(t){this._dataClass=DataManager.isSkill(t)?"skill":DataManager.isItem(t)?"item":DataManager.isWeapon(t)?"weapon":DataManager.isArmor(t)?"armor":"",this._itemId=t?t.id:0},Game_Item.prototype.setEquip=function(t,e){this._dataClass=t?"weapon":"armor",this._itemId=e},Game_Action.EFFECT_RECOVER_HP=11,Game_Action.EFFECT_RECOVER_MP=12,Game_Action.EFFECT_GAIN_TP=13,Game_Action.EFFECT_ADD_STATE=21,Game_Action.EFFECT_REMOVE_STATE=22,Game_Action.EFFECT_ADD_BUFF=31,Game_Action.EFFECT_ADD_DEBUFF=32,Game_Action.EFFECT_REMOVE_BUFF=33,Game_Action.EFFECT_REMOVE_DEBUFF=34,Game_Action.EFFECT_SPECIAL=41,Game_Action.EFFECT_GROW=42,Game_Action.EFFECT_LEARN_SKILL=43,Game_Action.EFFECT_COMMON_EVENT=44,Game_Action.SPECIAL_EFFECT_ESCAPE=0,Game_Action.HITTYPE_CERTAIN=0,Game_Action.HITTYPE_PHYSICAL=1,Game_Action.HITTYPE_MAGICAL=2,Game_Action.prototype.initialize=function(t,e){this._subjectActorId=0,this._subjectEnemyIndex=-1,this._forcing=e||!1,this.setSubject(t),this.clear()},Game_Action.prototype.clear=function(){this._item=new Game_Item,this._targetIndex=-1},Game_Action.prototype.setSubject=function(t){t.isActor()?(this._subjectActorId=t.actorId(),this._subjectEnemyIndex=-1):(this._subjectEnemyIndex=t.index(),this._subjectActorId=0)},Game_Action.prototype.subject=function(){return this._subjectActorId>0?$gameActors.actor(this._subjectActorId):$gameTroop.members()[this._subjectEnemyIndex]},Game_Action.prototype.friendsUnit=function(){return this.subject().friendsUnit()},Game_Action.prototype.opponentsUnit=function(){return this.subject().opponentsUnit()},Game_Action.prototype.setEnemyAction=function(t){t?this.setSkill(t.skillId):this.clear()},Game_Action.prototype.setAttack=function(){this.setSkill(this.subject().attackSkillId())},Game_Action.prototype.setGuard=function(){this.setSkill(this.subject().guardSkillId())},Game_Action.prototype.setSkill=function(t){this._item.setObject($dataSkills[t])},Game_Action.prototype.setItem=function(t){this._item.setObject($dataItems[t])},Game_Action.prototype.setItemObject=function(t){this._item.setObject(t)},Game_Action.prototype.setTarget=function(t){this._targetIndex=t},Game_Action.prototype.item=function(){return this._item.object()},Game_Action.prototype.isSkill=function(){return this._item.isSkill()},Game_Action.prototype.isItem=function(){return this._item.isItem()},Game_Action.prototype.numRepeats=function(){var t=this.item().repeats;return this.isAttack()&&(t+=this.subject().attackTimesAdd()),Math.floor(t)},Game_Action.prototype.checkItemScope=function(t){return t.contains(this.item().scope)},Game_Action.prototype.isForOpponent=function(){return this.checkItemScope([1,2,3,4,5,6])},Game_Action.prototype.isForFriend=function(){return this.checkItemScope([7,8,9,10,11])},Game_Action.prototype.isForDeadFriend=function(){return this.checkItemScope([9,10])},Game_Action.prototype.isForUser=function(){return this.checkItemScope([11])},Game_Action.prototype.isForOne=function(){return this.checkItemScope([1,3,7,9,11])},Game_Action.prototype.isForRandom=function(){return this.checkItemScope([3,4,5,6])},Game_Action.prototype.isForAll=function(){return this.checkItemScope([2,8,10])},Game_Action.prototype.needsSelection=function(){return this.checkItemScope([1,7,9])},Game_Action.prototype.numTargets=function(){return this.isForRandom()?this.item().scope-2:0},Game_Action.prototype.checkDamageType=function(t){return t.contains(this.item().damage.type)},Game_Action.prototype.isHpEffect=function(){return this.checkDamageType([1,3,5])},Game_Action.prototype.isMpEffect=function(){return this.checkDamageType([2,4,6])},Game_Action.prototype.isDamage=function(){return this.checkDamageType([1,2])},Game_Action.prototype.isRecover=function(){return this.checkDamageType([3,4])},Game_Action.prototype.isDrain=function(){return this.checkDamageType([5,6])},Game_Action.prototype.isHpRecover=function(){return this.checkDamageType([3])},Game_Action.prototype.isMpRecover=function(){return this.checkDamageType([4])},Game_Action.prototype.isCertainHit=function(){return this.item().hitType===Game_Action.HITTYPE_CERTAIN},Game_Action.prototype.isPhysical=function(){return this.item().hitType===Game_Action.HITTYPE_PHYSICAL},Game_Action.prototype.isMagical=function(){return this.item().hitType===Game_Action.HITTYPE_MAGICAL},Game_Action.prototype.isAttack=function(){return this.item()===$dataSkills[this.subject().attackSkillId()]},Game_Action.prototype.isGuard=function(){return this.item()===$dataSkills[this.subject().guardSkillId()]},Game_Action.prototype.isMagicSkill=function(){return!!this.isSkill()&&$dataSystem.magicSkills.contains(this.item().stypeId)},Game_Action.prototype.decideRandomTarget=function(){var t;(t=this.isForDeadFriend()?this.friendsUnit().randomDeadTarget():this.isForFriend()?this.friendsUnit().randomTarget():this.opponentsUnit().randomTarget())?this._targetIndex=t.index():this.clear()},Game_Action.prototype.setConfusion=function(){this.setAttack()},Game_Action.prototype.prepare=function(){this.subject().isConfused()&&!this._forcing&&this.setConfusion()},Game_Action.prototype.isValid=function(){return this._forcing&&this.item()||this.subject().canUse(this.item())},Game_Action.prototype.speed=function(){var t=this.subject().agi,e=t+Math.randomInt(Math.floor(5+t/4));return this.item()&&(e+=this.item().speed),this.isAttack()&&(e+=this.subject().attackSpeed()),e},Game_Action.prototype.makeTargets=function(){var t=[];return!this._forcing&&this.subject().isConfused()?t=[this.confusionTarget()]:this.isForOpponent()?t=this.targetsForOpponents():this.isForFriend()&&(t=this.targetsForFriends()),this.repeatTargets(t)},Game_Action.prototype.repeatTargets=function(t){for(var e=[],i=this.numRepeats(),r=0;r<t.length;r++){var n=t[r];if(n)for(var a=0;a<i;a++)e.push(n)}return e},Game_Action.prototype.confusionTarget=function(){switch(this.subject().confusionLevel()){case 1:return this.opponentsUnit().randomTarget();case 2:return 0===Math.randomInt(2)?this.opponentsUnit().randomTarget():this.friendsUnit().randomTarget();default:return this.friendsUnit().randomTarget()}},Game_Action.prototype.targetsForOpponents=function(){var t=[],e=this.opponentsUnit();if(this.isForRandom())for(var i=0;i<this.numTargets();i++)t.push(e.randomTarget());else this.isForOne()?t.push(this._targetIndex<0?e.randomTarget():e.smoothTarget(this._targetIndex)):t=e.aliveMembers();return t},Game_Action.prototype.targetsForFriends=function(){var t=[],e=this.friendsUnit();return this.isForUser()?[this.subject()]:(this.isForDeadFriend()?this.isForOne()?t.push(e.smoothDeadTarget(this._targetIndex)):t=e.deadMembers():this.isForOne()?t.push(this._targetIndex<0?e.randomTarget():e.smoothTarget(this._targetIndex)):t=e.aliveMembers(),t)},Game_Action.prototype.evaluate=function(){var t=0;return this.itemTargetCandidates().forEach(function(e){var i=this.evaluateWithTarget(e);this.isForAll()?t+=i:i>t&&(t=i,this._targetIndex=e.index())},this),(t*=this.numRepeats())>0&&(t+=Math.random()),t},Game_Action.prototype.itemTargetCandidates=function(){return this.isValid()?this.isForOpponent()?this.opponentsUnit().aliveMembers():this.isForUser()?[this.subject()]:this.isForDeadFriend()?this.friendsUnit().deadMembers():this.friendsUnit().aliveMembers():[]},Game_Action.prototype.evaluateWithTarget=function(t){if(this.isHpEffect()){var e=this.makeDamageValue(t,!1);return this.isForOpponent()?e/Math.max(t.hp,1):Math.min(-e,t.mhp-t.hp)/t.mhp}},Game_Action.prototype.testApply=function(t){return this.isForDeadFriend()===t.isDead()&&($gameParty.inBattle()||this.isForOpponent()||this.isHpRecover()&&t.hp<t.mhp||this.isMpRecover()&&t.mp<t.mmp||this.hasItemAnyValidEffects(t))},Game_Action.prototype.hasItemAnyValidEffects=function(t){return this.item().effects.some(function(e){return this.testItemEffect(t,e)},this)},Game_Action.prototype.testItemEffect=function(t,e){switch(e.code){case Game_Action.EFFECT_RECOVER_HP:return t.hp<t.mhp||e.value1<0||e.value2<0;case Game_Action.EFFECT_RECOVER_MP:return t.mp<t.mmp||e.value1<0||e.value2<0;case Game_Action.EFFECT_ADD_STATE:return!t.isStateAffected(e.dataId);case Game_Action.EFFECT_REMOVE_STATE:return t.isStateAffected(e.dataId);case Game_Action.EFFECT_ADD_BUFF:return!t.isMaxBuffAffected(e.dataId);case Game_Action.EFFECT_ADD_DEBUFF:return!t.isMaxDebuffAffected(e.dataId);case Game_Action.EFFECT_REMOVE_BUFF:return t.isBuffAffected(e.dataId);case Game_Action.EFFECT_REMOVE_DEBUFF:return t.isDebuffAffected(e.dataId);case Game_Action.EFFECT_LEARN_SKILL:return t.isActor()&&!t.isLearnedSkill(e.dataId);default:return!0}},Game_Action.prototype.itemCnt=function(t){return this.isPhysical()&&t.canMove()?t.cnt:0},Game_Action.prototype.itemMrf=function(t){return this.isMagical()?t.mrf:0},Game_Action.prototype.itemHit=function(t){return this.isPhysical()?.01*this.item().successRate*this.subject().hit:.01*this.item().successRate},Game_Action.prototype.itemEva=function(t){return this.isPhysical()?t.eva:this.isMagical()?t.mev:0},Game_Action.prototype.itemCri=function(t){return this.item().damage.critical?this.subject().cri*(1-t.cev):0},Game_Action.prototype.apply=function(t){var e=t.result();if(this.subject().clearResult(),e.clear(),e.used=this.testApply(t),e.missed=e.used&&Math.random()>=this.itemHit(t),e.evaded=!e.missed&&Math.random()<this.itemEva(t),e.physical=this.isPhysical(),e.drain=this.isDrain(),e.isHit()){if(this.item().damage.type>0){e.critical=Math.random()<this.itemCri(t);var i=this.makeDamageValue(t,e.critical);this.executeDamage(t,i)}this.item().effects.forEach(function(e){this.applyItemEffect(t,e)},this),this.applyItemUserEffect(t)}},Game_Action.prototype.makeDamageValue=function(t,e){var i=this.item(),r=this.evalDamageFormula(t),n=r*this.calcElementRate(t);return this.isPhysical()&&(n*=t.pdr),this.isMagical()&&(n*=t.mdr),r<0&&(n*=t.rec),e&&(n=this.applyCritical(n)),n=this.applyVariance(n,i.damage.variance),n=this.applyGuard(n,t),Math.round(n)},Game_Action.prototype.evalDamageFormula=function(target){try{var item=this.item(),a=this.subject(),b=target,v=$gameVariables._data,sign=[3,4].contains(item.damage.type)?-1:1,value=Math.max(eval(item.damage.formula),0)*sign;return isNaN(value)&&(value=0),value}catch(e){return 0}},Game_Action.prototype.calcElementRate=function(t){return this.item().damage.elementId<0?this.elementsMaxRate(t,this.subject().attackElements()):t.elementRate(this.item().damage.elementId)},Game_Action.prototype.elementsMaxRate=function(t,e){return e.length>0?Math.max.apply(null,e.map(function(e){return t.elementRate(e)},this)):1},Game_Action.prototype.applyCritical=function(t){return 3*t},Game_Action.prototype.applyVariance=function(t,e){var i=Math.floor(Math.max(Math.abs(t)*e/100,0)),r=Math.randomInt(i+1)+Math.randomInt(i+1)-i;return t>=0?t+r:t-r},Game_Action.prototype.applyGuard=function(t,e){return t/(t>0&&e.isGuard()?2*e.grd:1)},Game_Action.prototype.executeDamage=function(t,e){var i=t.result();0===e&&(i.critical=!1),this.isHpEffect()&&this.executeHpDamage(t,e),this.isMpEffect()&&this.executeMpDamage(t,e)},Game_Action.prototype.executeHpDamage=function(t,e){this.isDrain()&&(e=Math.min(t.hp,e)),this.makeSuccess(t),t.gainHp(-e),e>0&&t.onDamage(e),this.gainDrainedHp(e)},Game_Action.prototype.executeMpDamage=function(t,e){this.isMpRecover()||(e=Math.min(t.mp,e)),0!==e&&this.makeSuccess(t),t.gainMp(-e),this.gainDrainedMp(e)},Game_Action.prototype.gainDrainedHp=function(t){if(this.isDrain()){var e=this.subject();void 0!==this._reflectionTarget&&(e=this._reflectionTarget),e.gainHp(t)}},Game_Action.prototype.gainDrainedMp=function(t){if(this.isDrain()){var e=this.subject();void 0!==this._reflectionTarget&&(e=this._reflectionTarget),e.gainMp(t)}},Game_Action.prototype.applyItemEffect=function(t,e){switch(e.code){case Game_Action.EFFECT_RECOVER_HP:this.itemEffectRecoverHp(t,e);break;case Game_Action.EFFECT_RECOVER_MP:this.itemEffectRecoverMp(t,e);break;case Game_Action.EFFECT_GAIN_TP:this.itemEffectGainTp(t,e);break;case Game_Action.EFFECT_ADD_STATE:this.itemEffectAddState(t,e);break;case Game_Action.EFFECT_REMOVE_STATE:this.itemEffectRemoveState(t,e);break;case Game_Action.EFFECT_ADD_BUFF:this.itemEffectAddBuff(t,e);break;case Game_Action.EFFECT_ADD_DEBUFF:this.itemEffectAddDebuff(t,e);break;case Game_Action.EFFECT_REMOVE_BUFF:this.itemEffectRemoveBuff(t,e);break;case Game_Action.EFFECT_REMOVE_DEBUFF:this.itemEffectRemoveDebuff(t,e);break;case Game_Action.EFFECT_SPECIAL:this.itemEffectSpecial(t,e);break;case Game_Action.EFFECT_GROW:this.itemEffectGrow(t,e);break;case Game_Action.EFFECT_LEARN_SKILL:this.itemEffectLearnSkill(t,e);break;case Game_Action.EFFECT_COMMON_EVENT:this.itemEffectCommonEvent(t,e)}},Game_Action.prototype.itemEffectRecoverHp=function(t,e){var i=(t.mhp*e.value1+e.value2)*t.rec;this.isItem()&&(i*=this.subject().pha),0!==(i=Math.floor(i))&&(t.gainHp(i),this.makeSuccess(t))},Game_Action.prototype.itemEffectRecoverMp=function(t,e){var i=(t.mmp*e.value1+e.value2)*t.rec;this.isItem()&&(i*=this.subject().pha),0!==(i=Math.floor(i))&&(t.gainMp(i),this.makeSuccess(t))},Game_Action.prototype.itemEffectGainTp=function(t,e){var i=Math.floor(e.value1);0!==i&&(t.gainTp(i),this.makeSuccess(t))},Game_Action.prototype.itemEffectAddState=function(t,e){0===e.dataId?this.itemEffectAddAttackState(t,e):this.itemEffectAddNormalState(t,e)},Game_Action.prototype.itemEffectAddAttackState=function(t,e){this.subject().attackStates().forEach((function(i){var r=e.value1;r*=t.stateRate(i),r*=this.subject().attackStatesRate(i),r*=this.lukEffectRate(t),Math.random()<r&&(t.addState(i),this.makeSuccess(t))}).bind(this),t)},Game_Action.prototype.itemEffectAddNormalState=function(t,e){var i=e.value1;this.isCertainHit()||(i*=t.stateRate(e.dataId),i*=this.lukEffectRate(t)),Math.random()<i&&(t.addState(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectRemoveState=function(t,e){var i=e.value1;Math.random()<i&&(t.removeState(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectAddBuff=function(t,e){t.addBuff(e.dataId,e.value1),this.makeSuccess(t)},Game_Action.prototype.itemEffectAddDebuff=function(t,e){var i=t.debuffRate(e.dataId)*this.lukEffectRate(t);Math.random()<i&&(t.addDebuff(e.dataId,e.value1),this.makeSuccess(t))},Game_Action.prototype.itemEffectRemoveBuff=function(t,e){t.isBuffAffected(e.dataId)&&(t.removeBuff(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectRemoveDebuff=function(t,e){t.isDebuffAffected(e.dataId)&&(t.removeBuff(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectSpecial=function(t,e){e.dataId===Game_Action.SPECIAL_EFFECT_ESCAPE&&(t.escape(),this.makeSuccess(t))},Game_Action.prototype.itemEffectGrow=function(t,e){t.addParam(e.dataId,Math.floor(e.value1)),this.makeSuccess(t)},Game_Action.prototype.itemEffectLearnSkill=function(t,e){t.isActor()&&(t.learnSkill(e.dataId),this.makeSuccess(t))},Game_Action.prototype.itemEffectCommonEvent=function(t,e){},Game_Action.prototype.makeSuccess=function(t){t.result().success=!0},Game_Action.prototype.applyItemUserEffect=function(t){var e=Math.floor(this.item().tpGain*this.subject().tcr);this.subject().gainSilentTp(e)},Game_Action.prototype.lukEffectRate=function(t){return Math.max(1+.001*(this.subject().luk-t.luk),0)},Game_Action.prototype.applyGlobal=function(){this.item().effects.forEach(function(t){t.code===Game_Action.EFFECT_COMMON_EVENT&&$gameTemp.reserveCommonEvent(t.dataId)},this)},Game_ActionResult.prototype.initialize=function(){this.clear()},Game_ActionResult.prototype.clear=function(){this.used=!1,this.missed=!1,this.evaded=!1,this.physical=!1,this.drain=!1,this.critical=!1,this.success=!1,this.hpAffected=!1,this.hpDamage=0,this.mpDamage=0,this.tpDamage=0,this.addedStates=[],this.removedStates=[],this.addedBuffs=[],this.addedDebuffs=[],this.removedBuffs=[]},Game_ActionResult.prototype.addedStateObjects=function(){return this.addedStates.map(function(t){return $dataStates[t]})},Game_ActionResult.prototype.removedStateObjects=function(){return this.removedStates.map(function(t){return $dataStates[t]})},Game_ActionResult.prototype.isStatusAffected=function(){return this.addedStates.length>0||this.removedStates.length>0||this.addedBuffs.length>0||this.addedDebuffs.length>0||this.removedBuffs.length>0},Game_ActionResult.prototype.isHit=function(){return this.used&&!this.missed&&!this.evaded},Game_ActionResult.prototype.isStateAdded=function(t){return this.addedStates.contains(t)},Game_ActionResult.prototype.pushAddedState=function(t){this.isStateAdded(t)||this.addedStates.push(t)},Game_ActionResult.prototype.isStateRemoved=function(t){return this.removedStates.contains(t)},Game_ActionResult.prototype.pushRemovedState=function(t){this.isStateRemoved(t)||this.removedStates.push(t)},Game_ActionResult.prototype.isBuffAdded=function(t){return this.addedBuffs.contains(t)},Game_ActionResult.prototype.pushAddedBuff=function(t){this.isBuffAdded(t)||this.addedBuffs.push(t)},Game_ActionResult.prototype.isDebuffAdded=function(t){return this.addedDebuffs.contains(t)},Game_ActionResult.prototype.pushAddedDebuff=function(t){this.isDebuffAdded(t)||this.addedDebuffs.push(t)},Game_ActionResult.prototype.isBuffRemoved=function(t){return this.removedBuffs.contains(t)},Game_ActionResult.prototype.pushRemovedBuff=function(t){this.isBuffRemoved(t)||this.removedBuffs.push(t)},Game_BattlerBase.TRAIT_ELEMENT_RATE=11,Game_BattlerBase.TRAIT_DEBUFF_RATE=12,Game_BattlerBase.TRAIT_STATE_RATE=13,Game_BattlerBase.TRAIT_STATE_RESIST=14,Game_BattlerBase.TRAIT_PARAM=21,Game_BattlerBase.TRAIT_XPARAM=22,Game_BattlerBase.TRAIT_SPARAM=23,Game_BattlerBase.TRAIT_ATTACK_ELEMENT=31,Game_BattlerBase.TRAIT_ATTACK_STATE=32,Game_BattlerBase.TRAIT_ATTACK_SPEED=33,Game_BattlerBase.TRAIT_ATTACK_TIMES=34,Game_BattlerBase.TRAIT_STYPE_ADD=41,Game_BattlerBase.TRAIT_STYPE_SEAL=42,Game_BattlerBase.TRAIT_SKILL_ADD=43,Game_BattlerBase.TRAIT_SKILL_SEAL=44,Game_BattlerBase.TRAIT_EQUIP_WTYPE=51,Game_BattlerBase.TRAIT_EQUIP_ATYPE=52,Game_BattlerBase.TRAIT_EQUIP_LOCK=53,Game_BattlerBase.TRAIT_EQUIP_SEAL=54,Game_BattlerBase.TRAIT_SLOT_TYPE=55,Game_BattlerBase.TRAIT_ACTION_PLUS=61,Game_BattlerBase.TRAIT_SPECIAL_FLAG=62,Game_BattlerBase.TRAIT_COLLAPSE_TYPE=63,Game_BattlerBase.TRAIT_PARTY_ABILITY=64,Game_BattlerBase.FLAG_ID_AUTO_BATTLE=0,Game_BattlerBase.FLAG_ID_GUARD=1,Game_BattlerBase.FLAG_ID_SUBSTITUTE=2,Game_BattlerBase.FLAG_ID_PRESERVE_TP=3,Game_BattlerBase.ICON_BUFF_START=32,Game_BattlerBase.ICON_DEBUFF_START=48,Object.defineProperties(Game_BattlerBase.prototype,{hp:{get:function(){return this._hp},configurable:!0},mp:{get:function(){return this._mp},configurable:!0},tp:{get:function(){return this._tp},configurable:!0},mhp:{get:function(){return this.param(0)},configurable:!0},mmp:{get:function(){return this.param(1)},configurable:!0},atk:{get:function(){return this.param(2)},configurable:!0},def:{get:function(){return this.param(3)},configurable:!0},mat:{get:function(){return this.param(4)},configurable:!0},mdf:{get:function(){return this.param(5)},configurable:!0},agi:{get:function(){return this.param(6)},configurable:!0},luk:{get:function(){return this.param(7)},configurable:!0},hit:{get:function(){return this.xparam(0)},configurable:!0},eva:{get:function(){return this.xparam(1)},configurable:!0},cri:{get:function(){return this.xparam(2)},configurable:!0},cev:{get:function(){return this.xparam(3)},configurable:!0},mev:{get:function(){return this.xparam(4)},configurable:!0},mrf:{get:function(){return this.xparam(5)},configurable:!0},cnt:{get:function(){return this.xparam(6)},configurable:!0},hrg:{get:function(){return this.xparam(7)},configurable:!0},mrg:{get:function(){return this.xparam(8)},configurable:!0},trg:{get:function(){return this.xparam(9)},configurable:!0},tgr:{get:function(){return this.sparam(0)},configurable:!0},grd:{get:function(){return this.sparam(1)},configurable:!0},rec:{get:function(){return this.sparam(2)},configurable:!0},pha:{get:function(){return this.sparam(3)},configurable:!0},mcr:{get:function(){return this.sparam(4)},configurable:!0},tcr:{get:function(){return this.sparam(5)},configurable:!0},pdr:{get:function(){return this.sparam(6)},configurable:!0},mdr:{get:function(){return this.sparam(7)},configurable:!0},fdr:{get:function(){return this.sparam(8)},configurable:!0},exr:{get:function(){return this.sparam(9)},configurable:!0}}),Game_BattlerBase.prototype.initialize=function(){this.initMembers()},Game_BattlerBase.prototype.initMembers=function(){this._hp=1,this._mp=0,this._tp=0,this._hidden=!1,this.clearParamPlus(),this.clearStates(),this.clearBuffs()},Game_BattlerBase.prototype.clearParamPlus=function(){this._paramPlus=[0,0,0,0,0,0,0,0]},Game_BattlerBase.prototype.clearStates=function(){this._states=[],this._stateTurns={}},Game_BattlerBase.prototype.eraseState=function(t){var e=this._states.indexOf(t);e>=0&&this._states.splice(e,1),delete this._stateTurns[t]},Game_BattlerBase.prototype.isStateAffected=function(t){return this._states.contains(t)},Game_BattlerBase.prototype.isDeathStateAffected=function(){return this.isStateAffected(this.deathStateId())},Game_BattlerBase.prototype.deathStateId=function(){return 1},Game_BattlerBase.prototype.resetStateCounts=function(t){var e=$dataStates[t],i=1+Math.max(e.maxTurns-e.minTurns,0);this._stateTurns[t]=e.minTurns+Math.randomInt(i)},Game_BattlerBase.prototype.isStateExpired=function(t){return 0===this._stateTurns[t]},Game_BattlerBase.prototype.updateStateTurns=function(){this._states.forEach(function(t){this._stateTurns[t]>0&&this._stateTurns[t]--},this)},Game_BattlerBase.prototype.clearBuffs=function(){this._buffs=[0,0,0,0,0,0,0,0],this._buffTurns=[0,0,0,0,0,0,0,0]},Game_BattlerBase.prototype.eraseBuff=function(t){this._buffs[t]=0,this._buffTurns[t]=0},Game_BattlerBase.prototype.buffLength=function(){return this._buffs.length},Game_BattlerBase.prototype.buff=function(t){return this._buffs[t]},Game_BattlerBase.prototype.isBuffAffected=function(t){return this._buffs[t]>0},Game_BattlerBase.prototype.isDebuffAffected=function(t){return this._buffs[t]<0},Game_BattlerBase.prototype.isBuffOrDebuffAffected=function(t){return 0!==this._buffs[t]},Game_BattlerBase.prototype.isMaxBuffAffected=function(t){return 2===this._buffs[t]},Game_BattlerBase.prototype.isMaxDebuffAffected=function(t){return-2===this._buffs[t]},Game_BattlerBase.prototype.increaseBuff=function(t){this.isMaxBuffAffected(t)||this._buffs[t]++},Game_BattlerBase.prototype.decreaseBuff=function(t){this.isMaxDebuffAffected(t)||this._buffs[t]--},Game_BattlerBase.prototype.overwriteBuffTurns=function(t,e){this._buffTurns[t]<e&&(this._buffTurns[t]=e)},Game_BattlerBase.prototype.isBuffExpired=function(t){return 0===this._buffTurns[t]},Game_BattlerBase.prototype.updateBuffTurns=function(){for(var t=0;t<this._buffTurns.length;t++)this._buffTurns[t]>0&&this._buffTurns[t]--},Game_BattlerBase.prototype.die=function(){this._hp=0,this.clearStates(),this.clearBuffs()},Game_BattlerBase.prototype.revive=function(){0===this._hp&&(this._hp=1)},Game_BattlerBase.prototype.states=function(){return this._states.map(function(t){return $dataStates[t]})},Game_BattlerBase.prototype.stateIcons=function(){return this.states().map(function(t){return t.iconIndex}).filter(function(t){return t>0})},Game_BattlerBase.prototype.buffIcons=function(){for(var t=[],e=0;e<this._buffs.length;e++)0!==this._buffs[e]&&t.push(this.buffIconIndex(this._buffs[e],e));return t},Game_BattlerBase.prototype.buffIconIndex=function(t,e){return t>0?Game_BattlerBase.ICON_BUFF_START+8*(t-1)+e:t<0?Game_BattlerBase.ICON_DEBUFF_START+8*(-t-1)+e:0},Game_BattlerBase.prototype.allIcons=function(){return this.stateIcons().concat(this.buffIcons())},Game_BattlerBase.prototype.traitObjects=function(){return this.states()},Game_BattlerBase.prototype.allTraits=function(){return this.traitObjects().reduce(function(t,e){return t.concat(e.traits)},[])},Game_BattlerBase.prototype.traits=function(t){return this.allTraits().filter(function(e){return e.code===t})},Game_BattlerBase.prototype.traitsWithId=function(t,e){return this.allTraits().filter(function(i){return i.code===t&&i.dataId===e})},Game_BattlerBase.prototype.traitsPi=function(t,e){return this.traitsWithId(t,e).reduce(function(t,e){return t*e.value},1)},Game_BattlerBase.prototype.traitsSum=function(t,e){return this.traitsWithId(t,e).reduce(function(t,e){return t+e.value},0)},Game_BattlerBase.prototype.traitsSumAll=function(t){return this.traits(t).reduce(function(t,e){return t+e.value},0)},Game_BattlerBase.prototype.traitsSet=function(t){return this.traits(t).reduce(function(t,e){return t.concat(e.dataId)},[])},Game_BattlerBase.prototype.paramBase=function(t){return 0},Game_BattlerBase.prototype.paramPlus=function(t){return this._paramPlus[t]},Game_BattlerBase.prototype.paramMin=function(t){return 1===t?0:1},Game_BattlerBase.prototype.paramMax=function(t){return 0===t?999999:1===t?9999:999},Game_BattlerBase.prototype.paramRate=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_PARAM,t)},Game_BattlerBase.prototype.paramBuffRate=function(t){return.25*this._buffs[t]+1},Game_BattlerBase.prototype.param=function(t){var e=this.paramBase(t)+this.paramPlus(t);e*=this.paramRate(t)*this.paramBuffRate(t);var i=this.paramMax(t),r=this.paramMin(t);return Math.round(e.clamp(r,i))},Game_BattlerBase.prototype.xparam=function(t){return this.traitsSum(Game_BattlerBase.TRAIT_XPARAM,t)},Game_BattlerBase.prototype.sparam=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_SPARAM,t)},Game_BattlerBase.prototype.elementRate=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_ELEMENT_RATE,t)},Game_BattlerBase.prototype.debuffRate=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_DEBUFF_RATE,t)},Game_BattlerBase.prototype.stateRate=function(t){return this.traitsPi(Game_BattlerBase.TRAIT_STATE_RATE,t)},Game_BattlerBase.prototype.stateResistSet=function(){return this.traitsSet(Game_BattlerBase.TRAIT_STATE_RESIST)},Game_BattlerBase.prototype.isStateResist=function(t){return this.stateResistSet().contains(t)},Game_BattlerBase.prototype.attackElements=function(){return this.traitsSet(Game_BattlerBase.TRAIT_ATTACK_ELEMENT)},Game_BattlerBase.prototype.attackStates=function(){return this.traitsSet(Game_BattlerBase.TRAIT_ATTACK_STATE)},Game_BattlerBase.prototype.attackStatesRate=function(t){return this.traitsSum(Game_BattlerBase.TRAIT_ATTACK_STATE,t)},Game_BattlerBase.prototype.attackSpeed=function(){return this.traitsSumAll(Game_BattlerBase.TRAIT_ATTACK_SPEED)},Game_BattlerBase.prototype.attackTimesAdd=function(){return Math.max(this.traitsSumAll(Game_BattlerBase.TRAIT_ATTACK_TIMES),0)},Game_BattlerBase.prototype.addedSkillTypes=function(){return this.traitsSet(Game_BattlerBase.TRAIT_STYPE_ADD)};function Window_EventItem(){this.initialize.apply(this,arguments)}function Window_Message(){this.initialize.apply(this,arguments)}function Window_ScrollText(){this.initialize.apply(this,arguments)}function Window_MapName(){this.initialize.apply(this,arguments)}function Window_BattleLog(){this.initialize.apply(this,arguments)}function Window_PartyCommand(){this.initialize.apply(this,arguments)}function Window_ActorCommand(){this.initialize.apply(this,arguments)}function Window_BattleStatus(){this.initialize.apply(this,arguments)}function Window_BattleActor(){this.initialize.apply(this,arguments)}function Window_BattleEnemy(){this.initialize.apply(this,arguments)}function Window_BattleSkill(){this.initialize.apply(this,arguments)}function Window_BattleItem(){this.initialize.apply(this,arguments)}function Window_TitleCommand(){this.initialize.apply(this,arguments)}function Window_GameEnd(){this.initialize.apply(this,arguments)}function Window_DebugRange(){this.initialize.apply(this,arguments)}function Window_DebugEdit(){this.initialize.apply(this,arguments)}Game_BattlerBase.prototype.isSkillTypeSealed=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_STYPE_SEAL).contains(t)},Game_BattlerBase.prototype.addedSkills=function(){return this.traitsSet(Game_BattlerBase.TRAIT_SKILL_ADD)},Game_BattlerBase.prototype.isSkillSealed=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_SKILL_SEAL).contains(t)},Game_BattlerBase.prototype.isEquipWtypeOk=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_WTYPE).contains(t)},Game_BattlerBase.prototype.isEquipAtypeOk=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_ATYPE).contains(t)},Game_BattlerBase.prototype.isEquipTypeLocked=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_LOCK).contains(t)},Game_BattlerBase.prototype.isEquipTypeSealed=function(t){return this.traitsSet(Game_BattlerBase.TRAIT_EQUIP_SEAL).contains(t)},Game_BattlerBase.prototype.slotType=function(){var t=this.traitsSet(Game_BattlerBase.TRAIT_SLOT_TYPE);return t.length>0?Math.max.apply(null,t):0},Game_BattlerBase.prototype.isDualWield=function(){return 1===this.slotType()},Game_BattlerBase.prototype.actionPlusSet=function(){return this.traits(Game_BattlerBase.TRAIT_ACTION_PLUS).map(function(t){return t.value})},Game_BattlerBase.prototype.specialFlag=function(t){return this.traits(Game_BattlerBase.TRAIT_SPECIAL_FLAG).some(function(e){return e.dataId===t})},Game_BattlerBase.prototype.collapseType=function(){var t=this.traitsSet(Game_BattlerBase.TRAIT_COLLAPSE_TYPE);return t.length>0?Math.max.apply(null,t):0},Game_BattlerBase.prototype.partyAbility=function(t){return this.traits(Game_BattlerBase.TRAIT_PARTY_ABILITY).some(function(e){return e.dataId===t})},Game_BattlerBase.prototype.isAutoBattle=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_AUTO_BATTLE)},Game_BattlerBase.prototype.isGuard=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_GUARD)&&this.canMove()},Game_BattlerBase.prototype.isSubstitute=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_SUBSTITUTE)&&this.canMove()},Game_BattlerBase.prototype.isPreserveTp=function(){return this.specialFlag(Game_BattlerBase.FLAG_ID_PRESERVE_TP)},Game_BattlerBase.prototype.addParam=function(t,e){this._paramPlus[t]+=e,this.refresh()},Game_BattlerBase.prototype.setHp=function(t){this._hp=t,this.refresh()},Game_BattlerBase.prototype.setMp=function(t){this._mp=t,this.refresh()},Game_BattlerBase.prototype.setTp=function(t){this._tp=t,this.refresh()},Game_BattlerBase.prototype.maxTp=function(){return 100},Game_BattlerBase.prototype.refresh=function(){this.stateResistSet().forEach(function(t){this.eraseState(t)},this),this._hp=this._hp.clamp(0,this.mhp),this._mp=this._mp.clamp(0,this.mmp),this._tp=this._tp.clamp(0,this.maxTp())},Game_BattlerBase.prototype.recoverAll=function(){this.clearStates(),this._hp=this.mhp,this._mp=this.mmp},Game_BattlerBase.prototype.hpRate=function(){return this.hp/this.mhp},Game_BattlerBase.prototype.mpRate=function(){return this.mmp>0?this.mp/this.mmp:0},Game_BattlerBase.prototype.tpRate=function(){return this.tp/this.maxTp()},Game_BattlerBase.prototype.hide=function(){this._hidden=!0},Game_BattlerBase.prototype.appear=function(){this._hidden=!1},Game_BattlerBase.prototype.isHidden=function(){return this._hidden},Game_BattlerBase.prototype.isAppeared=function(){return!this.isHidden()},Game_BattlerBase.prototype.isDead=function(){return this.isAppeared()&&this.isDeathStateAffected()},Game_BattlerBase.prototype.isAlive=function(){return this.isAppeared()&&!this.isDeathStateAffected()},Game_BattlerBase.prototype.isDying=function(){return this.isAlive()&&this._hp<this.mhp/4},Game_BattlerBase.prototype.isRestricted=function(){return this.isAppeared()&&this.restriction()>0},Game_BattlerBase.prototype.canInput=function(){return this.isAppeared()&&!this.isRestricted()&&!this.isAutoBattle()},Game_BattlerBase.prototype.canMove=function(){return this.isAppeared()&&this.restriction()<4},Game_BattlerBase.prototype.isConfused=function(){return this.isAppeared()&&this.restriction()>=1&&this.restriction()<=3},Game_BattlerBase.prototype.confusionLevel=function(){return this.isConfused()?this.restriction():0},Game_BattlerBase.prototype.isActor=function(){return!1},Game_BattlerBase.prototype.isEnemy=function(){return!1},Game_BattlerBase.prototype.sortStates=function(){this._states.sort(function(t,e){var i=$dataStates[t].priority,r=$dataStates[e].priority;return i!==r?r-i:t-e})},Game_BattlerBase.prototype.restriction=function(){return Math.max.apply(null,this.states().map(function(t){return t.restriction}).concat(0))},Game_BattlerBase.prototype.addNewState=function(t){t===this.deathStateId()&&this.die();var e=this.isRestricted();this._states.push(t),this.sortStates(),!e&&this.isRestricted()&&this.onRestrict()},Game_BattlerBase.prototype.onRestrict=function(){},Game_BattlerBase.prototype.mostImportantStateText=function(){for(var t=this.states(),e=0;e<t.length;e++)if(t[e].message3)return t[e].message3;return""},Game_BattlerBase.prototype.stateMotionIndex=function(){var t=this.states();return t.length>0?t[0].motion:0},Game_BattlerBase.prototype.stateOverlayIndex=function(){var t=this.states();return t.length>0?t[0].overlay:0},Game_BattlerBase.prototype.isSkillWtypeOk=function(t){return!0},Game_BattlerBase.prototype.skillMpCost=function(t){return Math.floor(t.mpCost*this.mcr)},Game_BattlerBase.prototype.skillTpCost=function(t){return t.tpCost},Game_BattlerBase.prototype.canPaySkillCost=function(t){return this._tp>=this.skillTpCost(t)&&this._mp>=this.skillMpCost(t)},Game_BattlerBase.prototype.paySkillCost=function(t){this._mp-=this.skillMpCost(t),this._tp-=this.skillTpCost(t)},Game_BattlerBase.prototype.isOccasionOk=function(t){return $gameParty.inBattle()?0===t.occasion||1===t.occasion:0===t.occasion||2===t.occasion},Game_BattlerBase.prototype.meetsUsableItemConditions=function(t){return this.canMove()&&this.isOccasionOk(t)},Game_BattlerBase.prototype.meetsSkillConditions=function(t){return this.meetsUsableItemConditions(t)&&this.isSkillWtypeOk(t)&&this.canPaySkillCost(t)&&!this.isSkillSealed(t.id)&&!this.isSkillTypeSealed(t.stypeId)},Game_BattlerBase.prototype.meetsItemConditions=function(t){return this.meetsUsableItemConditions(t)&&$gameParty.hasItem(t)},Game_BattlerBase.prototype.canUse=function(t){return!!t&&(DataManager.isSkill(t)?this.meetsSkillConditions(t):!!DataManager.isItem(t)&&this.meetsItemConditions(t))},Game_BattlerBase.prototype.canEquip=function(t){return!!t&&(DataManager.isWeapon(t)?this.canEquipWeapon(t):!!DataManager.isArmor(t)&&this.canEquipArmor(t))},Game_BattlerBase.prototype.canEquipWeapon=function(t){return this.isEquipWtypeOk(t.wtypeId)&&!this.isEquipTypeSealed(t.etypeId)},Game_BattlerBase.prototype.canEquipArmor=function(t){return this.isEquipAtypeOk(t.atypeId)&&!this.isEquipTypeSealed(t.etypeId)},Game_BattlerBase.prototype.attackSkillId=function(){return 1},Game_BattlerBase.prototype.guardSkillId=function(){return 2},Game_BattlerBase.prototype.canAttack=function(){return this.canUse($dataSkills[this.attackSkillId()])},Game_BattlerBase.prototype.canGuard=function(){return this.canUse($dataSkills[this.guardSkillId()])},Game_Battler.prototype=Object.create(Game_BattlerBase.prototype),Game_Battler.prototype.constructor=Game_Battler,Game_Battler.prototype.initialize=function(){Game_BattlerBase.prototype.initialize.call(this)},Game_Battler.prototype.initMembers=function(){Game_BattlerBase.prototype.initMembers.call(this),this._actions=[],this._speed=0,this._result=new Game_ActionResult,this._actionState="",this._lastTargetIndex=0,this._animations=[],this._damagePopup=!1,this._effectType=null,this._motionType=null,this._weaponImageId=0,this._motionRefresh=!1,this._selected=!1},Game_Battler.prototype.clearAnimations=function(){this._animations=[]},Game_Battler.prototype.clearDamagePopup=function(){this._damagePopup=!1},Game_Battler.prototype.clearWeaponAnimation=function(){this._weaponImageId=0},Game_Battler.prototype.clearEffect=function(){this._effectType=null},Game_Battler.prototype.clearMotion=function(){this._motionType=null,this._motionRefresh=!1},Game_Battler.prototype.requestEffect=function(t){this._effectType=t},Game_Battler.prototype.requestMotion=function(t){this._motionType=t},Game_Battler.prototype.requestMotionRefresh=function(){this._motionRefresh=!0},Game_Battler.prototype.select=function(){this._selected=!0},Game_Battler.prototype.deselect=function(){this._selected=!1},Game_Battler.prototype.isAnimationRequested=function(){return this._animations.length>0},Game_Battler.prototype.isDamagePopupRequested=function(){return this._damagePopup},Game_Battler.prototype.isEffectRequested=function(){return!!this._effectType},Game_Battler.prototype.isMotionRequested=function(){return!!this._motionType},Game_Battler.prototype.isWeaponAnimationRequested=function(){return this._weaponImageId>0},Game_Battler.prototype.isMotionRefreshRequested=function(){return this._motionRefresh},Game_Battler.prototype.isSelected=function(){return this._selected},Game_Battler.prototype.effectType=function(){return this._effectType},Game_Battler.prototype.motionType=function(){return this._motionType},Game_Battler.prototype.weaponImageId=function(){return this._weaponImageId},Game_Battler.prototype.shiftAnimation=function(){return this._animations.shift()},Game_Battler.prototype.startAnimation=function(t,e,i){this._animations.push({animationId:t,mirror:e,delay:i})},Game_Battler.prototype.startDamagePopup=function(){this._damagePopup=!0},Game_Battler.prototype.startWeaponAnimation=function(t){this._weaponImageId=t},Game_Battler.prototype.action=function(t){return this._actions[t]},Game_Battler.prototype.setAction=function(t,e){this._actions[t]=e},Game_Battler.prototype.numActions=function(){return this._actions.length},Game_Battler.prototype.clearActions=function(){this._actions=[]},Game_Battler.prototype.result=function(){return this._result},Game_Battler.prototype.clearResult=function(){this._result.clear()},Game_Battler.prototype.refresh=function(){Game_BattlerBase.prototype.refresh.call(this),0===this.hp?this.addState(this.deathStateId()):this.removeState(this.deathStateId())},Game_Battler.prototype.addState=function(t){this.isStateAddable(t)&&(this.isStateAffected(t)||(this.addNewState(t),this.refresh()),this.resetStateCounts(t),this._result.pushAddedState(t))},Game_Battler.prototype.isStateAddable=function(t){return this.isAlive()&&$dataStates[t]&&!this.isStateResist(t)&&!this._result.isStateRemoved(t)&&!this.isStateRestrict(t)},Game_Battler.prototype.isStateRestrict=function(t){return $dataStates[t].removeByRestriction&&this.isRestricted()},Game_Battler.prototype.onRestrict=function(){Game_BattlerBase.prototype.onRestrict.call(this),this.clearActions(),this.states().forEach(function(t){t.removeByRestriction&&this.removeState(t.id)},this)},Game_Battler.prototype.removeState=function(t){this.isStateAffected(t)&&(t===this.deathStateId()&&this.revive(),this.eraseState(t),this.refresh(),this._result.pushRemovedState(t))},Game_Battler.prototype.escape=function(){$gameParty.inBattle()&&this.hide(),this.clearActions(),this.clearStates(),SoundManager.playEscape()},Game_Battler.prototype.addBuff=function(t,e){this.isAlive()&&(this.increaseBuff(t),this.isBuffAffected(t)&&this.overwriteBuffTurns(t,e),this._result.pushAddedBuff(t),this.refresh())},Game_Battler.prototype.addDebuff=function(t,e){this.isAlive()&&(this.decreaseBuff(t),this.isDebuffAffected(t)&&this.overwriteBuffTurns(t,e),this._result.pushAddedDebuff(t),this.refresh())},Game_Battler.prototype.removeBuff=function(t){this.isAlive()&&this.isBuffOrDebuffAffected(t)&&(this.eraseBuff(t),this._result.pushRemovedBuff(t),this.refresh())},Game_Battler.prototype.removeBattleStates=function(){this.states().forEach(function(t){t.removeAtBattleEnd&&this.removeState(t.id)},this)},Game_Battler.prototype.removeAllBuffs=function(){for(var t=0;t<this.buffLength();t++)this.removeBuff(t)},Game_Battler.prototype.removeStatesAuto=function(t){this.states().forEach(function(e){this.isStateExpired(e.id)&&e.autoRemovalTiming===t&&this.removeState(e.id)},this)},Game_Battler.prototype.removeBuffsAuto=function(){for(var t=0;t<this.buffLength();t++)this.isBuffExpired(t)&&this.removeBuff(t)},Game_Battler.prototype.removeStatesByDamage=function(){this.states().forEach(function(t){t.removeByDamage&&Math.randomInt(100)<t.chanceByDamage&&this.removeState(t.id)},this)},Game_Battler.prototype.makeActionTimes=function(){return this.actionPlusSet().reduce(function(t,e){return Math.random()<e?t+1:t},1)},Game_Battler.prototype.makeActions=function(){if(this.clearActions(),this.canMove()){var t=this.makeActionTimes();this._actions=[];for(var e=0;e<t;e++)this._actions.push(new Game_Action(this))}},Game_Battler.prototype.speed=function(){return this._speed},Game_Battler.prototype.makeSpeed=function(){this._speed=Math.min.apply(null,this._actions.map(function(t){return t.speed()}))||0},Game_Battler.prototype.currentAction=function(){return this._actions[0]},Game_Battler.prototype.removeCurrentAction=function(){this._actions.shift()},Game_Battler.prototype.setLastTarget=function(t){this._lastTargetIndex=t?t.index():0},Game_Battler.prototype.forceAction=function(t,e){this.clearActions();var i=new Game_Action(this,!0);i.setSkill(t),-2===e?i.setTarget(this._lastTargetIndex):-1===e?i.decideRandomTarget():i.setTarget(e),this._actions.push(i)},Game_Battler.prototype.useItem=function(t){DataManager.isSkill(t)?this.paySkillCost(t):DataManager.isItem(t)&&this.consumeItem(t)},Game_Battler.prototype.consumeItem=function(t){$gameParty.consumeItem(t)},Game_Battler.prototype.gainHp=function(t){this._result.hpDamage=-t,this._result.hpAffected=!0,this.setHp(this.hp+t)},Game_Battler.prototype.gainMp=function(t){this._result.mpDamage=-t,this.setMp(this.mp+t)},Game_Battler.prototype.gainTp=function(t){this._result.tpDamage=-t,this.setTp(this.tp+t)},Game_Battler.prototype.gainSilentTp=function(t){this.setTp(this.tp+t)},Game_Battler.prototype.initTp=function(){this.setTp(Math.randomInt(25))},Game_Battler.prototype.clearTp=function(){this.setTp(0)},Game_Battler.prototype.chargeTpByDamage=function(t){var e=Math.floor(50*t*this.tcr);this.gainSilentTp(e)},Game_Battler.prototype.regenerateHp=function(){var t=Math.floor(this.mhp*this.hrg);0!==(t=Math.max(t,-this.maxSlipDamage()))&&this.gainHp(t)},Game_Battler.prototype.maxSlipDamage=function(){return $dataSystem.optSlipDeath?this.hp:Math.max(this.hp-1,0)},Game_Battler.prototype.regenerateMp=function(){var t=Math.floor(this.mmp*this.mrg);0!==t&&this.gainMp(t)},Game_Battler.prototype.regenerateTp=function(){var t=Math.floor(100*this.trg);this.gainSilentTp(t)},Game_Battler.prototype.regenerateAll=function(){this.isAlive()&&(this.regenerateHp(),this.regenerateMp(),this.regenerateTp())},Game_Battler.prototype.onBattleStart=function(){this.setActionState("undecided"),this.clearMotion(),this.isPreserveTp()||this.initTp()},Game_Battler.prototype.onAllActionsEnd=function(){this.clearResult(),this.removeStatesAuto(1),this.removeBuffsAuto()},Game_Battler.prototype.onTurnEnd=function(){this.clearResult(),this.regenerateAll(),BattleManager.isForcedTurn()||(this.updateStateTurns(),this.updateBuffTurns()),this.removeStatesAuto(2)},Game_Battler.prototype.onBattleEnd=function(){this.clearResult(),this.removeBattleStates(),this.removeAllBuffs(),this.clearActions(),this.isPreserveTp()||this.clearTp(),this.appear()},Game_Battler.prototype.onDamage=function(t){this.removeStatesByDamage(),this.chargeTpByDamage(t/this.mhp)},Game_Battler.prototype.setActionState=function(t){this._actionState=t,this.requestMotionRefresh()},Game_Battler.prototype.isUndecided=function(){return"undecided"===this._actionState},Game_Battler.prototype.isInputting=function(){return"inputting"===this._actionState},Game_Battler.prototype.isWaiting=function(){return"waiting"===this._actionState},Game_Battler.prototype.isActing=function(){return"acting"===this._actionState},Game_Battler.prototype.isChanting=function(){return!!this.isWaiting()&&this._actions.some(function(t){return t.isMagicSkill()})},Game_Battler.prototype.isGuardWaiting=function(){return!!this.isWaiting()&&this._actions.some(function(t){return t.isGuard()})},Game_Battler.prototype.performActionStart=function(t){t.isGuard()||this.setActionState("acting")},Game_Battler.prototype.performAction=function(t){},Game_Battler.prototype.performActionEnd=function(){this.setActionState("done")},Game_Battler.prototype.performDamage=function(){},Game_Battler.prototype.performMiss=function(){SoundManager.playMiss()},Game_Battler.prototype.performRecovery=function(){SoundManager.playRecovery()},Game_Battler.prototype.performEvasion=function(){SoundManager.playEvasion()},Game_Battler.prototype.performMagicEvasion=function(){SoundManager.playMagicEvasion()},Game_Battler.prototype.performCounter=function(){SoundManager.playEvasion()},Game_Battler.prototype.performReflection=function(){SoundManager.playReflection()},Game_Battler.prototype.performSubstitute=function(t){},Game_Battler.prototype.performCollapse=function(){},Game_Actor.prototype=Object.create(Game_Battler.prototype),Game_Actor.prototype.constructor=Game_Actor,Object.defineProperty(Game_Actor.prototype,"level",{get:function(){return this._level},configurable:!0}),Game_Actor.prototype.initialize=function(t){Game_Battler.prototype.initialize.call(this),this.setup(t)},Game_Actor.prototype.initMembers=function(){Game_Battler.prototype.initMembers.call(this),this._actorId=0,this._name="",this._nickname="",this._classId=0,this._level=0,this._characterName="",this._characterIndex=0,this._faceName="",this._faceIndex=0,this._battlerName="",this._exp={},this._skills=[],this._equips=[],this._actionInputIndex=0,this._lastMenuSkill=new Game_Item,this._lastBattleSkill=new Game_Item,this._lastCommandSymbol=""},Game_Actor.prototype.setup=function(t){var e=$dataActors[t];this._actorId=t,this._name=e.name,this._nickname=e.nickname,this._profile=e.profile,this._classId=e.classId,this._level=e.initialLevel,this.initImages(),this.initExp(),this.initSkills(),this.initEquips(e.equips),this.clearParamPlus(),this.recoverAll()},Game_Actor.prototype.actorId=function(){return this._actorId},Game_Actor.prototype.actor=function(){return $dataActors[this._actorId]},Game_Actor.prototype.name=function(){return this._name},Game_Actor.prototype.setName=function(t){this._name=t},Game_Actor.prototype.nickname=function(){return this._nickname},Game_Actor.prototype.setNickname=function(t){this._nickname=t},Game_Actor.prototype.profile=function(){return this._profile},Game_Actor.prototype.setProfile=function(t){this._profile=t},Game_Actor.prototype.characterName=function(){return this._characterName},Game_Actor.prototype.characterIndex=function(){return this._characterIndex},Game_Actor.prototype.faceName=function(){return this._faceName},Game_Actor.prototype.faceIndex=function(){return this._faceIndex},Game_Actor.prototype.battlerName=function(){return this._battlerName},Game_Actor.prototype.clearStates=function(){Game_Battler.prototype.clearStates.call(this),this._stateSteps={}},Game_Actor.prototype.eraseState=function(t){Game_Battler.prototype.eraseState.call(this,t),delete this._stateSteps[t]},Game_Actor.prototype.resetStateCounts=function(t){Game_Battler.prototype.resetStateCounts.call(this,t),this._stateSteps[t]=$dataStates[t].stepsToRemove},Game_Actor.prototype.initImages=function(){var t=this.actor();this._characterName=t.characterName,this._characterIndex=t.characterIndex,this._faceName=t.faceName,this._faceIndex=t.faceIndex,this._battlerName=t.battlerName},Game_Actor.prototype.expForLevel=function(t){var e=this.currentClass(),i=e.expParams[1],r=e.expParams[3];return Math.round(e.expParams[0]*Math.pow(t-1,.9+e.expParams[2]/250)*t*(t+1)/(6+Math.pow(t,2)/50/r)+(t-1)*i)},Game_Actor.prototype.initExp=function(){this._exp[this._classId]=this.currentLevelExp()},Game_Actor.prototype.currentExp=function(){return this._exp[this._classId]},Game_Actor.prototype.currentLevelExp=function(){return this.expForLevel(this._level)},Game_Actor.prototype.nextLevelExp=function(){return this.expForLevel(this._level+1)},Game_Actor.prototype.nextRequiredExp=function(){return this.nextLevelExp()-this.currentExp()},Game_Actor.prototype.maxLevel=function(){return this.actor().maxLevel},Game_Actor.prototype.isMaxLevel=function(){return this._level>=this.maxLevel()},Game_Actor.prototype.initSkills=function(){this._skills=[],this.currentClass().learnings.forEach(function(t){t.level<=this._level&&this.learnSkill(t.skillId)},this)},Game_Actor.prototype.initEquips=function(t){var e=this.equipSlots(),i=e.length;this._equips=[];for(var r=0;r<i;r++)this._equips[r]=new Game_Item;for(var n=0;n<t.length;n++)n<i&&this._equips[n].setEquip(1===e[n],t[n]);this.releaseUnequippableItems(!0),this.refresh()},Game_Actor.prototype.equipSlots=function(){for(var t=[],e=1;e<$dataSystem.equipTypes.length;e++)t.push(e);return t.length>=2&&this.isDualWield()&&(t[1]=1),t},Game_Actor.prototype.equips=function(){return this._equips.map(function(t){return t.object()})},Game_Actor.prototype.weapons=function(){return this.equips().filter(function(t){return t&&DataManager.isWeapon(t)})},Game_Actor.prototype.armors=function(){return this.equips().filter(function(t){return t&&DataManager.isArmor(t)})},Game_Actor.prototype.hasWeapon=function(t){return this.weapons().contains(t)},Game_Actor.prototype.hasArmor=function(t){return this.armors().contains(t)},Game_Actor.prototype.isEquipChangeOk=function(t){return!this.isEquipTypeLocked(this.equipSlots()[t])&&!this.isEquipTypeSealed(this.equipSlots()[t])},Game_Actor.prototype.changeEquip=function(t,e){!this.tradeItemWithParty(e,this.equips()[t])||e&&this.equipSlots()[t]!==e.etypeId||(this._equips[t].setObject(e),this.refresh())},Game_Actor.prototype.forceChangeEquip=function(t,e){this._equips[t].setObject(e),this.releaseUnequippableItems(!0),this.refresh()},Game_Actor.prototype.tradeItemWithParty=function(t,e){return!(t&&!$gameParty.hasItem(t)||($gameParty.gainItem(e,1),$gameParty.loseItem(t,1),0))},Game_Actor.prototype.changeEquipById=function(t,e){var i=t-1;1===this.equipSlots()[i]?this.changeEquip(i,$dataWeapons[e]):this.changeEquip(i,$dataArmors[e])},Game_Actor.prototype.isEquipped=function(t){return this.equips().contains(t)},Game_Actor.prototype.discardEquip=function(t){var e=this.equips().indexOf(t);e>=0&&this._equips[e].setObject(null)},Game_Actor.prototype.releaseUnequippableItems=function(t){for(;;){for(var e=this.equipSlots(),i=this.equips(),r=!1,n=0;n<i.length;n++){var a=i[n];!a||this.canEquip(a)&&a.etypeId===e[n]||(t||this.tradeItemWithParty(null,a),this._equips[n].setObject(null),r=!0)}if(!r)break}},Game_Actor.prototype.clearEquipments=function(){for(var t=this.equipSlots().length,e=0;e<t;e++)this.isEquipChangeOk(e)&&this.changeEquip(e,null)},Game_Actor.prototype.optimizeEquipments=function(){var t=this.equipSlots().length;this.clearEquipments();for(var e=0;e<t;e++)this.isEquipChangeOk(e)&&this.changeEquip(e,this.bestEquipItem(e))},Game_Actor.prototype.bestEquipItem=function(t){for(var e=this.equipSlots()[t],i=$gameParty.equipItems().filter(function(t){return t.etypeId===e&&this.canEquip(t)},this),r=null,n=-1e3,a=0;a<i.length;a++){var o=this.calcEquipItemPerformance(i[a]);o>n&&(n=o,r=i[a])}return r},Game_Actor.prototype.calcEquipItemPerformance=function(t){return t.params.reduce(function(t,e){return t+e})},Game_Actor.prototype.isSkillWtypeOk=function(t){var e=t.requiredWtypeId1,i=t.requiredWtypeId2;return!!(0===e&&0===i||e>0&&this.isWtypeEquipped(e)||i>0&&this.isWtypeEquipped(i))},Game_Actor.prototype.isWtypeEquipped=function(t){return this.weapons().some(function(e){return e.wtypeId===t})},Game_Actor.prototype.refresh=function(){this.releaseUnequippableItems(!1),Game_Battler.prototype.refresh.call(this)},Game_Actor.prototype.isActor=function(){return!0},Game_Actor.prototype.friendsUnit=function(){return $gameParty},Game_Actor.prototype.opponentsUnit=function(){return $gameTroop},Game_Actor.prototype.index=function(){return $gameParty.members().indexOf(this)},Game_Actor.prototype.isBattleMember=function(){return $gameParty.battleMembers().contains(this)},Game_Actor.prototype.isFormationChangeOk=function(){return!0},Game_Actor.prototype.currentClass=function(){return $dataClasses[this._classId]},Game_Actor.prototype.isClass=function(t){return t&&this._classId===t.id},Game_Actor.prototype.skills=function(){var t=[];return this._skills.concat(this.addedSkills()).forEach(function(e){t.contains($dataSkills[e])||t.push($dataSkills[e])}),t},Game_Actor.prototype.usableSkills=function(){return this.skills().filter(function(t){return this.canUse(t)},this)},Game_Actor.prototype.traitObjects=function(){var t=Game_Battler.prototype.traitObjects.call(this);t=t.concat([this.actor(),this.currentClass()]);for(var e=this.equips(),i=0;i<e.length;i++){var r=e[i];r&&t.push(r)}return t},Game_Actor.prototype.attackElements=function(){var t=Game_Battler.prototype.attackElements.call(this);return this.hasNoWeapons()&&!t.contains(this.bareHandsElementId())&&t.push(this.bareHandsElementId()),t},Game_Actor.prototype.hasNoWeapons=function(){return 0===this.weapons().length},Game_Actor.prototype.bareHandsElementId=function(){return 1},Game_Actor.prototype.paramMax=function(t){return 0===t?9999:Game_Battler.prototype.paramMax.call(this,t)},Game_Actor.prototype.paramBase=function(t){return this.currentClass().params[t][this._level]},Game_Actor.prototype.paramPlus=function(t){for(var e=Game_Battler.prototype.paramPlus.call(this,t),i=this.equips(),r=0;r<i.length;r++){var n=i[r];n&&(e+=n.params[t])}return e},Game_Actor.prototype.attackAnimationId1=function(){if(this.hasNoWeapons())return this.bareHandsAnimationId();var t=this.weapons();return t[0]?t[0].animationId:0},Game_Actor.prototype.attackAnimationId2=function(){var t=this.weapons();return t[1]?t[1].animationId:0},Game_Actor.prototype.bareHandsAnimationId=function(){return 1},Game_Actor.prototype.changeExp=function(t,e){this._exp[this._classId]=Math.max(t,0);for(var i=this._level,r=this.skills();!this.isMaxLevel()&&this.currentExp()>=this.nextLevelExp();)this.levelUp();for(;this.currentExp()<this.currentLevelExp();)this.levelDown();e&&this._level>i&&this.displayLevelUp(this.findNewSkills(r)),this.refresh()},Game_Actor.prototype.levelUp=function(){this._level++,this.currentClass().learnings.forEach(function(t){t.level===this._level&&this.learnSkill(t.skillId)},this)},Game_Actor.prototype.levelDown=function(){this._level--},Game_Actor.prototype.findNewSkills=function(t){for(var e=this.skills(),i=0;i<t.length;i++){var r=e.indexOf(t[i]);r>=0&&e.splice(r,1)}return e},Game_Actor.prototype.displayLevelUp=function(t){var e=TextManager.levelUp.format(this._name,TextManager.level,this._level);$gameMessage.newPage(),$gameMessage.add(e),t.forEach(function(t){$gameMessage.add(TextManager.obtainSkill.format(t.name))})},Game_Actor.prototype.gainExp=function(t){var e=this.currentExp()+Math.round(t*this.finalExpRate());this.changeExp(e,this.shouldDisplayLevelUp())},Game_Actor.prototype.finalExpRate=function(){return this.exr*(this.isBattleMember()?1:this.benchMembersExpRate())},Game_Actor.prototype.benchMembersExpRate=function(){return $dataSystem.optExtraExp?1:0},Game_Actor.prototype.shouldDisplayLevelUp=function(){return!0},Game_Actor.prototype.changeLevel=function(t,e){t=t.clamp(1,this.maxLevel()),this.changeExp(this.expForLevel(t),e)},Game_Actor.prototype.learnSkill=function(t){this.isLearnedSkill(t)||(this._skills.push(t),this._skills.sort(function(t,e){return t-e}))},Game_Actor.prototype.forgetSkill=function(t){var e=this._skills.indexOf(t);e>=0&&this._skills.splice(e,1)},Game_Actor.prototype.isLearnedSkill=function(t){return this._skills.contains(t)},Game_Actor.prototype.hasSkill=function(t){return this.skills().contains($dataSkills[t])},Game_Actor.prototype.changeClass=function(t,e){e&&(this._exp[t]=this.currentExp()),this._classId=t,this.changeExp(this._exp[this._classId]||0,!1),this.refresh()},Game_Actor.prototype.setCharacterImage=function(t,e){this._characterName=t,this._characterIndex=e},Game_Actor.prototype.setFaceImage=function(t,e){this._faceName=t,this._faceIndex=e},Game_Actor.prototype.setBattlerImage=function(t){this._battlerName=t},Game_Actor.prototype.isSpriteVisible=function(){return $gameSystem.isSideView()},Game_Actor.prototype.startAnimation=function(t,e,i){Game_Battler.prototype.startAnimation.call(this,t,e=!e,i)},Game_Actor.prototype.performActionStart=function(t){Game_Battler.prototype.performActionStart.call(this,t)},Game_Actor.prototype.performAction=function(t){Game_Battler.prototype.performAction.call(this,t),t.isAttack()?this.performAttack():t.isGuard()?this.requestMotion("guard"):t.isMagicSkill()?this.requestMotion("spell"):t.isSkill()?this.requestMotion("skill"):t.isItem()&&this.requestMotion("item")},Game_Actor.prototype.performActionEnd=function(){Game_Battler.prototype.performActionEnd.call(this)},Game_Actor.prototype.performAttack=function(){var t=this.weapons(),e=$dataSystem.attackMotions[t[0]?t[0].wtypeId:0];e&&(0===e.type?this.requestMotion("thrust"):1===e.type?this.requestMotion("swing"):2===e.type&&this.requestMotion("missile"),this.startWeaponAnimation(e.weaponImageId))},Game_Actor.prototype.performDamage=function(){Game_Battler.prototype.performDamage.call(this),this.isSpriteVisible()?this.requestMotion("damage"):$gameScreen.startShake(5,5,10),SoundManager.playActorDamage()},Game_Actor.prototype.performEvasion=function(){Game_Battler.prototype.performEvasion.call(this),this.requestMotion("evade")},Game_Actor.prototype.performMagicEvasion=function(){Game_Battler.prototype.performMagicEvasion.call(this),this.requestMotion("evade")},Game_Actor.prototype.performCounter=function(){Game_Battler.prototype.performCounter.call(this),this.performAttack()},Game_Actor.prototype.performCollapse=function(){Game_Battler.prototype.performCollapse.call(this),$gameParty.inBattle()&&SoundManager.playActorCollapse()},Game_Actor.prototype.performVictory=function(){this.canMove()&&this.requestMotion("victory")},Game_Actor.prototype.performEscape=function(){this.canMove()&&this.requestMotion("escape")},Game_Actor.prototype.makeActionList=function(){var t=[],e=new Game_Action(this);return e.setAttack(),t.push(e),this.usableSkills().forEach(function(i){(e=new Game_Action(this)).setSkill(i.id),t.push(e)},this),t},Game_Actor.prototype.makeAutoBattleActions=function(){for(var t=0;t<this.numActions();t++)for(var e=this.makeActionList(),i=Number.MIN_VALUE,r=0;r<e.length;r++){var n=e[r].evaluate();n>i&&(i=n,this.setAction(t,e[r]))}this.setActionState("waiting")},Game_Actor.prototype.makeConfusionActions=function(){for(var t=0;t<this.numActions();t++)this.action(t).setConfusion();this.setActionState("waiting")},Game_Actor.prototype.makeActions=function(){Game_Battler.prototype.makeActions.call(this),this.numActions()>0?this.setActionState("undecided"):this.setActionState("waiting"),this.isAutoBattle()?this.makeAutoBattleActions():this.isConfused()&&this.makeConfusionActions()},Game_Actor.prototype.onPlayerWalk=function(){this.clearResult(),this.checkFloorEffect(),$gamePlayer.isNormal()&&(this.turnEndOnMap(),this.states().forEach(function(t){this.updateStateSteps(t)},this),this.showAddedStates(),this.showRemovedStates())},Game_Actor.prototype.updateStateSteps=function(t){t.removeByWalking&&this._stateSteps[t.id]>0&&0==--this._stateSteps[t.id]&&this.removeState(t.id)},Game_Actor.prototype.showAddedStates=function(){this.result().addedStateObjects().forEach(function(t){t.message1&&$gameMessage.add(this._name+t.message1)},this)},Game_Actor.prototype.showRemovedStates=function(){this.result().removedStateObjects().forEach(function(t){t.message4&&$gameMessage.add(this._name+t.message4)},this)},Game_Actor.prototype.stepsForTurn=function(){return 20},Game_Actor.prototype.turnEndOnMap=function(){$gameParty.steps()%this.stepsForTurn()==0&&(this.onTurnEnd(),this.result().hpDamage>0&&this.performMapDamage())},Game_Actor.prototype.checkFloorEffect=function(){$gamePlayer.isOnDamageFloor()&&this.executeFloorDamage()},Game_Actor.prototype.executeFloorDamage=function(){var t=Math.floor(this.basicFloorDamage()*this.fdr);t=Math.min(t,this.maxFloorDamage()),this.gainHp(-t),t>0&&this.performMapDamage()},Game_Actor.prototype.basicFloorDamage=function(){return 10},Game_Actor.prototype.maxFloorDamage=function(){return $dataSystem.optFloorDeath?this.hp:Math.max(this.hp-1,0)},Game_Actor.prototype.performMapDamage=function(){$gameParty.inBattle()||$gameScreen.startFlashForDamage()},Game_Actor.prototype.clearActions=function(){Game_Battler.prototype.clearActions.call(this),this._actionInputIndex=0},Game_Actor.prototype.inputtingAction=function(){return this.action(this._actionInputIndex)},Game_Actor.prototype.selectNextCommand=function(){return this._actionInputIndex<this.numActions()-1&&(this._actionInputIndex++,!0)},Game_Actor.prototype.selectPreviousCommand=function(){return this._actionInputIndex>0&&(this._actionInputIndex--,!0)},Game_Actor.prototype.lastMenuSkill=function(){return this._lastMenuSkill.object()},Game_Actor.prototype.setLastMenuSkill=function(t){this._lastMenuSkill.setObject(t)},Game_Actor.prototype.lastBattleSkill=function(){return this._lastBattleSkill.object()},Game_Actor.prototype.setLastBattleSkill=function(t){this._lastBattleSkill.setObject(t)},Game_Actor.prototype.lastCommandSymbol=function(){return this._lastCommandSymbol},Game_Actor.prototype.setLastCommandSymbol=function(t){this._lastCommandSymbol=t},Game_Actor.prototype.testEscape=function(t){return t.effects.some(function(t,e,i){return t&&t.code===Game_Action.EFFECT_SPECIAL})},Game_Actor.prototype.meetsUsableItemConditions=function(t){return!($gameParty.inBattle()&&!BattleManager.canEscape()&&this.testEscape(t))&&Game_BattlerBase.prototype.meetsUsableItemConditions.call(this,t)},Game_Enemy.prototype=Object.create(Game_Battler.prototype),Game_Enemy.prototype.constructor=Game_Enemy,Game_Enemy.prototype.initialize=function(t,e,i){Game_Battler.prototype.initialize.call(this),this.setup(t,e,i)},Game_Enemy.prototype.initMembers=function(){Game_Battler.prototype.initMembers.call(this),this._enemyId=0,this._letter="",this._plural=!1,this._screenX=0,this._screenY=0},Game_Enemy.prototype.setup=function(t,e,i){this._enemyId=t,this._screenX=e,this._screenY=i,this.recoverAll()},Game_Enemy.prototype.isEnemy=function(){return!0},Game_Enemy.prototype.friendsUnit=function(){return $gameTroop},Game_Enemy.prototype.opponentsUnit=function(){return $gameParty},Game_Enemy.prototype.index=function(){return $gameTroop.members().indexOf(this)},Game_Enemy.prototype.isBattleMember=function(){return this.index()>=0},Game_Enemy.prototype.enemyId=function(){return this._enemyId},Game_Enemy.prototype.enemy=function(){return $dataEnemies[this._enemyId]},Game_Enemy.prototype.traitObjects=function(){return Game_Battler.prototype.traitObjects.call(this).concat(this.enemy())},Game_Enemy.prototype.paramBase=function(t){return this.enemy().params[t]},Game_Enemy.prototype.exp=function(){return this.enemy().exp},Game_Enemy.prototype.gold=function(){return this.enemy().gold},Game_Enemy.prototype.makeDropItems=function(){return this.enemy().dropItems.reduce((function(t,e){return e.kind>0&&Math.random()*e.denominator<this.dropItemRate()?t.concat(this.itemObject(e.kind,e.dataId)):t}).bind(this),[])},Game_Enemy.prototype.dropItemRate=function(){return $gameParty.hasDropItemDouble()?2:1},Game_Enemy.prototype.itemObject=function(t,e){return 1===t?$dataItems[e]:2===t?$dataWeapons[e]:3===t?$dataArmors[e]:null},Game_Enemy.prototype.isSpriteVisible=function(){return!0},Game_Enemy.prototype.screenX=function(){return this._screenX},Game_Enemy.prototype.screenY=function(){return this._screenY},Game_Enemy.prototype.battlerName=function(){return this.enemy().battlerName},Game_Enemy.prototype.battlerHue=function(){return this.enemy().battlerHue},Game_Enemy.prototype.originalName=function(){return this.enemy().name},Game_Enemy.prototype.name=function(){return this.originalName()+(this._plural?this._letter:"")},Game_Enemy.prototype.isLetterEmpty=function(){return""===this._letter},Game_Enemy.prototype.setLetter=function(t){this._letter=t},Game_Enemy.prototype.setPlural=function(t){this._plural=t},Game_Enemy.prototype.performActionStart=function(t){Game_Battler.prototype.performActionStart.call(this,t),this.requestEffect("whiten")},Game_Enemy.prototype.performAction=function(t){Game_Battler.prototype.performAction.call(this,t)},Game_Enemy.prototype.performActionEnd=function(){Game_Battler.prototype.performActionEnd.call(this)},Game_Enemy.prototype.performDamage=function(){Game_Battler.prototype.performDamage.call(this),SoundManager.playEnemyDamage(),this.requestEffect("blink")},Game_Enemy.prototype.performCollapse=function(){switch(Game_Battler.prototype.performCollapse.call(this),this.collapseType()){case 0:this.requestEffect("collapse"),SoundManager.playEnemyCollapse();break;case 1:this.requestEffect("bossCollapse"),SoundManager.playBossCollapse1();break;case 2:this.requestEffect("instantCollapse")}},Game_Enemy.prototype.transform=function(t){var e=this.originalName();this._enemyId=t,this.originalName()!==e&&(this._letter="",this._plural=!1),this.refresh(),this.numActions()>0&&this.makeActions()},Game_Enemy.prototype.meetsCondition=function(t){var e=t.conditionParam1,i=t.conditionParam2;switch(t.conditionType){case 1:return this.meetsTurnCondition(e,i);case 2:return this.meetsHpCondition(e,i);case 3:return this.meetsMpCondition(e,i);case 4:return this.meetsStateCondition(e);case 5:return this.meetsPartyLevelCondition(e);case 6:return this.meetsSwitchCondition(e);default:return!0}},Game_Enemy.prototype.meetsTurnCondition=function(t,e){var i=$gameTroop.turnCount();return 0===e?i===t:i>0&&i>=t&&i%e==t%e},Game_Enemy.prototype.meetsHpCondition=function(t,e){return this.hpRate()>=t&&this.hpRate()<=e},Game_Enemy.prototype.meetsMpCondition=function(t,e){return this.mpRate()>=t&&this.mpRate()<=e},Game_Enemy.prototype.meetsStateCondition=function(t){return this.isStateAffected(t)},Game_Enemy.prototype.meetsPartyLevelCondition=function(t){return $gameParty.highestLevel()>=t},Game_Enemy.prototype.meetsSwitchCondition=function(t){return $gameSwitches.value(t)},Game_Enemy.prototype.isActionValid=function(t){return this.meetsCondition(t)&&this.canUse($dataSkills[t.skillId])},Game_Enemy.prototype.selectAction=function(t,e){var i=t.reduce(function(t,i){return t+i.rating-e},0);if(!(i>0))return null;for(var r=Math.randomInt(i),n=0;n<t.length;n++){var a=t[n];if((r-=a.rating-e)<0)return a}},Game_Enemy.prototype.selectAllActions=function(t){var e=Math.max.apply(null,t.map(function(t){return t.rating}))-3;t=t.filter(function(t){return t.rating>e});for(var i=0;i<this.numActions();i++)this.action(i).setEnemyAction(this.selectAction(t,e))},Game_Enemy.prototype.makeActions=function(){if(Game_Battler.prototype.makeActions.call(this),this.numActions()>0){var t=this.enemy().actions.filter(function(t){return this.isActionValid(t)},this);t.length>0&&this.selectAllActions(t)}this.setActionState("waiting")},Game_Actors.prototype.initialize=function(){this._data=[]},Game_Actors.prototype.actor=function(t){return $dataActors[t]?(this._data[t]||(this._data[t]=new Game_Actor(t)),this._data[t]):null},Game_Unit.prototype.initialize=function(){this._inBattle=!1},Game_Unit.prototype.inBattle=function(){return this._inBattle},Game_Unit.prototype.members=function(){return[]},Game_Unit.prototype.aliveMembers=function(){return this.members().filter(function(t){return t.isAlive()})},Game_Unit.prototype.deadMembers=function(){return this.members().filter(function(t){return t.isDead()})},Game_Unit.prototype.movableMembers=function(){return this.members().filter(function(t){return t.canMove()})},Game_Unit.prototype.clearActions=function(){return this.members().forEach(function(t){return t.clearActions()})},Game_Unit.prototype.agility=function(){var t=this.members();return 0===t.length?1:t.reduce(function(t,e){return t+e.agi},0)/t.length},Game_Unit.prototype.tgrSum=function(){return this.aliveMembers().reduce(function(t,e){return t+e.tgr},0)},Game_Unit.prototype.randomTarget=function(){var t=Math.random()*this.tgrSum(),e=null;return this.aliveMembers().forEach(function(i){(t-=i.tgr)<=0&&!e&&(e=i)}),e},Game_Unit.prototype.randomDeadTarget=function(){var t=this.deadMembers();return 0===t.length?null:t[Math.floor(Math.random()*t.length)]},Game_Unit.prototype.smoothTarget=function(t){t<0&&(t=0);var e=this.members()[t];return e&&e.isAlive()?e:this.aliveMembers()[0]},Game_Unit.prototype.smoothDeadTarget=function(t){t<0&&(t=0);var e=this.members()[t];return e&&e.isDead()?e:this.deadMembers()[0]},Game_Unit.prototype.clearResults=function(){this.members().forEach(function(t){t.clearResult()})},Game_Unit.prototype.onBattleStart=function(){this.members().forEach(function(t){t.onBattleStart()}),this._inBattle=!0},Game_Unit.prototype.onBattleEnd=function(){this._inBattle=!1,this.members().forEach(function(t){t.onBattleEnd()})},Game_Unit.prototype.makeActions=function(){this.members().forEach(function(t){t.makeActions()})},Game_Unit.prototype.select=function(t){this.members().forEach(function(e){e===t?e.select():e.deselect()})},Game_Unit.prototype.isAllDead=function(){return 0===this.aliveMembers().length},Game_Unit.prototype.substituteBattler=function(){for(var t=this.members(),e=0;e<t.length;e++)if(t[e].isSubstitute())return t[e]},Game_Party.prototype=Object.create(Game_Unit.prototype),Game_Party.prototype.constructor=Game_Party,Game_Party.ABILITY_ENCOUNTER_HALF=0,Game_Party.ABILITY_ENCOUNTER_NONE=1,Game_Party.ABILITY_CANCEL_SURPRISE=2,Game_Party.ABILITY_RAISE_PREEMPTIVE=3,Game_Party.ABILITY_GOLD_DOUBLE=4,Game_Party.ABILITY_DROP_ITEM_DOUBLE=5,Game_Party.prototype.initialize=function(){Game_Unit.prototype.initialize.call(this),this._gold=0,this._steps=0,this._lastItem=new Game_Item,this._menuActorId=0,this._targetActorId=0,this._actors=[],this.initAllItems()},Game_Party.prototype.initAllItems=function(){this._items={},this._weapons={},this._armors={}},Game_Party.prototype.exists=function(){return this._actors.length>0},Game_Party.prototype.size=function(){return this.members().length},Game_Party.prototype.isEmpty=function(){return 0===this.size()},Game_Party.prototype.members=function(){return this.inBattle()?this.battleMembers():this.allMembers()},Game_Party.prototype.allMembers=function(){return this._actors.map(function(t){return $gameActors.actor(t)})},Game_Party.prototype.battleMembers=function(){return this.allMembers().slice(0,this.maxBattleMembers()).filter(function(t){return t.isAppeared()})},Game_Party.prototype.maxBattleMembers=function(){return 4},Game_Party.prototype.leader=function(){return this.battleMembers()[0]},Game_Party.prototype.reviveBattleMembers=function(){this.battleMembers().forEach(function(t){t.isDead()&&t.setHp(1)})},Game_Party.prototype.items=function(){var t=[];for(var e in this._items)t.push($dataItems[e]);return t},Game_Party.prototype.weapons=function(){var t=[];for(var e in this._weapons)t.push($dataWeapons[e]);return t},Game_Party.prototype.armors=function(){var t=[];for(var e in this._armors)t.push($dataArmors[e]);return t},Game_Party.prototype.equipItems=function(){return this.weapons().concat(this.armors())},Game_Party.prototype.allItems=function(){return this.items().concat(this.equipItems())},Game_Party.prototype.itemContainer=function(t){return t?DataManager.isItem(t)?this._items:DataManager.isWeapon(t)?this._weapons:DataManager.isArmor(t)?this._armors:null:null},Game_Party.prototype.setupStartingMembers=function(){this._actors=[],$dataSystem.partyMembers.forEach(function(t){$gameActors.actor(t)&&this._actors.push(t)},this)},Game_Party.prototype.name=function(){var t=this.battleMembers().length;return 0===t?"":1===t?this.leader().name():TextManager.partyName.format(this.leader().name())},Game_Party.prototype.setupBattleTest=function(){this.setupBattleTestMembers(),this.setupBattleTestItems()},Game_Party.prototype.setupBattleTestMembers=function(){$dataSystem.testBattlers.forEach(function(t){var e=$gameActors.actor(t.actorId);e&&(e.changeLevel(t.level,!1),e.initEquips(t.equips),e.recoverAll(),this.addActor(t.actorId))},this)},Game_Party.prototype.setupBattleTestItems=function(){$dataItems.forEach(function(t){t&&t.name.length>0&&this.gainItem(t,this.maxItems(t))},this)},Game_Party.prototype.highestLevel=function(){return Math.max.apply(null,this.members().map(function(t){return t.level}))},Game_Party.prototype.addActor=function(t){this._actors.contains(t)||(this._actors.push(t),$gamePlayer.refresh(),$gameMap.requestRefresh())},Game_Party.prototype.removeActor=function(t){this._actors.contains(t)&&(this._actors.splice(this._actors.indexOf(t),1),$gamePlayer.refresh(),$gameMap.requestRefresh())},Game_Party.prototype.gold=function(){return this._gold},Game_Party.prototype.gainGold=function(t){this._gold=(this._gold+t).clamp(0,this.maxGold())},Game_Party.prototype.loseGold=function(t){this.gainGold(-t)},Game_Party.prototype.maxGold=function(){return 99999999},Game_Party.prototype.steps=function(){return this._steps},Game_Party.prototype.increaseSteps=function(){this._steps++},Game_Party.prototype.numItems=function(t){var e=this.itemContainer(t);return e&&e[t.id]||0},Game_Party.prototype.maxItems=function(t){return 99},Game_Party.prototype.hasMaxItems=function(t){return this.numItems(t)>=this.maxItems(t)},Game_Party.prototype.hasItem=function(t,e){return void 0===e&&(e=!1),this.numItems(t)>0||!(!e||!this.isAnyMemberEquipped(t))},Game_Party.prototype.isAnyMemberEquipped=function(t){return this.members().some(function(e){return e.equips().contains(t)})},Game_Party.prototype.gainItem=function(t,e,i){var r=this.itemContainer(t);if(r){var n=this.numItems(t)+e;r[t.id]=n.clamp(0,this.maxItems(t)),0===r[t.id]&&delete r[t.id],i&&n<0&&this.discardMembersEquip(t,-n),$gameMap.requestRefresh()}},Game_Party.prototype.discardMembersEquip=function(t,e){var i=e;this.members().forEach(function(e){for(;i>0&&e.isEquipped(t);)e.discardEquip(t),i--})},Game_Party.prototype.loseItem=function(t,e,i){this.gainItem(t,-e,i)},Game_Party.prototype.consumeItem=function(t){DataManager.isItem(t)&&t.consumable&&this.loseItem(t,1)},Game_Party.prototype.canUse=function(t){return this.members().some(function(e){return e.canUse(t)})},Game_Party.prototype.canInput=function(){return this.members().some(function(t){return t.canInput()})},Game_Party.prototype.isAllDead=function(){return!!Game_Unit.prototype.isAllDead.call(this)&&(this.inBattle()||!this.isEmpty())},Game_Party.prototype.onPlayerWalk=function(){this.members().forEach(function(t){return t.onPlayerWalk()})},Game_Party.prototype.menuActor=function(){var t=$gameActors.actor(this._menuActorId);return this.members().contains(t)||(t=this.members()[0]),t},Game_Party.prototype.setMenuActor=function(t){this._menuActorId=t.actorId()},Game_Party.prototype.makeMenuActorNext=function(){var t=this.members().indexOf(this.menuActor());t>=0?(t=(t+1)%this.members().length,this.setMenuActor(this.members()[t])):this.setMenuActor(this.members()[0])},Game_Party.prototype.makeMenuActorPrevious=function(){var t=this.members().indexOf(this.menuActor());t>=0?(t=(t+this.members().length-1)%this.members().length,this.setMenuActor(this.members()[t])):this.setMenuActor(this.members()[0])},Game_Party.prototype.targetActor=function(){var t=$gameActors.actor(this._targetActorId);return this.members().contains(t)||(t=this.members()[0]),t},Game_Party.prototype.setTargetActor=function(t){this._targetActorId=t.actorId()},Game_Party.prototype.lastItem=function(){return this._lastItem.object()},Game_Party.prototype.setLastItem=function(t){this._lastItem.setObject(t)},Game_Party.prototype.swapOrder=function(t,e){var i=this._actors[t];this._actors[t]=this._actors[e],this._actors[e]=i,$gamePlayer.refresh()},Game_Party.prototype.charactersForSavefile=function(){return this.battleMembers().map(function(t){return[t.characterName(),t.characterIndex()]})},Game_Party.prototype.facesForSavefile=function(){return this.battleMembers().map(function(t){return[t.faceName(),t.faceIndex()]})},Game_Party.prototype.partyAbility=function(t){return this.battleMembers().some(function(e){return e.partyAbility(t)})},Game_Party.prototype.hasEncounterHalf=function(){return this.partyAbility(Game_Party.ABILITY_ENCOUNTER_HALF)},Game_Party.prototype.hasEncounterNone=function(){return this.partyAbility(Game_Party.ABILITY_ENCOUNTER_NONE)},Game_Party.prototype.hasCancelSurprise=function(){return this.partyAbility(Game_Party.ABILITY_CANCEL_SURPRISE)},Game_Party.prototype.hasRaisePreemptive=function(){return this.partyAbility(Game_Party.ABILITY_RAISE_PREEMPTIVE)},Game_Party.prototype.hasGoldDouble=function(){return this.partyAbility(Game_Party.ABILITY_GOLD_DOUBLE)},Game_Party.prototype.hasDropItemDouble=function(){return this.partyAbility(Game_Party.ABILITY_DROP_ITEM_DOUBLE)},Game_Party.prototype.ratePreemptive=function(t){var e=this.agility()>=t?.05:.03;return this.hasRaisePreemptive()&&(e*=4),e},Game_Party.prototype.rateSurprise=function(t){var e=this.agility()>=t?.03:.05;return this.hasCancelSurprise()&&(e=0),e},Game_Party.prototype.performVictory=function(){this.members().forEach(function(t){t.performVictory()})},Game_Party.prototype.performEscape=function(){this.members().forEach(function(t){t.performEscape()})},Game_Party.prototype.removeBattleStates=function(){this.members().forEach(function(t){t.removeBattleStates()})},Game_Party.prototype.requestMotionRefresh=function(){this.members().forEach(function(t){t.requestMotionRefresh()})},Game_Troop.prototype=Object.create(Game_Unit.prototype),Game_Troop.prototype.constructor=Game_Troop,Game_Troop.LETTER_TABLE_HALF=[" A"," B"," C"," D"," E"," F"," G"," H"," I"," J"," K"," L"," M"," N"," O"," P"," Q"," R"," S"," T"," U"," V"," W"," X"," Y"," Z"],Game_Troop.LETTER_TABLE_FULL=["\uff21","\uff22","\uff23","\uff24","\uff25","\uff26","\uff27","\uff28","\uff29","\uff2a","\uff2b","\uff2c","\uff2d","\uff2e","\uff2f","\uff30","\uff31","\uff32","\uff33","\uff34","\uff35","\uff36","\uff37","\uff38","\uff39","\uff3a"],Game_Troop.prototype.initialize=function(){Game_Unit.prototype.initialize.call(this),this._interpreter=new Game_Interpreter,this.clear()},Game_Troop.prototype.isEventRunning=function(){return this._interpreter.isRunning()},Game_Troop.prototype.updateInterpreter=function(){this._interpreter.update()},Game_Troop.prototype.turnCount=function(){return this._turnCount},Game_Troop.prototype.members=function(){return this._enemies},Game_Troop.prototype.clear=function(){this._interpreter.clear(),this._troopId=0,this._eventFlags={},this._enemies=[],this._turnCount=0,this._namesCount={}},Game_Troop.prototype.troop=function(){return $dataTroops[this._troopId]},Game_Troop.prototype.setup=function(t){this.clear(),this._troopId=t,this._enemies=[],this.troop().members.forEach(function(t){if($dataEnemies[t.enemyId]){var e=new Game_Enemy(t.enemyId,t.x,t.y);t.hidden&&e.hide(),this._enemies.push(e)}},this),this.makeUniqueNames()},Game_Troop.prototype.makeUniqueNames=function(){var t=this.letterTable();this.members().forEach(function(e){if(e.isAlive()&&e.isLetterEmpty()){var i=e.originalName(),r=this._namesCount[i]||0;e.setLetter(t[r%t.length]),this._namesCount[i]=r+1}},this),this.members().forEach(function(t){var e=t.originalName();this._namesCount[e]>=2&&t.setPlural(!0)},this)},Game_Troop.prototype.letterTable=function(){return $gameSystem.isCJK()?Game_Troop.LETTER_TABLE_FULL:Game_Troop.LETTER_TABLE_HALF},Game_Troop.prototype.enemyNames=function(){var t=[];return this.members().forEach(function(e){var i=e.originalName();e.isAlive()&&!t.contains(i)&&t.push(i)}),t},Game_Troop.prototype.meetsConditions=function(t){var e=t.conditions;if(!(e.turnEnding||e.turnValid||e.enemyValid||e.actorValid||e.switchValid))return!1;if(e.turnEnding&&!BattleManager.isTurnEnd())return!1;if(e.turnValid){var i=this._turnCount,r=e.turnA,n=e.turnB;if(0===n&&i!==r)return!1;if(n>0&&(i<1||i<r||i%n!=r%n))return!1}if(e.enemyValid){var a=$gameTroop.members()[e.enemyIndex];if(!a||100*a.hpRate()>e.enemyHp)return!1}if(e.actorValid){var o=$gameActors.actor(e.actorId);if(!o||100*o.hpRate()>e.actorHp)return!1}return!(e.switchValid&&!$gameSwitches.value(e.switchId))},Game_Troop.prototype.setupBattleEvent=function(){if(!this._interpreter.isRunning()){if(this._interpreter.setupReservedCommonEvent())return;for(var t=this.troop().pages,e=0;e<t.length;e++){var i=t[e];if(this.meetsConditions(i)&&!this._eventFlags[e]){this._interpreter.setup(i.list),i.span<=1&&(this._eventFlags[e]=!0);break}}}},Game_Troop.prototype.increaseTurn=function(){for(var t=this.troop().pages,e=0;e<t.length;e++)1===t[e].span&&(this._eventFlags[e]=!1);this._turnCount++},Game_Troop.prototype.expTotal=function(){return this.deadMembers().reduce(function(t,e){return t+e.exp()},0)},Game_Troop.prototype.goldTotal=function(){return this.deadMembers().reduce(function(t,e){return t+e.gold()},0)*this.goldRate()},Game_Troop.prototype.goldRate=function(){return $gameParty.hasGoldDouble()?2:1},Game_Troop.prototype.makeDropItems=function(){return this.deadMembers().reduce(function(t,e){return t.concat(e.makeDropItems())},[])},Game_Map.prototype.initialize=function(){this._interpreter=new Game_Interpreter,this._mapId=0,this._tilesetId=0,this._events=[],this._commonEvents=[],this._vehicles=[],this._displayX=0,this._displayY=0,this._nameDisplay=!0,this._scrollDirection=2,this._scrollRest=0,this._scrollSpeed=4,this._parallaxName="",this._parallaxZero=!1,this._parallaxLoopX=!1,this._parallaxLoopY=!1,this._parallaxSx=0,this._parallaxSy=0,this._parallaxX=0,this._parallaxY=0,this._battleback1Name=null,this._battleback2Name=null,this.createVehicles()},Game_Map.prototype.setup=function(t){if(!$dataMap)throw new Error("The map data is not available");this._mapId=t,this._tilesetId=$dataMap.tilesetId,this._displayX=0,this._displayY=0,this.refereshVehicles(),this.setupEvents(),this.setupScroll(),this.setupParallax(),this.setupBattleback(),this._needsRefresh=!1},Game_Map.prototype.isEventRunning=function(){return this._interpreter.isRunning()||this.isAnyEventStarting()},Game_Map.prototype.tileWidth=function(){return 48},Game_Map.prototype.tileHeight=function(){return 48},Game_Map.prototype.mapId=function(){return this._mapId},Game_Map.prototype.tilesetId=function(){return this._tilesetId},Game_Map.prototype.displayX=function(){return this._displayX},Game_Map.prototype.displayY=function(){return this._displayY},Game_Map.prototype.parallaxName=function(){return this._parallaxName},Game_Map.prototype.battleback1Name=function(){return this._battleback1Name},Game_Map.prototype.battleback2Name=function(){return this._battleback2Name},Game_Map.prototype.requestRefresh=function(t){this._needsRefresh=!0},Game_Map.prototype.isNameDisplayEnabled=function(){return this._nameDisplay},Game_Map.prototype.disableNameDisplay=function(){this._nameDisplay=!1},Game_Map.prototype.enableNameDisplay=function(){this._nameDisplay=!0},Game_Map.prototype.createVehicles=function(){this._vehicles=[],this._vehicles[0]=new Game_Vehicle("boat"),this._vehicles[1]=new Game_Vehicle("ship"),this._vehicles[2]=new Game_Vehicle("airship")},Game_Map.prototype.refereshVehicles=function(){this._vehicles.forEach(function(t){t.refresh()})},Game_Map.prototype.vehicles=function(){return this._vehicles},Game_Map.prototype.vehicle=function(t){return 0===t||"boat"===t?this.boat():1===t||"ship"===t?this.ship():2===t||"airship"===t?this.airship():null},Game_Map.prototype.boat=function(){return this._vehicles[0]},Game_Map.prototype.ship=function(){return this._vehicles[1]},Game_Map.prototype.airship=function(){return this._vehicles[2]},Game_Map.prototype.setupEvents=function(){this._events=[];for(var t=0;t<$dataMap.events.length;t++)$dataMap.events[t]&&(this._events[t]=new Game_Event(this._mapId,t));this._commonEvents=this.parallelCommonEvents().map(function(t){return new Game_CommonEvent(t.id)}),this.refreshTileEvents()},Game_Map.prototype.events=function(){return this._events.filter(function(t){return!!t})},Game_Map.prototype.event=function(t){return this._events[t]},Game_Map.prototype.eraseEvent=function(t){this._events[t].erase()},Game_Map.prototype.parallelCommonEvents=function(){return $dataCommonEvents.filter(function(t){return t&&2===t.trigger})},Game_Map.prototype.setupScroll=function(){this._scrollDirection=2,this._scrollRest=0,this._scrollSpeed=4},Game_Map.prototype.setupParallax=function(){this._parallaxName=$dataMap.parallaxName||"",this._parallaxZero=ImageManager.isZeroParallax(this._parallaxName),this._parallaxLoopX=$dataMap.parallaxLoopX,this._parallaxLoopY=$dataMap.parallaxLoopY,this._parallaxSx=$dataMap.parallaxSx,this._parallaxSy=$dataMap.parallaxSy,this._parallaxX=0,this._parallaxY=0},Game_Map.prototype.setupBattleback=function(){$dataMap.specifyBattleback?(this._battleback1Name=$dataMap.battleback1Name,this._battleback2Name=$dataMap.battleback2Name):(this._battleback1Name=null,this._battleback2Name=null)},Game_Map.prototype.setDisplayPos=function(t,e){if(this.isLoopHorizontal())this._displayX=t.mod(this.width()),this._parallaxX=t;else{var i=this.width()-this.screenTileX();this._displayX=i<0?i/2:t.clamp(0,i),this._parallaxX=this._displayX}if(this.isLoopVertical())this._displayY=e.mod(this.height()),this._parallaxY=e;else{var r=this.height()-this.screenTileY();this._displayY=r<0?r/2:e.clamp(0,r),this._parallaxY=this._displayY}},Game_Map.prototype.parallaxOx=function(){return this._parallaxZero?this._parallaxX*this.tileWidth():this._parallaxLoopX?this._parallaxX*this.tileWidth()/2:0},Game_Map.prototype.parallaxOy=function(){return this._parallaxZero?this._parallaxY*this.tileHeight():this._parallaxLoopY?this._parallaxY*this.tileHeight()/2:0},Game_Map.prototype.tileset=function(){return $dataTilesets[this._tilesetId]},Game_Map.prototype.tilesetFlags=function(){var t=this.tileset();return t?t.flags:[]},Game_Map.prototype.displayName=function(){return $dataMap.displayName},Game_Map.prototype.width=function(){return $dataMap.width},Game_Map.prototype.height=function(){return $dataMap.height},Game_Map.prototype.data=function(){return $dataMap.data},Game_Map.prototype.isLoopHorizontal=function(){return 2===$dataMap.scrollType||3===$dataMap.scrollType},Game_Map.prototype.isLoopVertical=function(){return 1===$dataMap.scrollType||3===$dataMap.scrollType},Game_Map.prototype.isDashDisabled=function(){return $dataMap.disableDashing},Game_Map.prototype.encounterList=function(){return $dataMap.encounterList},Game_Map.prototype.encounterStep=function(){return $dataMap.encounterStep},Game_Map.prototype.isOverworld=function(){return this.tileset()&&0===this.tileset().mode},Game_Map.prototype.screenTileX=function(){return Graphics.width/this.tileWidth()},Game_Map.prototype.screenTileY=function(){return Graphics.height/this.tileHeight()},Game_Map.prototype.adjustX=function(t){return this.isLoopHorizontal()&&t<this._displayX-(this.width()-this.screenTileX())/2?t-this._displayX+$dataMap.width:t-this._displayX},Game_Map.prototype.adjustY=function(t){return this.isLoopVertical()&&t<this._displayY-(this.height()-this.screenTileY())/2?t-this._displayY+$dataMap.height:t-this._displayY},Game_Map.prototype.roundX=function(t){return this.isLoopHorizontal()?t.mod(this.width()):t},Game_Map.prototype.roundY=function(t){return this.isLoopVertical()?t.mod(this.height()):t},Game_Map.prototype.xWithDirection=function(t,e){return t+(6===e?1:4===e?-1:0)},Game_Map.prototype.yWithDirection=function(t,e){return t+(2===e?1:8===e?-1:0)},Game_Map.prototype.roundXWithDirection=function(t,e){return this.roundX(t+(6===e?1:4===e?-1:0))},Game_Map.prototype.roundYWithDirection=function(t,e){return this.roundY(t+(2===e?1:8===e?-1:0))},Game_Map.prototype.deltaX=function(t,e){var i=t-e;return this.isLoopHorizontal()&&Math.abs(i)>this.width()/2&&(i<0?i+=this.width():i-=this.width()),i},Game_Map.prototype.deltaY=function(t,e){var i=t-e;return this.isLoopVertical()&&Math.abs(i)>this.height()/2&&(i<0?i+=this.height():i-=this.height()),i},Game_Map.prototype.distance=function(t,e,i,r){return Math.abs(this.deltaX(t,i))+Math.abs(this.deltaY(e,r))},Game_Map.prototype.canvasToMapX=function(t){var e=this.tileWidth(),i=Math.floor((this._displayX*e+t)/e);return this.roundX(i)},Game_Map.prototype.canvasToMapY=function(t){var e=this.tileHeight(),i=Math.floor((this._displayY*e+t)/e);return this.roundY(i)},Game_Map.prototype.autoplay=function(){$dataMap.autoplayBgm&&($gamePlayer.isInVehicle()?$gameSystem.saveWalkingBgm2():AudioManager.playBgm($dataMap.bgm)),$dataMap.autoplayBgs&&AudioManager.playBgs($dataMap.bgs)},Game_Map.prototype.refreshIfNeeded=function(){this._needsRefresh&&this.refresh()},Game_Map.prototype.refresh=function(){this.events().forEach(function(t){t.refresh()}),this._commonEvents.forEach(function(t){t.refresh()}),this.refreshTileEvents(),this._needsRefresh=!1},Game_Map.prototype.refreshTileEvents=function(){this.tileEvents=this.events().filter(function(t){return t.isTile()})},Game_Map.prototype.eventsXy=function(t,e){return this.events().filter(function(i){return i.pos(t,e)})},Game_Map.prototype.eventsXyNt=function(t,e){return this.events().filter(function(i){return i.posNt(t,e)})},Game_Map.prototype.tileEventsXy=function(t,e){return this.tileEvents.filter(function(i){return i.posNt(t,e)})},Game_Map.prototype.eventIdXy=function(t,e){var i=this.eventsXy(t,e);return 0===i.length?0:i[0].eventId()},Game_Map.prototype.scrollDown=function(t){if(this.isLoopVertical())this._displayY+=t,this._displayY%=$dataMap.height,this._parallaxLoopY&&(this._parallaxY+=t);else if(this.height()>=this.screenTileY()){var e=this._displayY;this._displayY=Math.min(this._displayY+t,this.height()-this.screenTileY()),this._parallaxY+=this._displayY-e}},Game_Map.prototype.scrollLeft=function(t){if(this.isLoopHorizontal())this._displayX+=$dataMap.width-t,this._displayX%=$dataMap.width,this._parallaxLoopX&&(this._parallaxX-=t);else if(this.width()>=this.screenTileX()){var e=this._displayX;this._displayX=Math.max(this._displayX-t,0),this._parallaxX+=this._displayX-e}},Game_Map.prototype.scrollRight=function(t){if(this.isLoopHorizontal())this._displayX+=t,this._displayX%=$dataMap.width,this._parallaxLoopX&&(this._parallaxX+=t);else if(this.width()>=this.screenTileX()){var e=this._displayX;this._displayX=Math.min(this._displayX+t,this.width()-this.screenTileX()),this._parallaxX+=this._displayX-e}},Game_Map.prototype.scrollUp=function(t){if(this.isLoopVertical())this._displayY+=$dataMap.height-t,this._displayY%=$dataMap.height,this._parallaxLoopY&&(this._parallaxY-=t);else if(this.height()>=this.screenTileY()){var e=this._displayY;this._displayY=Math.max(this._displayY-t,0),this._parallaxY+=this._displayY-e}},Game_Map.prototype.isValid=function(t,e){return t>=0&&t<this.width()&&e>=0&&e<this.height()},Game_Map.prototype.checkPassage=function(t,e,i){for(var r=this.tilesetFlags(),n=this.allTiles(t,e),a=0;a<n.length;a++){var o=r[n[a]];if(0==(16&o)){if(0==(o&i))return!0;if((o&i)===i)return!1}}return!1},Game_Map.prototype.tileId=function(t,e,i){return $dataMap.data[(i*$dataMap.height+e)*$dataMap.width+t]||0},Game_Map.prototype.layeredTiles=function(t,e){for(var i=[],r=0;r<4;r++)i.push(this.tileId(t,e,3-r));return i},Game_Map.prototype.allTiles=function(t,e){return this.tileEventsXy(t,e).map(function(t){return t.tileId()}).concat(this.layeredTiles(t,e))},Game_Map.prototype.autotileType=function(t,e,i){var r=this.tileId(t,e,i);return r>=2048?Math.floor((r-2048)/48):-1},Game_Map.prototype.isPassable=function(t,e,i){return this.checkPassage(t,e,1<<i/2-1&15)},Game_Map.prototype.isBoatPassable=function(t,e){return this.checkPassage(t,e,512)},Game_Map.prototype.isShipPassable=function(t,e){return this.checkPassage(t,e,1024)},Game_Map.prototype.isAirshipLandOk=function(t,e){return this.checkPassage(t,e,2048)&&this.checkPassage(t,e,15)},Game_Map.prototype.checkLayeredTilesFlags=function(t,e,i){var r=this.tilesetFlags();return this.layeredTiles(t,e).some(function(t){return 0!=(r[t]&i)})},Game_Map.prototype.isLadder=function(t,e){return this.isValid(t,e)&&this.checkLayeredTilesFlags(t,e,32)},Game_Map.prototype.isBush=function(t,e){return this.isValid(t,e)&&this.checkLayeredTilesFlags(t,e,64)},Game_Map.prototype.isCounter=function(t,e){return this.isValid(t,e)&&this.checkLayeredTilesFlags(t,e,128)},Game_Map.prototype.isDamageFloor=function(t,e){return this.isValid(t,e)&&this.checkLayeredTilesFlags(t,e,256)},Game_Map.prototype.terrainTag=function(t,e){if(this.isValid(t,e))for(var i=this.tilesetFlags(),r=this.layeredTiles(t,e),n=0;n<r.length;n++){var a=i[r[n]]>>12;if(a>0)return a}return 0},Game_Map.prototype.regionId=function(t,e){return this.isValid(t,e)?this.tileId(t,e,5):0},Game_Map.prototype.startScroll=function(t,e,i){this._scrollDirection=t,this._scrollRest=e,this._scrollSpeed=i},Game_Map.prototype.isScrolling=function(){return this._scrollRest>0},Game_Map.prototype.update=function(t){this.refreshIfNeeded(),t&&this.updateInterpreter(),this.updateScroll(),this.updateEvents(),this.updateVehicles(),this.updateParallax()},Game_Map.prototype.updateScroll=function(){if(this.isScrolling()){var t=this._displayX,e=this._displayY;this.doScroll(this._scrollDirection,this.scrollDistance()),this._displayX===t&&this._displayY===e?this._scrollRest=0:this._scrollRest-=this.scrollDistance()}},Game_Map.prototype.scrollDistance=function(){return Math.pow(2,this._scrollSpeed)/256},Game_Map.prototype.doScroll=function(t,e){switch(t){case 2:this.scrollDown(e);break;case 4:this.scrollLeft(e);break;case 6:this.scrollRight(e);break;case 8:this.scrollUp(e)}},Game_Map.prototype.updateEvents=function(){this.events().forEach(function(t){t.update()}),this._commonEvents.forEach(function(t){t.update()})},Game_Map.prototype.updateVehicles=function(){this._vehicles.forEach(function(t){t.update()})},Game_Map.prototype.updateParallax=function(){this._parallaxLoopX&&(this._parallaxX+=this._parallaxSx/this.tileWidth()/2),this._parallaxLoopY&&(this._parallaxY+=this._parallaxSy/this.tileHeight()/2)},Game_Map.prototype.changeTileset=function(t){this._tilesetId=t,this.refresh()},Game_Map.prototype.changeBattleback=function(t,e){this._battleback1Name=t,this._battleback2Name=e},Game_Map.prototype.changeParallax=function(t,e,i,r,n){this._parallaxName=t,this._parallaxZero=ImageManager.isZeroParallax(this._parallaxName),this._parallaxLoopX&&!e&&(this._parallaxX=0),this._parallaxLoopY&&!i&&(this._parallaxY=0),this._parallaxLoopX=e,this._parallaxLoopY=i,this._parallaxSx=r,this._parallaxSy=n},Game_Map.prototype.updateInterpreter=function(){for(;;){if(this._interpreter.update(),this._interpreter.isRunning())return;if(this._interpreter.eventId()>0&&(this.unlockEvent(this._interpreter.eventId()),this._interpreter.clear()),!this.setupStartingEvent())return}},Game_Map.prototype.unlockEvent=function(t){this._events[t]&&this._events[t].unlock()},Game_Map.prototype.setupStartingEvent=function(){return this.refreshIfNeeded(),!!(this._interpreter.setupReservedCommonEvent()||this.setupTestEvent()||this.setupStartingMapEvent()||this.setupAutorunCommonEvent())},Game_Map.prototype.setupTestEvent=function(){return!!$testEvent&&(this._interpreter.setup($testEvent,0),$testEvent=null,!0)},Game_Map.prototype.setupStartingMapEvent=function(){for(var t=this.events(),e=0;e<t.length;e++){var i=t[e];if(i.isStarting())return i.clearStartingFlag(),this._interpreter.setup(i.list(),i.eventId()),!0}return!1},Game_Map.prototype.setupAutorunCommonEvent=function(){for(var t=0;t<$dataCommonEvents.length;t++){var e=$dataCommonEvents[t];if(e&&1===e.trigger&&$gameSwitches.value(e.switchId))return this._interpreter.setup(e.list),!0}return!1},Game_Map.prototype.isAnyEventStarting=function(){return this.events().some(function(t){return t.isStarting()})},Game_CommonEvent.prototype.initialize=function(t){this._commonEventId=t,this.refresh()},Game_CommonEvent.prototype.event=function(){return $dataCommonEvents[this._commonEventId]},Game_CommonEvent.prototype.list=function(){return this.event().list},Game_CommonEvent.prototype.refresh=function(){this.isActive()?this._interpreter||(this._interpreter=new Game_Interpreter):this._interpreter=null},Game_CommonEvent.prototype.isActive=function(){var t=this.event();return 2===t.trigger&&$gameSwitches.value(t.switchId)},Game_CommonEvent.prototype.update=function(){this._interpreter&&(this._interpreter.isRunning()||this._interpreter.setup(this.list()),this._interpreter.update())},Object.defineProperties(Game_CharacterBase.prototype,{x:{get:function(){return this._x},configurable:!0},y:{get:function(){return this._y},configurable:!0}}),Game_CharacterBase.prototype.initialize=function(){this.initMembers()},Game_CharacterBase.prototype.initMembers=function(){this._x=0,this._y=0,this._realX=0,this._realY=0,this._moveSpeed=4,this._moveFrequency=6,this._opacity=255,this._blendMode=0,this._direction=2,this._pattern=1,this._priorityType=1,this._tileId=0,this._characterName="",this._characterIndex=0,this._isObjectCharacter=!1,this._walkAnime=!0,this._stepAnime=!1,this._directionFix=!1,this._through=!1,this._transparent=!1,this._bushDepth=0,this._animationId=0,this._balloonId=0,this._animationPlaying=!1,this._balloonPlaying=!1,this._animationCount=0,this._stopCount=0,this._jumpCount=0,this._jumpPeak=0,this._movementSuccess=!0},Game_CharacterBase.prototype.pos=function(t,e){return this._x===t&&this._y===e},Game_CharacterBase.prototype.posNt=function(t,e){return this.pos(t,e)&&!this.isThrough()},Game_CharacterBase.prototype.moveSpeed=function(){return this._moveSpeed},Game_CharacterBase.prototype.setMoveSpeed=function(t){this._moveSpeed=t},Game_CharacterBase.prototype.moveFrequency=function(){return this._moveFrequency},Game_CharacterBase.prototype.setMoveFrequency=function(t){this._moveFrequency=t},Game_CharacterBase.prototype.opacity=function(){return this._opacity},Game_CharacterBase.prototype.setOpacity=function(t){this._opacity=t},Game_CharacterBase.prototype.blendMode=function(){return this._blendMode},Game_CharacterBase.prototype.setBlendMode=function(t){this._blendMode=t},Game_CharacterBase.prototype.isNormalPriority=function(){return 1===this._priorityType},Game_CharacterBase.prototype.setPriorityType=function(t){this._priorityType=t},Game_CharacterBase.prototype.isMoving=function(){return this._realX!==this._x||this._realY!==this._y},Game_CharacterBase.prototype.isJumping=function(){return this._jumpCount>0},Game_CharacterBase.prototype.jumpHeight=function(){return(this._jumpPeak*this._jumpPeak-Math.pow(Math.abs(this._jumpCount-this._jumpPeak),2))/2},Game_CharacterBase.prototype.isStopping=function(){return!this.isMoving()&&!this.isJumping()},Game_CharacterBase.prototype.checkStop=function(t){return this._stopCount>t},Game_CharacterBase.prototype.resetStopCount=function(){this._stopCount=0},Game_CharacterBase.prototype.realMoveSpeed=function(){return this._moveSpeed+(this.isDashing()?1:0)},Game_CharacterBase.prototype.distancePerFrame=function(){return Math.pow(2,this.realMoveSpeed())/256},Game_CharacterBase.prototype.isDashing=function(){return!1},Game_CharacterBase.prototype.isDebugThrough=function(){return!1},Game_CharacterBase.prototype.straighten=function(){(this.hasWalkAnime()||this.hasStepAnime())&&(this._pattern=1),this._animationCount=0},Game_CharacterBase.prototype.reverseDir=function(t){return 10-t},Game_CharacterBase.prototype.canPass=function(t,e,i){var r=$gameMap.roundXWithDirection(t,i),n=$gameMap.roundYWithDirection(e,i);return!(!$gameMap.isValid(r,n)||!this.isThrough()&&!this.isDebugThrough()&&(!this.isMapPassable(t,e,i)||this.isCollidedWithCharacters(r,n)))},Game_CharacterBase.prototype.canPassDiagonally=function(t,e,i,r){var n=$gameMap.roundXWithDirection(t,i),a=$gameMap.roundYWithDirection(e,r);return!(!this.canPass(t,e,r)||!this.canPass(t,a,i))||!(!this.canPass(t,e,i)||!this.canPass(n,e,r))},Game_CharacterBase.prototype.isMapPassable=function(t,e,i){var r=$gameMap.roundXWithDirection(t,i),n=$gameMap.roundYWithDirection(e,i),a=this.reverseDir(i);return $gameMap.isPassable(t,e,i)&&$gameMap.isPassable(r,n,a)},Game_CharacterBase.prototype.isCollidedWithCharacters=function(t,e){return this.isCollidedWithEvents(t,e)||this.isCollidedWithVehicles(t,e)},Game_CharacterBase.prototype.isCollidedWithEvents=function(t,e){return $gameMap.eventsXyNt(t,e).some(function(t){return t.isNormalPriority()})},Game_CharacterBase.prototype.isCollidedWithVehicles=function(t,e){return $gameMap.boat().posNt(t,e)||$gameMap.ship().posNt(t,e)},Game_CharacterBase.prototype.setPosition=function(t,e){this._x=Math.round(t),this._y=Math.round(e),this._realX=t,this._realY=e},Game_CharacterBase.prototype.copyPosition=function(t){this._x=t._x,this._y=t._y,this._realX=t._realX,this._realY=t._realY,this._direction=t._direction},Game_CharacterBase.prototype.locate=function(t,e){this.setPosition(t,e),this.straighten(),this.refreshBushDepth()},Game_CharacterBase.prototype.direction=function(){return this._direction},Game_CharacterBase.prototype.setDirection=function(t){!this.isDirectionFixed()&&t&&(this._direction=t),this.resetStopCount()},Game_CharacterBase.prototype.isTile=function(){return this._tileId>0&&0===this._priorityType},Game_CharacterBase.prototype.isObjectCharacter=function(){return this._isObjectCharacter},Game_CharacterBase.prototype.shiftY=function(){return this.isObjectCharacter()?0:6},Game_CharacterBase.prototype.scrolledX=function(){return $gameMap.adjustX(this._realX)},Game_CharacterBase.prototype.scrolledY=function(){return $gameMap.adjustY(this._realY)},Game_CharacterBase.prototype.screenX=function(){var t=$gameMap.tileWidth();return Math.round(this.scrolledX()*t+t/2)},Game_CharacterBase.prototype.screenY=function(){var t=$gameMap.tileHeight();return Math.round(this.scrolledY()*t+t-this.shiftY()-this.jumpHeight())},Game_CharacterBase.prototype.screenZ=function(){return 2*this._priorityType+1},Game_CharacterBase.prototype.isNearTheScreen=function(){var t=Graphics.width,e=Graphics.height,i=$gameMap.tileWidth(),r=$gameMap.tileHeight(),n=this.scrolledX()*i+i/2-t/2,a=this.scrolledY()*r+r/2-e/2;return n>=-t&&n<=t&&a>=-e&&a<=e},Game_CharacterBase.prototype.update=function(){this.isStopping()&&this.updateStop(),this.isJumping()?this.updateJump():this.isMoving()&&this.updateMove(),this.updateAnimation()},Game_CharacterBase.prototype.updateStop=function(){this._stopCount++},Game_CharacterBase.prototype.updateJump=function(){this._jumpCount--,this._realX=(this._realX*this._jumpCount+this._x)/(this._jumpCount+1),this._realY=(this._realY*this._jumpCount+this._y)/(this._jumpCount+1),this.refreshBushDepth(),0===this._jumpCount&&(this._realX=this._x=$gameMap.roundX(this._x),this._realY=this._y=$gameMap.roundY(this._y))},Game_CharacterBase.prototype.updateMove=function(){this._x<this._realX&&(this._realX=Math.max(this._realX-this.distancePerFrame(),this._x)),this._x>this._realX&&(this._realX=Math.min(this._realX+this.distancePerFrame(),this._x)),this._y<this._realY&&(this._realY=Math.max(this._realY-this.distancePerFrame(),this._y)),this._y>this._realY&&(this._realY=Math.min(this._realY+this.distancePerFrame(),this._y)),this.isMoving()||this.refreshBushDepth()},Game_CharacterBase.prototype.updateAnimation=function(){this.updateAnimationCount(),this._animationCount>=this.animationWait()&&(this.updatePattern(),this._animationCount=0)},Game_CharacterBase.prototype.animationWait=function(){return 3*(9-this.realMoveSpeed())},Game_CharacterBase.prototype.updateAnimationCount=function(){this.isMoving()&&this.hasWalkAnime()?this._animationCount+=1.5:!this.hasStepAnime()&&this.isOriginalPattern()||this._animationCount++},Game_CharacterBase.prototype.updatePattern=function(){!this.hasStepAnime()&&this._stopCount>0?this.resetPattern():this._pattern=(this._pattern+1)%this.maxPattern()},Game_CharacterBase.prototype.maxPattern=function(){return 4},Game_CharacterBase.prototype.pattern=function(){return this._pattern<3?this._pattern:1},Game_CharacterBase.prototype.setPattern=function(t){this._pattern=t},Game_CharacterBase.prototype.isOriginalPattern=function(){return 1===this.pattern()},Game_CharacterBase.prototype.resetPattern=function(){this.setPattern(1)},Game_CharacterBase.prototype.refreshBushDepth=function(){this.isNormalPriority()&&!this.isObjectCharacter()&&this.isOnBush()&&!this.isJumping()?this.isMoving()||(this._bushDepth=12):this._bushDepth=0},Game_CharacterBase.prototype.isOnLadder=function(){return $gameMap.isLadder(this._x,this._y)},Game_CharacterBase.prototype.isOnBush=function(){return $gameMap.isBush(this._x,this._y)},Game_CharacterBase.prototype.terrainTag=function(){return $gameMap.terrainTag(this._x,this._y)},Game_CharacterBase.prototype.regionId=function(){return $gameMap.regionId(this._x,this._y)},Game_CharacterBase.prototype.increaseSteps=function(){this.isOnLadder()&&this.setDirection(8),this.resetStopCount(),this.refreshBushDepth()},Game_CharacterBase.prototype.tileId=function(){return this._tileId},Game_CharacterBase.prototype.characterName=function(){return this._characterName},Game_CharacterBase.prototype.characterIndex=function(){return this._characterIndex},Game_CharacterBase.prototype.setImage=function(t,e){this._tileId=0,this._characterName=t,this._characterIndex=e,this._isObjectCharacter=ImageManager.isObjectCharacter(t)},Game_CharacterBase.prototype.setTileImage=function(t){this._tileId=t,this._characterName="",this._characterIndex=0,this._isObjectCharacter=!0},Game_CharacterBase.prototype.checkEventTriggerTouchFront=function(t){var e=$gameMap.roundXWithDirection(this._x,t),i=$gameMap.roundYWithDirection(this._y,t);this.checkEventTriggerTouch(e,i)},Game_CharacterBase.prototype.checkEventTriggerTouch=function(t,e){return!1},Game_CharacterBase.prototype.isMovementSucceeded=function(t,e){return this._movementSuccess},Game_CharacterBase.prototype.setMovementSuccess=function(t){this._movementSuccess=t},Game_CharacterBase.prototype.moveStraight=function(t){this.setMovementSuccess(this.canPass(this._x,this._y,t)),this.isMovementSucceeded()?(this.setDirection(t),this._x=$gameMap.roundXWithDirection(this._x,t),this._y=$gameMap.roundYWithDirection(this._y,t),this._realX=$gameMap.xWithDirection(this._x,this.reverseDir(t)),this._realY=$gameMap.yWithDirection(this._y,this.reverseDir(t)),this.increaseSteps()):(this.setDirection(t),this.checkEventTriggerTouchFront(t))},Game_CharacterBase.prototype.moveDiagonally=function(t,e){this.setMovementSuccess(this.canPassDiagonally(this._x,this._y,t,e)),this.isMovementSucceeded()&&(this._x=$gameMap.roundXWithDirection(this._x,t),this._y=$gameMap.roundYWithDirection(this._y,e),this._realX=$gameMap.xWithDirection(this._x,this.reverseDir(t)),this._realY=$gameMap.yWithDirection(this._y,this.reverseDir(e)),this.increaseSteps()),this._direction===this.reverseDir(t)&&this.setDirection(t),this._direction===this.reverseDir(e)&&this.setDirection(e)},Game_CharacterBase.prototype.jump=function(t,e){Math.abs(t)>Math.abs(e)?0!==t&&this.setDirection(t<0?4:6):0!==e&&this.setDirection(e<0?8:2),this._x+=t,this._y+=e;var i=Math.round(Math.sqrt(t*t+e*e));this._jumpPeak=10+i-this._moveSpeed,this._jumpCount=2*this._jumpPeak,this.resetStopCount(),this.straighten()},Game_CharacterBase.prototype.hasWalkAnime=function(){return this._walkAnime},Game_CharacterBase.prototype.setWalkAnime=function(t){this._walkAnime=t},Game_CharacterBase.prototype.hasStepAnime=function(){return this._stepAnime},Game_CharacterBase.prototype.setStepAnime=function(t){this._stepAnime=t},Game_CharacterBase.prototype.isDirectionFixed=function(){return this._directionFix},Game_CharacterBase.prototype.setDirectionFix=function(t){this._directionFix=t},Game_CharacterBase.prototype.isThrough=function(){return this._through},Game_CharacterBase.prototype.setThrough=function(t){this._through=t},Game_CharacterBase.prototype.isTransparent=function(){return this._transparent},Game_CharacterBase.prototype.bushDepth=function(){return this._bushDepth},Game_CharacterBase.prototype.setTransparent=function(t){this._transparent=t},Game_CharacterBase.prototype.requestAnimation=function(t){this._animationId=t},Game_CharacterBase.prototype.requestBalloon=function(t){this._balloonId=t},Game_CharacterBase.prototype.animationId=function(){return this._animationId},Game_CharacterBase.prototype.balloonId=function(){return this._balloonId},Game_CharacterBase.prototype.startAnimation=function(){this._animationId=0,this._animationPlaying=!0},Game_CharacterBase.prototype.startBalloon=function(){this._balloonId=0,this._balloonPlaying=!0},Game_CharacterBase.prototype.isAnimationPlaying=function(){return this._animationId>0||this._animationPlaying},Game_CharacterBase.prototype.isBalloonPlaying=function(){return this._balloonId>0||this._balloonPlaying},Game_CharacterBase.prototype.endAnimation=function(){this._animationPlaying=!1},Game_CharacterBase.prototype.endBalloon=function(){this._balloonPlaying=!1},Game_Character.prototype=Object.create(Game_CharacterBase.prototype),Game_Character.prototype.constructor=Game_Character,Game_Character.ROUTE_END=0,Game_Character.ROUTE_MOVE_DOWN=1,Game_Character.ROUTE_MOVE_LEFT=2,Game_Character.ROUTE_MOVE_RIGHT=3,Game_Character.ROUTE_MOVE_UP=4,Game_Character.ROUTE_MOVE_LOWER_L=5,Game_Character.ROUTE_MOVE_LOWER_R=6,Game_Character.ROUTE_MOVE_UPPER_L=7,Game_Character.ROUTE_MOVE_UPPER_R=8,Game_Character.ROUTE_MOVE_RANDOM=9,Game_Character.ROUTE_MOVE_TOWARD=10,Game_Character.ROUTE_MOVE_AWAY=11,Game_Character.ROUTE_MOVE_FORWARD=12,Game_Character.ROUTE_MOVE_BACKWARD=13,Game_Character.ROUTE_JUMP=14,Game_Character.ROUTE_WAIT=15,Game_Character.ROUTE_TURN_DOWN=16,Game_Character.ROUTE_TURN_LEFT=17,Game_Character.ROUTE_TURN_RIGHT=18,Game_Character.ROUTE_TURN_UP=19,Game_Character.ROUTE_TURN_90D_R=20,Game_Character.ROUTE_TURN_90D_L=21,Game_Character.ROUTE_TURN_180D=22,Game_Character.ROUTE_TURN_90D_R_L=23,Game_Character.ROUTE_TURN_RANDOM=24,Game_Character.ROUTE_TURN_TOWARD=25,Game_Character.ROUTE_TURN_AWAY=26,Game_Character.ROUTE_SWITCH_ON=27,Game_Character.ROUTE_SWITCH_OFF=28,Game_Character.ROUTE_CHANGE_SPEED=29,Game_Character.ROUTE_CHANGE_FREQ=30,Game_Character.ROUTE_WALK_ANIME_ON=31,Game_Character.ROUTE_WALK_ANIME_OFF=32,Game_Character.ROUTE_STEP_ANIME_ON=33,Game_Character.ROUTE_STEP_ANIME_OFF=34,Game_Character.ROUTE_DIR_FIX_ON=35,Game_Character.ROUTE_DIR_FIX_OFF=36,Game_Character.ROUTE_THROUGH_ON=37,Game_Character.ROUTE_THROUGH_OFF=38,Game_Character.ROUTE_TRANSPARENT_ON=39,Game_Character.ROUTE_TRANSPARENT_OFF=40,Game_Character.ROUTE_CHANGE_IMAGE=41,Game_Character.ROUTE_CHANGE_OPACITY=42,Game_Character.ROUTE_CHANGE_BLEND_MODE=43,Game_Character.ROUTE_PLAY_SE=44,Game_Character.ROUTE_SCRIPT=45,Game_Character.prototype.initialize=function(){Game_CharacterBase.prototype.initialize.call(this)},Game_Character.prototype.initMembers=function(){Game_CharacterBase.prototype.initMembers.call(this),this._moveRouteForcing=!1,this._moveRoute=null,this._moveRouteIndex=0,this._originalMoveRoute=null,this._originalMoveRouteIndex=0,this._waitCount=0},Game_Character.prototype.memorizeMoveRoute=function(){this._originalMoveRoute=this._moveRoute,this._originalMoveRouteIndex=this._moveRouteIndex},Game_Character.prototype.restoreMoveRoute=function(){this._moveRoute=this._originalMoveRoute,this._moveRouteIndex=this._originalMoveRouteIndex,this._originalMoveRoute=null},Game_Character.prototype.isMoveRouteForcing=function(){return this._moveRouteForcing},Game_Character.prototype.setMoveRoute=function(t){this._moveRoute=t,this._moveRouteIndex=0,this._moveRouteForcing=!1},Game_Character.prototype.forceMoveRoute=function(t){this._originalMoveRoute||this.memorizeMoveRoute(),this._moveRoute=t,this._moveRouteIndex=0,this._moveRouteForcing=!0,this._waitCount=0},Game_Character.prototype.updateStop=function(){Game_CharacterBase.prototype.updateStop.call(this),this._moveRouteForcing&&this.updateRoutineMove()},Game_Character.prototype.updateRoutineMove=function(){if(this._waitCount>0)this._waitCount--;else{this.setMovementSuccess(!0);var t=this._moveRoute.list[this._moveRouteIndex];t&&(this.processMoveCommand(t),this.advanceMoveRouteIndex())}},Game_Character.prototype.processMoveCommand=function(command){var gc=Game_Character,params=command.parameters;switch(command.code){case gc.ROUTE_END:this.processRouteEnd();break;case gc.ROUTE_MOVE_DOWN:this.moveStraight(2);break;case gc.ROUTE_MOVE_LEFT:this.moveStraight(4);break;case gc.ROUTE_MOVE_RIGHT:this.moveStraight(6);break;case gc.ROUTE_MOVE_UP:this.moveStraight(8);break;case gc.ROUTE_MOVE_LOWER_L:this.moveDiagonally(4,2);break;case gc.ROUTE_MOVE_LOWER_R:this.moveDiagonally(6,2);break;case gc.ROUTE_MOVE_UPPER_L:this.moveDiagonally(4,8);break;case gc.ROUTE_MOVE_UPPER_R:this.moveDiagonally(6,8);break;case gc.ROUTE_MOVE_RANDOM:this.moveRandom();break;case gc.ROUTE_MOVE_TOWARD:this.moveTowardPlayer();break;case gc.ROUTE_MOVE_AWAY:this.moveAwayFromPlayer();break;case gc.ROUTE_MOVE_FORWARD:this.moveForward();break;case gc.ROUTE_MOVE_BACKWARD:this.moveBackward();break;case gc.ROUTE_JUMP:this.jump(params[0],params[1]);break;case gc.ROUTE_WAIT:this._waitCount=params[0]-1;break;case gc.ROUTE_TURN_DOWN:this.setDirection(2);break;case gc.ROUTE_TURN_LEFT:this.setDirection(4);break;case gc.ROUTE_TURN_RIGHT:this.setDirection(6);break;case gc.ROUTE_TURN_UP:this.setDirection(8);break;case gc.ROUTE_TURN_90D_R:this.turnRight90();break;case gc.ROUTE_TURN_90D_L:this.turnLeft90();break;case gc.ROUTE_TURN_180D:this.turn180();break;case gc.ROUTE_TURN_90D_R_L:this.turnRightOrLeft90();break;case gc.ROUTE_TURN_RANDOM:this.turnRandom();break;case gc.ROUTE_TURN_TOWARD:this.turnTowardPlayer();break;case gc.ROUTE_TURN_AWAY:this.turnAwayFromPlayer();break;case gc.ROUTE_SWITCH_ON:$gameSwitches.setValue(params[0],!0);break;case gc.ROUTE_SWITCH_OFF:$gameSwitches.setValue(params[0],!1);break;case gc.ROUTE_CHANGE_SPEED:this.setMoveSpeed(params[0]);break;case gc.ROUTE_CHANGE_FREQ:this.setMoveFrequency(params[0]);break;case gc.ROUTE_WALK_ANIME_ON:this.setWalkAnime(!0);break;case gc.ROUTE_WALK_ANIME_OFF:this.setWalkAnime(!1);break;case gc.ROUTE_STEP_ANIME_ON:this.setStepAnime(!0);break;case gc.ROUTE_STEP_ANIME_OFF:this.setStepAnime(!1);break;case gc.ROUTE_DIR_FIX_ON:this.setDirectionFix(!0);break;case gc.ROUTE_DIR_FIX_OFF:this.setDirectionFix(!1);break;case gc.ROUTE_THROUGH_ON:this.setThrough(!0);break;case gc.ROUTE_THROUGH_OFF:this.setThrough(!1);break;case gc.ROUTE_TRANSPARENT_ON:this.setTransparent(!0);break;case gc.ROUTE_TRANSPARENT_OFF:this.setTransparent(!1);break;case gc.ROUTE_CHANGE_IMAGE:this.setImage(params[0],params[1]);break;case gc.ROUTE_CHANGE_OPACITY:this.setOpacity(params[0]);break;case gc.ROUTE_CHANGE_BLEND_MODE:this.setBlendMode(params[0]);break;case gc.ROUTE_PLAY_SE:AudioManager.playSe(params[0]);break;case gc.ROUTE_SCRIPT:eval(params[0])}},Game_Character.prototype.deltaXFrom=function(t){return $gameMap.deltaX(this.x,t)},Game_Character.prototype.deltaYFrom=function(t){return $gameMap.deltaY(this.y,t)},Game_Character.prototype.moveRandom=function(){var t=2+2*Math.randomInt(4);this.canPass(this.x,this.y,t)&&this.moveStraight(t)},Game_Character.prototype.moveTowardCharacter=function(t){var e=this.deltaXFrom(t.x),i=this.deltaYFrom(t.y);Math.abs(e)>Math.abs(i)?(this.moveStraight(e>0?4:6),this.isMovementSucceeded()||0===i||this.moveStraight(i>0?8:2)):0!==i&&(this.moveStraight(i>0?8:2),this.isMovementSucceeded()||0===e||this.moveStraight(e>0?4:6))},Game_Character.prototype.moveAwayFromCharacter=function(t){var e=this.deltaXFrom(t.x),i=this.deltaYFrom(t.y);Math.abs(e)>Math.abs(i)?(this.moveStraight(e>0?6:4),this.isMovementSucceeded()||0===i||this.moveStraight(i>0?2:8)):0!==i&&(this.moveStraight(i>0?2:8),this.isMovementSucceeded()||0===e||this.moveStraight(e>0?6:4))},Game_Character.prototype.turnTowardCharacter=function(t){var e=this.deltaXFrom(t.x),i=this.deltaYFrom(t.y);Math.abs(e)>Math.abs(i)?this.setDirection(e>0?4:6):0!==i&&this.setDirection(i>0?8:2)},Game_Character.prototype.turnAwayFromCharacter=function(t){var e=this.deltaXFrom(t.x),i=this.deltaYFrom(t.y);Math.abs(e)>Math.abs(i)?this.setDirection(e>0?6:4):0!==i&&this.setDirection(i>0?2:8)},Game_Character.prototype.turnTowardPlayer=function(){this.turnTowardCharacter($gamePlayer)},Game_Character.prototype.turnAwayFromPlayer=function(){this.turnAwayFromCharacter($gamePlayer)},Game_Character.prototype.moveTowardPlayer=function(){this.moveTowardCharacter($gamePlayer)},Game_Character.prototype.moveAwayFromPlayer=function(){this.moveAwayFromCharacter($gamePlayer)},Game_Character.prototype.moveForward=function(){this.moveStraight(this.direction())},Game_Character.prototype.moveBackward=function(){var t=this.isDirectionFixed();this.setDirectionFix(!0),this.moveStraight(this.reverseDir(this.direction())),this.setDirectionFix(t)},Game_Character.prototype.processRouteEnd=function(){this._moveRoute.repeat?this._moveRouteIndex=-1:this._moveRouteForcing&&(this._moveRouteForcing=!1,this.restoreMoveRoute())},Game_Character.prototype.advanceMoveRouteIndex=function(){var t=this._moveRoute;if(t&&(this.isMovementSucceeded()||t.skippable)){var e=t.list.length-1;this._moveRouteIndex++,t.repeat&&this._moveRouteIndex>=e&&(this._moveRouteIndex=0)}},Game_Character.prototype.turnRight90=function(){switch(this.direction()){case 2:this.setDirection(4);break;case 4:this.setDirection(8);break;case 6:this.setDirection(2);break;case 8:this.setDirection(6)}},Game_Character.prototype.turnLeft90=function(){switch(this.direction()){case 2:this.setDirection(6);break;case 4:this.setDirection(2);break;case 6:this.setDirection(8);break;case 8:this.setDirection(4)}},Game_Character.prototype.turn180=function(){this.setDirection(this.reverseDir(this.direction()))},Game_Character.prototype.turnRightOrLeft90=function(){switch(Math.randomInt(2)){case 0:this.turnRight90();break;case 1:this.turnLeft90()}},Game_Character.prototype.turnRandom=function(){this.setDirection(2+2*Math.randomInt(4))},Game_Character.prototype.swap=function(t){var e=t.x,i=t.y;t.locate(this.x,this.y),this.locate(e,i)},Game_Character.prototype.findDirectionTo=function(t,e){var i=this.searchLimit(),r=$gameMap.width(),n=[],a=[],o=[],s={},h=s;if(this.x===t&&this.y===e)return 0;for(s.parent=null,s.x=this.x,s.y=this.y,s.g=0,s.f=$gameMap.distance(s.x,s.y,t,e),n.push(s),a.push(s.y*r+s.x);n.length>0;){for(var c=0,u=0;u<n.length;u++)n[u].f<n[c].f&&(c=u);var p=n[c],l=p.x,d=p.y,m=d*r+l,f=p.g;if(n.splice(c,1),a.splice(a.indexOf(m),1),o.push(m),p.x===t&&p.y===e){h=p;break}if(!(f>=i))for(var _=0;_<4;_++){var y=2+2*_,g=$gameMap.roundXWithDirection(l,y),v=$gameMap.roundYWithDirection(d,y),w=v*r+g;if(!o.contains(w)&&this.canPass(l,d,y)){var S,b=f+1,x=a.indexOf(w);(x<0||b<n[x].g)&&(x>=0?S=n[x]:(n.push(S={}),a.push(w)),S.parent=p,S.x=g,S.y=v,S.g=b,S.f=b+$gameMap.distance(g,v,t,e),(!h||S.f-S.g<h.f-h.g)&&(h=S))}}}for(var T=h;T.parent&&T.parent!==s;)T=T.parent;var M=$gameMap.deltaX(T.x,s.x),E=$gameMap.deltaY(T.y,s.y);if(E>0)return 2;if(M<0)return 4;if(M>0)return 6;if(E<0)return 8;var I=this.deltaXFrom(t),C=this.deltaYFrom(e);return Math.abs(I)>Math.abs(C)?I>0?4:6:0!==C?C>0?8:2:0},Game_Character.prototype.searchLimit=function(){return 12},Game_Player.prototype=Object.create(Game_Character.prototype),Game_Player.prototype.constructor=Game_Player,Game_Player.prototype.initialize=function(){Game_Character.prototype.initialize.call(this),this.setTransparent($dataSystem.optTransparent)},Game_Player.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._vehicleType="walk",this._vehicleGettingOn=!1,this._vehicleGettingOff=!1,this._dashing=!1,this._needsMapReload=!1,this._transferring=!1,this._newMapId=0,this._newX=0,this._newY=0,this._newDirection=0,this._fadeType=0,this._followers=new Game_Followers,this._encounterCount=0},Game_Player.prototype.clearTransferInfo=function(){this._transferring=!1,this._newMapId=0,this._newX=0,this._newY=0,this._newDirection=0},Game_Player.prototype.followers=function(){return this._followers},Game_Player.prototype.refresh=function(){var t=$gameParty.leader(),e=t?t.characterName():"",i=t?t.characterIndex():0;this.setImage(e,i),this._followers.refresh()},Game_Player.prototype.isStopping=function(){return!this._vehicleGettingOn&&!this._vehicleGettingOff&&Game_Character.prototype.isStopping.call(this)},Game_Player.prototype.reserveTransfer=function(t,e,i,r,n){this._transferring=!0,this._newMapId=t,this._newX=e,this._newY=i,this._newDirection=r,this._fadeType=n},Game_Player.prototype.requestMapReload=function(){this._needsMapReload=!0},Game_Player.prototype.isTransferring=function(){return this._transferring},Game_Player.prototype.newMapId=function(){return this._newMapId},Game_Player.prototype.fadeType=function(){return this._fadeType},Game_Player.prototype.performTransfer=function(){this.isTransferring()&&(this.setDirection(this._newDirection),(this._newMapId!==$gameMap.mapId()||this._needsMapReload)&&($gameMap.setup(this._newMapId),this._needsMapReload=!1),this.locate(this._newX,this._newY),this.refresh(),this.clearTransferInfo())},Game_Player.prototype.isMapPassable=function(t,e,i){var r=this.vehicle();return r?r.isMapPassable(t,e,i):Game_Character.prototype.isMapPassable.call(this,t,e,i)},Game_Player.prototype.vehicle=function(){return $gameMap.vehicle(this._vehicleType)},Game_Player.prototype.isInBoat=function(){return"boat"===this._vehicleType},Game_Player.prototype.isInShip=function(){return"ship"===this._vehicleType},Game_Player.prototype.isInAirship=function(){return"airship"===this._vehicleType},Game_Player.prototype.isInVehicle=function(){return this.isInBoat()||this.isInShip()||this.isInAirship()},Game_Player.prototype.isNormal=function(){return"walk"===this._vehicleType&&!this.isMoveRouteForcing()},Game_Player.prototype.isDashing=function(){return this._dashing},Game_Player.prototype.isDebugThrough=function(){return Input.isPressed("control")&&$gameTemp.isPlaytest()},Game_Player.prototype.isCollided=function(t,e){return!this.isThrough()&&(this.pos(t,e)||this._followers.isSomeoneCollided(t,e))},Game_Player.prototype.centerX=function(){return(Graphics.width/$gameMap.tileWidth()-1)/2},Game_Player.prototype.centerY=function(){return(Graphics.height/$gameMap.tileHeight()-1)/2},Game_Player.prototype.center=function(t,e){return $gameMap.setDisplayPos(t-this.centerX(),e-this.centerY())},Game_Player.prototype.locate=function(t,e){Game_Character.prototype.locate.call(this,t,e),this.center(t,e),this.makeEncounterCount(),this.isInVehicle()&&this.vehicle().refresh(),this._followers.synchronize(t,e,this.direction())},Game_Player.prototype.increaseSteps=function(){Game_Character.prototype.increaseSteps.call(this),this.isNormal()&&$gameParty.increaseSteps()},Game_Player.prototype.makeEncounterCount=function(){var t=$gameMap.encounterStep();this._encounterCount=Math.randomInt(t)+Math.randomInt(t)+1},Game_Player.prototype.makeEncounterTroopId=function(){var t=[],e=0;if($gameMap.encounterList().forEach(function(i){this.meetsEncounterConditions(i)&&(t.push(i),e+=i.weight)},this),e>0)for(var i=Math.randomInt(e),r=0;r<t.length;r++)if((i-=t[r].weight)<0)return t[r].troopId;return 0},Game_Player.prototype.meetsEncounterConditions=function(t){return 0===t.regionSet.length||t.regionSet.contains(this.regionId())},Game_Player.prototype.executeEncounter=function(){if(!$gameMap.isEventRunning()&&this._encounterCount<=0){this.makeEncounterCount();var t=this.makeEncounterTroopId();return!!$dataTroops[t]&&(BattleManager.setup(t,!0,!1),BattleManager.onEncounter(),!0)}return!1},Game_Player.prototype.startMapEvent=function(t,e,i,r){$gameMap.isEventRunning()||$gameMap.eventsXy(t,e).forEach(function(t){t.isTriggerIn(i)&&t.isNormalPriority()===r&&t.start()})},Game_Player.prototype.moveByInput=function(){if(!this.isMoving()&&this.canMove()){var t=this.getInputDirection();if(t>0)$gameTemp.clearDestination();else if($gameTemp.isDestinationValid()){var e=$gameTemp.destinationX(),i=$gameTemp.destinationY();t=this.findDirectionTo(e,i)}t>0&&this.executeMove(t)}},Game_Player.prototype.canMove=function(){return!($gameMap.isEventRunning()||$gameMessage.isBusy()||this.isMoveRouteForcing()||this.areFollowersGathering()||this._vehicleGettingOn||this._vehicleGettingOff||this.isInVehicle()&&!this.vehicle().canMove())},Game_Player.prototype.getInputDirection=function(){return Input.dir4},Game_Player.prototype.executeMove=function(t){this.moveStraight(t)},Game_Player.prototype.update=function(t){var e=this.scrolledX(),i=this.scrolledY(),r=this.isMoving();this.updateDashing(),t&&this.moveByInput(),Game_Character.prototype.update.call(this),this.updateScroll(e,i),this.updateVehicle(),this.isMoving()||this.updateNonmoving(r),this._followers.update()},Game_Player.prototype.updateDashing=function(){this.isMoving()||(this._dashing=!(!this.canMove()||this.isInVehicle()||$gameMap.isDashDisabled())&&(this.isDashButtonPressed()||$gameTemp.isDestinationValid()))},Game_Player.prototype.isDashButtonPressed=function(){var t=Input.isPressed("shift");return ConfigManager.alwaysDash?!t:t},Game_Player.prototype.updateScroll=function(t,e){var i=t,r=e,n=this.scrolledX(),a=this.scrolledY();a>r&&a>this.centerY()&&$gameMap.scrollDown(a-r),n<i&&n<this.centerX()&&$gameMap.scrollLeft(i-n),n>i&&n>this.centerX()&&$gameMap.scrollRight(n-i),a<r&&a<this.centerY()&&$gameMap.scrollUp(r-a)},Game_Player.prototype.updateVehicle=function(){this.isInVehicle()&&!this.areFollowersGathering()&&(this._vehicleGettingOn?this.updateVehicleGetOn():this._vehicleGettingOff?this.updateVehicleGetOff():this.vehicle().syncWithPlayer())},Game_Player.prototype.updateVehicleGetOn=function(){this.areFollowersGathering()||this.isMoving()||(this.setDirection(this.vehicle().direction()),this.setMoveSpeed(this.vehicle().moveSpeed()),this._vehicleGettingOn=!1,this.setTransparent(!0),this.isInAirship()&&this.setThrough(!0),this.vehicle().getOn())},Game_Player.prototype.updateVehicleGetOff=function(){!this.areFollowersGathering()&&this.vehicle().isLowest()&&(this._vehicleGettingOff=!1,this._vehicleType="walk",this.setTransparent(!1))},Game_Player.prototype.updateNonmoving=function(t){if(!$gameMap.isEventRunning()){if(t&&($gameParty.onPlayerWalk(),this.checkEventTriggerHere([1,2]),$gameMap.setupStartingEvent()))return;if(this.triggerAction())return;t?this.updateEncounterCount():$gameTemp.clearDestination()}},Game_Player.prototype.triggerAction=function(){if(this.canMove()){if(this.triggerButtonAction())return!0;if(this.triggerTouchAction())return!0}return!1};Game_Player.prototype.triggerButtonAction=function(){if(Input.isTriggered("ok")){if(this.getOnOffVehicle())return!0;if(this.checkEventTriggerHere([0]),$gameMap.setupStartingEvent())return!0;if(this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent())return!0}return!1},Game_Player.prototype.triggerTouchAction=function(){if($gameTemp.isDestinationValid()){var t=this.direction(),e=this.x,i=this.y,r=$gameMap.roundXWithDirection(e,t),n=$gameMap.roundYWithDirection(i,t),a=$gameMap.roundXWithDirection(r,t),o=$gameMap.roundYWithDirection(n,t),s=$gameTemp.destinationX(),h=$gameTemp.destinationY();if(s===e&&h===i)return this.triggerTouchActionD1(e,i);if(s===r&&h===n)return this.triggerTouchActionD2(r,n);if(s===a&&h===o)return this.triggerTouchActionD3(r,n)}return!1},Game_Player.prototype.triggerTouchActionD1=function(t,e){return!!($gameMap.airship().pos(t,e)&&TouchInput.isTriggered()&&this.getOnOffVehicle())||(this.checkEventTriggerHere([0]),$gameMap.setupStartingEvent())},Game_Player.prototype.triggerTouchActionD2=function(t,e){return!(!$gameMap.boat().pos(t,e)&&!$gameMap.ship().pos(t,e)||!TouchInput.isTriggered()||!this.getOnVehicle())||!(!this.isInBoat()&&!this.isInShip()||!TouchInput.isTriggered()||!this.getOffVehicle())||(this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent())},Game_Player.prototype.triggerTouchActionD3=function(t,e){return $gameMap.isCounter(t,e)&&this.checkEventTriggerThere([0,1,2]),$gameMap.setupStartingEvent()},Game_Player.prototype.updateEncounterCount=function(){this.canEncounter()&&(this._encounterCount-=this.encounterProgressValue())},Game_Player.prototype.canEncounter=function(){return!$gameParty.hasEncounterNone()&&$gameSystem.isEncounterEnabled()&&!this.isInAirship()&&!this.isMoveRouteForcing()&&!this.isDebugThrough()},Game_Player.prototype.encounterProgressValue=function(){var t=$gameMap.isBush(this.x,this.y)?2:1;return $gameParty.hasEncounterHalf()&&(t*=.5),this.isInShip()&&(t*=.5),t},Game_Player.prototype.checkEventTriggerHere=function(t){this.canStartLocalEvents()&&this.startMapEvent(this.x,this.y,t,!1)},Game_Player.prototype.checkEventTriggerThere=function(t){if(this.canStartLocalEvents()){var e=this.direction(),i=this.y,r=$gameMap.roundXWithDirection(this.x,e),n=$gameMap.roundYWithDirection(i,e);if(this.startMapEvent(r,n,t,!0),!$gameMap.isAnyEventStarting()&&$gameMap.isCounter(r,n)){var a=$gameMap.roundXWithDirection(r,e),o=$gameMap.roundYWithDirection(n,e);this.startMapEvent(a,o,t,!0)}}},Game_Player.prototype.checkEventTriggerTouch=function(t,e){this.canStartLocalEvents()&&this.startMapEvent(t,e,[1,2],!0)},Game_Player.prototype.canStartLocalEvents=function(){return!this.isInAirship()},Game_Player.prototype.getOnOffVehicle=function(){return this.isInVehicle()?this.getOffVehicle():this.getOnVehicle()},Game_Player.prototype.getOnVehicle=function(){var t=this.direction(),e=this.x,i=this.y,r=$gameMap.roundXWithDirection(e,t),n=$gameMap.roundYWithDirection(i,t);return $gameMap.airship().pos(e,i)?this._vehicleType="airship":$gameMap.ship().pos(r,n)?this._vehicleType="ship":$gameMap.boat().pos(r,n)&&(this._vehicleType="boat"),this.isInVehicle()&&(this._vehicleGettingOn=!0,this.isInAirship()||this.forceMoveForward(),this.gatherFollowers()),this._vehicleGettingOn},Game_Player.prototype.getOffVehicle=function(){return this.vehicle().isLandOk(this.x,this.y,this.direction())&&(this.isInAirship()&&this.setDirection(2),this._followers.synchronize(this.x,this.y,this.direction()),this.vehicle().getOff(),this.isInAirship()||(this.forceMoveForward(),this.setTransparent(!1)),this._vehicleGettingOff=!0,this.setMoveSpeed(4),this.setThrough(!1),this.makeEncounterCount(),this.gatherFollowers()),this._vehicleGettingOff},Game_Player.prototype.forceMoveForward=function(){this.setThrough(!0),this.moveForward(),this.setThrough(!1)},Game_Player.prototype.isOnDamageFloor=function(){return $gameMap.isDamageFloor(this.x,this.y)&&!this.isInAirship()},Game_Player.prototype.moveStraight=function(t){this.canPass(this.x,this.y,t)&&this._followers.updateMove(),Game_Character.prototype.moveStraight.call(this,t)},Game_Player.prototype.moveDiagonally=function(t,e){this.canPassDiagonally(this.x,this.y,t,e)&&this._followers.updateMove(),Game_Character.prototype.moveDiagonally.call(this,t,e)},Game_Player.prototype.jump=function(t,e){Game_Character.prototype.jump.call(this,t,e),this._followers.jumpAll()},Game_Player.prototype.showFollowers=function(){this._followers.show()},Game_Player.prototype.hideFollowers=function(){this._followers.hide()},Game_Player.prototype.gatherFollowers=function(){this._followers.gather()},Game_Player.prototype.areFollowersGathering=function(){return this._followers.areGathering()},Game_Player.prototype.areFollowersGathered=function(){return this._followers.areGathered()},Game_Follower.prototype=Object.create(Game_Character.prototype),Game_Follower.prototype.constructor=Game_Follower,Game_Follower.prototype.initialize=function(t){Game_Character.prototype.initialize.call(this),this._memberIndex=t,this.setTransparent($dataSystem.optTransparent),this.setThrough(!0)},Game_Follower.prototype.refresh=function(){var t=this.isVisible()?this.actor().characterName():"",e=this.isVisible()?this.actor().characterIndex():0;this.setImage(t,e)},Game_Follower.prototype.actor=function(){return $gameParty.battleMembers()[this._memberIndex]},Game_Follower.prototype.isVisible=function(){return this.actor()&&$gamePlayer.followers().isVisible()},Game_Follower.prototype.update=function(){Game_Character.prototype.update.call(this),this.setMoveSpeed($gamePlayer.realMoveSpeed()),this.setOpacity($gamePlayer.opacity()),this.setBlendMode($gamePlayer.blendMode()),this.setWalkAnime($gamePlayer.hasWalkAnime()),this.setStepAnime($gamePlayer.hasStepAnime()),this.setDirectionFix($gamePlayer.isDirectionFixed()),this.setTransparent($gamePlayer.isTransparent())},Game_Follower.prototype.chaseCharacter=function(t){var e=this.deltaXFrom(t.x),i=this.deltaYFrom(t.y);0!==e&&0!==i?this.moveDiagonally(e>0?4:6,i>0?8:2):0!==e?this.moveStraight(e>0?4:6):0!==i&&this.moveStraight(i>0?8:2),this.setMoveSpeed($gamePlayer.realMoveSpeed())},Game_Followers.prototype.initialize=function(){this._visible=$dataSystem.optFollowers,this._gathering=!1,this._data=[];for(var t=1;t<$gameParty.maxBattleMembers();t++)this._data.push(new Game_Follower(t))},Game_Followers.prototype.isVisible=function(){return this._visible},Game_Followers.prototype.show=function(){this._visible=!0},Game_Followers.prototype.hide=function(){this._visible=!1},Game_Followers.prototype.follower=function(t){return this._data[t]},Game_Followers.prototype.forEach=function(t,e){this._data.forEach(t,e)},Game_Followers.prototype.reverseEach=function(t,e){this._data.reverse(),this._data.forEach(t,e),this._data.reverse()},Game_Followers.prototype.refresh=function(){this.forEach(function(t){return t.refresh()},this)},Game_Followers.prototype.update=function(){this.areGathering()&&(this.areMoving()||this.updateMove(),this.areGathered()&&(this._gathering=!1)),this.forEach(function(t){t.update()},this)},Game_Followers.prototype.updateMove=function(){for(var t=this._data.length-1;t>=0;t--)this._data[t].chaseCharacter(t>0?this._data[t-1]:$gamePlayer)},Game_Followers.prototype.jumpAll=function(){if($gamePlayer.isJumping())for(var t=0;t<this._data.length;t++){var e=this._data[t],i=$gamePlayer.deltaXFrom(e.x),r=$gamePlayer.deltaYFrom(e.y);e.jump(i,r)}},Game_Followers.prototype.synchronize=function(t,e,i){this.forEach(function(r){r.locate(t,e),r.setDirection(i)},this)},Game_Followers.prototype.gather=function(){this._gathering=!0},Game_Followers.prototype.areGathering=function(){return this._gathering},Game_Followers.prototype.visibleFollowers=function(){return this._data.filter(function(t){return t.isVisible()},this)},Game_Followers.prototype.areMoving=function(){return this.visibleFollowers().some(function(t){return t.isMoving()},this)},Game_Followers.prototype.areGathered=function(){return this.visibleFollowers().every(function(t){return!t.isMoving()&&t.pos($gamePlayer.x,$gamePlayer.y)},this)},Game_Followers.prototype.isSomeoneCollided=function(t,e){return this.visibleFollowers().some(function(i){return i.pos(t,e)},this)},Game_Vehicle.prototype=Object.create(Game_Character.prototype),Game_Vehicle.prototype.constructor=Game_Vehicle,Game_Vehicle.prototype.initialize=function(t){Game_Character.prototype.initialize.call(this),this._type=t,this.resetDirection(),this.initMoveSpeed(),this.loadSystemSettings()},Game_Vehicle.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._type="",this._mapId=0,this._altitude=0,this._driving=!1,this._bgm=null},Game_Vehicle.prototype.isBoat=function(){return"boat"===this._type},Game_Vehicle.prototype.isShip=function(){return"ship"===this._type},Game_Vehicle.prototype.isAirship=function(){return"airship"===this._type},Game_Vehicle.prototype.resetDirection=function(){this.setDirection(4)},Game_Vehicle.prototype.initMoveSpeed=function(){this.isBoat()?this.setMoveSpeed(4):this.isShip()?this.setMoveSpeed(5):this.isAirship()&&this.setMoveSpeed(6)},Game_Vehicle.prototype.vehicle=function(){return this.isBoat()?$dataSystem.boat:this.isShip()?$dataSystem.ship:this.isAirship()?$dataSystem.airship:null},Game_Vehicle.prototype.loadSystemSettings=function(){var t=this.vehicle();this._mapId=t.startMapId,this.setPosition(t.startX,t.startY),this.setImage(t.characterName,t.characterIndex)},Game_Vehicle.prototype.refresh=function(){this._driving?(this._mapId=$gameMap.mapId(),this.syncWithPlayer()):this._mapId===$gameMap.mapId()&&this.locate(this.x,this.y),this.isAirship()?this.setPriorityType(this._driving?2:0):this.setPriorityType(1),this.setWalkAnime(this._driving),this.setStepAnime(this._driving),this.setTransparent(this._mapId!==$gameMap.mapId())},Game_Vehicle.prototype.setLocation=function(t,e,i){this._mapId=t,this.setPosition(e,i),this.refresh()},Game_Vehicle.prototype.pos=function(t,e){return this._mapId===$gameMap.mapId()&&Game_Character.prototype.pos.call(this,t,e)},Game_Vehicle.prototype.isMapPassable=function(t,e,i){var r=$gameMap.roundXWithDirection(t,i),n=$gameMap.roundYWithDirection(e,i);return this.isBoat()?$gameMap.isBoatPassable(r,n):this.isShip()?$gameMap.isShipPassable(r,n):!!this.isAirship()},Game_Vehicle.prototype.getOn=function(){this._driving=!0,this.setWalkAnime(!0),this.setStepAnime(!0),$gameSystem.saveWalkingBgm(),this.playBgm()},Game_Vehicle.prototype.getOff=function(){this._driving=!1,this.setWalkAnime(!1),this.setStepAnime(!1),this.resetDirection(),$gameSystem.replayWalkingBgm()},Game_Vehicle.prototype.setBgm=function(t){this._bgm=t},Game_Vehicle.prototype.playBgm=function(){AudioManager.playBgm(this._bgm||this.vehicle().bgm)},Game_Vehicle.prototype.syncWithPlayer=function(){this.copyPosition($gamePlayer),this.refreshBushDepth()},Game_Vehicle.prototype.screenY=function(){return Game_Character.prototype.screenY.call(this)-this._altitude},Game_Vehicle.prototype.shadowX=function(){return this.screenX()},Game_Vehicle.prototype.shadowY=function(){return this.screenY()+this._altitude},Game_Vehicle.prototype.shadowOpacity=function(){return 255*this._altitude/this.maxAltitude()},Game_Vehicle.prototype.canMove=function(){return!this.isAirship()||this.isHighest()},Game_Vehicle.prototype.update=function(){Game_Character.prototype.update.call(this),this.isAirship()&&this.updateAirship()},Game_Vehicle.prototype.updateAirship=function(){this.updateAirshipAltitude(),this.setStepAnime(this.isHighest()),this.setPriorityType(this.isLowest()?0:2)},Game_Vehicle.prototype.updateAirshipAltitude=function(){this._driving&&!this.isHighest()&&this._altitude++,this._driving||this.isLowest()||this._altitude--},Game_Vehicle.prototype.maxAltitude=function(){return 48},Game_Vehicle.prototype.isLowest=function(){return this._altitude<=0},Game_Vehicle.prototype.isHighest=function(){return this._altitude>=this.maxAltitude()},Game_Vehicle.prototype.isTakeoffOk=function(){return $gamePlayer.areFollowersGathered()},Game_Vehicle.prototype.isLandOk=function(t,e,i){if(this.isAirship()){if(!$gameMap.isAirshipLandOk(t,e))return!1;if($gameMap.eventsXy(t,e).length>0)return!1}else{var r=$gameMap.roundXWithDirection(t,i),n=$gameMap.roundYWithDirection(e,i);if(!$gameMap.isValid(r,n))return!1;if(!$gameMap.isPassable(r,n,this.reverseDir(i)))return!1;if(this.isCollidedWithCharacters(r,n))return!1}return!0},Game_Event.prototype=Object.create(Game_Character.prototype),Game_Event.prototype.constructor=Game_Event,Game_Event.prototype.initialize=function(t,e){Game_Character.prototype.initialize.call(this),this._mapId=t,this._eventId=e,this.locate(this.event().x,this.event().y),this.refresh()},Game_Event.prototype.initMembers=function(){Game_Character.prototype.initMembers.call(this),this._moveType=0,this._trigger=0,this._starting=!1,this._erased=!1,this._pageIndex=-2,this._originalPattern=1,this._originalDirection=2,this._prelockDirection=0,this._locked=!1},Game_Event.prototype.eventId=function(){return this._eventId},Game_Event.prototype.event=function(){return $dataMap.events[this._eventId]},Game_Event.prototype.page=function(){return this.event().pages[this._pageIndex]},Game_Event.prototype.list=function(){return this.page().list},Game_Event.prototype.isCollidedWithCharacters=function(t,e){return Game_Character.prototype.isCollidedWithCharacters.call(this,t,e)||this.isCollidedWithPlayerCharacters(t,e)},Game_Event.prototype.isCollidedWithEvents=function(t,e){return $gameMap.eventsXyNt(t,e).length>0},Game_Event.prototype.isCollidedWithPlayerCharacters=function(t,e){return this.isNormalPriority()&&$gamePlayer.isCollided(t,e)},Game_Event.prototype.lock=function(){this._locked||(this._prelockDirection=this.direction(),this.turnTowardPlayer(),this._locked=!0)},Game_Event.prototype.unlock=function(){this._locked&&(this._locked=!1,this.setDirection(this._prelockDirection))},Game_Event.prototype.updateStop=function(){this._locked&&this.resetStopCount(),Game_Character.prototype.updateStop.call(this),this.isMoveRouteForcing()||this.updateSelfMovement()},Game_Event.prototype.updateSelfMovement=function(){if(!this._locked&&this.isNearTheScreen()&&this.checkStop(this.stopCountThreshold()))switch(this._moveType){case 1:this.moveTypeRandom();break;case 2:this.moveTypeTowardPlayer();break;case 3:this.moveTypeCustom()}},Game_Event.prototype.stopCountThreshold=function(){return 30*(5-this.moveFrequency())},Game_Event.prototype.moveTypeRandom=function(){switch(Math.randomInt(6)){case 0:case 1:this.moveRandom();break;case 2:case 3:case 4:this.moveForward();break;case 5:this.resetStopCount()}},Game_Event.prototype.moveTypeTowardPlayer=function(){if(this.isNearThePlayer())switch(Math.randomInt(6)){case 0:case 1:case 2:case 3:this.moveTowardPlayer();break;case 4:this.moveRandom();break;case 5:this.moveForward()}else this.moveRandom()},Game_Event.prototype.isNearThePlayer=function(){return Math.abs(this.deltaXFrom($gamePlayer.x))+Math.abs(this.deltaYFrom($gamePlayer.y))<20},Game_Event.prototype.moveTypeCustom=function(){this.updateRoutineMove()},Game_Event.prototype.isStarting=function(){return this._starting},Game_Event.prototype.clearStartingFlag=function(){this._starting=!1},Game_Event.prototype.isTriggerIn=function(t){return t.contains(this._trigger)},Game_Event.prototype.start=function(){var t=this.list();t&&t.length>1&&(this._starting=!0,this.isTriggerIn([0,1,2])&&this.lock())},Game_Event.prototype.erase=function(){this._erased=!0,this.refresh()},Game_Event.prototype.refresh=function(){var t=this._erased?-1:this.findProperPageIndex();this._pageIndex!==t&&(this._pageIndex=t,this.setupPage())},Game_Event.prototype.findProperPageIndex=function(){for(var t=this.event().pages,e=t.length-1;e>=0;e--)if(this.meetsConditions(t[e]))return e;return-1},Game_Event.prototype.meetsConditions=function(t){var e=t.conditions;if(e.switch1Valid&&!$gameSwitches.value(e.switch1Id))return!1;if(e.switch2Valid&&!$gameSwitches.value(e.switch2Id))return!1;if(e.variableValid&&$gameVariables.value(e.variableId)<e.variableValue)return!1;if(e.selfSwitchValid&&!0!==$gameSelfSwitches.value([this._mapId,this._eventId,e.selfSwitchCh]))return!1;if(e.itemValid&&!$gameParty.hasItem($dataItems[e.itemId]))return!1;if(e.actorValid){var i=$gameActors.actor(e.actorId);if(!$gameParty.members().contains(i))return!1}return!0},Game_Event.prototype.setupPage=function(){this._pageIndex>=0?this.setupPageSettings():this.clearPageSettings(),this.refreshBushDepth(),this.clearStartingFlag(),this.checkEventTriggerAuto()},Game_Event.prototype.clearPageSettings=function(){this.setImage("",0),this._moveType=0,this._trigger=null,this._interpreter=null,this.setThrough(!0)},Game_Event.prototype.setupPageSettings=function(){var t=this.page(),e=t.image;e.tileId>0?this.setTileImage(e.tileId):this.setImage(e.characterName,e.characterIndex),this._originalDirection!==e.direction&&(this._originalDirection=e.direction,this._prelockDirection=0,this.setDirectionFix(!1),this.setDirection(e.direction)),this._originalPattern!==e.pattern&&(this._originalPattern=e.pattern,this.setPattern(e.pattern)),this.setMoveSpeed(t.moveSpeed),this.setMoveFrequency(t.moveFrequency),this.setPriorityType(t.priorityType),this.setWalkAnime(t.walkAnime),this.setStepAnime(t.stepAnime),this.setDirectionFix(t.directionFix),this.setThrough(t.through),this.setMoveRoute(t.moveRoute),this._moveType=t.moveType,this._trigger=t.trigger,this._interpreter=4===this._trigger?new Game_Interpreter:null},Game_Event.prototype.isOriginalPattern=function(){return this.pattern()===this._originalPattern},Game_Event.prototype.resetPattern=function(){this.setPattern(this._originalPattern)},Game_Event.prototype.checkEventTriggerTouch=function(t,e){$gameMap.isEventRunning()||2===this._trigger&&$gamePlayer.pos(t,e)&&!this.isJumping()&&this.isNormalPriority()&&this.start()},Game_Event.prototype.checkEventTriggerAuto=function(){3===this._trigger&&this.start()},Game_Event.prototype.update=function(){Game_Character.prototype.update.call(this),this.checkEventTriggerAuto(),this.updateParallel()},Game_Event.prototype.updateParallel=function(){this._interpreter&&(this._interpreter.isRunning()||this._interpreter.setup(this.list(),this._eventId),this._interpreter.update())},Game_Event.prototype.locate=function(t,e){Game_Character.prototype.locate.call(this,t,e),this._prelockDirection=0},Game_Event.prototype.forceMoveRoute=function(t){Game_Character.prototype.forceMoveRoute.call(this,t),this._prelockDirection=0},Game_Interpreter.prototype.initialize=function(t){this._depth=t||0,this.checkOverflow(),this.clear(),this._branch={},this._params=[],this._indent=0,this._frameCount=0,this._freezeChecker=0},Game_Interpreter.prototype.checkOverflow=function(){if(this._depth>=100)throw new Error("Common event calls exceeded the limit")},Game_Interpreter.prototype.clear=function(){this._mapId=0,this._eventId=0,this._list=null,this._index=0,this._waitCount=0,this._waitMode="",this._comments="",this._character=null,this._childInterpreter=null},Game_Interpreter.prototype.setup=function(t,e){this.clear(),this._mapId=$gameMap.mapId(),this._eventId=e||0,this._list=t,Game_Interpreter.requestImages(t)},Game_Interpreter.prototype.eventId=function(){return this._eventId},Game_Interpreter.prototype.isOnCurrentMap=function(){return this._mapId===$gameMap.mapId()},Game_Interpreter.prototype.setupReservedCommonEvent=function(){return!!$gameTemp.isCommonEventReserved()&&(this.setup($gameTemp.reservedCommonEvent().list),$gameTemp.clearCommonEvent(),!0)},Game_Interpreter.prototype.isRunning=function(){return!!this._list},Game_Interpreter.prototype.update=function(){for(;this.isRunning()&&!this.updateChild()&&!this.updateWait()&&!SceneManager.isSceneChanging()&&this.executeCommand()&&!this.checkFreeze(););},Game_Interpreter.prototype.updateChild=function(){if(this._childInterpreter){if(this._childInterpreter.update(),this._childInterpreter.isRunning())return!0;this._childInterpreter=null}return!1},Game_Interpreter.prototype.updateWait=function(){return this.updateWaitCount()||this.updateWaitMode()},Game_Interpreter.prototype.updateWaitCount=function(){return this._waitCount>0&&(this._waitCount--,!0)},Game_Interpreter.prototype.updateWaitMode=function(){var t=!1;switch(this._waitMode){case"message":t=$gameMessage.isBusy();break;case"transfer":t=$gamePlayer.isTransferring();break;case"scroll":t=$gameMap.isScrolling();break;case"route":t=this._character.isMoveRouteForcing();break;case"animation":t=this._character.isAnimationPlaying();break;case"balloon":t=this._character.isBalloonPlaying();break;case"gather":t=$gamePlayer.areFollowersGathering();break;case"action":t=BattleManager.isActionForced();break;case"video":t=Graphics.isVideoPlaying();break;case"image":t=!ImageManager.isReady()}return t||(this._waitMode=""),t},Game_Interpreter.prototype.setWaitMode=function(t){this._waitMode=t},Game_Interpreter.prototype.wait=function(t){this._waitCount=t},Game_Interpreter.prototype.fadeSpeed=function(){return 24},Game_Interpreter.prototype.executeCommand=function(){var t=this.currentCommand();if(t){this._params=t.parameters,this._indent=t.indent;var e="command"+t.code;if("function"==typeof this[e]&&!this[e]())return!1;this._index++}else this.terminate();return!0},Game_Interpreter.prototype.checkFreeze=function(){return this._frameCount!==Graphics.frameCount&&(this._frameCount=Graphics.frameCount,this._freezeChecker=0),this._freezeChecker++>=1e5},Game_Interpreter.prototype.terminate=function(){this._list=null,this._comments=""},Game_Interpreter.prototype.skipBranch=function(){for(;this._list[this._index+1].indent>this._indent;)this._index++},Game_Interpreter.prototype.currentCommand=function(){return this._list[this._index]},Game_Interpreter.prototype.nextEventCode=function(){var t=this._list[this._index+1];return t?t.code:0},Game_Interpreter.prototype.iterateActorId=function(t,e){if(0===t)$gameParty.members().forEach(e);else{var i=$gameActors.actor(t);i&&e(i)}},Game_Interpreter.prototype.iterateActorEx=function(t,e,i){this.iterateActorId(0===t?e:$gameVariables.value(e),i)},Game_Interpreter.prototype.iterateActorIndex=function(t,e){if(t<0)$gameParty.members().forEach(e);else{var i=$gameParty.members()[t];i&&e(i)}},Game_Interpreter.prototype.iterateEnemyIndex=function(t,e){if(t<0)$gameTroop.members().forEach(e);else{var i=$gameTroop.members()[t];i&&e(i)}},Game_Interpreter.prototype.iterateBattler=function(t,e,i){$gameParty.inBattle()&&(0===t?this.iterateEnemyIndex(e,i):this.iterateActorId(e,i))},Game_Interpreter.prototype.character=function(t){return $gameParty.inBattle()?null:t<0?$gamePlayer:this.isOnCurrentMap()?$gameMap.event(t>0?t:this._eventId):null},Game_Interpreter.prototype.operateValue=function(t,e,i){var r=0===e?i:$gameVariables.value(i);return 0===t?r:-r},Game_Interpreter.prototype.changeHp=function(t,e,i){t.isAlive()&&(!i&&t.hp<=-e&&(e=1-t.hp),t.gainHp(e),t.isDead()&&t.performCollapse())},Game_Interpreter.prototype.command101=function(){if(!$gameMessage.isBusy()){for($gameMessage.setFaceImage(this._params[0],this._params[1]),$gameMessage.setBackground(this._params[2]),$gameMessage.setPositionType(this._params[3]);401===this.nextEventCode();)this._index++,$gameMessage.add(this.currentCommand().parameters[0]);switch(this.nextEventCode()){case 102:this._index++,this.setupChoices(this.currentCommand().parameters);break;case 103:this._index++,this.setupNumInput(this.currentCommand().parameters);break;case 104:this._index++,this.setupItemChoice(this.currentCommand().parameters)}this._index++,this.setWaitMode("message")}return!1},Game_Interpreter.prototype.command102=function(){return $gameMessage.isBusy()||(this.setupChoices(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupChoices=function(t){var e=t[0].clone(),i=t[1],r=t.length>3?t[3]:2,n=t.length>4?t[4]:0;i>=e.length&&(i=-2),$gameMessage.setChoices(e,t.length>2?t[2]:0,i),$gameMessage.setChoiceBackground(n),$gameMessage.setChoicePositionType(r),$gameMessage.setChoiceCallback((function(t){this._branch[this._indent]=t}).bind(this))},Game_Interpreter.prototype.command402=function(){return this._branch[this._indent]!==this._params[0]&&this.skipBranch(),!0},Game_Interpreter.prototype.command403=function(){return this._branch[this._indent]>=0&&this.skipBranch(),!0},Game_Interpreter.prototype.command103=function(){return $gameMessage.isBusy()||(this.setupNumInput(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupNumInput=function(t){$gameMessage.setNumberInput(t[0],t[1])},Game_Interpreter.prototype.command104=function(){return $gameMessage.isBusy()||(this.setupItemChoice(this._params),this._index++,this.setWaitMode("message")),!1},Game_Interpreter.prototype.setupItemChoice=function(t){$gameMessage.setItemChoice(t[0],t[1]||2)},Game_Interpreter.prototype.command105=function(){if(!$gameMessage.isBusy()){for($gameMessage.setScroll(this._params[0],this._params[1]);405===this.nextEventCode();)this._index++,$gameMessage.add(this.currentCommand().parameters[0]);this._index++,this.setWaitMode("message")}return!1},Game_Interpreter.prototype.command108=function(){for(this._comments=[this._params[0]];408===this.nextEventCode();)this._index++,this._comments.push(this.currentCommand().parameters[0]);return!0},Game_Interpreter.prototype.command111=function(){var result=!1;switch(this._params[0]){case 0:result=$gameSwitches.value(this._params[1])===(0===this._params[2]);break;case 1:var value1=$gameVariables.value(this._params[1]),value2;switch(value2=0===this._params[2]?this._params[3]:$gameVariables.value(this._params[3]),this._params[4]){case 0:result=value1===value2;break;case 1:result=value1>=value2;break;case 2:result=value1<=value2;break;case 3:result=value1>value2;break;case 4:result=value1<value2;break;case 5:result=value1!==value2}break;case 2:if(this._eventId>0){var key=[this._mapId,this._eventId,this._params[1]];result=$gameSelfSwitches.value(key)===(0===this._params[2])}break;case 3:$gameTimer.isWorking()&&(result=0===this._params[2]?$gameTimer.seconds()>=this._params[1]:$gameTimer.seconds()<=this._params[1]);break;case 4:var actor=$gameActors.actor(this._params[1]);if(actor){var n=this._params[3];switch(this._params[2]){case 0:result=$gameParty.members().contains(actor);break;case 1:result=actor.name()===n;break;case 2:result=actor.isClass($dataClasses[n]);break;case 3:result=actor.hasSkill(n);break;case 4:result=actor.hasWeapon($dataWeapons[n]);break;case 5:result=actor.hasArmor($dataArmors[n]);break;case 6:result=actor.isStateAffected(n)}}break;case 5:var enemy=$gameTroop.members()[this._params[1]];if(enemy)switch(this._params[2]){case 0:result=enemy.isAlive();break;case 1:result=enemy.isStateAffected(this._params[3])}break;case 6:var character=this.character(this._params[1]);character&&(result=character.direction()===this._params[2]);break;case 7:switch(this._params[2]){case 0:result=$gameParty.gold()>=this._params[1];break;case 1:result=$gameParty.gold()<=this._params[1];break;case 2:result=$gameParty.gold()<this._params[1]}break;case 8:result=$gameParty.hasItem($dataItems[this._params[1]]);break;case 9:result=$gameParty.hasItem($dataWeapons[this._params[1]],this._params[2]);break;case 10:result=$gameParty.hasItem($dataArmors[this._params[1]],this._params[2]);break;case 11:result=Input.isPressed(this._params[1]);break;case 12:result=!!eval(this._params[1]);break;case 13:result=$gamePlayer.vehicle()===$gameMap.vehicle(this._params[1])}return this._branch[this._indent]=result,!1===this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command411=function(){return!1!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command112=function(){return!0},Game_Interpreter.prototype.command413=function(){do{this._index--}while(this.currentCommand().indent!==this._indent);return!0},Game_Interpreter.prototype.command113=function(){for(var t=0;this._index<this._list.length-1;){this._index++;var e=this.currentCommand();if(112===e.code&&t++,413===e.code){if(!(t>0))break;t--}}return!0},Game_Interpreter.prototype.command115=function(){return this._index=this._list.length,!0},Game_Interpreter.prototype.command117=function(){var t=$dataCommonEvents[this._params[0]];if(t){var e=this.isOnCurrentMap()?this._eventId:0;this.setupChild(t.list,e)}return!0},Game_Interpreter.prototype.setupChild=function(t,e){this._childInterpreter=new Game_Interpreter(this._depth+1),this._childInterpreter.setup(t,e)},Game_Interpreter.prototype.command118=function(){return!0},Game_Interpreter.prototype.command119=function(){for(var t=this._params[0],e=0;e<this._list.length;e++){var i=this._list[e];if(118===i.code&&i.parameters[0]===t)return void this.jumpTo(e)}return!0},Game_Interpreter.prototype.jumpTo=function(t){for(var e=this._index,i=Math.min(t,e),r=Math.max(t,e),n=this._indent,a=i;a<=r;a++){var o=this._list[a].indent;o!==n&&(this._branch[n]=null,n=o)}this._index=t},Game_Interpreter.prototype.command121=function(){for(var t=this._params[0];t<=this._params[1];t++)$gameSwitches.setValue(t,0===this._params[2]);return!0},Game_Interpreter.prototype.command122=function(){var value=0;switch(this._params[3]){case 0:value=this._params[4];break;case 1:value=$gameVariables.value(this._params[4]);break;case 2:value=this._params[5]-this._params[4]+1;for(var i=this._params[0];i<=this._params[1];i++)this.operateVariable(i,this._params[2],this._params[4]+Math.randomInt(value));return!0;case 3:value=this.gameDataOperand(this._params[4],this._params[5],this._params[6]);break;case 4:value=eval(this._params[4])}for(var i=this._params[0];i<=this._params[1];i++)this.operateVariable(i,this._params[2],value);return!0},Game_Interpreter.prototype.gameDataOperand=function(t,e,i){switch(t){case 0:return $gameParty.numItems($dataItems[e]);case 1:return $gameParty.numItems($dataWeapons[e]);case 2:return $gameParty.numItems($dataArmors[e]);case 3:var r=$gameActors.actor(e);if(r)switch(i){case 0:return r.level;case 1:return r.currentExp();case 2:return r.hp;case 3:return r.mp;default:if(i>=4&&i<=11)return r.param(i-4)}break;case 4:var n=$gameTroop.members()[e];if(n)switch(i){case 0:return n.hp;case 1:return n.mp;default:if(i>=2&&i<=9)return n.param(i-2)}break;case 5:var a=this.character(e);if(a)switch(i){case 0:return a.x;case 1:return a.y;case 2:return a.direction();case 3:return a.screenX();case 4:return a.screenY()}break;case 6:return(r=$gameParty.members()[e])?r.actorId():0;case 7:switch(e){case 0:return $gameMap.mapId();case 1:return $gameParty.size();case 2:return $gameParty.gold();case 3:return $gameParty.steps();case 4:return $gameSystem.playtime();case 5:return $gameTimer.seconds();case 6:return $gameSystem.saveCount();case 7:return $gameSystem.battleCount();case 8:return $gameSystem.winCount();case 9:return $gameSystem.escapeCount()}}return 0},Game_Interpreter.prototype.operateVariable=function(t,e,i){try{var r=$gameVariables.value(t);switch(e){case 0:$gameVariables.setValue(t,r=i);break;case 1:$gameVariables.setValue(t,r+i);break;case 2:$gameVariables.setValue(t,r-i);break;case 3:$gameVariables.setValue(t,r*i);break;case 4:$gameVariables.setValue(t,r/i);break;case 5:$gameVariables.setValue(t,r%i)}}catch(n){$gameVariables.setValue(t,0)}},Game_Interpreter.prototype.command123=function(){return this._eventId>0&&$gameSelfSwitches.setValue([this._mapId,this._eventId,this._params[0]],0===this._params[1]),!0},Game_Interpreter.prototype.command124=function(){return 0===this._params[0]?$gameTimer.start(60*this._params[1]):$gameTimer.stop(),!0},Game_Interpreter.prototype.command125=function(){var t=this.operateValue(this._params[0],this._params[1],this._params[2]);return $gameParty.gainGold(t),!0},Game_Interpreter.prototype.command126=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataItems[this._params[0]],t),!0},Game_Interpreter.prototype.command127=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataWeapons[this._params[0]],t,this._params[4]),!0},Game_Interpreter.prototype.command128=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return $gameParty.gainItem($dataArmors[this._params[0]],t,this._params[4]),!0},Game_Interpreter.prototype.command129=function(){return $gameActors.actor(this._params[0])&&(0===this._params[1]?(this._params[2]&&$gameActors.actor(this._params[0]).setup(this._params[0]),$gameParty.addActor(this._params[0])):$gameParty.removeActor(this._params[0])),!0},Game_Interpreter.prototype.command132=function(){return $gameSystem.setBattleBgm(this._params[0]),!0},Game_Interpreter.prototype.command133=function(){return $gameSystem.setVictoryMe(this._params[0]),!0},Game_Interpreter.prototype.command134=function(){return 0===this._params[0]?$gameSystem.disableSave():$gameSystem.enableSave(),!0},Game_Interpreter.prototype.command135=function(){return 0===this._params[0]?$gameSystem.disableMenu():$gameSystem.enableMenu(),!0},Game_Interpreter.prototype.command136=function(){return 0===this._params[0]?$gameSystem.disableEncounter():$gameSystem.enableEncounter(),$gamePlayer.makeEncounterCount(),!0},Game_Interpreter.prototype.command137=function(){return 0===this._params[0]?$gameSystem.disableFormation():$gameSystem.enableFormation(),!0},Game_Interpreter.prototype.command138=function(){return $gameSystem.setWindowTone(this._params[0]),!0},Game_Interpreter.prototype.command139=function(){return $gameSystem.setDefeatMe(this._params[0]),!0},Game_Interpreter.prototype.command140=function(){var t=$gameMap.vehicle(this._params[0]);return t&&t.setBgm(this._params[1]),!0},Game_Interpreter.prototype.command201=function(){var t,e,i;return $gameParty.inBattle()||$gameMessage.isBusy()||(0===this._params[0]?(t=this._params[1],e=this._params[2],i=this._params[3]):(t=$gameVariables.value(this._params[1]),e=$gameVariables.value(this._params[2]),i=$gameVariables.value(this._params[3])),$gamePlayer.reserveTransfer(t,e,i,this._params[4],this._params[5]),this.setWaitMode("transfer"),this._index++),!1},Game_Interpreter.prototype.command202=function(){var t,e,i;0===this._params[1]?(t=this._params[2],e=this._params[3],i=this._params[4]):(t=$gameVariables.value(this._params[2]),e=$gameVariables.value(this._params[3]),i=$gameVariables.value(this._params[4]));var r=$gameMap.vehicle(this._params[0]);return r&&r.setLocation(t,e,i),!0},Game_Interpreter.prototype.command203=function(){var t=this.character(this._params[0]);if(t){if(0===this._params[1])t.locate(this._params[2],this._params[3]);else if(1===this._params[1]){var e=$gameVariables.value(this._params[2]),i=$gameVariables.value(this._params[3]);t.locate(e,i)}else{var r=this.character(this._params[2]);r&&t.swap(r)}this._params[4]>0&&t.setDirection(this._params[4])}return!0},Game_Interpreter.prototype.command204=function(){if(!$gameParty.inBattle()){if($gameMap.isScrolling())return this.setWaitMode("scroll"),!1;$gameMap.startScroll(this._params[0],this._params[1],this._params[2])}return!0},Game_Interpreter.prototype.command205=function(){return $gameMap.refreshIfNeeded(),this._character=this.character(this._params[0]),this._character&&(this._character.forceMoveRoute(this._params[1]),this._params[1].wait&&this.setWaitMode("route")),!0},Game_Interpreter.prototype.command206=function(){return $gamePlayer.getOnOffVehicle(),!0},Game_Interpreter.prototype.command211=function(){return $gamePlayer.setTransparent(0===this._params[0]),!0},Game_Interpreter.prototype.command212=function(){return this._character=this.character(this._params[0]),this._character&&(this._character.requestAnimation(this._params[1]),this._params[2]&&this.setWaitMode("animation")),!0},Game_Interpreter.prototype.command213=function(){return this._character=this.character(this._params[0]),this._character&&(this._character.requestBalloon(this._params[1]),this._params[2]&&this.setWaitMode("balloon")),!0},Game_Interpreter.prototype.command214=function(){return this.isOnCurrentMap()&&this._eventId>0&&$gameMap.eraseEvent(this._eventId),!0},Game_Interpreter.prototype.command216=function(){return 0===this._params[0]?$gamePlayer.showFollowers():$gamePlayer.hideFollowers(),$gamePlayer.refresh(),!0},Game_Interpreter.prototype.command217=function(){return $gameParty.inBattle()||($gamePlayer.gatherFollowers(),this.setWaitMode("gather")),!0},Game_Interpreter.prototype.command221=function(){return $gameMessage.isBusy()||($gameScreen.startFadeOut(this.fadeSpeed()),this.wait(this.fadeSpeed()),this._index++),!1},Game_Interpreter.prototype.command222=function(){return $gameMessage.isBusy()||($gameScreen.startFadeIn(this.fadeSpeed()),this.wait(this.fadeSpeed()),this._index++),!1},Game_Interpreter.prototype.command223=function(){return $gameScreen.startTint(this._params[0],this._params[1]),this._params[2]&&this.wait(this._params[1]),!0},Game_Interpreter.prototype.command224=function(){return $gameScreen.startFlash(this._params[0],this._params[1]),this._params[2]&&this.wait(this._params[1]),!0},Game_Interpreter.prototype.command225=function(){return $gameScreen.startShake(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2]),!0},Game_Interpreter.prototype.command230=function(){return this.wait(this._params[0]),!0},Game_Interpreter.prototype.command231=function(){var t,e;return 0===this._params[3]?(t=this._params[4],e=this._params[5]):(t=$gameVariables.value(this._params[4]),e=$gameVariables.value(this._params[5])),$gameScreen.showPicture(this._params[0],this._params[1],this._params[2],t,e,this._params[6],this._params[7],this._params[8],this._params[9]),!0},Game_Interpreter.prototype.command232=function(){var t,e;return 0===this._params[3]?(t=this._params[4],e=this._params[5]):(t=$gameVariables.value(this._params[4]),e=$gameVariables.value(this._params[5])),$gameScreen.movePicture(this._params[0],this._params[2],t,e,this._params[6],this._params[7],this._params[8],this._params[9],this._params[10]),this._params[11]&&this.wait(this._params[10]),!0},Game_Interpreter.prototype.command233=function(){return $gameScreen.rotatePicture(this._params[0],this._params[1]),!0},Game_Interpreter.prototype.command234=function(){return $gameScreen.tintPicture(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2]),!0},Game_Interpreter.prototype.command235=function(){return $gameScreen.erasePicture(this._params[0]),!0},Game_Interpreter.prototype.command236=function(){return $gameParty.inBattle()||($gameScreen.changeWeather(this._params[0],this._params[1],this._params[2]),this._params[3]&&this.wait(this._params[2])),!0},Game_Interpreter.prototype.command241=function(){return AudioManager.playBgm(this._params[0]),!0},Game_Interpreter.prototype.command242=function(){return AudioManager.fadeOutBgm(this._params[0]),!0},Game_Interpreter.prototype.command243=function(){return $gameSystem.saveBgm(),!0},Game_Interpreter.prototype.command244=function(){return $gameSystem.replayBgm(),!0},Game_Interpreter.prototype.command245=function(){return AudioManager.playBgs(this._params[0]),!0},Game_Interpreter.prototype.command246=function(){return AudioManager.fadeOutBgs(this._params[0]),!0},Game_Interpreter.prototype.command249=function(){return AudioManager.playMe(this._params[0]),!0},Game_Interpreter.prototype.command250=function(){return AudioManager.playSe(this._params[0]),!0},Game_Interpreter.prototype.command251=function(){return AudioManager.stopSe(),!0},Game_Interpreter.prototype.command261=function(){if(!$gameMessage.isBusy()){var t=this._params[0];if(t.length>0){var e=this.videoFileExt();Graphics.playVideo("movies/"+t+e),this.setWaitMode("video")}this._index++}return!1},Game_Interpreter.prototype.videoFileExt=function(){return Graphics.canPlayVideoType("video/webm")&&!Utils.isMobileDevice()?".webm":".mp4"},Game_Interpreter.prototype.command281=function(){return 0===this._params[0]?$gameMap.enableNameDisplay():$gameMap.disableNameDisplay(),!0},Game_Interpreter.prototype.command282=function(){var t=$dataTilesets[this._params[0]];return this._imageReservationId||(this._imageReservationId=Utils.generateRuntimeId()),!!t.tilesetNames.map(function(t){return ImageManager.reserveTileset(t,0,this._imageReservationId)},this).every(function(t){return t.isReady()})&&($gameMap.changeTileset(this._params[0]),ImageManager.releaseReservation(this._imageReservationId),this._imageReservationId=null,!0)},Game_Interpreter.prototype.command283=function(){return $gameMap.changeBattleback(this._params[0],this._params[1]),!0},Game_Interpreter.prototype.command284=function(){return $gameMap.changeParallax(this._params[0],this._params[1],this._params[2],this._params[3],this._params[4]),!0},Game_Interpreter.prototype.command285=function(){var t,e,i;switch(0===this._params[2]?(t=this._params[3],e=this._params[4]):(t=$gameVariables.value(this._params[3]),e=$gameVariables.value(this._params[4])),this._params[1]){case 0:i=$gameMap.terrainTag(t,e);break;case 1:i=$gameMap.eventIdXy(t,e);break;case 2:case 3:case 4:case 5:i=$gameMap.tileId(t,e,this._params[1]-2);break;default:i=$gameMap.regionId(t,e)}return $gameVariables.setValue(this._params[0],i),!0},Game_Interpreter.prototype.command301=function(){var t;return $gameParty.inBattle()||(t=0===this._params[0]?this._params[1]:1===this._params[0]?$gameVariables.value(this._params[1]):$gamePlayer.makeEncounterTroopId(),$dataTroops[t]&&(BattleManager.setup(t,this._params[2],this._params[3]),BattleManager.setEventCallback((function(t){this._branch[this._indent]=t}).bind(this)),$gamePlayer.makeEncounterCount(),SceneManager.push(Scene_Battle))),!0},Game_Interpreter.prototype.command601=function(){return 0!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command602=function(){return 1!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command603=function(){return 2!==this._branch[this._indent]&&this.skipBranch(),!0},Game_Interpreter.prototype.command302=function(){if(!$gameParty.inBattle()){for(var t=[this._params];605===this.nextEventCode();)this._index++,t.push(this.currentCommand().parameters);SceneManager.push(Scene_Shop),SceneManager.prepareNextScene(t,this._params[4])}return!0},Game_Interpreter.prototype.command303=function(){return $gameParty.inBattle()||$dataActors[this._params[0]]&&(SceneManager.push(Scene_Name),SceneManager.prepareNextScene(this._params[0],this._params[1])),!0},Game_Interpreter.prototype.command311=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],(function(e){this.changeHp(e,t,this._params[5])}).bind(this)),!0},Game_Interpreter.prototype.command312=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],(function(e){e.gainMp(t)}).bind(this)),!0},Game_Interpreter.prototype.command326=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],(function(e){e.gainTp(t)}).bind(this)),!0},Game_Interpreter.prototype.command313=function(){return this.iterateActorEx(this._params[0],this._params[1],(function(t){var e=t.isDead();0===this._params[2]?t.addState(this._params[3]):t.removeState(this._params[3]),t.isDead()&&!e&&t.performCollapse(),t.clearResult()}).bind(this)),!0},Game_Interpreter.prototype.command314=function(){return this.iterateActorEx(this._params[0],this._params[1],(function(t){t.recoverAll()}).bind(this)),!0},Game_Interpreter.prototype.command315=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],(function(e){e.changeExp(e.currentExp()+t,this._params[5])}).bind(this)),!0},Game_Interpreter.prototype.command316=function(){var t=this.operateValue(this._params[2],this._params[3],this._params[4]);return this.iterateActorEx(this._params[0],this._params[1],(function(e){e.changeLevel(e.level+t,this._params[5])}).bind(this)),!0},Game_Interpreter.prototype.command317=function(){var t=this.operateValue(this._params[3],this._params[4],this._params[5]);return this.iterateActorEx(this._params[0],this._params[1],(function(e){e.addParam(this._params[2],t)}).bind(this)),!0},Game_Interpreter.prototype.command318=function(){return this.iterateActorEx(this._params[0],this._params[1],(function(t){0===this._params[2]?t.learnSkill(this._params[3]):t.forgetSkill(this._params[3])}).bind(this)),!0},Game_Interpreter.prototype.command319=function(){var t=$gameActors.actor(this._params[0]);return t&&t.changeEquipById(this._params[1],this._params[2]),!0},Game_Interpreter.prototype.command320=function(){var t=$gameActors.actor(this._params[0]);return t&&t.setName(this._params[1]),!0},Game_Interpreter.prototype.command321=function(){var t=$gameActors.actor(this._params[0]);return t&&$dataClasses[this._params[1]]&&t.changeClass(this._params[1],this._params[2]),!0},Game_Interpreter.prototype.command322=function(){var t=$gameActors.actor(this._params[0]);return t&&(t.setCharacterImage(this._params[1],this._params[2]),t.setFaceImage(this._params[3],this._params[4]),t.setBattlerImage(this._params[5])),$gamePlayer.refresh(),!0},Game_Interpreter.prototype.command323=function(){var t=$gameMap.vehicle(this._params[0]);return t&&t.setImage(this._params[1],this._params[2]),!0},Game_Interpreter.prototype.command324=function(){var t=$gameActors.actor(this._params[0]);return t&&t.setNickname(this._params[1]),!0},Game_Interpreter.prototype.command325=function(){var t=$gameActors.actor(this._params[0]);return t&&t.setProfile(this._params[1]),!0},Game_Interpreter.prototype.command331=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],(function(e){this.changeHp(e,t,this._params[4])}).bind(this)),!0},Game_Interpreter.prototype.command332=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],(function(e){e.gainMp(t)}).bind(this)),!0},Game_Interpreter.prototype.command342=function(){var t=this.operateValue(this._params[1],this._params[2],this._params[3]);return this.iterateEnemyIndex(this._params[0],(function(e){e.gainTp(t)}).bind(this)),!0},Game_Interpreter.prototype.command333=function(){return this.iterateEnemyIndex(this._params[0],(function(t){var e=t.isDead();0===this._params[1]?t.addState(this._params[2]):t.removeState(this._params[2]),t.isDead()&&!e&&t.performCollapse(),t.clearResult()}).bind(this)),!0},Game_Interpreter.prototype.command334=function(){return this.iterateEnemyIndex(this._params[0],(function(t){t.recoverAll()}).bind(this)),!0},Game_Interpreter.prototype.command335=function(){return this.iterateEnemyIndex(this._params[0],(function(t){t.appear(),$gameTroop.makeUniqueNames()}).bind(this)),!0},Game_Interpreter.prototype.command336=function(){return this.iterateEnemyIndex(this._params[0],(function(t){t.transform(this._params[1]),$gameTroop.makeUniqueNames()}).bind(this)),!0},Game_Interpreter.prototype.command337=function(){return this.iterateEnemyIndex(1==this._params[2]?-1:this._params[0],(function(t){t.isAlive()&&t.startAnimation(this._params[1],!1,0)}).bind(this)),!0},Game_Interpreter.prototype.command339=function(){return this.iterateBattler(this._params[0],this._params[1],(function(t){t.isDeathStateAffected()||(t.forceAction(this._params[2],this._params[3]),BattleManager.forceAction(t),this.setWaitMode("action"))}).bind(this)),!0},Game_Interpreter.prototype.command340=function(){return BattleManager.abort(),!0},Game_Interpreter.prototype.command351=function(){return $gameParty.inBattle()||(SceneManager.push(Scene_Menu),Window_MenuCommand.initCommandPosition()),!0},Game_Interpreter.prototype.command352=function(){return $gameParty.inBattle()||SceneManager.push(Scene_Save),!0},Game_Interpreter.prototype.command353=function(){return SceneManager.goto(Scene_Gameover),!0},Game_Interpreter.prototype.command354=function(){return SceneManager.goto(Scene_Title),!0},Game_Interpreter.prototype.command355=function(){for(var script=this.currentCommand().parameters[0]+"\n";655===this.nextEventCode();)this._index++,script+=this.currentCommand().parameters[0]+"\n";return eval(script),!0},Game_Interpreter.prototype.command356=function(){var t=this._params[0].split(" "),e=t.shift();return this.pluginCommand(e,t),!0},Game_Interpreter.prototype.pluginCommand=function(t,e){},Game_Interpreter.requestImages=function(t,e){t&&t.forEach(function(t){var i=t.parameters;switch(t.code){case 101:ImageManager.requestFace(i[0]);break;case 117:var r=$dataCommonEvents[i[0]];r&&(e||(e=[]),e.contains(i[0])||(e.push(i[0]),Game_Interpreter.requestImages(r.list,e)));break;case 129:var n=$gameActors.actor(i[0]);if(n&&0===i[1]){var a=n.characterName();ImageManager.requestCharacter(a)}break;case 205:i[1]&&i[1].list.forEach(function(t){t.code===Game_Character.ROUTE_CHANGE_IMAGE&&ImageManager.requestCharacter(t.parameters[0])});break;case 212:case 337:if(i[1]){var o=$dataAnimations[i[1]],s=o.animation2Name,h=o.animation2Hue;ImageManager.requestAnimation(o.animation1Name,o.animation1Hue),ImageManager.requestAnimation(s,h)}break;case 216:0===i[0]&&$gamePlayer.followers().forEach(function(t){var e=t.characterName();ImageManager.requestCharacter(e)});break;case 231:ImageManager.requestPicture(i[1]);break;case 282:$dataTilesets[i[0]].tilesetNames.forEach(function(t){ImageManager.requestTileset(t)});break;case 283:$gameParty.inBattle()&&(ImageManager.requestBattleback1(i[0]),ImageManager.requestBattleback2(i[1]));break;case 284:$gameParty.inBattle()||ImageManager.requestParallax(i[0]);break;case 322:ImageManager.requestCharacter(i[1]),ImageManager.requestFace(i[3]),ImageManager.requestSvActor(i[5]);break;case 323:$gameMap.vehicle(i[0])&&ImageManager.requestCharacter(i[1]);break;case 336:var c=$dataEnemies[i[1]],u=(a=c.battlerName,c.battlerHue);$gameSystem.isSideView()?ImageManager.requestSvEnemy(a,u):ImageManager.requestEnemy(a,u)}})},Scene_Base.prototype=Object.create(Stage.prototype),Scene_Base.prototype.constructor=Scene_Base,Scene_Base.prototype.initialize=function(){Stage.prototype.initialize.call(this),this._active=!1,this._fadeSign=0,this._fadeDuration=0,this._fadeSprite=null,this._imageReservationId=Utils.generateRuntimeId()},Scene_Base.prototype.attachReservation=function(){ImageManager.setDefaultReservationId(this._imageReservationId)},Scene_Base.prototype.detachReservation=function(){ImageManager.releaseReservation(this._imageReservationId)},Scene_Base.prototype.create=function(){},Scene_Base.prototype.isActive=function(){return this._active},Scene_Base.prototype.isReady=function(){return ImageManager.isReady()},Scene_Base.prototype.start=function(){this._active=!0},Scene_Base.prototype.update=function(){this.updateFade(),this.updateChildren()},Scene_Base.prototype.stop=function(){this._active=!1},Scene_Base.prototype.isBusy=function(){return this._fadeDuration>0},Scene_Base.prototype.terminate=function(){},Scene_Base.prototype.createWindowLayer=function(){var t=Graphics.boxWidth,e=Graphics.boxHeight,i=(Graphics.width-t)/2,r=(Graphics.height-e)/2;this._windowLayer=new WindowLayer,this._windowLayer.move(i,r,t,e),this.addChild(this._windowLayer)},Scene_Base.prototype.addWindow=function(t){this._windowLayer.addChild(t)},Scene_Base.prototype.startFadeIn=function(t,e){this.createFadeSprite(e),this._fadeSign=1,this._fadeDuration=t||30,this._fadeSprite.opacity=255},Scene_Base.prototype.startFadeOut=function(t,e){this.createFadeSprite(e),this._fadeSign=-1,this._fadeDuration=t||30,this._fadeSprite.opacity=0},Scene_Base.prototype.createFadeSprite=function(t){this._fadeSprite||(this._fadeSprite=new ScreenSprite,this.addChild(this._fadeSprite)),t?this._fadeSprite.setWhite():this._fadeSprite.setBlack()},Scene_Base.prototype.updateFade=function(){if(this._fadeDuration>0){var t=this._fadeDuration;this._fadeSign>0?this._fadeSprite.opacity-=this._fadeSprite.opacity/t:this._fadeSprite.opacity+=(255-this._fadeSprite.opacity)/t,this._fadeDuration--}},Scene_Base.prototype.updateChildren=function(){this.children.forEach(function(t){t.update&&t.update()})},Scene_Base.prototype.popScene=function(){SceneManager.pop()},Scene_Base.prototype.checkGameover=function(){$gameParty.isAllDead()&&SceneManager.goto(Scene_Gameover)},Scene_Base.prototype.fadeOutAll=function(){var t=this.slowFadeSpeed()/60;AudioManager.fadeOutBgm(t),AudioManager.fadeOutBgs(t),AudioManager.fadeOutMe(t),this.startFadeOut(this.slowFadeSpeed())},Scene_Base.prototype.fadeSpeed=function(){return 24},Scene_Base.prototype.slowFadeSpeed=function(){return 2*this.fadeSpeed()},Scene_Boot.prototype=Object.create(Scene_Base.prototype),Scene_Boot.prototype.constructor=Scene_Boot,Scene_Boot.prototype.initialize=function(){Scene_Base.prototype.initialize.call(this),this._startDate=Date.now()},Scene_Boot.prototype.create=function(){Scene_Base.prototype.create.call(this),DataManager.loadDatabase(),ConfigManager.load(),this.loadSystemWindowImage()},Scene_Boot.prototype.loadSystemWindowImage=function(){ImageManager.reserveSystem("Window")},Scene_Boot.loadSystemImages=function(){ImageManager.reserveSystem("IconSet"),ImageManager.reserveSystem("Balloon"),ImageManager.reserveSystem("Shadow1"),ImageManager.reserveSystem("Shadow2"),ImageManager.reserveSystem("Damage"),ImageManager.reserveSystem("States"),ImageManager.reserveSystem("Weapons1"),ImageManager.reserveSystem("Weapons2"),ImageManager.reserveSystem("Weapons3"),ImageManager.reserveSystem("ButtonSet")},Scene_Boot.prototype.isReady=function(){return!!Scene_Base.prototype.isReady.call(this)&&DataManager.isDatabaseLoaded()&&this.isGameFontLoaded()},Scene_Boot.prototype.isGameFontLoaded=function(){if(Graphics.isFontLoaded("GameFont"))return!0;if(!Graphics.canUseCssFontLoading()&&Date.now()-this._startDate>=6e4)throw new Error("Failed to load GameFont")},Scene_Boot.prototype.start=function(){Scene_Base.prototype.start.call(this),SoundManager.preloadImportantSounds(),DataManager.isBattleTest()?(DataManager.setupBattleTest(),SceneManager.goto(Scene_Battle)):DataManager.isEventTest()?(DataManager.setupEventTest(),SceneManager.goto(Scene_Map)):(this.checkPlayerLocation(),DataManager.setupNewGame(),SceneManager.goto(Scene_Title),Window_TitleCommand.initCommandPosition()),this.updateDocumentTitle()},Scene_Boot.prototype.updateDocumentTitle=function(){document.title=$dataSystem.gameTitle},Scene_Boot.prototype.checkPlayerLocation=function(){if(0===$dataSystem.startMapId)throw new Error("Player's starting position is not set")},Scene_Title.prototype=Object.create(Scene_Base.prototype),Scene_Title.prototype.constructor=Scene_Title,Scene_Title.prototype.initialize=function(){Scene_Base.prototype.initialize.call(this)},Scene_Title.prototype.create=function(){Scene_Base.prototype.create.call(this),this.createBackground(),this.createForeground(),this.createWindowLayer(),this.createCommandWindow()},Scene_Title.prototype.start=function(){Scene_Base.prototype.start.call(this),SceneManager.clearStack(),this.centerSprite(this._backSprite1),this.centerSprite(this._backSprite2),this.playTitleMusic(),this.startFadeIn(this.fadeSpeed(),!1)},Scene_Title.prototype.update=function(){this.isBusy()||this._commandWindow.open(),Scene_Base.prototype.update.call(this)},Scene_Title.prototype.isBusy=function(){return this._commandWindow.isClosing()||Scene_Base.prototype.isBusy.call(this)},Scene_Title.prototype.terminate=function(){Scene_Base.prototype.terminate.call(this),SceneManager.snapForBackground()},Scene_Title.prototype.createBackground=function(){this._backSprite1=new Sprite(ImageManager.loadTitle1($dataSystem.title1Name)),this._backSprite2=new Sprite(ImageManager.loadTitle2($dataSystem.title2Name)),this.addChild(this._backSprite1),this.addChild(this._backSprite2)},Scene_Title.prototype.createForeground=function(){this._gameTitleSprite=new Sprite(new Bitmap(Graphics.width,Graphics.height)),this.addChild(this._gameTitleSprite),$dataSystem.optDrawTitle&&this.drawGameTitle()},Scene_Title.prototype.drawGameTitle=function(){var t=Graphics.height/4,e=Graphics.width-40,i=$dataSystem.gameTitle;this._gameTitleSprite.bitmap.outlineColor="black",this._gameTitleSprite.bitmap.outlineWidth=8,this._gameTitleSprite.bitmap.fontSize=72,this._gameTitleSprite.bitmap.drawText(i,20,t,e,48,"center")},Scene_Title.prototype.centerSprite=function(t){t.x=Graphics.width/2,t.y=Graphics.height/2,t.anchor.x=.5,t.anchor.y=.5},Scene_Title.prototype.createCommandWindow=function(){this._commandWindow=new Window_TitleCommand,this._commandWindow.setHandler("newGame",this.commandNewGame.bind(this)),this._commandWindow.setHandler("continue",this.commandContinue.bind(this)),this._commandWindow.setHandler("options",this.commandOptions.bind(this)),this.addWindow(this._commandWindow)},Scene_Title.prototype.commandNewGame=function(){DataManager.setupNewGame(),this._commandWindow.close(),this.fadeOutAll(),SceneManager.goto(Scene_Map)},Scene_Title.prototype.commandContinue=function(){this._commandWindow.close(),SceneManager.push(Scene_Load)},Scene_Title.prototype.commandOptions=function(){this._commandWindow.close(),SceneManager.push(Scene_Options)},Scene_Title.prototype.playTitleMusic=function(){AudioManager.playBgm($dataSystem.titleBgm),AudioManager.stopBgs(),AudioManager.stopMe()},Scene_Map.prototype=Object.create(Scene_Base.prototype),Scene_Map.prototype.constructor=Scene_Map,Scene_Map.prototype.initialize=function(){Scene_Base.prototype.initialize.call(this),this._waitCount=0,this._encounterEffectDuration=0,this._mapLoaded=!1,this._touchCount=0},Scene_Map.prototype.create=function(){Scene_Base.prototype.create.call(this),this._transfer=$gamePlayer.isTransferring();var t=this._transfer?$gamePlayer.newMapId():$gameMap.mapId();DataManager.loadMapData(t)},Scene_Map.prototype.isReady=function(){return!this._mapLoaded&&DataManager.isMapLoaded()&&(this.onMapLoaded(),this._mapLoaded=!0),this._mapLoaded&&Scene_Base.prototype.isReady.call(this)},Scene_Map.prototype.onMapLoaded=function(){this._transfer&&$gamePlayer.performTransfer(),this.createDisplayObjects()},Scene_Map.prototype.start=function(){Scene_Base.prototype.start.call(this),SceneManager.clearStack(),this._transfer?(this.fadeInForTransfer(),this._mapNameWindow.open(),$gameMap.autoplay()):this.needsFadeIn()&&this.startFadeIn(this.fadeSpeed(),!1),this.menuCalling=!1},Scene_Map.prototype.update=function(){this.updateDestination(),this.updateMainMultiply(),this.isSceneChangeOk()?this.updateScene():SceneManager.isNextScene(Scene_Battle)&&this.updateEncounterEffect(),this.updateWaitCount(),Scene_Base.prototype.update.call(this)},Scene_Map.prototype.updateMainMultiply=function(){this.updateMain(),this.isFastForward()&&this.updateMain()},Scene_Map.prototype.updateMain=function(){var t=this.isActive();$gameMap.update(t),$gamePlayer.update(t),$gameTimer.update(t),$gameScreen.update()},Scene_Map.prototype.isFastForward=function(){return $gameMap.isEventRunning()&&!SceneManager.isSceneChanging()&&(Input.isLongPressed("ok")||TouchInput.isLongPressed())},Scene_Map.prototype.stop=function(){Scene_Base.prototype.stop.call(this),$gamePlayer.straighten(),this._mapNameWindow.close(),this.needsSlowFadeOut()?this.startFadeOut(this.slowFadeSpeed(),!1):SceneManager.isNextScene(Scene_Map)?this.fadeOutForTransfer():SceneManager.isNextScene(Scene_Battle)&&this.launchBattle()},Scene_Map.prototype.isBusy=function(){return this._messageWindow&&this._messageWindow.isClosing()||this._waitCount>0||this._encounterEffectDuration>0||Scene_Base.prototype.isBusy.call(this)},Scene_Map.prototype.terminate=function(){Scene_Base.prototype.terminate.call(this),SceneManager.isNextScene(Scene_Battle)?ImageManager.clearRequest():(this._spriteset.update(),this._mapNameWindow.hide(),SceneManager.snapForBackground()),SceneManager.isNextScene(Scene_Map)&&ImageManager.clearRequest(),$gameScreen.clearZoom(),this.removeChild(this._fadeSprite),this.removeChild(this._mapNameWindow),this.removeChild(this._windowLayer),this.removeChild(this._spriteset)},Scene_Map.prototype.needsFadeIn=function(){return SceneManager.isPreviousScene(Scene_Battle)||SceneManager.isPreviousScene(Scene_Load)},Scene_Map.prototype.needsSlowFadeOut=function(){return SceneManager.isNextScene(Scene_Title)||SceneManager.isNextScene(Scene_Gameover)},Scene_Map.prototype.updateWaitCount=function(){return this._waitCount>0&&(this._waitCount--,!0)},Scene_Map.prototype.updateDestination=function(){this.isMapTouchOk()?this.processMapTouch():($gameTemp.clearDestination(),this._touchCount=0)},Scene_Map.prototype.isMapTouchOk=function(){return this.isActive()&&$gamePlayer.canMove()},Scene_Map.prototype.processMapTouch=function(){if(TouchInput.isTriggered()||this._touchCount>0)if(TouchInput.isPressed()){if(0===this._touchCount||this._touchCount>=15){var t=$gameMap.canvasToMapX(TouchInput.x),e=$gameMap.canvasToMapY(TouchInput.y);$gameTemp.setDestination(t,e)}this._touchCount++}else this._touchCount=0},Scene_Map.prototype.isSceneChangeOk=function(){return this.isActive()&&!$gameMessage.isBusy()},Scene_Map.prototype.updateScene=function(){this.checkGameover(),SceneManager.isSceneChanging()||this.updateTransferPlayer(),SceneManager.isSceneChanging()||this.updateEncounter(),SceneManager.isSceneChanging()||this.updateCallMenu(),SceneManager.isSceneChanging()||this.updateCallDebug()},Scene_Map.prototype.createDisplayObjects=function(){this.createSpriteset(),this.createMapNameWindow(),this.createWindowLayer(),this.createAllWindows()},Scene_Map.prototype.createSpriteset=function(){this._spriteset=new Spriteset_Map,this.addChild(this._spriteset)},Scene_Map.prototype.createAllWindows=function(){this.createMessageWindow(),this.createScrollTextWindow()},Scene_Map.prototype.createMapNameWindow=function(){this._mapNameWindow=new Window_MapName,this.addChild(this._mapNameWindow)},Scene_Map.prototype.createMessageWindow=function(){this._messageWindow=new Window_Message,this.addWindow(this._messageWindow),this._messageWindow.subWindows().forEach(function(t){this.addWindow(t)},this)},Scene_Map.prototype.createScrollTextWindow=function(){this._scrollTextWindow=new Window_ScrollText,this.addWindow(this._scrollTextWindow)},Scene_Map.prototype.updateTransferPlayer=function(){$gamePlayer.isTransferring()&&SceneManager.goto(Scene_Map)},Scene_Map.prototype.updateEncounter=function(){$gamePlayer.executeEncounter()&&SceneManager.push(Scene_Battle)},Scene_Map.prototype.updateCallMenu=function(){this.isMenuEnabled()?(this.isMenuCalled()&&(this.menuCalling=!0),this.menuCalling&&!$gamePlayer.isMoving()&&this.callMenu()):this.menuCalling=!1},Scene_Map.prototype.isMenuEnabled=function(){return $gameSystem.isMenuEnabled()&&!$gameMap.isEventRunning()},Scene_Map.prototype.isMenuCalled=function(){return Input.isTriggered("menu")||TouchInput.isCancelled()},Scene_Map.prototype.callMenu=function(){SoundManager.playOk(),SceneManager.push(Scene_Menu),Window_MenuCommand.initCommandPosition(),$gameTemp.clearDestination(),this._mapNameWindow.hide(),this._waitCount=2},Scene_Map.prototype.updateCallDebug=function(){this.isDebugCalled()&&SceneManager.push(Scene_Debug)},Scene_Map.prototype.isDebugCalled=function(){return Input.isTriggered("debug")&&$gameTemp.isPlaytest()},Scene_Map.prototype.fadeInForTransfer=function(){var t=$gamePlayer.fadeType();switch(t){case 0:case 1:this.startFadeIn(this.fadeSpeed(),1===t)}},Scene_Map.prototype.fadeOutForTransfer=function(){var t=$gamePlayer.fadeType();switch(t){case 0:case 1:this.startFadeOut(this.fadeSpeed(),1===t)}},Scene_Map.prototype.launchBattle=function(){BattleManager.saveBgmAndBgs(),this.stopAudioOnBattleStart(),SoundManager.playBattleStart(),this.startEncounterEffect(),this._mapNameWindow.hide()},Scene_Map.prototype.stopAudioOnBattleStart=function(){AudioManager.isCurrentBgm($gameSystem.battleBgm())||AudioManager.stopBgm(),AudioManager.stopBgs(),AudioManager.stopMe(),AudioManager.stopSe()},Scene_Map.prototype.startEncounterEffect=function(){this._spriteset.hideCharacters(),this._encounterEffectDuration=this.encounterEffectSpeed()},Scene_Map.prototype.updateEncounterEffect=function(){if(this._encounterEffectDuration>0){this._encounterEffectDuration--;var t=this.encounterEffectSpeed(),e=t-this._encounterEffectDuration,i=e/t,r=(20*(i-1)*i+5)*i+1,n=$gamePlayer.screenX(),a=$gamePlayer.screenY()-24;2===e&&($gameScreen.setZoom(n,a,1),this.snapForBattleBackground(),this.startFlashForEncounter(t/2)),$gameScreen.setZoom(n,a,r),e===Math.floor(t/6)&&this.startFlashForEncounter(t/2),e===Math.floor(t/2)&&(BattleManager.playBattleBgm(),this.startFadeOut(this.fadeSpeed()))}},Scene_Map.prototype.snapForBattleBackground=function(){this._windowLayer.visible=!1,SceneManager.snapForBackground(),this._windowLayer.visible=!0},Scene_Map.prototype.startFlashForEncounter=function(t){$gameScreen.startFlash([255,255,255,255],t)},Scene_Map.prototype.encounterEffectSpeed=function(){return 60},Scene_MenuBase.prototype=Object.create(Scene_Base.prototype),Scene_MenuBase.prototype.constructor=Scene_MenuBase,Scene_MenuBase.prototype.initialize=function(){Scene_Base.prototype.initialize.call(this)},Scene_MenuBase.prototype.create=function(){Scene_Base.prototype.create.call(this),this.createBackground(),this.updateActor(),this.createWindowLayer()},Scene_MenuBase.prototype.actor=function(){return this._actor},Scene_MenuBase.prototype.updateActor=function(){this._actor=$gameParty.menuActor()},Scene_MenuBase.prototype.createBackground=function(){this._backgroundSprite=new Sprite,this._backgroundSprite.bitmap=SceneManager.backgroundBitmap(),this.addChild(this._backgroundSprite)},Scene_MenuBase.prototype.setBackgroundOpacity=function(t){this._backgroundSprite.opacity=t},Scene_MenuBase.prototype.createHelpWindow=function(){this._helpWindow=new Window_Help,this.addWindow(this._helpWindow)},Scene_MenuBase.prototype.nextActor=function(){$gameParty.makeMenuActorNext(),this.updateActor(),this.onActorChange()},Scene_MenuBase.prototype.previousActor=function(){$gameParty.makeMenuActorPrevious(),this.updateActor(),this.onActorChange()},Scene_MenuBase.prototype.onActorChange=function(){},Scene_Menu.prototype=Object.create(Scene_MenuBase.prototype),Scene_Menu.prototype.constructor=Scene_Menu,Scene_Menu.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_Menu.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this.createCommandWindow(),this.createGoldWindow(),this.createStatusWindow()},Scene_Menu.prototype.start=function(){Scene_MenuBase.prototype.start.call(this),this._statusWindow.refresh()},Scene_Menu.prototype.createCommandWindow=function(){this._commandWindow=new Window_MenuCommand(0,0),this._commandWindow.setHandler("item",this.commandItem.bind(this)),this._commandWindow.setHandler("skill",this.commandPersonal.bind(this)),this._commandWindow.setHandler("equip",this.commandPersonal.bind(this)),this._commandWindow.setHandler("status",this.commandPersonal.bind(this)),this._commandWindow.setHandler("formation",this.commandFormation.bind(this)),this._commandWindow.setHandler("options",this.commandOptions.bind(this)),this._commandWindow.setHandler("save",this.commandSave.bind(this)),this._commandWindow.setHandler("gameEnd",this.commandGameEnd.bind(this)),this._commandWindow.setHandler("cancel",this.popScene.bind(this)),this.addWindow(this._commandWindow)},Scene_Menu.prototype.createGoldWindow=function(){this._goldWindow=new Window_Gold(0,0),this._goldWindow.y=Graphics.boxHeight-this._goldWindow.height,this.addWindow(this._goldWindow)},Scene_Menu.prototype.createStatusWindow=function(){this._statusWindow=new Window_MenuStatus(this._commandWindow.width,0),this._statusWindow.reserveFaceImages(),this.addWindow(this._statusWindow)},Scene_Menu.prototype.commandItem=function(){SceneManager.push(Scene_Item)},Scene_Menu.prototype.commandPersonal=function(){this._statusWindow.setFormationMode(!1),this._statusWindow.selectLast(),this._statusWindow.activate(),this._statusWindow.setHandler("ok",this.onPersonalOk.bind(this)),this._statusWindow.setHandler("cancel",this.onPersonalCancel.bind(this))},Scene_Menu.prototype.commandFormation=function(){this._statusWindow.setFormationMode(!0),this._statusWindow.selectLast(),this._statusWindow.activate(),this._statusWindow.setHandler("ok",this.onFormationOk.bind(this)),this._statusWindow.setHandler("cancel",this.onFormationCancel.bind(this))},Scene_Menu.prototype.commandOptions=function(){SceneManager.push(Scene_Options)},Scene_Menu.prototype.commandSave=function(){SceneManager.push(Scene_Save)},Scene_Menu.prototype.commandGameEnd=function(){SceneManager.push(Scene_GameEnd)},Scene_Menu.prototype.onPersonalOk=function(){switch(this._commandWindow.currentSymbol()){case"skill":SceneManager.push(Scene_Skill);break;case"equip":SceneManager.push(Scene_Equip);break;case"status":SceneManager.push(Scene_Status)}},Scene_Menu.prototype.onPersonalCancel=function(){this._statusWindow.deselect(),this._commandWindow.activate()},Scene_Menu.prototype.onFormationOk=function(){var t=this._statusWindow.index(),e=($gameParty.members(),this._statusWindow.pendingIndex());e>=0?($gameParty.swapOrder(t,e),this._statusWindow.setPendingIndex(-1),this._statusWindow.redrawItem(t)):this._statusWindow.setPendingIndex(t),this._statusWindow.activate()},Scene_Menu.prototype.onFormationCancel=function(){this._statusWindow.pendingIndex()>=0?(this._statusWindow.setPendingIndex(-1),this._statusWindow.activate()):(this._statusWindow.deselect(),this._commandWindow.activate())},Scene_ItemBase.prototype=Object.create(Scene_MenuBase.prototype),Scene_ItemBase.prototype.constructor=Scene_ItemBase,Scene_ItemBase.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_ItemBase.prototype.create=function(){Scene_MenuBase.prototype.create.call(this)},Scene_ItemBase.prototype.createActorWindow=function(){this._actorWindow=new Window_MenuActor,this._actorWindow.setHandler("ok",this.onActorOk.bind(this)),this._actorWindow.setHandler("cancel",this.onActorCancel.bind(this)),this.addWindow(this._actorWindow)},Scene_ItemBase.prototype.item=function(){return this._itemWindow.item()},Scene_ItemBase.prototype.user=function(){return null},Scene_ItemBase.prototype.isCursorLeft=function(){return this._itemWindow.index()%2==0},Scene_ItemBase.prototype.showSubWindow=function(t){t.x=this.isCursorLeft()?Graphics.boxWidth-t.width:0,t.show(),t.activate()},Scene_ItemBase.prototype.hideSubWindow=function(t){t.hide(),t.deactivate(),this.activateItemWindow()},Scene_ItemBase.prototype.onActorOk=function(){this.canUse()?this.useItem():SoundManager.playBuzzer()},Scene_ItemBase.prototype.onActorCancel=function(){this.hideSubWindow(this._actorWindow)},Scene_ItemBase.prototype.determineItem=function(){var t=new Game_Action(this.user()),e=this.item();t.setItemObject(e),t.isForFriend()?(this.showSubWindow(this._actorWindow),this._actorWindow.selectForItem(this.item())):(this.useItem(),this.activateItemWindow())},Scene_ItemBase.prototype.useItem=function(){this.playSeForItem(),this.user().useItem(this.item()),this.applyItem(),this.checkCommonEvent(),this.checkGameover(),this._actorWindow.refresh()},Scene_ItemBase.prototype.activateItemWindow=function(){this._itemWindow.refresh(),this._itemWindow.activate()},Scene_ItemBase.prototype.itemTargetActors=function(){var t=new Game_Action(this.user());return t.setItemObject(this.item()),t.isForFriend()?t.isForAll()?$gameParty.members():[$gameParty.members()[this._actorWindow.index()]]:[]},Scene_ItemBase.prototype.canUse=function(){return this.user().canUse(this.item())&&this.isItemEffectsValid()},Scene_ItemBase.prototype.isItemEffectsValid=function(){var t=new Game_Action(this.user());return t.setItemObject(this.item()),this.itemTargetActors().some(function(e){return t.testApply(e)},this)},Scene_ItemBase.prototype.applyItem=function(){var t=new Game_Action(this.user());t.setItemObject(this.item()),this.itemTargetActors().forEach(function(e){for(var i=0;i<t.numRepeats();i++)t.apply(e)},this),t.applyGlobal()},Scene_ItemBase.prototype.checkCommonEvent=function(){$gameTemp.isCommonEventReserved()&&SceneManager.goto(Scene_Map)},Scene_Item.prototype=Object.create(Scene_ItemBase.prototype),Scene_Item.prototype.constructor=Scene_Item,Scene_Item.prototype.initialize=function(){Scene_ItemBase.prototype.initialize.call(this)},Scene_Item.prototype.create=function(){Scene_ItemBase.prototype.create.call(this),this.createHelpWindow(),this.createCategoryWindow(),this.createItemWindow(),this.createActorWindow()},Scene_Item.prototype.createCategoryWindow=function(){this._categoryWindow=new Window_ItemCategory,this._categoryWindow.setHelpWindow(this._helpWindow),this._categoryWindow.y=this._helpWindow.height,this._categoryWindow.setHandler("ok",this.onCategoryOk.bind(this)),this._categoryWindow.setHandler("cancel",this.popScene.bind(this)),this.addWindow(this._categoryWindow)},Scene_Item.prototype.createItemWindow=function(){var t=this._categoryWindow.y+this._categoryWindow.height;this._itemWindow=new Window_ItemList(0,t,Graphics.boxWidth,Graphics.boxHeight-t),this._itemWindow.setHelpWindow(this._helpWindow),this._itemWindow.setHandler("ok",this.onItemOk.bind(this)),this._itemWindow.setHandler("cancel",this.onItemCancel.bind(this)),this.addWindow(this._itemWindow),this._categoryWindow.setItemWindow(this._itemWindow)},Scene_Item.prototype.user=function(){for(var t=$gameParty.movableMembers(),e=t[0],i=0,r=0;r<t.length;r++)t[r].pha>i&&(i=t[r].pha,e=t[r]);return e},Scene_Item.prototype.onCategoryOk=function(){this._itemWindow.activate(),this._itemWindow.selectLast()},Scene_Item.prototype.onItemOk=function(){$gameParty.setLastItem(this.item()),this.determineItem()},Scene_Item.prototype.onItemCancel=function(){this._itemWindow.deselect(),this._categoryWindow.activate()},Scene_Item.prototype.playSeForItem=function(){SoundManager.playUseItem()},Scene_Item.prototype.useItem=function(){Scene_ItemBase.prototype.useItem.call(this),this._itemWindow.redrawCurrentItem()},Scene_Skill.prototype=Object.create(Scene_ItemBase.prototype),Scene_Skill.prototype.constructor=Scene_Skill,Scene_Skill.prototype.initialize=function(){Scene_ItemBase.prototype.initialize.call(this)},Scene_Skill.prototype.create=function(){Scene_ItemBase.prototype.create.call(this),this.createHelpWindow(),this.createSkillTypeWindow(),this.createStatusWindow(),this.createItemWindow(),this.createActorWindow()},Scene_Skill.prototype.start=function(){Scene_ItemBase.prototype.start.call(this),this.refreshActor()},Scene_Skill.prototype.createSkillTypeWindow=function(){this._skillTypeWindow=new Window_SkillType(0,this._helpWindow.height),this._skillTypeWindow.setHelpWindow(this._helpWindow),this._skillTypeWindow.setHandler("skill",this.commandSkill.bind(this)),this._skillTypeWindow.setHandler("cancel",this.popScene.bind(this)),this._skillTypeWindow.setHandler("pagedown",this.nextActor.bind(this)),this._skillTypeWindow.setHandler("pageup",this.previousActor.bind(this)),this.addWindow(this._skillTypeWindow)},Scene_Skill.prototype.createStatusWindow=function(){var t=this._skillTypeWindow.width;this._statusWindow=new Window_SkillStatus(t,this._helpWindow.height,Graphics.boxWidth-t,this._skillTypeWindow.height),this._statusWindow.reserveFaceImages(),this.addWindow(this._statusWindow)},Scene_Skill.prototype.createItemWindow=function(){var t=this._statusWindow.y+this._statusWindow.height;this._itemWindow=new Window_SkillList(0,t,Graphics.boxWidth,Graphics.boxHeight-t),this._itemWindow.setHelpWindow(this._helpWindow),this._itemWindow.setHandler("ok",this.onItemOk.bind(this)),this._itemWindow.setHandler("cancel",this.onItemCancel.bind(this)),this._skillTypeWindow.setSkillWindow(this._itemWindow),this.addWindow(this._itemWindow)},Scene_Skill.prototype.refreshActor=function(){var t=this.actor();this._skillTypeWindow.setActor(t),this._statusWindow.setActor(t),this._itemWindow.setActor(t)},Scene_Skill.prototype.user=function(){return this.actor()},Scene_Skill.prototype.commandSkill=function(){this._itemWindow.activate(),this._itemWindow.selectLast()},Scene_Skill.prototype.onItemOk=function(){this.actor().setLastMenuSkill(this.item()),this.determineItem()},Scene_Skill.prototype.onItemCancel=function(){this._itemWindow.deselect(),this._skillTypeWindow.activate()},Scene_Skill.prototype.playSeForItem=function(){SoundManager.playUseSkill()},Scene_Skill.prototype.useItem=function(){Scene_ItemBase.prototype.useItem.call(this),this._statusWindow.refresh(),this._itemWindow.refresh()},Scene_Skill.prototype.onActorChange=function(){this.refreshActor(),this._skillTypeWindow.activate()},Scene_Equip.prototype=Object.create(Scene_MenuBase.prototype),Scene_Equip.prototype.constructor=Scene_Equip,Scene_Equip.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_Equip.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this.createHelpWindow(),this.createStatusWindow(),this.createCommandWindow(),this.createSlotWindow(),this.createItemWindow(),this.refreshActor()},Scene_Equip.prototype.createStatusWindow=function(){this._statusWindow=new Window_EquipStatus(0,this._helpWindow.height),this.addWindow(this._statusWindow)},Scene_Equip.prototype.createCommandWindow=function(){this._commandWindow=new Window_EquipCommand(this._statusWindow.width,this._helpWindow.height,Graphics.boxWidth-this._statusWindow.width),this._commandWindow.setHelpWindow(this._helpWindow),this._commandWindow.setHandler("equip",this.commandEquip.bind(this)),this._commandWindow.setHandler("optimize",this.commandOptimize.bind(this)),this._commandWindow.setHandler("clear",this.commandClear.bind(this)),this._commandWindow.setHandler("cancel",this.popScene.bind(this)),this._commandWindow.setHandler("pagedown",this.nextActor.bind(this)),this._commandWindow.setHandler("pageup",this.previousActor.bind(this)),this.addWindow(this._commandWindow)},Scene_Equip.prototype.createSlotWindow=function(){this._slotWindow=new Window_EquipSlot(this._statusWindow.width,this._commandWindow.y+this._commandWindow.height,Graphics.boxWidth-this._statusWindow.width,this._statusWindow.height-this._commandWindow.height),this._slotWindow.setHelpWindow(this._helpWindow),this._slotWindow.setStatusWindow(this._statusWindow),this._slotWindow.setHandler("ok",this.onSlotOk.bind(this)),this._slotWindow.setHandler("cancel",this.onSlotCancel.bind(this)),this.addWindow(this._slotWindow)},Scene_Equip.prototype.createItemWindow=function(){var t=this._statusWindow.y+this._statusWindow.height;this._itemWindow=new Window_EquipItem(0,t,Graphics.boxWidth,Graphics.boxHeight-t),this._itemWindow.setHelpWindow(this._helpWindow),this._itemWindow.setStatusWindow(this._statusWindow),this._itemWindow.setHandler("ok",this.onItemOk.bind(this)),this._itemWindow.setHandler("cancel",this.onItemCancel.bind(this)),this._slotWindow.setItemWindow(this._itemWindow),this.addWindow(this._itemWindow)},Scene_Equip.prototype.refreshActor=function(){var t=this.actor();this._statusWindow.setActor(t),this._slotWindow.setActor(t),this._itemWindow.setActor(t)},Scene_Equip.prototype.commandEquip=function(){this._slotWindow.activate(),this._slotWindow.select(0)},Scene_Equip.prototype.commandOptimize=function(){SoundManager.playEquip(),this.actor().optimizeEquipments(),this._statusWindow.refresh(),this._slotWindow.refresh(),this._commandWindow.activate()},Scene_Equip.prototype.commandClear=function(){SoundManager.playEquip(),this.actor().clearEquipments(),this._statusWindow.refresh(),this._slotWindow.refresh(),this._commandWindow.activate()},Scene_Equip.prototype.onSlotOk=function(){this._itemWindow.activate(),this._itemWindow.select(0)},Scene_Equip.prototype.onSlotCancel=function(){this._slotWindow.deselect(),this._commandWindow.activate()},Scene_Equip.prototype.onItemOk=function(){SoundManager.playEquip(),this.actor().changeEquip(this._slotWindow.index(),this._itemWindow.item()),this._slotWindow.activate(),this._slotWindow.refresh(),this._itemWindow.deselect(),this._itemWindow.refresh(),this._statusWindow.refresh()},Scene_Equip.prototype.onItemCancel=function(){this._slotWindow.activate(),this._itemWindow.deselect()},Scene_Equip.prototype.onActorChange=function(){this.refreshActor(),this._commandWindow.activate()},Scene_Status.prototype=Object.create(Scene_MenuBase.prototype),Scene_Status.prototype.constructor=Scene_Status,Scene_Status.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_Status.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this._statusWindow=new Window_Status,this._statusWindow.setHandler("cancel",this.popScene.bind(this)),this._statusWindow.setHandler("pagedown",this.nextActor.bind(this)),this._statusWindow.setHandler("pageup",this.previousActor.bind(this)),this._statusWindow.reserveFaceImages(),this.addWindow(this._statusWindow)},Scene_Status.prototype.start=function(){Scene_MenuBase.prototype.start.call(this),this.refreshActor()},Scene_Status.prototype.refreshActor=function(){var t=this.actor();this._statusWindow.setActor(t)},Scene_Status.prototype.onActorChange=function(){this.refreshActor(),this._statusWindow.activate()},Scene_Options.prototype=Object.create(Scene_MenuBase.prototype),Scene_Options.prototype.constructor=Scene_Options,Scene_Options.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_Options.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this.createOptionsWindow()},Scene_Options.prototype.terminate=function(){Scene_MenuBase.prototype.terminate.call(this),ConfigManager.save()},Scene_Options.prototype.createOptionsWindow=function(){this._optionsWindow=new Window_Options,this._optionsWindow.setHandler("cancel",this.popScene.bind(this)),this.addWindow(this._optionsWindow)},Scene_File.prototype=Object.create(Scene_MenuBase.prototype),Scene_File.prototype.constructor=Scene_File,Scene_File.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_File.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),DataManager.loadAllSavefileImages(),this.createHelpWindow(),this.createListWindow()},Scene_File.prototype.start=function(){Scene_MenuBase.prototype.start.call(this),this._listWindow.refresh()},Scene_File.prototype.savefileId=function(){return this._listWindow.index()+1},Scene_File.prototype.createHelpWindow=function(){this._helpWindow=new Window_Help(1),this._helpWindow.setText(this.helpWindowText()),this.addWindow(this._helpWindow)},Scene_File.prototype.createListWindow=function(){var t=this._helpWindow.height;this._listWindow=new Window_SavefileList(0,t,Graphics.boxWidth,Graphics.boxHeight-t),this._listWindow.setHandler("ok",this.onSavefileOk.bind(this)),this._listWindow.setHandler("cancel",this.popScene.bind(this)),this._listWindow.select(this.firstSavefileIndex()),this._listWindow.setTopRow(this.firstSavefileIndex()-2),this._listWindow.setMode(this.mode()),this._listWindow.refresh(),this.addWindow(this._listWindow)},Scene_File.prototype.mode=function(){return null},Scene_File.prototype.activateListWindow=function(){this._listWindow.activate()},Scene_File.prototype.helpWindowText=function(){return""},Scene_File.prototype.firstSavefileIndex=function(){return 0},Scene_File.prototype.onSavefileOk=function(){},Scene_Save.prototype=Object.create(Scene_File.prototype),Scene_Save.prototype.constructor=Scene_Save,Scene_Save.prototype.initialize=function(){Scene_File.prototype.initialize.call(this)},Scene_Save.prototype.mode=function(){return"save"},Scene_Save.prototype.helpWindowText=function(){return TextManager.saveMessage},Scene_Save.prototype.firstSavefileIndex=function(){return DataManager.lastAccessedSavefileId()-1},Scene_Save.prototype.onSavefileOk=function(){Scene_File.prototype.onSavefileOk.call(this),$gameSystem.onBeforeSave(),DataManager.saveGame(this.savefileId())?this.onSaveSuccess():this.onSaveFailure()},Scene_Save.prototype.onSaveSuccess=function(){SoundManager.playSave(),StorageManager.cleanBackup(this.savefileId()),this.popScene()},Scene_Save.prototype.onSaveFailure=function(){SoundManager.playBuzzer(),this.activateListWindow()},Scene_Load.prototype=Object.create(Scene_File.prototype),Scene_Load.prototype.constructor=Scene_Load,Scene_Load.prototype.initialize=function(){Scene_File.prototype.initialize.call(this),this._loadSuccess=!1},Scene_Load.prototype.terminate=function(){Scene_File.prototype.terminate.call(this),this._loadSuccess&&$gameSystem.onAfterLoad()},Scene_Load.prototype.mode=function(){return"load"},Scene_Load.prototype.helpWindowText=function(){return TextManager.loadMessage},Scene_Load.prototype.firstSavefileIndex=function(){return DataManager.latestSavefileId()-1},Scene_Load.prototype.onSavefileOk=function(){Scene_File.prototype.onSavefileOk.call(this),DataManager.loadGame(this.savefileId())?this.onLoadSuccess():this.onLoadFailure()},Scene_Load.prototype.onLoadSuccess=function(){SoundManager.playLoad(),this.fadeOutAll(),this.reloadMapIfUpdated(),SceneManager.goto(Scene_Map),this._loadSuccess=!0},Scene_Load.prototype.onLoadFailure=function(){SoundManager.playBuzzer(),this.activateListWindow()},Scene_Load.prototype.reloadMapIfUpdated=function(){$gameSystem.versionId()!==$dataSystem.versionId&&($gamePlayer.reserveTransfer($gameMap.mapId(),$gamePlayer.x,$gamePlayer.y),$gamePlayer.requestMapReload())},Scene_GameEnd.prototype=Object.create(Scene_MenuBase.prototype),Scene_GameEnd.prototype.constructor=Scene_GameEnd,Scene_GameEnd.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_GameEnd.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this.createCommandWindow()},Scene_GameEnd.prototype.stop=function(){Scene_MenuBase.prototype.stop.call(this),this._commandWindow.close()},Scene_GameEnd.prototype.createBackground=function(){Scene_MenuBase.prototype.createBackground.call(this),this.setBackgroundOpacity(128)},Scene_GameEnd.prototype.createCommandWindow=function(){this._commandWindow=new Window_GameEnd,this._commandWindow.setHandler("toTitle",this.commandToTitle.bind(this)),this._commandWindow.setHandler("cancel",this.popScene.bind(this)),this.addWindow(this._commandWindow)},Scene_GameEnd.prototype.commandToTitle=function(){this.fadeOutAll(),SceneManager.goto(Scene_Title)},Scene_Shop.prototype=Object.create(Scene_MenuBase.prototype),Scene_Shop.prototype.constructor=Scene_Shop,Scene_Shop.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_Shop.prototype.prepare=function(t,e){this._goods=t,this._purchaseOnly=e,this._item=null},Scene_Shop.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this.createHelpWindow(),this.createGoldWindow(),this.createCommandWindow(),this.createDummyWindow(),this.createNumberWindow(),this.createStatusWindow(),this.createBuyWindow(),this.createCategoryWindow(),this.createSellWindow()},Scene_Shop.prototype.createGoldWindow=function(){this._goldWindow=new Window_Gold(0,this._helpWindow.height),this._goldWindow.x=Graphics.boxWidth-this._goldWindow.width,this.addWindow(this._goldWindow)},Scene_Shop.prototype.createCommandWindow=function(){this._commandWindow=new Window_ShopCommand(this._goldWindow.x,this._purchaseOnly),this._commandWindow.y=this._helpWindow.height,this._commandWindow.setHandler("buy",this.commandBuy.bind(this)),this._commandWindow.setHandler("sell",this.commandSell.bind(this)),this._commandWindow.setHandler("cancel",this.popScene.bind(this)),this.addWindow(this._commandWindow)},Scene_Shop.prototype.createDummyWindow=function(){var t=this._commandWindow.y+this._commandWindow.height;this._dummyWindow=new Window_Base(0,t,Graphics.boxWidth,Graphics.boxHeight-t),this.addWindow(this._dummyWindow)},Scene_Shop.prototype.createNumberWindow=function(){this._numberWindow=new Window_ShopNumber(0,this._dummyWindow.y,this._dummyWindow.height),this._numberWindow.hide(),this._numberWindow.setHandler("ok",this.onNumberOk.bind(this)),this._numberWindow.setHandler("cancel",this.onNumberCancel.bind(this)),this.addWindow(this._numberWindow)},Scene_Shop.prototype.createStatusWindow=function(){var t=this._numberWindow.width;this._statusWindow=new Window_ShopStatus(t,this._dummyWindow.y,Graphics.boxWidth-t,this._dummyWindow.height),this._statusWindow.hide(),this.addWindow(this._statusWindow)},Scene_Shop.prototype.createBuyWindow=function(){this._buyWindow=new Window_ShopBuy(0,this._dummyWindow.y,this._dummyWindow.height,this._goods),this._buyWindow.setHelpWindow(this._helpWindow),this._buyWindow.setStatusWindow(this._statusWindow),this._buyWindow.hide(),this._buyWindow.setHandler("ok",this.onBuyOk.bind(this)),this._buyWindow.setHandler("cancel",this.onBuyCancel.bind(this)),this.addWindow(this._buyWindow)},Scene_Shop.prototype.createCategoryWindow=function(){this._categoryWindow=new Window_ItemCategory,this._categoryWindow.setHelpWindow(this._helpWindow),this._categoryWindow.y=this._dummyWindow.y,this._categoryWindow.hide(),this._categoryWindow.deactivate(),this._categoryWindow.setHandler("ok",this.onCategoryOk.bind(this)),this._categoryWindow.setHandler("cancel",this.onCategoryCancel.bind(this)),this.addWindow(this._categoryWindow)},Scene_Shop.prototype.createSellWindow=function(){var t=this._categoryWindow.y+this._categoryWindow.height;this._sellWindow=new Window_ShopSell(0,t,Graphics.boxWidth,Graphics.boxHeight-t),this._sellWindow.setHelpWindow(this._helpWindow),this._sellWindow.hide(),this._sellWindow.setHandler("ok",this.onSellOk.bind(this)),this._sellWindow.setHandler("cancel",this.onSellCancel.bind(this)),this._categoryWindow.setItemWindow(this._sellWindow),this.addWindow(this._sellWindow)},Scene_Shop.prototype.activateBuyWindow=function(){this._buyWindow.setMoney(this.money()),this._buyWindow.show(),this._buyWindow.activate(),this._statusWindow.show()},Scene_Shop.prototype.activateSellWindow=function(){this._categoryWindow.show(),this._sellWindow.refresh(),this._sellWindow.show(),this._sellWindow.activate(),this._statusWindow.hide()},Scene_Shop.prototype.commandBuy=function(){this._dummyWindow.hide(),this.activateBuyWindow()},Scene_Shop.prototype.commandSell=function(){this._dummyWindow.hide(),this._categoryWindow.show(),this._categoryWindow.activate(),this._sellWindow.show(),this._sellWindow.deselect(),this._sellWindow.refresh()},Scene_Shop.prototype.onBuyOk=function(){this._item=this._buyWindow.item(),this._buyWindow.hide(),this._numberWindow.setup(this._item,this.maxBuy(),this.buyingPrice()),this._numberWindow.setCurrencyUnit(this.currencyUnit()),this._numberWindow.show(),this._numberWindow.activate()},Scene_Shop.prototype.onBuyCancel=function(){this._commandWindow.activate(),this._dummyWindow.show(),this._buyWindow.hide(),this._statusWindow.hide(),this._statusWindow.setItem(null),this._helpWindow.clear()},Scene_Shop.prototype.onCategoryOk=function(){this.activateSellWindow(),this._sellWindow.select(0)},Scene_Shop.prototype.onCategoryCancel=function(){this._commandWindow.activate(),this._dummyWindow.show(),this._categoryWindow.hide(),this._sellWindow.hide()},Scene_Shop.prototype.onSellOk=function(){this._item=this._sellWindow.item(),this._categoryWindow.hide(),this._sellWindow.hide(),this._numberWindow.setup(this._item,this.maxSell(),this.sellingPrice()),this._numberWindow.setCurrencyUnit(this.currencyUnit()),this._numberWindow.show(),this._numberWindow.activate(),this._statusWindow.setItem(this._item),this._statusWindow.show()},Scene_Shop.prototype.onSellCancel=function(){this._sellWindow.deselect(),this._categoryWindow.activate(),this._statusWindow.setItem(null),this._helpWindow.clear()},Scene_Shop.prototype.onNumberOk=function(){switch(SoundManager.playShop(),this._commandWindow.currentSymbol()){case"buy":this.doBuy(this._numberWindow.number());break;case"sell":this.doSell(this._numberWindow.number())}this.endNumberInput(),this._goldWindow.refresh(),this._statusWindow.refresh()},Scene_Shop.prototype.onNumberCancel=function(){SoundManager.playCancel(),this.endNumberInput()},Scene_Shop.prototype.doBuy=function(t){$gameParty.loseGold(t*this.buyingPrice()),$gameParty.gainItem(this._item,t)},Scene_Shop.prototype.doSell=function(t){$gameParty.gainGold(t*this.sellingPrice()),$gameParty.loseItem(this._item,t)},Scene_Shop.prototype.endNumberInput=function(){switch(this._numberWindow.hide(),this._commandWindow.currentSymbol()){case"buy":this.activateBuyWindow();break;case"sell":this.activateSellWindow()}},Scene_Shop.prototype.maxBuy=function(){var t=$gameParty.maxItems(this._item)-$gameParty.numItems(this._item),e=this.buyingPrice();return e>0?Math.min(t,Math.floor(this.money()/e)):t},Scene_Shop.prototype.maxSell=function(){return $gameParty.numItems(this._item)},Scene_Shop.prototype.money=function(){return this._goldWindow.value()},Scene_Shop.prototype.currencyUnit=function(){return this._goldWindow.currencyUnit()},Scene_Shop.prototype.buyingPrice=function(){return this._buyWindow.price(this._item)},Scene_Shop.prototype.sellingPrice=function(){return Math.floor(this._item.price/2)},Scene_Name.prototype=Object.create(Scene_MenuBase.prototype),Scene_Name.prototype.constructor=Scene_Name,Scene_Name.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_Name.prototype.prepare=function(t,e){this._actorId=t,this._maxLength=e},Scene_Name.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this._actor=$gameActors.actor(this._actorId),this.createEditWindow(),this.createInputWindow()},Scene_Name.prototype.start=function(){Scene_MenuBase.prototype.start.call(this),this._editWindow.refresh()},Scene_Name.prototype.createEditWindow=function(){this._editWindow=new Window_NameEdit(this._actor,this._maxLength),this.addWindow(this._editWindow)},Scene_Name.prototype.createInputWindow=function(){this._inputWindow=new Window_NameInput(this._editWindow),this._inputWindow.setHandler("ok",this.onInputOk.bind(this)),this.addWindow(this._inputWindow)},Scene_Name.prototype.onInputOk=function(){this._actor.setName(this._editWindow.name()),this.popScene()},Scene_Debug.prototype=Object.create(Scene_MenuBase.prototype),Scene_Debug.prototype.constructor=Scene_Debug,Scene_Debug.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},Scene_Debug.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this.createRangeWindow(),this.createEditWindow(),this.createDebugHelpWindow()},Scene_Debug.prototype.createRangeWindow=function(){this._rangeWindow=new Window_DebugRange(0,0),this._rangeWindow.setHandler("ok",this.onRangeOk.bind(this)),this._rangeWindow.setHandler("cancel",this.popScene.bind(this)),this.addWindow(this._rangeWindow)},Scene_Debug.prototype.createEditWindow=function(){var t=this._rangeWindow.width;this._editWindow=new Window_DebugEdit(t,0,Graphics.boxWidth-t),this._editWindow.setHandler("cancel",this.onEditCancel.bind(this)),this._rangeWindow.setEditWindow(this._editWindow),this.addWindow(this._editWindow)},Scene_Debug.prototype.createDebugHelpWindow=function(){var t=this._editWindow.height;this._debugHelpWindow=new Window_Base(this._editWindow.x,t,this._editWindow.width,Graphics.boxHeight-t),this.addWindow(this._debugHelpWindow)},Scene_Debug.prototype.onRangeOk=function(){this._editWindow.activate(),this._editWindow.select(0),this.refreshHelpWindow()},Scene_Debug.prototype.onEditCancel=function(){this._rangeWindow.activate(),this._editWindow.deselect(),this.refreshHelpWindow()},Scene_Debug.prototype.refreshHelpWindow=function(){this._debugHelpWindow.contents.clear(),this._editWindow.active&&this._debugHelpWindow.drawTextEx(this.helpText(),4,0)},Scene_Debug.prototype.helpText=function(){return"switch"===this._rangeWindow.mode()?"Enter : ON / OFF":"Left     :  -1\nRight    :  +1\nPageup   : -10\nPagedown : +10"},Scene_Battle.prototype=Object.create(Scene_Base.prototype),Scene_Battle.prototype.constructor=Scene_Battle,Scene_Battle.prototype.initialize=function(){Scene_Base.prototype.initialize.call(this)},Scene_Battle.prototype.create=function(){Scene_Base.prototype.create.call(this),this.createDisplayObjects()},Scene_Battle.prototype.start=function(){Scene_Base.prototype.start.call(this),this.startFadeIn(this.fadeSpeed(),!1),BattleManager.playBattleBgm(),BattleManager.startBattle()},Scene_Battle.prototype.update=function(){var t=this.isActive();$gameTimer.update(t),$gameScreen.update(),this.updateStatusWindow(),this.updateWindowPositions(),t&&!this.isBusy()&&this.updateBattleProcess(),Scene_Base.prototype.update.call(this)},Scene_Battle.prototype.updateBattleProcess=function(){(!this.isAnyInputWindowActive()||BattleManager.isAborting()||BattleManager.isBattleEnd())&&(BattleManager.update(),this.changeInputWindow())},Scene_Battle.prototype.isAnyInputWindowActive=function(){return this._partyCommandWindow.active||this._actorCommandWindow.active||this._skillWindow.active||this._itemWindow.active||this._actorWindow.active||this._enemyWindow.active},Scene_Battle.prototype.changeInputWindow=function(){BattleManager.isInputting()?BattleManager.actor()?this.startActorCommandSelection():this.startPartyCommandSelection():this.endCommandSelection()},Scene_Battle.prototype.stop=function(){Scene_Base.prototype.stop.call(this),this.needsSlowFadeOut()?this.startFadeOut(this.slowFadeSpeed(),!1):this.startFadeOut(this.fadeSpeed(),!1),this._statusWindow.close(),this._partyCommandWindow.close(),this._actorCommandWindow.close()},Scene_Battle.prototype.terminate=function(){Scene_Base.prototype.terminate.call(this),$gameParty.onBattleEnd(),$gameTroop.onBattleEnd(),AudioManager.stopMe(),ImageManager.clearRequest()},Scene_Battle.prototype.needsSlowFadeOut=function(){return SceneManager.isNextScene(Scene_Title)||SceneManager.isNextScene(Scene_Gameover)},Scene_Battle.prototype.updateStatusWindow=function(){$gameMessage.isBusy()?(this._statusWindow.close(),this._partyCommandWindow.close(),this._actorCommandWindow.close()):this.isActive()&&!this._messageWindow.isClosing()&&this._statusWindow.open()},Scene_Battle.prototype.updateWindowPositions=function(){var t;t=BattleManager.isInputting()?this._partyCommandWindow.width:this._partyCommandWindow.width/2,this._statusWindow.x<t&&(this._statusWindow.x+=16,this._statusWindow.x>t&&(this._statusWindow.x=t)),this._statusWindow.x>t&&(this._statusWindow.x-=16,this._statusWindow.x<t&&(this._statusWindow.x=t))},Scene_Battle.prototype.createDisplayObjects=function(){this.createSpriteset(),this.createWindowLayer(),this.createAllWindows(),BattleManager.setLogWindow(this._logWindow),BattleManager.setStatusWindow(this._statusWindow),BattleManager.setSpriteset(this._spriteset),this._logWindow.setSpriteset(this._spriteset)},Scene_Battle.prototype.createSpriteset=function(){this._spriteset=new Spriteset_Battle,this.addChild(this._spriteset)},Scene_Battle.prototype.createAllWindows=function(){this.createLogWindow(),this.createStatusWindow(),this.createPartyCommandWindow(),this.createActorCommandWindow(),this.createHelpWindow(),this.createSkillWindow(),this.createItemWindow(),this.createActorWindow(),this.createEnemyWindow(),this.createMessageWindow(),this.createScrollTextWindow()},Scene_Battle.prototype.createLogWindow=function(){this._logWindow=new Window_BattleLog,this.addWindow(this._logWindow)},Scene_Battle.prototype.createStatusWindow=function(){this._statusWindow=new Window_BattleStatus,this.addWindow(this._statusWindow)},Scene_Battle.prototype.createPartyCommandWindow=function(){this._partyCommandWindow=new Window_PartyCommand,this._partyCommandWindow.setHandler("fight",this.commandFight.bind(this)),this._partyCommandWindow.setHandler("escape",this.commandEscape.bind(this)),this._partyCommandWindow.deselect(),this.addWindow(this._partyCommandWindow)},Scene_Battle.prototype.createActorCommandWindow=function(){this._actorCommandWindow=new Window_ActorCommand,this._actorCommandWindow.setHandler("attack",this.commandAttack.bind(this)),this._actorCommandWindow.setHandler("skill",this.commandSkill.bind(this)),this._actorCommandWindow.setHandler("guard",this.commandGuard.bind(this)),this._actorCommandWindow.setHandler("item",this.commandItem.bind(this)),this._actorCommandWindow.setHandler("cancel",this.selectPreviousCommand.bind(this)),this.addWindow(this._actorCommandWindow)},Scene_Battle.prototype.createHelpWindow=function(){this._helpWindow=new Window_Help,this._helpWindow.visible=!1,this.addWindow(this._helpWindow)},Scene_Battle.prototype.createSkillWindow=function(){var t=this._helpWindow.y+this._helpWindow.height;this._skillWindow=new Window_BattleSkill(0,t,Graphics.boxWidth,this._statusWindow.y-t),this._skillWindow.setHelpWindow(this._helpWindow),this._skillWindow.setHandler("ok",this.onSkillOk.bind(this)),this._skillWindow.setHandler("cancel",this.onSkillCancel.bind(this)),this.addWindow(this._skillWindow)},Scene_Battle.prototype.createItemWindow=function(){var t=this._helpWindow.y+this._helpWindow.height;this._itemWindow=new Window_BattleItem(0,t,Graphics.boxWidth,this._statusWindow.y-t),this._itemWindow.setHelpWindow(this._helpWindow),this._itemWindow.setHandler("ok",this.onItemOk.bind(this)),this._itemWindow.setHandler("cancel",this.onItemCancel.bind(this)),this.addWindow(this._itemWindow)},Scene_Battle.prototype.createActorWindow=function(){this._actorWindow=new Window_BattleActor(0,this._statusWindow.y),this._actorWindow.setHandler("ok",this.onActorOk.bind(this)),this._actorWindow.setHandler("cancel",this.onActorCancel.bind(this)),this.addWindow(this._actorWindow)},Scene_Battle.prototype.createEnemyWindow=function(){this._enemyWindow=new Window_BattleEnemy(0,this._statusWindow.y),this._enemyWindow.x=Graphics.boxWidth-this._enemyWindow.width,this._enemyWindow.setHandler("ok",this.onEnemyOk.bind(this)),this._enemyWindow.setHandler("cancel",this.onEnemyCancel.bind(this)),this.addWindow(this._enemyWindow)},Scene_Battle.prototype.createMessageWindow=function(){this._messageWindow=new Window_Message,this.addWindow(this._messageWindow),this._messageWindow.subWindows().forEach(function(t){this.addWindow(t)},this)},Scene_Battle.prototype.createScrollTextWindow=function(){this._scrollTextWindow=new Window_ScrollText,this.addWindow(this._scrollTextWindow)},Scene_Battle.prototype.refreshStatus=function(){this._statusWindow.refresh()},Scene_Battle.prototype.startPartyCommandSelection=function(){this.refreshStatus(),this._statusWindow.deselect(),this._statusWindow.open(),this._actorCommandWindow.close(),this._partyCommandWindow.setup()},Scene_Battle.prototype.commandFight=function(){this.selectNextCommand()},Scene_Battle.prototype.commandEscape=function(){BattleManager.processEscape(),this.changeInputWindow()},Scene_Battle.prototype.startActorCommandSelection=function(){this._statusWindow.select(BattleManager.actor().index()),this._partyCommandWindow.close(),this._actorCommandWindow.setup(BattleManager.actor())},Scene_Battle.prototype.commandAttack=function(){BattleManager.inputtingAction().setAttack(),this.selectEnemySelection()},Scene_Battle.prototype.commandSkill=function(){this._skillWindow.setActor(BattleManager.actor()),this._skillWindow.setStypeId(this._actorCommandWindow.currentExt()),this._skillWindow.refresh(),this._skillWindow.show(),this._skillWindow.activate()},Scene_Battle.prototype.commandGuard=function(){BattleManager.inputtingAction().setGuard(),this.selectNextCommand()},Scene_Battle.prototype.commandItem=function(){this._itemWindow.refresh(),this._itemWindow.show(),this._itemWindow.activate()},Scene_Battle.prototype.selectNextCommand=function(){BattleManager.selectNextCommand(),this.changeInputWindow()},Scene_Battle.prototype.selectPreviousCommand=function(){BattleManager.selectPreviousCommand(),this.changeInputWindow()},Scene_Battle.prototype.selectActorSelection=function(){this._actorWindow.refresh(),this._actorWindow.show(),this._actorWindow.activate()},Scene_Battle.prototype.onActorOk=function(){BattleManager.inputtingAction().setTarget(this._actorWindow.index()),this._actorWindow.hide(),this._skillWindow.hide(),this._itemWindow.hide(),this.selectNextCommand()},Scene_Battle.prototype.onActorCancel=function(){switch(this._actorWindow.hide(),this._actorCommandWindow.currentSymbol()){case"skill":this._skillWindow.show(),this._skillWindow.activate();break;case"item":this._itemWindow.show(),this._itemWindow.activate()}},Scene_Battle.prototype.selectEnemySelection=function(){this._enemyWindow.refresh(),this._enemyWindow.show(),this._enemyWindow.select(0),this._enemyWindow.activate()},Scene_Battle.prototype.onEnemyOk=function(){BattleManager.inputtingAction().setTarget(this._enemyWindow.enemyIndex()),this._enemyWindow.hide(),this._skillWindow.hide(),this._itemWindow.hide(),this.selectNextCommand()},Scene_Battle.prototype.onEnemyCancel=function(){switch(this._enemyWindow.hide(),this._actorCommandWindow.currentSymbol()){case"attack":this._actorCommandWindow.activate();break;case"skill":this._skillWindow.show(),this._skillWindow.activate();break;case"item":this._itemWindow.show(),this._itemWindow.activate()}},Scene_Battle.prototype.onSkillOk=function(){var t=this._skillWindow.item();BattleManager.inputtingAction().setSkill(t.id),BattleManager.actor().setLastBattleSkill(t),this.onSelectAction()},Scene_Battle.prototype.onSkillCancel=function(){this._skillWindow.hide(),this._actorCommandWindow.activate()},Scene_Battle.prototype.onItemOk=function(){var t=this._itemWindow.item();BattleManager.inputtingAction().setItem(t.id),$gameParty.setLastItem(t),this.onSelectAction()},Scene_Battle.prototype.onItemCancel=function(){this._itemWindow.hide(),this._actorCommandWindow.activate()},Scene_Battle.prototype.onSelectAction=function(){var t=BattleManager.inputtingAction();this._skillWindow.hide(),this._itemWindow.hide(),t.needsSelection()?t.isForOpponent()?this.selectEnemySelection():this.selectActorSelection():this.selectNextCommand()},Scene_Battle.prototype.endCommandSelection=function(){this._partyCommandWindow.close(),this._actorCommandWindow.close(),this._statusWindow.deselect()},Scene_Gameover.prototype=Object.create(Scene_Base.prototype),Scene_Gameover.prototype.constructor=Scene_Gameover,Scene_Gameover.prototype.initialize=function(){Scene_Base.prototype.initialize.call(this)},Scene_Gameover.prototype.create=function(){Scene_Base.prototype.create.call(this),this.playGameoverMusic(),this.createBackground()},Scene_Gameover.prototype.start=function(){Scene_Base.prototype.start.call(this),this.startFadeIn(this.slowFadeSpeed(),!1)},Scene_Gameover.prototype.update=function(){this.isActive()&&!this.isBusy()&&this.isTriggered()&&this.gotoTitle(),Scene_Base.prototype.update.call(this)},Scene_Gameover.prototype.stop=function(){Scene_Base.prototype.stop.call(this),this.fadeOutAll()},Scene_Gameover.prototype.terminate=function(){Scene_Base.prototype.terminate.call(this),AudioManager.stopAll()},Scene_Gameover.prototype.playGameoverMusic=function(){AudioManager.stopBgm(),AudioManager.stopBgs(),AudioManager.playMe($dataSystem.gameoverMe)},Scene_Gameover.prototype.createBackground=function(){this._backSprite=new Sprite,this._backSprite.bitmap=ImageManager.loadSystem("GameOver"),this.addChild(this._backSprite)},Scene_Gameover.prototype.isTriggered=function(){return Input.isTriggered("ok")||TouchInput.isTriggered()},Scene_Gameover.prototype.gotoTitle=function(){SceneManager.goto(Scene_Title)},Sprite_Base.prototype=Object.create(Sprite.prototype),Sprite_Base.prototype.constructor=Sprite_Base,Sprite_Base.prototype.initialize=function(){Sprite.prototype.initialize.call(this),this._animationSprites=[],this._effectTarget=this,this._hiding=!1},Sprite_Base.prototype.update=function(){Sprite.prototype.update.call(this),this.updateVisibility(),this.updateAnimationSprites()},Sprite_Base.prototype.hide=function(){this._hiding=!0,this.updateVisibility()},Sprite_Base.prototype.show=function(){this._hiding=!1,this.updateVisibility()},Sprite_Base.prototype.updateVisibility=function(){this.visible=!this._hiding},Sprite_Base.prototype.updateAnimationSprites=function(){if(this._animationSprites.length>0){var t=this._animationSprites.clone();this._animationSprites=[];for(var e=0;e<t.length;e++){var i=t[e];i.isPlaying()?this._animationSprites.push(i):i.remove()}}},Sprite_Base.prototype.startAnimation=function(t,e,i){var r=new Sprite_Animation;r.setup(this._effectTarget,t,e,i),this.parent.addChild(r),this._animationSprites.push(r)},Sprite_Base.prototype.isAnimationPlaying=function(){return this._animationSprites.length>0},Sprite_Button.prototype=Object.create(Sprite.prototype),Sprite_Button.prototype.constructor=Sprite_Button,Sprite_Button.prototype.initialize=function(){Sprite.prototype.initialize.call(this),this._touching=!1,this._coldFrame=null,this._hotFrame=null,this._clickHandler=null},Sprite_Button.prototype.update=function(){Sprite.prototype.update.call(this),this.updateFrame(),this.processTouch()},Sprite_Button.prototype.updateFrame=function(){var t;(t=this._touching?this._hotFrame:this._coldFrame)&&this.setFrame(t.x,t.y,t.width,t.height)},Sprite_Button.prototype.setColdFrame=function(t,e,i,r){this._coldFrame=new Rectangle(t,e,i,r)},Sprite_Button.prototype.setHotFrame=function(t,e,i,r){this._hotFrame=new Rectangle(t,e,i,r)},Sprite_Button.prototype.setClickHandler=function(t){this._clickHandler=t},Sprite_Button.prototype.callClickHandler=function(){this._clickHandler&&this._clickHandler()},Sprite_Button.prototype.processTouch=function(){this.isActive()?(TouchInput.isTriggered()&&this.isButtonTouched()&&(this._touching=!0),this._touching&&(!TouchInput.isReleased()&&this.isButtonTouched()||(this._touching=!1,TouchInput.isReleased()&&this.callClickHandler()))):this._touching=!1},Sprite_Button.prototype.isActive=function(){for(var t=this;t;){if(!t.visible)return!1;t=t.parent}return!0},Sprite_Button.prototype.isButtonTouched=function(){var t=this.canvasToLocalX(TouchInput.x),e=this.canvasToLocalY(TouchInput.y);return t>=0&&e>=0&&t<this.width&&e<this.height},Sprite_Button.prototype.canvasToLocalX=function(t){for(var e=this;e;)t-=e.x,e=e.parent;return t},Sprite_Button.prototype.canvasToLocalY=function(t){for(var e=this;e;)t-=e.y,e=e.parent;return t},Sprite_Character.prototype=Object.create(Sprite_Base.prototype),Sprite_Character.prototype.constructor=Sprite_Character,Sprite_Character.prototype.initialize=function(t){Sprite_Base.prototype.initialize.call(this),this.initMembers(),this.setCharacter(t)},Sprite_Character.prototype.initMembers=function(){this.anchor.x=.5,this.anchor.y=1,this._character=null,this._balloonDuration=0,this._tilesetId=0,this._upperBody=null,this._lowerBody=null},Sprite_Character.prototype.setCharacter=function(t){this._character=t},Sprite_Character.prototype.update=function(){Sprite_Base.prototype.update.call(this),this.updateBitmap(),this.updateFrame(),this.updatePosition(),this.updateAnimation(),this.updateBalloon(),this.updateOther()},Sprite_Character.prototype.updateVisibility=function(){Sprite_Base.prototype.updateVisibility.call(this),this._character.isTransparent()&&(this.visible=!1)},Sprite_Character.prototype.isTile=function(){return this._character.tileId>0},Sprite_Character.prototype.tilesetBitmap=function(t){var e=$gameMap.tileset(),i=5+Math.floor(t/256);return ImageManager.loadTileset(e.tilesetNames[i])},Sprite_Character.prototype.updateBitmap=function(){this.isImageChanged()&&(this._tilesetId=$gameMap.tilesetId(),this._tileId=this._character.tileId(),this._characterName=this._character.characterName(),this._characterIndex=this._character.characterIndex(),this._tileId>0?this.setTileBitmap():this.setCharacterBitmap())},Sprite_Character.prototype.isImageChanged=function(){return this._tilesetId!==$gameMap.tilesetId()||this._tileId!==this._character.tileId()||this._characterName!==this._character.characterName()||this._characterIndex!==this._character.characterIndex()},Sprite_Character.prototype.setTileBitmap=function(){this.bitmap=this.tilesetBitmap(this._tileId)},Sprite_Character.prototype.setCharacterBitmap=function(){this.bitmap=ImageManager.loadCharacter(this._characterName),this._isBigCharacter=ImageManager.isBigCharacter(this._characterName)},Sprite_Character.prototype.updateFrame=function(){this._tileId>0?this.updateTileFrame():this.updateCharacterFrame()},Sprite_Character.prototype.updateTileFrame=function(){var t=this.patternWidth(),e=this.patternHeight(),i=(Math.floor(this._tileId/128)%2*8+this._tileId%8)*t,r=Math.floor(this._tileId%256/8)%16*e;this.setFrame(i,r,t,e)},Sprite_Character.prototype.updateCharacterFrame=function(){var t=this.patternWidth(),e=this.patternHeight(),i=(this.characterBlockX()+this.characterPatternX())*t,r=(this.characterBlockY()+this.characterPatternY())*e;if(this.updateHalfBodySprites(),this._bushDepth>0){var n=this._bushDepth;this._upperBody.setFrame(i,r,t,e-n),this._lowerBody.setFrame(i,r+e-n,t,n),this.setFrame(i,r,0,e)}else this.setFrame(i,r,t,e)},Sprite_Character.prototype.characterBlockX=function(){return this._isBigCharacter?0:this._character.characterIndex()%4*3},Sprite_Character.prototype.characterBlockY=function(){if(this._isBigCharacter)return 0;var t=this._character.characterIndex();return 4*Math.floor(t/4)},Sprite_Character.prototype.characterPatternX=function(){return this._character.pattern()},Sprite_Character.prototype.characterPatternY=function(){return(this._character.direction()-2)/2},Sprite_Character.prototype.patternWidth=function(){return this._tileId>0?$gameMap.tileWidth():this._isBigCharacter?this.bitmap.width/3:this.bitmap.width/12},Sprite_Character.prototype.patternHeight=function(){return this._tileId>0?$gameMap.tileHeight():this._isBigCharacter?this.bitmap.height/4:this.bitmap.height/8},Sprite_Character.prototype.updateHalfBodySprites=function(){this._bushDepth>0?(this.createHalfBodySprites(),this._upperBody.bitmap=this.bitmap,this._upperBody.visible=!0,this._upperBody.y=-this._bushDepth,this._lowerBody.bitmap=this.bitmap,this._lowerBody.visible=!0,this._upperBody.setBlendColor(this.getBlendColor()),this._lowerBody.setBlendColor(this.getBlendColor()),this._upperBody.setColorTone(this.getColorTone()),this._lowerBody.setColorTone(this.getColorTone())):this._upperBody&&(this._upperBody.visible=!1,this._lowerBody.visible=!1)},Sprite_Character.prototype.createHalfBodySprites=function(){this._upperBody||(this._upperBody=new Sprite,this._upperBody.anchor.x=.5,this._upperBody.anchor.y=1,this.addChild(this._upperBody)),this._lowerBody||(this._lowerBody=new Sprite,this._lowerBody.anchor.x=.5,this._lowerBody.anchor.y=1,this._lowerBody.opacity=128,this.addChild(this._lowerBody))},Sprite_Character.prototype.updatePosition=function(){this.x=this._character.screenX(),this.y=this._character.screenY(),this.z=this._character.screenZ()},Sprite_Character.prototype.updateAnimation=function(){this.setupAnimation(),this.isAnimationPlaying()||this._character.endAnimation(),this.isBalloonPlaying()||this._character.endBalloon()},Sprite_Character.prototype.updateOther=function(){this.opacity=this._character.opacity(),this.blendMode=this._character.blendMode(),this._bushDepth=this._character.bushDepth()},Sprite_Character.prototype.setupAnimation=function(){if(this._character.animationId()>0){var t=$dataAnimations[this._character.animationId()];this.startAnimation(t,!1,0),this._character.startAnimation()}},Sprite_Character.prototype.setupBalloon=function(){this._character.balloonId()>0&&(this.startBalloon(),this._character.startBalloon())},Sprite_Character.prototype.startBalloon=function(){this._balloonSprite||(this._balloonSprite=new Sprite_Balloon),this._balloonSprite.setup(this._character.balloonId()),this.parent.addChild(this._balloonSprite)},Sprite_Character.prototype.updateBalloon=function(){this.setupBalloon(),this._balloonSprite&&(this._balloonSprite.x=this.x,this._balloonSprite.y=this.y-this.height,this._balloonSprite.isPlaying()||this.endBalloon())},Sprite_Character.prototype.endBalloon=function(){this._balloonSprite&&(this.parent.removeChild(this._balloonSprite),this._balloonSprite=null)},Sprite_Character.prototype.isBalloonPlaying=function(){return!!this._balloonSprite},Sprite_Battler.prototype=Object.create(Sprite_Base.prototype),Sprite_Battler.prototype.constructor=Sprite_Battler,Sprite_Battler.prototype.initialize=function(t){Sprite_Base.prototype.initialize.call(this),this.initMembers(),this.setBattler(t)},Sprite_Battler.prototype.initMembers=function(){this.anchor.x=.5,this.anchor.y=1,this._battler=null,this._damages=[],this._homeX=0,this._homeY=0,this._offsetX=0,this._offsetY=0,this._targetOffsetX=NaN,this._targetOffsetY=NaN,this._movementDuration=0,this._selectionEffectCount=0},Sprite_Battler.prototype.setBattler=function(t){this._battler=t},Sprite_Battler.prototype.setHome=function(t,e){this._homeX=t,this._homeY=e,this.updatePosition()},Sprite_Battler.prototype.update=function(){Sprite_Base.prototype.update.call(this),this._battler?(this.updateMain(),this.updateAnimation(),this.updateDamagePopup(),this.updateSelectionEffect()):this.bitmap=null},Sprite_Battler.prototype.updateVisibility=function(){Sprite_Base.prototype.updateVisibility.call(this),this._battler&&this._battler.isSpriteVisible()||(this.visible=!1)},Sprite_Battler.prototype.updateMain=function(){this._battler.isSpriteVisible()&&(this.updateBitmap(),this.updateFrame()),this.updateMove(),this.updatePosition()},Sprite_Battler.prototype.updateBitmap=function(){},Sprite_Battler.prototype.updateFrame=function(){},Sprite_Battler.prototype.updateMove=function(){if(this._movementDuration>0){var t=this._movementDuration;this._offsetX=(this._offsetX*(t-1)+this._targetOffsetX)/t,this._offsetY=(this._offsetY*(t-1)+this._targetOffsetY)/t,this._movementDuration--,0===this._movementDuration&&this.onMoveEnd()}},Sprite_Battler.prototype.updatePosition=function(){this.x=this._homeX+this._offsetX,this.y=this._homeY+this._offsetY},Sprite_Battler.prototype.updateAnimation=function(){this.setupAnimation()},Sprite_Battler.prototype.updateDamagePopup=function(){if(this.setupDamagePopup(),this._damages.length>0){for(var t=0;t<this._damages.length;t++)this._damages[t].update();this._damages[0].isPlaying()||(this.parent.removeChild(this._damages[0]),this._damages.shift())}},Sprite_Battler.prototype.updateSelectionEffect=function(){var t=this._effectTarget;this._battler.isSelected()?(this._selectionEffectCount++,t.setBlendColor(this._selectionEffectCount%30<15?[255,255,255,64]:[0,0,0,0])):this._selectionEffectCount>0&&(this._selectionEffectCount=0,t.setBlendColor([0,0,0,0]))},Sprite_Battler.prototype.setupAnimation=function(){for(;this._battler.isAnimationRequested();){var t=this._battler.shiftAnimation(),e=$dataAnimations[t.animationId];this.startAnimation(e,t.mirror,3===e.position?0:t.delay);for(var i=0;i<this._animationSprites.length;i++)this._animationSprites[i].visible=this._battler.isSpriteVisible()}},Sprite_Battler.prototype.setupDamagePopup=function(){if(this._battler.isDamagePopupRequested()){if(this._battler.isSpriteVisible()){var t=new Sprite_Damage;t.x=this.x+this.damageOffsetX(),t.y=this.y+this.damageOffsetY(),t.setup(this._battler),this._damages.push(t),this.parent.addChild(t)}this._battler.clearDamagePopup(),this._battler.clearResult()}},Sprite_Battler.prototype.damageOffsetX=function(){return 0},Sprite_Battler.prototype.damageOffsetY=function(){return 0},Sprite_Battler.prototype.startMove=function(t,e,i){this._targetOffsetX===t&&this._targetOffsetY===e||(this._targetOffsetX=t,this._targetOffsetY=e,this._movementDuration=i,0===i&&(this._offsetX=t,this._offsetY=e))},Sprite_Battler.prototype.onMoveEnd=function(){},Sprite_Battler.prototype.isEffecting=function(){return!1},Sprite_Battler.prototype.isMoving=function(){return this._movementDuration>0},Sprite_Battler.prototype.inHomePosition=function(){return 0===this._offsetX&&0===this._offsetY},Sprite_Actor.prototype=Object.create(Sprite_Battler.prototype),Sprite_Actor.prototype.constructor=Sprite_Actor,Sprite_Actor.MOTIONS={walk:{index:0,loop:!0},wait:{index:1,loop:!0},chant:{index:2,loop:!0},guard:{index:3,loop:!0},damage:{index:4,loop:!1},evade:{index:5,loop:!1},thrust:{index:6,loop:!1},swing:{index:7,loop:!1},missile:{index:8,loop:!1},skill:{index:9,loop:!1},spell:{index:10,loop:!1},item:{index:11,loop:!1},escape:{index:12,loop:!0},victory:{index:13,loop:!0},dying:{index:14,loop:!0},abnormal:{index:15,loop:!0},sleep:{index:16,loop:!0},dead:{index:17,loop:!0}},Sprite_Actor.prototype.initialize=function(t){Sprite_Battler.prototype.initialize.call(this,t),this.moveToStartPosition()},Sprite_Actor.prototype.initMembers=function(){Sprite_Battler.prototype.initMembers.call(this),this._battlerName="",this._motion=null,this._motionCount=0,this._pattern=0,this.createShadowSprite(),this.createWeaponSprite(),this.createMainSprite(),this.createStateSprite()},Sprite_Actor.prototype.createMainSprite=function(){this._mainSprite=new Sprite_Base,this._mainSprite.anchor.x=.5,this._mainSprite.anchor.y=1,this.addChild(this._mainSprite),this._effectTarget=this._mainSprite},Sprite_Actor.prototype.createShadowSprite=function(){this._shadowSprite=new Sprite,this._shadowSprite.bitmap=ImageManager.loadSystem("Shadow2"),this._shadowSprite.anchor.x=.5,this._shadowSprite.anchor.y=.5,this._shadowSprite.y=-2,this.addChild(this._shadowSprite)},Sprite_Actor.prototype.createWeaponSprite=function(){this._weaponSprite=new Sprite_Weapon,this.addChild(this._weaponSprite)},Sprite_Actor.prototype.createStateSprite=function(){this._stateSprite=new Sprite_StateOverlay,this.addChild(this._stateSprite)},Sprite_Actor.prototype.setBattler=function(t){Sprite_Battler.prototype.setBattler.call(this,t),t!==this._actor&&(this._actor=t,t&&this.setActorHome(t.index()),this.startEntryMotion(),this._stateSprite.setup(t))},Sprite_Actor.prototype.moveToStartPosition=function(){this.startMove(300,0,0)},Sprite_Actor.prototype.setActorHome=function(t){this.setHome(600+32*t,280+48*t)},Sprite_Actor.prototype.update=function(){Sprite_Battler.prototype.update.call(this),this.updateShadow(),this._actor&&this.updateMotion()},Sprite_Actor.prototype.updateShadow=function(){this._shadowSprite.visible=!!this._actor},Sprite_Actor.prototype.updateMain=function(){Sprite_Battler.prototype.updateMain.call(this),this._actor.isSpriteVisible()&&!this.isMoving()&&this.updateTargetPosition()},Sprite_Actor.prototype.setupMotion=function(){this._actor.isMotionRequested()&&(this.startMotion(this._actor.motionType()),this._actor.clearMotion())},Sprite_Actor.prototype.setupWeaponAnimation=function(){this._actor.isWeaponAnimationRequested()&&(this._weaponSprite.setup(this._actor.weaponImageId()),this._actor.clearWeaponAnimation())},Sprite_Actor.prototype.startMotion=function(t){var e=Sprite_Actor.MOTIONS[t];this._motion!==e&&(this._motion=e,this._motionCount=0,this._pattern=0)},Sprite_Actor.prototype.updateTargetPosition=function(){this._actor.isInputting()||this._actor.isActing()?this.stepForward():this._actor.canMove()&&BattleManager.isEscaped()?this.retreat():this.inHomePosition()||this.stepBack()},Sprite_Actor.prototype.updateBitmap=function(){Sprite_Battler.prototype.updateBitmap.call(this);var t=this._actor.battlerName();this._battlerName!==t&&(this._battlerName=t,this._mainSprite.bitmap=ImageManager.loadSvActor(t))},Sprite_Actor.prototype.updateFrame=function(){Sprite_Battler.prototype.updateFrame.call(this);var t=this._mainSprite.bitmap;if(t){var e=this._motion?this._motion.index:0,i=this._pattern<3?this._pattern:1,r=t.width/9,n=t.height/6,a=3*Math.floor(e/6)+i;this._mainSprite.setFrame(a*r,e%6*n,r,n)}},Sprite_Actor.prototype.updateMove=function(){var t=this._mainSprite.bitmap;t&&!t.isReady()||Sprite_Battler.prototype.updateMove.call(this)},Sprite_Actor.prototype.updateMotion=function(){this.setupMotion(),this.setupWeaponAnimation(),this._actor.isMotionRefreshRequested()&&(this.refreshMotion(),this._actor.clearMotion()),this.updateMotionCount()},Sprite_Actor.prototype.updateMotionCount=function(){this._motion&&++this._motionCount>=this.motionSpeed()&&(this._motion.loop?this._pattern=(this._pattern+1)%4:this._pattern<2?this._pattern++:this.refreshMotion(),this._motionCount=0)},Sprite_Actor.prototype.motionSpeed=function(){return 12},Sprite_Actor.prototype.refreshMotion=function(){var t=this._actor;if(t){if(this._motion===Sprite_Actor.MOTIONS.guard&&!BattleManager.isInputting())return;var e=t.stateMotionIndex();t.isInputting()||t.isActing()?this.startMotion("walk"):3===e?this.startMotion("dead"):2===e?this.startMotion("sleep"):t.isChanting()?this.startMotion("chant"):t.isGuard()||t.isGuardWaiting()?this.startMotion("guard"):1===e?this.startMotion("abnormal"):t.isDying()?this.startMotion("dying"):t.isUndecided()?this.startMotion("walk"):this.startMotion("wait")}},Sprite_Actor.prototype.startEntryMotion=function(){this._actor&&this._actor.canMove()?(this.startMotion("walk"),this.startMove(0,0,30)):this.isMoving()||(this.refreshMotion(),this.startMove(0,0,0))},Sprite_Actor.prototype.stepForward=function(){this.startMove(-48,0,12)},Sprite_Actor.prototype.stepBack=function(){this.startMove(0,0,12)},Sprite_Actor.prototype.retreat=function(){this.startMove(300,0,30)},Sprite_Actor.prototype.onMoveEnd=function(){Sprite_Battler.prototype.onMoveEnd.call(this),BattleManager.isBattleEnd()||this.refreshMotion()},Sprite_Actor.prototype.damageOffsetX=function(){return-32},Sprite_Actor.prototype.damageOffsetY=function(){return 0},Sprite_Enemy.prototype=Object.create(Sprite_Battler.prototype),Sprite_Enemy.prototype.constructor=Sprite_Enemy,Sprite_Enemy.prototype.initialize=function(t){Sprite_Battler.prototype.initialize.call(this,t)},Sprite_Enemy.prototype.initMembers=function(){Sprite_Battler.prototype.initMembers.call(this),this._enemy=null,this._appeared=!1,this._battlerName="",this._battlerHue=0,this._effectType=null,this._effectDuration=0,this._shake=0,this.createStateIconSprite()},Sprite_Enemy.prototype.createStateIconSprite=function(){this._stateIconSprite=new Sprite_StateIcon,this.addChild(this._stateIconSprite)},Sprite_Enemy.prototype.setBattler=function(t){Sprite_Battler.prototype.setBattler.call(this,t),this._enemy=t,this.setHome(t.screenX(),t.screenY()),this._stateIconSprite.setup(t)},Sprite_Enemy.prototype.update=function(){Sprite_Battler.prototype.update.call(this),this._enemy&&(this.updateEffect(),this.updateStateSprite())},Sprite_Enemy.prototype.updateBitmap=function(){Sprite_Battler.prototype.updateBitmap.call(this);var t=this._enemy.battlerName(),e=this._enemy.battlerHue();this._battlerName===t&&this._battlerHue===e||(this._battlerName=t,this._battlerHue=e,this.loadBitmap(t,e),this.initVisibility())},Sprite_Enemy.prototype.loadBitmap=function(t,e){this.bitmap=$gameSystem.isSideView()?ImageManager.loadSvEnemy(t,e):ImageManager.loadEnemy(t,e)},Sprite_Enemy.prototype.updateFrame=function(){Sprite_Battler.prototype.updateFrame.call(this);var t=this.bitmap.height;"bossCollapse"===this._effectType&&(t=this._effectDuration),this.setFrame(0,0,this.bitmap.width,t)},Sprite_Enemy.prototype.updatePosition=function(){Sprite_Battler.prototype.updatePosition.call(this),this.x+=this._shake},Sprite_Enemy.prototype.updateStateSprite=function(){this._stateIconSprite.y=-Math.round(.9*(this.bitmap.height+40)),this._stateIconSprite.y<20-this.y&&(this._stateIconSprite.y=20-this.y)},Sprite_Enemy.prototype.initVisibility=function(){this._appeared=this._enemy.isAlive(),this._appeared||(this.opacity=0)},Sprite_Enemy.prototype.setupEffect=function(){this._appeared&&this._enemy.isEffectRequested()&&(this.startEffect(this._enemy.effectType()),this._enemy.clearEffect()),!this._appeared&&this._enemy.isAlive()?this.startEffect("appear"):this._appeared&&this._enemy.isHidden()&&this.startEffect("disappear")},Sprite_Enemy.prototype.startEffect=function(t){switch(this._effectType=t,this._effectType){case"appear":this.startAppear();break;case"disappear":this.startDisappear();break;case"whiten":this.startWhiten();break;case"blink":this.startBlink();break;case"collapse":this.startCollapse();break;case"bossCollapse":this.startBossCollapse();break;case"instantCollapse":this.startInstantCollapse()}this.revertToNormal()},Sprite_Enemy.prototype.startAppear=function(){this._effectDuration=16,this._appeared=!0},Sprite_Enemy.prototype.startDisappear=function(){this._effectDuration=32,this._appeared=!1},Sprite_Enemy.prototype.startWhiten=function(){this._effectDuration=16},Sprite_Enemy.prototype.startBlink=function(){this._effectDuration=20},Sprite_Enemy.prototype.startCollapse=function(){this._effectDuration=32,this._appeared=!1},Sprite_Enemy.prototype.startBossCollapse=function(){this._effectDuration=this.bitmap.height,this._appeared=!1},Sprite_Enemy.prototype.startInstantCollapse=function(){this._effectDuration=16,this._appeared=!1},Sprite_Enemy.prototype.updateEffect=function(){if(this.setupEffect(),this._effectDuration>0){switch(this._effectDuration--,this._effectType){case"whiten":this.updateWhiten();break;case"blink":this.updateBlink();break;case"appear":this.updateAppear();break;case"disappear":this.updateDisappear();break;case"collapse":this.updateCollapse();break;case"bossCollapse":this.updateBossCollapse();break;case"instantCollapse":this.updateInstantCollapse()}0===this._effectDuration&&(this._effectType=null)}},Sprite_Enemy.prototype.isEffecting=function(){return null!==this._effectType},Sprite_Enemy.prototype.revertToNormal=function(){this._shake=0,this.blendMode=0,this.opacity=255,this.setBlendColor([0,0,0,0])},Sprite_Enemy.prototype.updateWhiten=function(){this.setBlendColor([255,255,255,128-10*(16-this._effectDuration)])},Sprite_Enemy.prototype.updateBlink=function(){this.opacity=this._effectDuration%10<5?255:0},Sprite_Enemy.prototype.updateAppear=function(){this.opacity=16*(16-this._effectDuration)},Sprite_Enemy.prototype.updateDisappear=function(){this.opacity=256-10*(32-this._effectDuration)},Sprite_Enemy.prototype.updateCollapse=function(){this.blendMode=Graphics.BLEND_ADD,this.setBlendColor([255,128,128,128]),this.opacity*=this._effectDuration/(this._effectDuration+1)},Sprite_Enemy.prototype.updateBossCollapse=function(){this._shake=this._effectDuration%2*4-2,this.blendMode=Graphics.BLEND_ADD,this.opacity*=this._effectDuration/(this._effectDuration+1),this.setBlendColor([255,255,255,255-this.opacity]),this._effectDuration%20==19&&SoundManager.playBossCollapse2()},Sprite_Enemy.prototype.updateInstantCollapse=function(){this.opacity=0},Sprite_Enemy.prototype.damageOffsetX=function(){return 0},Sprite_Enemy.prototype.damageOffsetY=function(){return-8},Sprite_Animation.prototype=Object.create(Sprite.prototype),Sprite_Animation.prototype.constructor=Sprite_Animation,Sprite_Animation._checker1={},Sprite_Animation._checker2={},Sprite_Animation.prototype.initialize=function(){Sprite.prototype.initialize.call(this),this._reduceArtifacts=!0,this.initMembers()},Sprite_Animation.prototype.initMembers=function(){this._target=null,this._animation=null,this._mirror=!1,this._delay=0,this._rate=4,this._duration=0,this._flashColor=[0,0,0,0],this._flashDuration=0,this._screenFlashDuration=0,this._hidingDuration=0,this._bitmap1=null,this._bitmap2=null,this._cellSprites=[],this._screenFlashSprite=null,this._duplicated=!1,this.z=8},Sprite_Animation.prototype.setup=function(t,e,i,r){this._target=t,this._animation=e,this._mirror=i,this._delay=r,this._animation&&(this.remove(),this.setupRate(),this.setupDuration(),this.loadBitmaps(),this.createSprites())},Sprite_Animation.prototype.remove=function(){this.parent&&this.parent.removeChild(this)&&(this._target.setBlendColor([0,0,0,0]),this._target.show())},Sprite_Animation.prototype.setupRate=function(){this._rate=4},Sprite_Animation.prototype.setupDuration=function(){this._duration=this._animation.frames.length*this._rate+1},Sprite_Animation.prototype.update=function(){Sprite.prototype.update.call(this),this.updateMain(),this.updateFlash(),this.updateScreenFlash(),this.updateHiding(),Sprite_Animation._checker1={},Sprite_Animation._checker2={}},Sprite_Animation.prototype.updateFlash=function(){if(this._flashDuration>0){var t=this._flashDuration--;this._flashColor[3]*=(t-1)/t,this._target.setBlendColor(this._flashColor)}};Sprite_Animation.prototype.updateScreenFlash=function(){if(this._screenFlashDuration>0){var t=this._screenFlashDuration--;this._screenFlashSprite&&(this._screenFlashSprite.x=-this.absoluteX(),this._screenFlashSprite.y=-this.absoluteY(),this._screenFlashSprite.opacity*=(t-1)/t,this._screenFlashSprite.visible=this._screenFlashDuration>0)}},Sprite_Animation.prototype.absoluteX=function(){for(var t=0,e=this;e;)t+=e.x,e=e.parent;return t},Sprite_Animation.prototype.absoluteY=function(){for(var t=0,e=this;e;)t+=e.y,e=e.parent;return t},Sprite_Animation.prototype.updateHiding=function(){this._hidingDuration>0&&(this._hidingDuration--,0===this._hidingDuration&&this._target.show())},Sprite_Animation.prototype.isPlaying=function(){return this._duration>0},Sprite_Animation.prototype.loadBitmaps=function(){var t=this._animation.animation2Name,e=this._animation.animation2Hue;this._bitmap1=ImageManager.loadAnimation(this._animation.animation1Name,this._animation.animation1Hue),this._bitmap2=ImageManager.loadAnimation(t,e)},Sprite_Animation.prototype.isReady=function(){return this._bitmap1&&this._bitmap1.isReady()&&this._bitmap2&&this._bitmap2.isReady()},Sprite_Animation.prototype.createSprites=function(){Sprite_Animation._checker2[this._animation]||(this.createCellSprites(),3===this._animation.position&&(Sprite_Animation._checker2[this._animation]=!0),this.createScreenFlashSprite()),Sprite_Animation._checker1[this._animation]?this._duplicated=!0:(this._duplicated=!1,3===this._animation.position&&(Sprite_Animation._checker1[this._animation]=!0))},Sprite_Animation.prototype.createCellSprites=function(){this._cellSprites=[];for(var t=0;t<16;t++){var e=new Sprite;e.anchor.x=.5,e.anchor.y=.5,this._cellSprites.push(e),this.addChild(e)}},Sprite_Animation.prototype.createScreenFlashSprite=function(){this._screenFlashSprite=new ScreenSprite,this.addChild(this._screenFlashSprite)},Sprite_Animation.prototype.updateMain=function(){this.isPlaying()&&this.isReady()&&(this._delay>0?this._delay--:(this._duration--,this.updatePosition(),this._duration%this._rate==0&&this.updateFrame()))},Sprite_Animation.prototype.updatePosition=function(){if(3===this._animation.position)this.x=this.parent.width/2,this.y=this.parent.height/2;else{var t=this._target.parent,e=t?t.parent:null;this.x=this._target.x,this.y=this._target.y,this.parent===e&&(this.x+=t.x,this.y+=t.y),0===this._animation.position?this.y-=this._target.height:1===this._animation.position&&(this.y-=this._target.height/2)}},Sprite_Animation.prototype.updateFrame=function(){if(this._duration>0){var t=this.currentFrameIndex();this.updateAllCellSprites(this._animation.frames[t]),this._animation.timings.forEach(function(e){e.frame===t&&this.processTimingData(e)},this)}},Sprite_Animation.prototype.currentFrameIndex=function(){return this._animation.frames.length-Math.floor((this._duration+this._rate-1)/this._rate)},Sprite_Animation.prototype.updateAllCellSprites=function(t){for(var e=0;e<this._cellSprites.length;e++){var i=this._cellSprites[e];e<t.length?this.updateCellSprite(i,t[e]):i.visible=!1}},Sprite_Animation.prototype.updateCellSprite=function(t,e){var i=e[0];if(i>=0){var r=i%5*192,n=192*Math.floor(i%100/5),a=this._mirror;t.bitmap=i<100?this._bitmap1:this._bitmap2,t.setFrame(r,n,192,192),t.x=e[1],t.y=e[2],t.rotation=e[4]*Math.PI/180,t.scale.x=e[3]/100,e[5]&&(t.scale.x*=-1),a&&(t.x*=-1,t.rotation*=-1,t.scale.x*=-1),t.scale.y=e[3]/100,t.opacity=e[6],t.blendMode=e[7],t.visible=!0}else t.visible=!1},Sprite_Animation.prototype.processTimingData=function(t){var e=t.flashDuration*this._rate;switch(t.flashScope){case 1:this.startFlash(t.flashColor,e);break;case 2:this.startScreenFlash(t.flashColor,e);break;case 3:this.startHiding(e)}!this._duplicated&&t.se&&AudioManager.playSe(t.se)},Sprite_Animation.prototype.startFlash=function(t,e){this._flashColor=t.clone(),this._flashDuration=e},Sprite_Animation.prototype.startScreenFlash=function(t,e){this._screenFlashDuration=e,this._screenFlashSprite&&(this._screenFlashSprite.setColor(t[0],t[1],t[2]),this._screenFlashSprite.opacity=t[3])},Sprite_Animation.prototype.startHiding=function(t){this._hidingDuration=t,this._target.hide()},Sprite_Damage.prototype=Object.create(Sprite.prototype),Sprite_Damage.prototype.constructor=Sprite_Damage,Sprite_Damage.prototype.initialize=function(){Sprite.prototype.initialize.call(this),this._duration=90,this._flashColor=[0,0,0,0],this._flashDuration=0,this._damageBitmap=ImageManager.loadSystem("Damage")},Sprite_Damage.prototype.setup=function(t){var e=t.result();e.missed||e.evaded?this.createMiss():e.hpAffected?this.createDigits(0,e.hpDamage):t.isAlive()&&0!==e.mpDamage&&this.createDigits(2,e.mpDamage),e.critical&&this.setupCriticalEffect()},Sprite_Damage.prototype.setupCriticalEffect=function(){this._flashColor=[255,0,0,160],this._flashDuration=60},Sprite_Damage.prototype.digitWidth=function(){return this._damageBitmap?this._damageBitmap.width/10:0},Sprite_Damage.prototype.digitHeight=function(){return this._damageBitmap?this._damageBitmap.height/5:0},Sprite_Damage.prototype.createMiss=function(){var t=this.digitWidth(),e=this.digitHeight(),i=this.createChildSprite();i.setFrame(0,4*e,4*t,e),i.dy=0},Sprite_Damage.prototype.createDigits=function(t,e){for(var i=Math.abs(e).toString(),r=t+(e<0?1:0),n=this.digitWidth(),a=this.digitHeight(),o=0;o<i.length;o++){var s=this.createChildSprite(),h=Number(i[o]);s.setFrame(h*n,r*a,n,a),s.x=(o-(i.length-1)/2)*n,s.dy=-o}},Sprite_Damage.prototype.createChildSprite=function(){var t=new Sprite;return t.bitmap=this._damageBitmap,t.anchor.x=.5,t.anchor.y=1,t.y=-40,t.ry=t.y,this.addChild(t),t},Sprite_Damage.prototype.update=function(){if(Sprite.prototype.update.call(this),this._duration>0){this._duration--;for(var t=0;t<this.children.length;t++)this.updateChild(this.children[t])}this.updateFlash(),this.updateOpacity()},Sprite_Damage.prototype.updateChild=function(t){t.dy+=.5,t.ry+=t.dy,t.ry>=0&&(t.ry=0,t.dy*=-.6),t.y=Math.round(t.ry),t.setBlendColor(this._flashColor)},Sprite_Damage.prototype.updateFlash=function(){if(this._flashDuration>0){var t=this._flashDuration--;this._flashColor[3]*=(t-1)/t}},Sprite_Damage.prototype.updateOpacity=function(){this._duration<10&&(this.opacity=255*this._duration/10)},Sprite_Damage.prototype.isPlaying=function(){return this._duration>0},Sprite_StateIcon.prototype=Object.create(Sprite.prototype),Sprite_StateIcon.prototype.constructor=Sprite_StateIcon,Sprite_StateIcon.prototype.initialize=function(){Sprite.prototype.initialize.call(this),this.initMembers(),this.loadBitmap()},Sprite_StateIcon._iconWidth=32,Sprite_StateIcon._iconHeight=32,Sprite_StateIcon.prototype.initMembers=function(){this._battler=null,this._iconIndex=0,this._animationCount=0,this._animationIndex=0,this.anchor.x=.5,this.anchor.y=.5},Sprite_StateIcon.prototype.loadBitmap=function(){this.bitmap=ImageManager.loadSystem("IconSet"),this.setFrame(0,0,0,0)},Sprite_StateIcon.prototype.setup=function(t){this._battler=t},Sprite_StateIcon.prototype.update=function(){Sprite.prototype.update.call(this),this._animationCount++,this._animationCount>=this.animationWait()&&(this.updateIcon(),this.updateFrame(),this._animationCount=0)},Sprite_StateIcon.prototype.animationWait=function(){return 40},Sprite_StateIcon.prototype.updateIcon=function(){var t=[];this._battler&&this._battler.isAlive()&&(t=this._battler.allIcons()),t.length>0?(this._animationIndex++,this._animationIndex>=t.length&&(this._animationIndex=0),this._iconIndex=t[this._animationIndex]):(this._animationIndex=0,this._iconIndex=0)},Sprite_StateIcon.prototype.updateFrame=function(){var t=Sprite_StateIcon._iconWidth,e=Sprite_StateIcon._iconHeight,i=this._iconIndex%16*t,r=Math.floor(this._iconIndex/16)*e;this.setFrame(i,r,t,e)},Sprite_StateOverlay.prototype=Object.create(Sprite_Base.prototype),Sprite_StateOverlay.prototype.constructor=Sprite_StateOverlay,Sprite_StateOverlay.prototype.initialize=function(){Sprite_Base.prototype.initialize.call(this),this.initMembers(),this.loadBitmap()},Sprite_StateOverlay.prototype.initMembers=function(){this._battler=null,this._overlayIndex=0,this._animationCount=0,this._pattern=0,this.anchor.x=.5,this.anchor.y=1},Sprite_StateOverlay.prototype.loadBitmap=function(){this.bitmap=ImageManager.loadSystem("States"),this.setFrame(0,0,0,0)},Sprite_StateOverlay.prototype.setup=function(t){this._battler=t},Sprite_StateOverlay.prototype.update=function(){Sprite_Base.prototype.update.call(this),this._animationCount++,this._animationCount>=this.animationWait()&&(this.updatePattern(),this.updateFrame(),this._animationCount=0)},Sprite_StateOverlay.prototype.animationWait=function(){return 8},Sprite_StateOverlay.prototype.updatePattern=function(){this._pattern++,this._pattern%=8,this._battler&&(this._overlayIndex=this._battler.stateOverlayIndex())},Sprite_StateOverlay.prototype.updateFrame=function(){this._overlayIndex>0?this.setFrame(96*this._pattern,96*(this._overlayIndex-1),96,96):this.setFrame(0,0,0,0)},Sprite_Weapon.prototype=Object.create(Sprite_Base.prototype),Sprite_Weapon.prototype.constructor=Sprite_Weapon,Sprite_Weapon.prototype.initialize=function(){Sprite_Base.prototype.initialize.call(this),this.initMembers()},Sprite_Weapon.prototype.initMembers=function(){this._weaponImageId=0,this._animationCount=0,this._pattern=0,this.anchor.x=.5,this.anchor.y=1,this.x=-16},Sprite_Weapon.prototype.setup=function(t){this._weaponImageId=t,this._animationCount=0,this._pattern=0,this.loadBitmap(),this.updateFrame()},Sprite_Weapon.prototype.update=function(){Sprite_Base.prototype.update.call(this),this._animationCount++,this._animationCount>=this.animationWait()&&(this.updatePattern(),this.updateFrame(),this._animationCount=0)},Sprite_Weapon.prototype.animationWait=function(){return 12},Sprite_Weapon.prototype.updatePattern=function(){this._pattern++,this._pattern>=3&&(this._weaponImageId=0)},Sprite_Weapon.prototype.loadBitmap=function(){var t=Math.floor((this._weaponImageId-1)/12)+1;this.bitmap=ImageManager.loadSystem(t>=1?"Weapons"+t:"")},Sprite_Weapon.prototype.updateFrame=function(){if(this._weaponImageId>0){var t=(this._weaponImageId-1)%12,e=96*(3*Math.floor(t/6)+this._pattern),i=64*Math.floor(t%6);this.setFrame(e,i,96,64)}else this.setFrame(0,0,0,0)},Sprite_Weapon.prototype.isPlaying=function(){return this._weaponImageId>0},Sprite_Balloon.prototype=Object.create(Sprite_Base.prototype),Sprite_Balloon.prototype.constructor=Sprite_Balloon,Sprite_Balloon.prototype.initialize=function(){Sprite_Base.prototype.initialize.call(this),this.initMembers(),this.loadBitmap()},Sprite_Balloon.prototype.initMembers=function(){this._balloonId=0,this._duration=0,this.anchor.x=.5,this.anchor.y=1,this.z=7},Sprite_Balloon.prototype.loadBitmap=function(){this.bitmap=ImageManager.loadSystem("Balloon"),this.setFrame(0,0,0,0)},Sprite_Balloon.prototype.setup=function(t){this._balloonId=t,this._duration=8*this.speed()+this.waitTime()},Sprite_Balloon.prototype.update=function(){Sprite_Base.prototype.update.call(this),this._duration>0&&(this._duration--,this._duration>0&&this.updateFrame())},Sprite_Balloon.prototype.updateFrame=function(){var t=48*this.frameIndex();this.setFrame(t,48*(this._balloonId-1),48,48)},Sprite_Balloon.prototype.speed=function(){return 8},Sprite_Balloon.prototype.waitTime=function(){return 12},Sprite_Balloon.prototype.frameIndex=function(){var t=(this._duration-this.waitTime())/this.speed();return 7-Math.max(Math.floor(t),0)},Sprite_Balloon.prototype.isPlaying=function(){return this._duration>0},Sprite_Picture.prototype=Object.create(Sprite.prototype),Sprite_Picture.prototype.constructor=Sprite_Picture,Sprite_Picture.prototype.initialize=function(t){Sprite.prototype.initialize.call(this),this._pictureId=t,this._pictureName="",this._isPicture=!0,this.update()},Sprite_Picture.prototype.picture=function(){return $gameScreen.picture(this._pictureId)},Sprite_Picture.prototype.update=function(){Sprite.prototype.update.call(this),this.updateBitmap(),this.visible&&(this.updateOrigin(),this.updatePosition(),this.updateScale(),this.updateTone(),this.updateOther())},Sprite_Picture.prototype.updateBitmap=function(){var t=this.picture();if(t){var e=t.name();this._pictureName!==e&&(this._pictureName=e,this.loadBitmap()),this.visible=!0}else this._pictureName="",this.bitmap=null,this.visible=!1},Sprite_Picture.prototype.updateOrigin=function(){0===this.picture().origin()?(this.anchor.x=0,this.anchor.y=0):(this.anchor.x=.5,this.anchor.y=.5)},Sprite_Picture.prototype.updatePosition=function(){var t=this.picture();this.x=Math.floor(t.x()),this.y=Math.floor(t.y())},Sprite_Picture.prototype.updateScale=function(){var t=this.picture();this.scale.x=t.scaleX()/100,this.scale.y=t.scaleY()/100},Sprite_Picture.prototype.updateTone=function(){var t=this.picture();t.tone()?this.setColorTone(t.tone()):this.setColorTone([0,0,0,0])},Sprite_Picture.prototype.updateOther=function(){var t=this.picture();this.opacity=t.opacity(),this.blendMode=t.blendMode(),this.rotation=t.angle()*Math.PI/180},Sprite_Picture.prototype.loadBitmap=function(){this.bitmap=ImageManager.loadPicture(this._pictureName)},Sprite_Timer.prototype=Object.create(Sprite.prototype),Sprite_Timer.prototype.constructor=Sprite_Timer,Sprite_Timer.prototype.initialize=function(){Sprite.prototype.initialize.call(this),this._seconds=0,this.createBitmap(),this.update()},Sprite_Timer.prototype.createBitmap=function(){this.bitmap=new Bitmap(96,48),this.bitmap.fontSize=32},Sprite_Timer.prototype.update=function(){Sprite.prototype.update.call(this),this.updateBitmap(),this.updatePosition(),this.updateVisibility()},Sprite_Timer.prototype.updateBitmap=function(){this._seconds!==$gameTimer.seconds()&&(this._seconds=$gameTimer.seconds(),this.redraw())},Sprite_Timer.prototype.redraw=function(){var t=this.timerText(),e=this.bitmap.width,i=this.bitmap.height;this.bitmap.clear(),this.bitmap.drawText(t,0,0,e,i,"center")},Sprite_Timer.prototype.timerText=function(){var t=Math.floor(this._seconds/60)%60,e=this._seconds%60;return t.padZero(2)+":"+e.padZero(2)},Sprite_Timer.prototype.updatePosition=function(){this.x=Graphics.width-this.bitmap.width,this.y=0},Sprite_Timer.prototype.updateVisibility=function(){this.visible=$gameTimer.isWorking()},Sprite_Destination.prototype=Object.create(Sprite.prototype),Sprite_Destination.prototype.constructor=Sprite_Destination,Sprite_Destination.prototype.initialize=function(){Sprite.prototype.initialize.call(this),this.createBitmap(),this._frameCount=0},Sprite_Destination.prototype.update=function(){Sprite.prototype.update.call(this),$gameTemp.isDestinationValid()?(this.updatePosition(),this.updateAnimation(),this.visible=!0):(this._frameCount=0,this.visible=!1)},Sprite_Destination.prototype.createBitmap=function(){var t=$gameMap.tileWidth(),e=$gameMap.tileHeight();this.bitmap=new Bitmap(t,e),this.bitmap.fillAll("white"),this.anchor.x=.5,this.anchor.y=.5,this.blendMode=Graphics.BLEND_ADD},Sprite_Destination.prototype.updatePosition=function(){var t=$gameMap.tileWidth(),e=$gameMap.tileHeight(),i=$gameTemp.destinationX(),r=$gameTemp.destinationY();this.x=($gameMap.adjustX(i)+.5)*t,this.y=($gameMap.adjustY(r)+.5)*e},Sprite_Destination.prototype.updateAnimation=function(){this._frameCount++,this._frameCount%=20,this.opacity=6*(20-this._frameCount),this.scale.x=1+this._frameCount/20,this.scale.y=this.scale.x},Spriteset_Base.prototype=Object.create(Sprite.prototype),Spriteset_Base.prototype.constructor=Spriteset_Base,Spriteset_Base.prototype.initialize=function(){Sprite.prototype.initialize.call(this),this.setFrame(0,0,Graphics.width,Graphics.height),this._tone=[0,0,0,0],this.opaque=!0,this.createLowerLayer(),this.createToneChanger(),this.createUpperLayer(),this.update()},Spriteset_Base.prototype.createLowerLayer=function(){this.createBaseSprite()},Spriteset_Base.prototype.createUpperLayer=function(){this.createPictures(),this.createTimer(),this.createScreenSprites()},Spriteset_Base.prototype.update=function(){Sprite.prototype.update.call(this),this.updateScreenSprites(),this.updateToneChanger(),this.updatePosition()},Spriteset_Base.prototype.createBaseSprite=function(){this._baseSprite=new Sprite,this._baseSprite.setFrame(0,0,this.width,this.height),this._blackScreen=new ScreenSprite,this._blackScreen.opacity=255,this.addChild(this._baseSprite),this._baseSprite.addChild(this._blackScreen)},Spriteset_Base.prototype.createToneChanger=function(){Graphics.isWebGL()?this.createWebGLToneChanger():this.createCanvasToneChanger()},Spriteset_Base.prototype.createWebGLToneChanger=function(){var t=Graphics.width+96,e=Graphics.height+96;this._toneFilter=new ToneFilter,this._baseSprite.filters=[this._toneFilter],this._baseSprite.filterArea=new Rectangle(-48,-48,t,e)},Spriteset_Base.prototype.createCanvasToneChanger=function(){this._toneSprite=new ToneSprite,this.addChild(this._toneSprite)},Spriteset_Base.prototype.createPictures=function(){var t=Graphics.boxWidth,e=Graphics.boxHeight,i=(Graphics.width-t)/2,r=(Graphics.height-e)/2;this._pictureContainer=new Sprite,this._pictureContainer.setFrame(i,r,t,e);for(var n=1;n<=$gameScreen.maxPictures();n++)this._pictureContainer.addChild(new Sprite_Picture(n));this.addChild(this._pictureContainer)},Spriteset_Base.prototype.createTimer=function(){this._timerSprite=new Sprite_Timer,this.addChild(this._timerSprite)},Spriteset_Base.prototype.createScreenSprites=function(){this._flashSprite=new ScreenSprite,this._fadeSprite=new ScreenSprite,this.addChild(this._flashSprite),this.addChild(this._fadeSprite)},Spriteset_Base.prototype.updateScreenSprites=function(){var t=$gameScreen.flashColor();this._flashSprite.setColor(t[0],t[1],t[2]),this._flashSprite.opacity=t[3],this._fadeSprite.opacity=255-$gameScreen.brightness()},Spriteset_Base.prototype.updateToneChanger=function(){var t=$gameScreen.tone();this._tone.equals(t)||(this._tone=t.clone(),Graphics.isWebGL()?this.updateWebGLToneChanger():this.updateCanvasToneChanger())},Spriteset_Base.prototype.updateWebGLToneChanger=function(){var t=this._tone;this._toneFilter.reset(),this._toneFilter.adjustTone(t[0],t[1],t[2]),this._toneFilter.adjustSaturation(-t[3])},Spriteset_Base.prototype.updateCanvasToneChanger=function(){var t=this._tone;this._toneSprite.setTone(t[0],t[1],t[2],t[3])},Spriteset_Base.prototype.updatePosition=function(){var t=$gameScreen,e=t.zoomScale();this.scale.x=e,this.scale.y=e,this.x=Math.round(-t.zoomX()*(e-1)),this.y=Math.round(-t.zoomY()*(e-1)),this.x+=Math.round(t.shake())},Spriteset_Map.prototype=Object.create(Spriteset_Base.prototype),Spriteset_Map.prototype.constructor=Spriteset_Map,Spriteset_Map.prototype.initialize=function(){Spriteset_Base.prototype.initialize.call(this)},Spriteset_Map.prototype.createLowerLayer=function(){Spriteset_Base.prototype.createLowerLayer.call(this),this.createParallax(),this.createTilemap(),this.createCharacters(),this.createShadow(),this.createDestination(),this.createWeather()},Spriteset_Map.prototype.update=function(){Spriteset_Base.prototype.update.call(this),this.updateTileset(),this.updateParallax(),this.updateTilemap(),this.updateShadow(),this.updateWeather()},Spriteset_Map.prototype.hideCharacters=function(){for(var t=0;t<this._characterSprites.length;t++){var e=this._characterSprites[t];e.isTile()||e.hide()}},Spriteset_Map.prototype.createParallax=function(){this._parallax=new TilingSprite,this._parallax.move(0,0,Graphics.width,Graphics.height),this._baseSprite.addChild(this._parallax)},Spriteset_Map.prototype.createTilemap=function(){this._tilemap=Graphics.isWebGL()?new ShaderTilemap:new Tilemap,this._tilemap.tileWidth=$gameMap.tileWidth(),this._tilemap.tileHeight=$gameMap.tileHeight(),this._tilemap.setData($gameMap.width(),$gameMap.height(),$gameMap.data()),this._tilemap.horizontalWrap=$gameMap.isLoopHorizontal(),this._tilemap.verticalWrap=$gameMap.isLoopVertical(),this.loadTileset(),this._baseSprite.addChild(this._tilemap)},Spriteset_Map.prototype.loadTileset=function(){if(this._tileset=$gameMap.tileset(),this._tileset){for(var t=this._tileset.tilesetNames,e=0;e<t.length;e++)this._tilemap.bitmaps[e]=ImageManager.loadTileset(t[e]);var i=$gameMap.tilesetFlags();this._tilemap.refreshTileset(),this._tilemap.flags.equals(i)||this._tilemap.refresh(),this._tilemap.flags=i}},Spriteset_Map.prototype.createCharacters=function(){this._characterSprites=[],$gameMap.events().forEach(function(t){this._characterSprites.push(new Sprite_Character(t))},this),$gameMap.vehicles().forEach(function(t){this._characterSprites.push(new Sprite_Character(t))},this),$gamePlayer.followers().reverseEach(function(t){this._characterSprites.push(new Sprite_Character(t))},this),this._characterSprites.push(new Sprite_Character($gamePlayer));for(var t=0;t<this._characterSprites.length;t++)this._tilemap.addChild(this._characterSprites[t])},Spriteset_Map.prototype.createShadow=function(){this._shadowSprite=new Sprite,this._shadowSprite.bitmap=ImageManager.loadSystem("Shadow1"),this._shadowSprite.anchor.x=.5,this._shadowSprite.anchor.y=1,this._shadowSprite.z=6,this._tilemap.addChild(this._shadowSprite)},Spriteset_Map.prototype.createDestination=function(){this._destinationSprite=new Sprite_Destination,this._destinationSprite.z=9,this._tilemap.addChild(this._destinationSprite)},Spriteset_Map.prototype.createWeather=function(){this._weather=new Weather,this.addChild(this._weather)},Spriteset_Map.prototype.updateTileset=function(){this._tileset!==$gameMap.tileset()&&this.loadTileset()},Spriteset_Map.prototype._canvasReAddParallax=function(){var t=this._baseSprite.children.indexOf(this._parallax);this._baseSprite.removeChild(this._parallax),this._parallax=new TilingSprite,this._parallax.move(0,0,Graphics.width,Graphics.height),this._parallax.bitmap=ImageManager.loadParallax(this._parallaxName),this._baseSprite.addChildAt(this._parallax,t)},Spriteset_Map.prototype.updateParallax=function(){this._parallaxName!==$gameMap.parallaxName()&&(this._parallaxName=$gameMap.parallaxName(),this._parallax.bitmap&&1!=Graphics.isWebGL()?this._canvasReAddParallax():this._parallax.bitmap=ImageManager.loadParallax(this._parallaxName)),this._parallax.bitmap&&(this._parallax.origin.x=$gameMap.parallaxOx(),this._parallax.origin.y=$gameMap.parallaxOy())},Spriteset_Map.prototype.updateTilemap=function(){this._tilemap.origin.x=$gameMap.displayX()*$gameMap.tileWidth(),this._tilemap.origin.y=$gameMap.displayY()*$gameMap.tileHeight()},Spriteset_Map.prototype.updateShadow=function(){var t=$gameMap.airship();this._shadowSprite.x=t.shadowX(),this._shadowSprite.y=t.shadowY(),this._shadowSprite.opacity=t.shadowOpacity()},Spriteset_Map.prototype.updateWeather=function(){this._weather.type=$gameScreen.weatherType(),this._weather.power=$gameScreen.weatherPower(),this._weather.origin.x=$gameMap.displayX()*$gameMap.tileWidth(),this._weather.origin.y=$gameMap.displayY()*$gameMap.tileHeight()},Spriteset_Battle.prototype=Object.create(Spriteset_Base.prototype),Spriteset_Battle.prototype.constructor=Spriteset_Battle,Spriteset_Battle.prototype.initialize=function(){Spriteset_Base.prototype.initialize.call(this),this._battlebackLocated=!1},Spriteset_Battle.prototype.createLowerLayer=function(){Spriteset_Base.prototype.createLowerLayer.call(this),this.createBackground(),this.createBattleField(),this.createBattleback(),this.createEnemies(),this.createActors()},Spriteset_Battle.prototype.createBackground=function(){this._backgroundSprite=new Sprite,this._backgroundSprite.bitmap=SceneManager.backgroundBitmap(),this._baseSprite.addChild(this._backgroundSprite)},Spriteset_Battle.prototype.update=function(){Spriteset_Base.prototype.update.call(this),this.updateActors(),this.updateBattleback()},Spriteset_Battle.prototype.createBattleField=function(){var t=Graphics.boxWidth,e=Graphics.boxHeight,i=(Graphics.width-t)/2,r=(Graphics.height-e)/2;this._battleField=new Sprite,this._battleField.setFrame(i,r,t,e),this._battleField.x=i,this._battleField.y=r,this._baseSprite.addChild(this._battleField)},Spriteset_Battle.prototype.createBattleback=function(){var t=-this._battleField.x-32,e=-this._battleField.y-32,i=Graphics.width+64,r=Graphics.height+64;this._back1Sprite=new TilingSprite,this._back2Sprite=new TilingSprite,this._back1Sprite.bitmap=this.battleback1Bitmap(),this._back2Sprite.bitmap=this.battleback2Bitmap(),this._back1Sprite.move(t,e,i,r),this._back2Sprite.move(t,e,i,r),this._battleField.addChild(this._back1Sprite),this._battleField.addChild(this._back2Sprite)},Spriteset_Battle.prototype.updateBattleback=function(){this._battlebackLocated||(this.locateBattleback(),this._battlebackLocated=!0)},Spriteset_Battle.prototype.locateBattleback=function(){var t=this._battleField.width,e=this._battleField.height,i=this._back1Sprite,r=this._back2Sprite;i.origin.x=i.x+(i.bitmap.width-t)/2,r.origin.x=i.y+(r.bitmap.width-t)/2,$gameSystem.isSideView()&&(i.origin.y=i.x+i.bitmap.height-e,r.origin.y=i.y+r.bitmap.height-e)},Spriteset_Battle.prototype.battleback1Bitmap=function(){return ImageManager.loadBattleback1(this.battleback1Name())},Spriteset_Battle.prototype.battleback2Bitmap=function(){return ImageManager.loadBattleback2(this.battleback2Name())},Spriteset_Battle.prototype.battleback1Name=function(){return BattleManager.isBattleTest()?$dataSystem.battleback1Name:$gameMap.battleback1Name()?$gameMap.battleback1Name():$gameMap.isOverworld()?this.overworldBattleback1Name():""},Spriteset_Battle.prototype.battleback2Name=function(){return BattleManager.isBattleTest()?$dataSystem.battleback2Name:$gameMap.battleback2Name()?$gameMap.battleback2Name():$gameMap.isOverworld()?this.overworldBattleback2Name():""},Spriteset_Battle.prototype.overworldBattleback1Name=function(){return""===$gameMap.battleback1Name()?"":$gamePlayer.isInVehicle()?this.shipBattleback1Name():this.normalBattleback1Name()},Spriteset_Battle.prototype.overworldBattleback2Name=function(){return""===$gameMap.battleback2Name()?"":$gamePlayer.isInVehicle()?this.shipBattleback2Name():this.normalBattleback2Name()},Spriteset_Battle.prototype.normalBattleback1Name=function(){return this.terrainBattleback1Name(this.autotileType(1))||this.terrainBattleback1Name(this.autotileType(0))||this.defaultBattleback1Name()},Spriteset_Battle.prototype.normalBattleback2Name=function(){return this.terrainBattleback2Name(this.autotileType(1))||this.terrainBattleback2Name(this.autotileType(0))||this.defaultBattleback2Name()},Spriteset_Battle.prototype.terrainBattleback1Name=function(t){switch(t){case 24:case 25:return"Wasteland";case 26:case 27:return"DirtField";case 32:case 33:return"Desert";case 34:return"Lava1";case 35:return"Lava2";case 40:case 41:return"Snowfield";case 42:return"Clouds";case 4:case 5:return"PoisonSwamp";default:return null}},Spriteset_Battle.prototype.terrainBattleback2Name=function(t){switch(t){case 20:case 21:return"Forest";case 22:case 30:case 38:return"Cliff";case 24:case 25:case 26:case 27:return"Wasteland";case 32:case 33:return"Desert";case 34:case 35:return"Lava";case 40:case 41:return"Snowfield";case 42:return"Clouds";case 4:case 5:return"PoisonSwamp"}},Spriteset_Battle.prototype.defaultBattleback1Name=function(){return"Grassland"},Spriteset_Battle.prototype.defaultBattleback2Name=function(){return"Grassland"},Spriteset_Battle.prototype.shipBattleback1Name=function(){return"Ship"},Spriteset_Battle.prototype.shipBattleback2Name=function(){return"Ship"},Spriteset_Battle.prototype.autotileType=function(t){return $gameMap.autotileType($gamePlayer.x,$gamePlayer.y,t)},Spriteset_Battle.prototype.createEnemies=function(){for(var t=$gameTroop.members(),e=[],i=0;i<t.length;i++)e[i]=new Sprite_Enemy(t[i]);e.sort(this.compareEnemySprite.bind(this));for(var r=0;r<e.length;r++)this._battleField.addChild(e[r]);this._enemySprites=e},Spriteset_Battle.prototype.compareEnemySprite=function(t,e){return t.y!==e.y?t.y-e.y:e.spriteId-t.spriteId},Spriteset_Battle.prototype.createActors=function(){this._actorSprites=[];for(var t=0;t<$gameParty.maxBattleMembers();t++)this._actorSprites[t]=new Sprite_Actor,this._battleField.addChild(this._actorSprites[t])},Spriteset_Battle.prototype.updateActors=function(){for(var t=$gameParty.battleMembers(),e=0;e<this._actorSprites.length;e++)this._actorSprites[e].setBattler(t[e])},Spriteset_Battle.prototype.battlerSprites=function(){return this._enemySprites.concat(this._actorSprites)},Spriteset_Battle.prototype.isAnimationPlaying=function(){return this.battlerSprites().some(function(t){return t.isAnimationPlaying()})},Spriteset_Battle.prototype.isEffecting=function(){return this.battlerSprites().some(function(t){return t.isEffecting()})},Spriteset_Battle.prototype.isAnyoneMoving=function(){return this.battlerSprites().some(function(t){return t.isMoving()})},Spriteset_Battle.prototype.isBusy=function(){return this.isAnimationPlaying()||this.isAnyoneMoving()},Window_Base.prototype=Object.create(Window.prototype),Window_Base.prototype.constructor=Window_Base,Window_Base.prototype.initialize=function(t,e,i,r){Window.prototype.initialize.call(this),this.loadWindowskin(),this.move(t,e,i,r),this.updatePadding(),this.updateBackOpacity(),this.updateTone(),this.createContents(),this._opening=!1,this._closing=!1,this._dimmerSprite=null},Window_Base._iconWidth=32,Window_Base._iconHeight=32,Window_Base._faceWidth=144,Window_Base._faceHeight=144,Window_Base.prototype.lineHeight=function(){return 36},Window_Base.prototype.standardFontFace=function(){return $gameSystem.isChinese()?"SimHei, Heiti TC, sans-serif":$gameSystem.isKorean()?"Dotum, AppleGothic, sans-serif":"GameFont"},Window_Base.prototype.standardFontSize=function(){return 28},Window_Base.prototype.standardPadding=function(){return 18},Window_Base.prototype.textPadding=function(){return 6},Window_Base.prototype.standardBackOpacity=function(){return 192},Window_Base.prototype.loadWindowskin=function(){this.windowskin=ImageManager.loadSystem("Window")},Window_Base.prototype.updatePadding=function(){this.padding=this.standardPadding()},Window_Base.prototype.updateBackOpacity=function(){this.backOpacity=this.standardBackOpacity()},Window_Base.prototype.contentsWidth=function(){return this.width-2*this.standardPadding()},Window_Base.prototype.contentsHeight=function(){return this.height-2*this.standardPadding()},Window_Base.prototype.fittingHeight=function(t){return t*this.lineHeight()+2*this.standardPadding()},Window_Base.prototype.updateTone=function(){var t=$gameSystem.windowTone();this.setTone(t[0],t[1],t[2])},Window_Base.prototype.createContents=function(){this.contents=new Bitmap(this.contentsWidth(),this.contentsHeight()),this.resetFontSettings()},Window_Base.prototype.resetFontSettings=function(){this.contents.fontFace=this.standardFontFace(),this.contents.fontSize=this.standardFontSize(),this.resetTextColor()},Window_Base.prototype.resetTextColor=function(){this.changeTextColor(this.normalColor())},Window_Base.prototype.update=function(){Window.prototype.update.call(this),this.updateTone(),this.updateOpen(),this.updateClose(),this.updateBackgroundDimmer()},Window_Base.prototype.updateOpen=function(){this._opening&&(this.openness+=32,this.isOpen()&&(this._opening=!1))},Window_Base.prototype.updateClose=function(){this._closing&&(this.openness-=32,this.isClosed()&&(this._closing=!1))},Window_Base.prototype.open=function(){this.isOpen()||(this._opening=!0),this._closing=!1},Window_Base.prototype.close=function(){this.isClosed()||(this._closing=!0),this._opening=!1},Window_Base.prototype.isOpening=function(){return this._opening},Window_Base.prototype.isClosing=function(){return this._closing},Window_Base.prototype.show=function(){this.visible=!0},Window_Base.prototype.hide=function(){this.visible=!1},Window_Base.prototype.activate=function(){this.active=!0},Window_Base.prototype.deactivate=function(){this.active=!1},Window_Base.prototype.textColor=function(t){var e=96+t%8*12+6,i=144+12*Math.floor(t/8)+6;return this.windowskin.getPixel(e,i)},Window_Base.prototype.normalColor=function(){return this.textColor(0)},Window_Base.prototype.systemColor=function(){return this.textColor(16)},Window_Base.prototype.crisisColor=function(){return this.textColor(17)},Window_Base.prototype.deathColor=function(){return this.textColor(18)},Window_Base.prototype.gaugeBackColor=function(){return this.textColor(19)},Window_Base.prototype.hpGaugeColor1=function(){return this.textColor(20)},Window_Base.prototype.hpGaugeColor2=function(){return this.textColor(21)},Window_Base.prototype.mpGaugeColor1=function(){return this.textColor(22)},Window_Base.prototype.mpGaugeColor2=function(){return this.textColor(23)},Window_Base.prototype.mpCostColor=function(){return this.textColor(23)},Window_Base.prototype.powerUpColor=function(){return this.textColor(24)},Window_Base.prototype.powerDownColor=function(){return this.textColor(25)},Window_Base.prototype.tpGaugeColor1=function(){return this.textColor(28)},Window_Base.prototype.tpGaugeColor2=function(){return this.textColor(29)},Window_Base.prototype.tpCostColor=function(){return this.textColor(29)},Window_Base.prototype.pendingColor=function(){return this.windowskin.getPixel(120,120)},Window_Base.prototype.translucentOpacity=function(){return 160},Window_Base.prototype.changeTextColor=function(t){this.contents.textColor=t},Window_Base.prototype.changePaintOpacity=function(t){this.contents.paintOpacity=t?255:this.translucentOpacity()},Window_Base.prototype.drawText=function(t,e,i,r,n){this.contents.drawText(t,e,i,r,this.lineHeight(),n)},Window_Base.prototype.textWidth=function(t){return this.contents.measureTextWidth(t)},Window_Base.prototype.drawTextEx=function(t,e,i){if(t){var r={index:0,x:e,y:i,left:e};for(r.text=this.convertEscapeCharacters(t),r.height=this.calcTextHeight(r,!1),this.resetFontSettings();r.index<r.text.length;)this.processCharacter(r);return r.x-e}return 0},Window_Base.prototype.convertEscapeCharacters=function(t){return(t=(t=(t=(t=(t=(t=t.replace(/\\/g,"\x1b")).replace(/\x1b\x1b/g,"\\")).replace(/\x1bV\[(\d+)\]/gi,(function(){return $gameVariables.value(parseInt(arguments[1]))}).bind(this))).replace(/\x1bV\[(\d+)\]/gi,(function(){return $gameVariables.value(parseInt(arguments[1]))}).bind(this))).replace(/\x1bN\[(\d+)\]/gi,(function(){return this.actorName(parseInt(arguments[1]))}).bind(this))).replace(/\x1bP\[(\d+)\]/gi,(function(){return this.partyMemberName(parseInt(arguments[1]))}).bind(this))).replace(/\x1bG/gi,TextManager.currencyUnit)},Window_Base.prototype.actorName=function(t){var e=t>=1?$gameActors.actor(t):null;return e?e.name():""},Window_Base.prototype.partyMemberName=function(t){var e=t>=1?$gameParty.members()[t-1]:null;return e?e.name():""},Window_Base.prototype.processCharacter=function(t){switch(t.text[t.index]){case"\n":this.processNewLine(t);break;case"\f":this.processNewPage(t);break;case"\x1b":this.processEscapeCharacter(this.obtainEscapeCode(t),t);break;default:this.processNormalCharacter(t)}},Window_Base.prototype.processNormalCharacter=function(t){var e=t.text[t.index++],i=this.textWidth(e);this.contents.drawText(e,t.x,t.y,2*i,t.height),t.x+=i},Window_Base.prototype.processNewLine=function(t){t.x=t.left,t.y+=t.height,t.height=this.calcTextHeight(t,!1),t.index++},Window_Base.prototype.processNewPage=function(t){t.index++},Window_Base.prototype.obtainEscapeCode=function(t){t.index++;var e=/^[\$\.\|\^!><\{\}\\]|^[A-Z]+/i.exec(t.text.slice(t.index));return e?(t.index+=e[0].length,e[0].toUpperCase()):""},Window_Base.prototype.obtainEscapeParam=function(t){var e=/^\[\d+\]/.exec(t.text.slice(t.index));return e?(t.index+=e[0].length,parseInt(e[0].slice(1))):""},Window_Base.prototype.processEscapeCharacter=function(t,e){switch(t){case"C":this.changeTextColor(this.textColor(this.obtainEscapeParam(e)));break;case"I":this.processDrawIcon(this.obtainEscapeParam(e),e);break;case"{":this.makeFontBigger();break;case"}":this.makeFontSmaller()}},Window_Base.prototype.processDrawIcon=function(t,e){this.drawIcon(t,e.x+2,e.y+2),e.x+=Window_Base._iconWidth+4},Window_Base.prototype.makeFontBigger=function(){this.contents.fontSize<=96&&(this.contents.fontSize+=12)},Window_Base.prototype.makeFontSmaller=function(){this.contents.fontSize>=24&&(this.contents.fontSize-=12)},Window_Base.prototype.calcTextHeight=function(t,e){for(var i=this.contents.fontSize,r=0,n=t.text.slice(t.index).split("\n"),a=e?n.length:1,o=0;o<a;o++){for(var s=this.contents.fontSize,h=/\x1b[\{\}]/g;;){var c=h.exec(n[o]);if(!c)break;"\x1b{"===c[0]&&this.makeFontBigger(),"\x1b}"===c[0]&&this.makeFontSmaller(),s<this.contents.fontSize&&(s=this.contents.fontSize)}r+=s+8}return this.contents.fontSize=i,r},Window_Base.prototype.drawIcon=function(t,e,i){var r=ImageManager.loadSystem("IconSet"),n=Window_Base._iconWidth,a=Window_Base._iconHeight,o=t%16*n,s=Math.floor(t/16)*a;this.contents.blt(r,o,s,n,a,e,i)},Window_Base.prototype.drawFace=function(t,e,i,r,n,a){n=n||Window_Base._faceWidth,a=a||Window_Base._faceHeight;var o=ImageManager.loadFace(t),s=Window_Base._faceWidth,h=Window_Base._faceHeight,c=Math.min(n,s),u=Math.min(a,h),p=Math.floor(i+Math.max(n-s,0)/2),l=Math.floor(r+Math.max(a-h,0)/2),d=e%4*s+(s-c)/2,m=Math.floor(e/4)*h+(h-u)/2;this.contents.blt(o,d,m,c,u,p,l)},Window_Base.prototype.drawCharacter=function(t,e,i,r){var n=ImageManager.loadCharacter(t),a=ImageManager.isBigCharacter(t),o=n.width/(a?3:12),s=n.height/(a?4:8),h=(e%4*3+1)*o,c=4*Math.floor(e/4)*s;this.contents.blt(n,h,c,o,s,i-o/2,r-s)},Window_Base.prototype.drawGauge=function(t,e,i,r,n,a){var o=Math.floor(i*r),s=e+this.lineHeight()-8;this.contents.fillRect(t,s,i,6,this.gaugeBackColor()),this.contents.gradientFillRect(t,s,o,6,n,a)},Window_Base.prototype.hpColor=function(t){return t.isDead()?this.deathColor():t.isDying()?this.crisisColor():this.normalColor()},Window_Base.prototype.mpColor=function(t){return this.normalColor()},Window_Base.prototype.tpColor=function(t){return this.normalColor()},Window_Base.prototype.drawActorCharacter=function(t,e,i){this.drawCharacter(t.characterName(),t.characterIndex(),e,i)},Window_Base.prototype.drawActorFace=function(t,e,i,r,n){this.drawFace(t.faceName(),t.faceIndex(),e,i,r,n)},Window_Base.prototype.drawActorName=function(t,e,i,r){r=r||168,this.changeTextColor(this.hpColor(t)),this.drawText(t.name(),e,i,r)},Window_Base.prototype.drawActorClass=function(t,e,i,r){r=r||168,this.resetTextColor(),this.drawText(t.currentClass().name,e,i,r)},Window_Base.prototype.drawActorNickname=function(t,e,i,r){r=r||270,this.resetTextColor(),this.drawText(t.nickname(),e,i,r)},Window_Base.prototype.drawActorLevel=function(t,e,i){this.changeTextColor(this.systemColor()),this.drawText(TextManager.levelA,e,i,48),this.resetTextColor(),this.drawText(t.level,e+84,i,36,"right")},Window_Base.prototype.drawActorIcons=function(t,e,i,r){r=r||144;for(var n=t.allIcons().slice(0,Math.floor(r/Window_Base._iconWidth)),a=0;a<n.length;a++)this.drawIcon(n[a],e+Window_Base._iconWidth*a,i+2)},Window_Base.prototype.drawCurrentAndMax=function(t,e,i,r,n,a,o){var s=this.textWidth("HP"),h=this.textWidth("0000"),c=this.textWidth("/"),u=i+n-h,p=u-c,l=p-h;l>=i+s?(this.changeTextColor(a),this.drawText(t,l,r,h,"right"),this.changeTextColor(o),this.drawText("/",p,r,c,"right"),this.drawText(e,u,r,h,"right")):(this.changeTextColor(a),this.drawText(t,u,r,h,"right"))},Window_Base.prototype.drawActorHp=function(t,e,i,r){r=r||186;var n=this.hpGaugeColor1(),a=this.hpGaugeColor2();this.drawGauge(e,i,r,t.hpRate(),n,a),this.changeTextColor(this.systemColor()),this.drawText(TextManager.hpA,e,i,44),this.drawCurrentAndMax(t.hp,t.mhp,e,i,r,this.hpColor(t),this.normalColor())},Window_Base.prototype.drawActorMp=function(t,e,i,r){r=r||186;var n=this.mpGaugeColor1(),a=this.mpGaugeColor2();this.drawGauge(e,i,r,t.mpRate(),n,a),this.changeTextColor(this.systemColor()),this.drawText(TextManager.mpA,e,i,44),this.drawCurrentAndMax(t.mp,t.mmp,e,i,r,this.mpColor(t),this.normalColor())},Window_Base.prototype.drawActorTp=function(t,e,i,r){r=r||96;var n=this.tpGaugeColor1(),a=this.tpGaugeColor2();this.drawGauge(e,i,r,t.tpRate(),n,a),this.changeTextColor(this.systemColor()),this.drawText(TextManager.tpA,e,i,44),this.changeTextColor(this.tpColor(t)),this.drawText(t.tp,e+r-64,i,64,"right")},Window_Base.prototype.drawActorSimpleStatus=function(t,e,i,r){var n=this.lineHeight(),a=e+180,o=Math.min(200,r-180-this.textPadding());this.drawActorName(t,e,i),this.drawActorLevel(t,e,i+1*n),this.drawActorIcons(t,e,i+2*n),this.drawActorClass(t,a,i),this.drawActorHp(t,a,i+1*n,o),this.drawActorMp(t,a,i+2*n,o)},Window_Base.prototype.drawItemName=function(t,e,i,r){if(r=r||312,t){var n=Window_Base._iconWidth+4;this.resetTextColor(),this.drawIcon(t.iconIndex,e+2,i+2),this.drawText(t.name,e+n,i,r-n)}},Window_Base.prototype.drawCurrencyValue=function(t,e,i,r,n){var a=Math.min(80,this.textWidth(e));this.resetTextColor(),this.drawText(t,i,r,n-a-6,"right"),this.changeTextColor(this.systemColor()),this.drawText(e,i+n-a,r,a,"right")},Window_Base.prototype.paramchangeTextColor=function(t){return t>0?this.powerUpColor():t<0?this.powerDownColor():this.normalColor()},Window_Base.prototype.setBackgroundType=function(t){this.opacity=0===t?255:0,1===t?this.showBackgroundDimmer():this.hideBackgroundDimmer()},Window_Base.prototype.showBackgroundDimmer=function(){this._dimmerSprite||(this._dimmerSprite=new Sprite,this._dimmerSprite.bitmap=new Bitmap(0,0),this.addChildToBack(this._dimmerSprite));var t=this._dimmerSprite.bitmap;t.width===this.width&&t.height===this.height||this.refreshDimmerBitmap(),this._dimmerSprite.visible=!0,this.updateBackgroundDimmer()},Window_Base.prototype.hideBackgroundDimmer=function(){this._dimmerSprite&&(this._dimmerSprite.visible=!1)},Window_Base.prototype.updateBackgroundDimmer=function(){this._dimmerSprite&&(this._dimmerSprite.opacity=this.openness)},Window_Base.prototype.refreshDimmerBitmap=function(){if(this._dimmerSprite){var t=this._dimmerSprite.bitmap,e=this.width,i=this.height,r=this.padding,n=this.dimColor1(),a=this.dimColor2();t.resize(e,i),t.gradientFillRect(0,0,e,r,a,n,!0),t.fillRect(0,r,e,i-2*r,n),t.gradientFillRect(0,i-r,e,r,n,a,!0),this._dimmerSprite.setFrame(0,0,e,i)}},Window_Base.prototype.dimColor1=function(){return"rgba(0, 0, 0, 0.6)"},Window_Base.prototype.dimColor2=function(){return"rgba(0, 0, 0, 0)"},Window_Base.prototype.canvasToLocalX=function(t){for(var e=this;e;)t-=e.x,e=e.parent;return t},Window_Base.prototype.canvasToLocalY=function(t){for(var e=this;e;)t-=e.y,e=e.parent;return t},Window_Base.prototype.reserveFaceImages=function(){$gameParty.members().forEach(function(t){ImageManager.reserveFace(t.faceName())},this)},Window_Selectable.prototype=Object.create(Window_Base.prototype),Window_Selectable.prototype.constructor=Window_Selectable,Window_Selectable.prototype.initialize=function(t,e,i,r){Window_Base.prototype.initialize.call(this,t,e,i,r),this._index=-1,this._cursorFixed=!1,this._cursorAll=!1,this._stayCount=0,this._helpWindow=null,this._handlers={},this._touching=!1,this._scrollX=0,this._scrollY=0,this.deactivate()},Window_Selectable.prototype.index=function(){return this._index},Window_Selectable.prototype.cursorFixed=function(){return this._cursorFixed},Window_Selectable.prototype.setCursorFixed=function(t){this._cursorFixed=t},Window_Selectable.prototype.cursorAll=function(){return this._cursorAll},Window_Selectable.prototype.setCursorAll=function(t){this._cursorAll=t},Window_Selectable.prototype.maxCols=function(){return 1},Window_Selectable.prototype.maxItems=function(){return 0},Window_Selectable.prototype.spacing=function(){return 12},Window_Selectable.prototype.itemWidth=function(){return Math.floor((this.width-2*this.padding+this.spacing())/this.maxCols()-this.spacing())},Window_Selectable.prototype.itemHeight=function(){return this.lineHeight()},Window_Selectable.prototype.maxRows=function(){return Math.max(Math.ceil(this.maxItems()/this.maxCols()),1)},Window_Selectable.prototype.activate=function(){Window_Base.prototype.activate.call(this),this.reselect()},Window_Selectable.prototype.deactivate=function(){Window_Base.prototype.deactivate.call(this),this.reselect()},Window_Selectable.prototype.select=function(t){this._index=t,this._stayCount=0,this.ensureCursorVisible(),this.updateCursor(),this.callUpdateHelp()},Window_Selectable.prototype.deselect=function(){this.select(-1)},Window_Selectable.prototype.reselect=function(){this.select(this._index)},Window_Selectable.prototype.row=function(){return Math.floor(this.index()/this.maxCols())},Window_Selectable.prototype.topRow=function(){return Math.floor(this._scrollY/this.itemHeight())},Window_Selectable.prototype.maxTopRow=function(){return Math.max(0,this.maxRows()-this.maxPageRows())},Window_Selectable.prototype.setTopRow=function(t){var e=t.clamp(0,this.maxTopRow())*this.itemHeight();this._scrollY!==e&&(this._scrollY=e,this.refresh(),this.updateCursor())},Window_Selectable.prototype.resetScroll=function(){this.setTopRow(0)},Window_Selectable.prototype.maxPageRows=function(){return Math.floor((this.height-2*this.padding)/this.itemHeight())},Window_Selectable.prototype.maxPageItems=function(){return this.maxPageRows()*this.maxCols()},Window_Selectable.prototype.isHorizontal=function(){return 1===this.maxPageRows()},Window_Selectable.prototype.bottomRow=function(){return Math.max(0,this.topRow()+this.maxPageRows()-1)},Window_Selectable.prototype.setBottomRow=function(t){this.setTopRow(t-(this.maxPageRows()-1))},Window_Selectable.prototype.topIndex=function(){return this.topRow()*this.maxCols()},Window_Selectable.prototype.itemRect=function(t){var e=new Rectangle,i=this.maxCols();return e.width=this.itemWidth(),e.height=this.itemHeight(),e.x=t%i*(e.width+this.spacing())-this._scrollX,e.y=Math.floor(t/i)*e.height-this._scrollY,e},Window_Selectable.prototype.itemRectForText=function(t){var e=this.itemRect(t);return e.x+=this.textPadding(),e.width-=2*this.textPadding(),e},Window_Selectable.prototype.setHelpWindow=function(t){this._helpWindow=t,this.callUpdateHelp()},Window_Selectable.prototype.showHelpWindow=function(){this._helpWindow&&this._helpWindow.show()},Window_Selectable.prototype.hideHelpWindow=function(){this._helpWindow&&this._helpWindow.hide()},Window_Selectable.prototype.setHandler=function(t,e){this._handlers[t]=e},Window_Selectable.prototype.isHandled=function(t){return!!this._handlers[t]},Window_Selectable.prototype.callHandler=function(t){this.isHandled(t)&&this._handlers[t]()},Window_Selectable.prototype.isOpenAndActive=function(){return this.isOpen()&&this.active},Window_Selectable.prototype.isCursorMovable=function(){return this.isOpenAndActive()&&!this._cursorFixed&&!this._cursorAll&&this.maxItems()>0},Window_Selectable.prototype.cursorDown=function(t){var e=this.index(),i=this.maxItems(),r=this.maxCols();(e<i-r||t&&1===r)&&this.select((e+r)%i)},Window_Selectable.prototype.cursorUp=function(t){var e=this.index(),i=this.maxItems(),r=this.maxCols();(e>=r||t&&1===r)&&this.select((e-r+i)%i)},Window_Selectable.prototype.cursorRight=function(t){var e=this.index(),i=this.maxItems();this.maxCols()>=2&&(e<i-1||t&&this.isHorizontal())&&this.select((e+1)%i)},Window_Selectable.prototype.cursorLeft=function(t){var e=this.index(),i=this.maxItems();this.maxCols()>=2&&(e>0||t&&this.isHorizontal())&&this.select((e-1+i)%i)},Window_Selectable.prototype.cursorPagedown=function(){var t=this.index(),e=this.maxItems();this.topRow()+this.maxPageRows()<this.maxRows()&&(this.setTopRow(this.topRow()+this.maxPageRows()),this.select(Math.min(t+this.maxPageItems(),e-1)))},Window_Selectable.prototype.cursorPageup=function(){var t=this.index();this.topRow()>0&&(this.setTopRow(this.topRow()-this.maxPageRows()),this.select(Math.max(t-this.maxPageItems(),0)))},Window_Selectable.prototype.scrollDown=function(){this.topRow()+1<this.maxRows()&&this.setTopRow(this.topRow()+1)},Window_Selectable.prototype.scrollUp=function(){this.topRow()>0&&this.setTopRow(this.topRow()-1)},Window_Selectable.prototype.update=function(){Window_Base.prototype.update.call(this),this.updateArrows(),this.processCursorMove(),this.processHandling(),this.processWheel(),this.processTouch(),this._stayCount++},Window_Selectable.prototype.updateArrows=function(){var t=this.topRow(),e=this.maxTopRow();this.downArrowVisible=e>0&&t<e,this.upArrowVisible=t>0},Window_Selectable.prototype.processCursorMove=function(){if(this.isCursorMovable()){var t=this.index();Input.isRepeated("down")&&this.cursorDown(Input.isTriggered("down")),Input.isRepeated("up")&&this.cursorUp(Input.isTriggered("up")),Input.isRepeated("right")&&this.cursorRight(Input.isTriggered("right")),Input.isRepeated("left")&&this.cursorLeft(Input.isTriggered("left")),!this.isHandled("pagedown")&&Input.isTriggered("pagedown")&&this.cursorPagedown(),!this.isHandled("pageup")&&Input.isTriggered("pageup")&&this.cursorPageup(),this.index()!==t&&SoundManager.playCursor()}},Window_Selectable.prototype.processHandling=function(){this.isOpenAndActive()&&(this.isOkEnabled()&&this.isOkTriggered()?this.processOk():this.isCancelEnabled()&&this.isCancelTriggered()?this.processCancel():this.isHandled("pagedown")&&Input.isTriggered("pagedown")?this.processPagedown():this.isHandled("pageup")&&Input.isTriggered("pageup")&&this.processPageup())},Window_Selectable.prototype.processWheel=function(){this.isOpenAndActive()&&(TouchInput.wheelY>=20&&this.scrollDown(),TouchInput.wheelY<=-20&&this.scrollUp())},Window_Selectable.prototype.processTouch=function(){this.isOpenAndActive()?(TouchInput.isTriggered()&&this.isTouchedInsideFrame()?(this._touching=!0,this.onTouch(!0)):TouchInput.isCancelled()&&this.isCancelEnabled()&&this.processCancel(),this._touching&&(TouchInput.isPressed()?this.onTouch(!1):this._touching=!1)):this._touching=!1},Window_Selectable.prototype.isTouchedInsideFrame=function(){var t=this.canvasToLocalX(TouchInput.x),e=this.canvasToLocalY(TouchInput.y);return t>=0&&e>=0&&t<this.width&&e<this.height},Window_Selectable.prototype.onTouch=function(t){var e=this.index(),i=this.canvasToLocalX(TouchInput.x),r=this.canvasToLocalY(TouchInput.y),n=this.hitTest(i,r);n>=0?n===this.index()?t&&this.isTouchOkEnabled()&&this.processOk():this.isCursorMovable()&&this.select(n):this._stayCount>=10&&(r<this.padding?this.cursorUp():r>=this.height-this.padding&&this.cursorDown()),this.index()!==e&&SoundManager.playCursor()},Window_Selectable.prototype.hitTest=function(t,e){if(this.isContentsArea(t,e))for(var i=t-this.padding,r=e-this.padding,n=this.topIndex(),a=0;a<this.maxPageItems();a++){var o=n+a;if(o<this.maxItems()){var s=this.itemRect(o);if(i>=s.x&&r>=s.y&&i<s.x+s.width&&r<s.y+s.height)return o}}return-1},Window_Selectable.prototype.isContentsArea=function(t,e){return t>=this.padding&&e>=this.padding&&t<this.width-this.padding&&e<this.height-this.padding},Window_Selectable.prototype.isTouchOkEnabled=function(){return this.isOkEnabled()},Window_Selectable.prototype.isOkEnabled=function(){return this.isHandled("ok")},Window_Selectable.prototype.isCancelEnabled=function(){return this.isHandled("cancel")},Window_Selectable.prototype.isOkTriggered=function(){return Input.isRepeated("ok")},Window_Selectable.prototype.isCancelTriggered=function(){return Input.isRepeated("cancel")},Window_Selectable.prototype.processOk=function(){this.isCurrentItemEnabled()?(this.playOkSound(),this.updateInputData(),this.deactivate(),this.callOkHandler()):this.playBuzzerSound()},Window_Selectable.prototype.playOkSound=function(){SoundManager.playOk()},Window_Selectable.prototype.playBuzzerSound=function(){SoundManager.playBuzzer()},Window_Selectable.prototype.callOkHandler=function(){this.callHandler("ok")},Window_Selectable.prototype.processCancel=function(){SoundManager.playCancel(),this.updateInputData(),this.deactivate(),this.callCancelHandler()},Window_Selectable.prototype.callCancelHandler=function(){this.callHandler("cancel")},Window_Selectable.prototype.processPageup=function(){SoundManager.playCursor(),this.updateInputData(),this.deactivate(),this.callHandler("pageup")},Window_Selectable.prototype.processPagedown=function(){SoundManager.playCursor(),this.updateInputData(),this.deactivate(),this.callHandler("pagedown")},Window_Selectable.prototype.updateInputData=function(){Input.update(),TouchInput.update()},Window_Selectable.prototype.updateCursor=function(){if(this._cursorAll){var t=this.maxRows()*this.itemHeight();this.setCursorRect(0,0,this.contents.width,t),this.setTopRow(0)}else if(this.isCursorVisible()){var e=this.itemRect(this.index());this.setCursorRect(e.x,e.y,e.width,e.height)}else this.setCursorRect(0,0,0,0)},Window_Selectable.prototype.isCursorVisible=function(){var t=this.row();return t>=this.topRow()&&t<=this.bottomRow()},Window_Selectable.prototype.ensureCursorVisible=function(){var t=this.row();t<this.topRow()?this.setTopRow(t):t>this.bottomRow()&&this.setBottomRow(t)},Window_Selectable.prototype.callUpdateHelp=function(){this.active&&this._helpWindow&&this.updateHelp()},Window_Selectable.prototype.updateHelp=function(){this._helpWindow.clear()},Window_Selectable.prototype.setHelpWindowItem=function(t){this._helpWindow&&this._helpWindow.setItem(t)},Window_Selectable.prototype.isCurrentItemEnabled=function(){return!0},Window_Selectable.prototype.drawAllItems=function(){for(var t=this.topIndex(),e=0;e<this.maxPageItems();e++){var i=t+e;i<this.maxItems()&&this.drawItem(i)}},Window_Selectable.prototype.drawItem=function(t){},Window_Selectable.prototype.clearItem=function(t){var e=this.itemRect(t);this.contents.clearRect(e.x,e.y,e.width,e.height)},Window_Selectable.prototype.redrawItem=function(t){t>=0&&(this.clearItem(t),this.drawItem(t))},Window_Selectable.prototype.redrawCurrentItem=function(){this.redrawItem(this.index())},Window_Selectable.prototype.refresh=function(){this.contents&&(this.contents.clear(),this.drawAllItems())},Window_Command.prototype=Object.create(Window_Selectable.prototype),Window_Command.prototype.constructor=Window_Command,Window_Command.prototype.initialize=function(t,e){this.clearCommandList(),this.makeCommandList();var i=this.windowWidth(),r=this.windowHeight();Window_Selectable.prototype.initialize.call(this,t,e,i,r),this.refresh(),this.select(0),this.activate()},Window_Command.prototype.windowWidth=function(){return 240},Window_Command.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_Command.prototype.numVisibleRows=function(){return Math.ceil(this.maxItems()/this.maxCols())},Window_Command.prototype.maxItems=function(){return this._list.length},Window_Command.prototype.clearCommandList=function(){this._list=[]},Window_Command.prototype.makeCommandList=function(){},Window_Command.prototype.addCommand=function(t,e,i,r){void 0===i&&(i=!0),void 0===r&&(r=null),this._list.push({name:t,symbol:e,enabled:i,ext:r})},Window_Command.prototype.commandName=function(t){return this._list[t].name},Window_Command.prototype.commandSymbol=function(t){return this._list[t].symbol},Window_Command.prototype.isCommandEnabled=function(t){return this._list[t].enabled},Window_Command.prototype.currentData=function(){return this.index()>=0?this._list[this.index()]:null},Window_Command.prototype.isCurrentItemEnabled=function(){return!!this.currentData()&&this.currentData().enabled},Window_Command.prototype.currentSymbol=function(){return this.currentData()?this.currentData().symbol:null},Window_Command.prototype.currentExt=function(){return this.currentData()?this.currentData().ext:null},Window_Command.prototype.findSymbol=function(t){for(var e=0;e<this._list.length;e++)if(this._list[e].symbol===t)return e;return-1},Window_Command.prototype.selectSymbol=function(t){var e=this.findSymbol(t);this.select(e>=0?e:0)},Window_Command.prototype.findExt=function(t){for(var e=0;e<this._list.length;e++)if(this._list[e].ext===t)return e;return-1},Window_Command.prototype.selectExt=function(t){var e=this.findExt(t);this.select(e>=0?e:0)},Window_Command.prototype.drawItem=function(t){var e=this.itemRectForText(t),i=this.itemTextAlign();this.resetTextColor(),this.changePaintOpacity(this.isCommandEnabled(t)),this.drawText(this.commandName(t),e.x,e.y,e.width,i)},Window_Command.prototype.itemTextAlign=function(){return"left"},Window_Command.prototype.isOkEnabled=function(){return!0},Window_Command.prototype.callOkHandler=function(){var t=this.currentSymbol();this.isHandled(t)?this.callHandler(t):this.isHandled("ok")?Window_Selectable.prototype.callOkHandler.call(this):this.activate()},Window_Command.prototype.refresh=function(){this.clearCommandList(),this.makeCommandList(),this.createContents(),Window_Selectable.prototype.refresh.call(this)},Window_HorzCommand.prototype=Object.create(Window_Command.prototype),Window_HorzCommand.prototype.constructor=Window_HorzCommand,Window_HorzCommand.prototype.initialize=function(t,e){Window_Command.prototype.initialize.call(this,t,e)},Window_HorzCommand.prototype.numVisibleRows=function(){return 1},Window_HorzCommand.prototype.maxCols=function(){return 4},Window_HorzCommand.prototype.itemTextAlign=function(){return"center"},Window_Help.prototype=Object.create(Window_Base.prototype),Window_Help.prototype.constructor=Window_Help,Window_Help.prototype.initialize=function(t){var e=Graphics.boxWidth,i=this.fittingHeight(t||2);Window_Base.prototype.initialize.call(this,0,0,e,i),this._text=""},Window_Help.prototype.setText=function(t){this._text!==t&&(this._text=t,this.refresh())},Window_Help.prototype.clear=function(){this.setText("")},Window_Help.prototype.setItem=function(t){this.setText(t?t.description:"")},Window_Help.prototype.refresh=function(){this.contents.clear(),this.drawTextEx(this._text,this.textPadding(),0)},Window_Gold.prototype=Object.create(Window_Base.prototype),Window_Gold.prototype.constructor=Window_Gold,Window_Gold.prototype.initialize=function(t,e){var i=this.windowWidth(),r=this.windowHeight();Window_Base.prototype.initialize.call(this,t,e,i,r),this.refresh()},Window_Gold.prototype.windowWidth=function(){return 240},Window_Gold.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_Gold.prototype.refresh=function(){var t=this.textPadding(),e=this.contents.width-2*this.textPadding();this.contents.clear(),this.drawCurrencyValue(this.value(),this.currencyUnit(),t,0,e)},Window_Gold.prototype.value=function(){return $gameParty.gold()},Window_Gold.prototype.currencyUnit=function(){return TextManager.currencyUnit},Window_Gold.prototype.open=function(){this.refresh(),Window_Base.prototype.open.call(this)},Window_MenuCommand.prototype=Object.create(Window_Command.prototype),Window_MenuCommand.prototype.constructor=Window_MenuCommand,Window_MenuCommand.prototype.initialize=function(t,e){Window_Command.prototype.initialize.call(this,t,e),this.selectLast()},Window_MenuCommand._lastCommandSymbol=null,Window_MenuCommand.initCommandPosition=function(){this._lastCommandSymbol=null},Window_MenuCommand.prototype.windowWidth=function(){return 240},Window_MenuCommand.prototype.numVisibleRows=function(){return this.maxItems()},Window_MenuCommand.prototype.makeCommandList=function(){this.addMainCommands(),this.addFormationCommand(),this.addOriginalCommands(),this.addOptionsCommand(),this.addSaveCommand(),this.addGameEndCommand()},Window_MenuCommand.prototype.addMainCommands=function(){var t=this.areMainCommandsEnabled();this.needsCommand("item")&&this.addCommand(TextManager.item,"item",t),this.needsCommand("skill")&&this.addCommand(TextManager.skill,"skill",t),this.needsCommand("equip")&&this.addCommand(TextManager.equip,"equip",t),this.needsCommand("status")&&this.addCommand(TextManager.status,"status",t)},Window_MenuCommand.prototype.addFormationCommand=function(){if(this.needsCommand("formation")){var t=this.isFormationEnabled();this.addCommand(TextManager.formation,"formation",t)}},Window_MenuCommand.prototype.addOriginalCommands=function(){},Window_MenuCommand.prototype.addOptionsCommand=function(){if(this.needsCommand("options")){var t=this.isOptionsEnabled();this.addCommand(TextManager.options,"options",t)}},Window_MenuCommand.prototype.addSaveCommand=function(){if(this.needsCommand("save")){var t=this.isSaveEnabled();this.addCommand(TextManager.save,"save",t)}},Window_MenuCommand.prototype.addGameEndCommand=function(){var t=this.isGameEndEnabled();this.addCommand(TextManager.gameEnd,"gameEnd",t)},Window_MenuCommand.prototype.needsCommand=function(t){var e=$dataSystem.menuCommands;if(e)switch(t){case"item":return e[0];case"skill":return e[1];case"equip":return e[2];case"status":return e[3];case"formation":return e[4];case"save":return e[5]}return!0},Window_MenuCommand.prototype.areMainCommandsEnabled=function(){return $gameParty.exists()},Window_MenuCommand.prototype.isFormationEnabled=function(){return $gameParty.size()>=2&&$gameSystem.isFormationEnabled()},Window_MenuCommand.prototype.isOptionsEnabled=function(){return!0},Window_MenuCommand.prototype.isSaveEnabled=function(){return!DataManager.isEventTest()&&$gameSystem.isSaveEnabled()},Window_MenuCommand.prototype.isGameEndEnabled=function(){return!0},Window_MenuCommand.prototype.processOk=function(){Window_MenuCommand._lastCommandSymbol=this.currentSymbol(),Window_Command.prototype.processOk.call(this)},Window_MenuCommand.prototype.selectLast=function(){this.selectSymbol(Window_MenuCommand._lastCommandSymbol)},Window_MenuStatus.prototype=Object.create(Window_Selectable.prototype),Window_MenuStatus.prototype.constructor=Window_MenuStatus,Window_MenuStatus.prototype.initialize=function(t,e){var i=this.windowWidth(),r=this.windowHeight();Window_Selectable.prototype.initialize.call(this,t,e,i,r),this._formationMode=!1,this._pendingIndex=-1,this.refresh()},Window_MenuStatus.prototype.windowWidth=function(){return Graphics.boxWidth-240},Window_MenuStatus.prototype.windowHeight=function(){return Graphics.boxHeight},Window_MenuStatus.prototype.maxItems=function(){return $gameParty.size()},Window_MenuStatus.prototype.itemHeight=function(){return Math.floor((this.height-2*this.padding)/this.numVisibleRows())},Window_MenuStatus.prototype.numVisibleRows=function(){return 4},Window_MenuStatus.prototype.loadImages=function(){$gameParty.members().forEach(function(t){ImageManager.reserveFace(t.faceName())},this)},Window_MenuStatus.prototype.drawItem=function(t){this.drawItemBackground(t),this.drawItemImage(t),this.drawItemStatus(t)},Window_MenuStatus.prototype.drawItemBackground=function(t){if(t===this._pendingIndex){var e=this.itemRect(t),i=this.pendingColor();this.changePaintOpacity(!1),this.contents.fillRect(e.x,e.y,e.width,e.height,i),this.changePaintOpacity(!0)}},Window_MenuStatus.prototype.drawItemImage=function(t){var e=$gameParty.members()[t],i=this.itemRect(t);this.changePaintOpacity(e.isBattleMember()),this.drawActorFace(e,i.x+1,i.y+1,Window_Base._faceWidth,Window_Base._faceHeight),this.changePaintOpacity(!0)},Window_MenuStatus.prototype.drawItemStatus=function(t){var e=$gameParty.members()[t],i=this.itemRect(t),r=i.x+162,n=i.y+i.height/2-1.5*this.lineHeight(),a=i.width-r-this.textPadding();this.drawActorSimpleStatus(e,r,n,a)},Window_MenuStatus.prototype.processOk=function(){Window_Selectable.prototype.processOk.call(this),$gameParty.setMenuActor($gameParty.members()[this.index()])},Window_MenuStatus.prototype.isCurrentItemEnabled=function(){if(this._formationMode){var t=$gameParty.members()[this.index()];return t&&t.isFormationChangeOk()}return!0},Window_MenuStatus.prototype.selectLast=function(){this.select($gameParty.menuActor().index()||0)},Window_MenuStatus.prototype.formationMode=function(){return this._formationMode},Window_MenuStatus.prototype.setFormationMode=function(t){this._formationMode=t},Window_MenuStatus.prototype.pendingIndex=function(){return this._pendingIndex},Window_MenuStatus.prototype.setPendingIndex=function(t){var e=this._pendingIndex;this._pendingIndex=t,this.redrawItem(this._pendingIndex),this.redrawItem(e)},Window_MenuActor.prototype=Object.create(Window_MenuStatus.prototype),Window_MenuActor.prototype.constructor=Window_MenuActor,Window_MenuActor.prototype.initialize=function(){Window_MenuStatus.prototype.initialize.call(this,0,0),this.hide()},Window_MenuActor.prototype.processOk=function(){this.cursorAll()||$gameParty.setTargetActor($gameParty.members()[this.index()]),this.callOkHandler()},Window_MenuActor.prototype.selectLast=function(){this.select($gameParty.targetActor().index()||0)},Window_MenuActor.prototype.selectForItem=function(t){var e=$gameParty.menuActor(),i=new Game_Action(e);i.setItemObject(t),this.setCursorFixed(!1),this.setCursorAll(!1),i.isForUser()?DataManager.isSkill(t)?(this.setCursorFixed(!0),this.select(e.index())):this.selectLast():i.isForAll()?(this.setCursorAll(!0),this.select(0)):this.selectLast()},Window_ItemCategory.prototype=Object.create(Window_HorzCommand.prototype),Window_ItemCategory.prototype.constructor=Window_ItemCategory,Window_ItemCategory.prototype.initialize=function(){Window_HorzCommand.prototype.initialize.call(this,0,0)},Window_ItemCategory.prototype.windowWidth=function(){return Graphics.boxWidth},Window_ItemCategory.prototype.maxCols=function(){return 4},Window_ItemCategory.prototype.update=function(){Window_HorzCommand.prototype.update.call(this),this._itemWindow&&this._itemWindow.setCategory(this.currentSymbol())},Window_ItemCategory.prototype.makeCommandList=function(){this.addCommand(TextManager.item,"item"),this.addCommand(TextManager.weapon,"weapon"),this.addCommand(TextManager.armor,"armor"),this.addCommand(TextManager.keyItem,"keyItem")},Window_ItemCategory.prototype.setItemWindow=function(t){this._itemWindow=t},Window_ItemList.prototype=Object.create(Window_Selectable.prototype),Window_ItemList.prototype.constructor=Window_ItemList,Window_ItemList.prototype.initialize=function(t,e,i,r){Window_Selectable.prototype.initialize.call(this,t,e,i,r),this._category="none",this._data=[]},Window_ItemList.prototype.setCategory=function(t){this._category!==t&&(this._category=t,this.refresh(),this.resetScroll())},Window_ItemList.prototype.maxCols=function(){return 2},Window_ItemList.prototype.spacing=function(){return 48},Window_ItemList.prototype.maxItems=function(){return this._data?this._data.length:1},Window_ItemList.prototype.item=function(){var t=this.index();return this._data&&t>=0?this._data[t]:null},Window_ItemList.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this.item())},Window_ItemList.prototype.includes=function(t){switch(this._category){case"item":return DataManager.isItem(t)&&1===t.itypeId;case"weapon":return DataManager.isWeapon(t);case"armor":return DataManager.isArmor(t);case"keyItem":return DataManager.isItem(t)&&2===t.itypeId;default:return!1}},Window_ItemList.prototype.needsNumber=function(){return!0},Window_ItemList.prototype.isEnabled=function(t){return $gameParty.canUse(t)},Window_ItemList.prototype.makeItemList=function(){this._data=$gameParty.allItems().filter(function(t){return this.includes(t)},this),this.includes(null)&&this._data.push(null)},Window_ItemList.prototype.selectLast=function(){var t=this._data.indexOf($gameParty.lastItem());this.select(t>=0?t:0)},Window_ItemList.prototype.drawItem=function(t){var e=this._data[t];if(e){var i=this.numberWidth(),r=this.itemRect(t);r.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(e)),this.drawItemName(e,r.x,r.y,r.width-i),this.drawItemNumber(e,r.x,r.y,r.width),this.changePaintOpacity(1)}},Window_ItemList.prototype.numberWidth=function(){return this.textWidth("000")},Window_ItemList.prototype.drawItemNumber=function(t,e,i,r){this.needsNumber()&&(this.drawText(":",e,i,r-this.textWidth("00"),"right"),this.drawText($gameParty.numItems(t),e,i,r,"right"))},Window_ItemList.prototype.updateHelp=function(){this.setHelpWindowItem(this.item())},Window_ItemList.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_SkillType.prototype=Object.create(Window_Command.prototype),Window_SkillType.prototype.constructor=Window_SkillType,Window_SkillType.prototype.initialize=function(t,e){Window_Command.prototype.initialize.call(this,t,e),this._actor=null},Window_SkillType.prototype.windowWidth=function(){return 240},Window_SkillType.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh(),this.selectLast())},Window_SkillType.prototype.numVisibleRows=function(){return 4},Window_SkillType.prototype.makeCommandList=function(){if(this._actor){var t=this._actor.addedSkillTypes();t.sort(function(t,e){return t-e}),t.forEach(function(t){this.addCommand($dataSystem.skillTypes[t],"skill",!0,t)},this)}},Window_SkillType.prototype.update=function(){Window_Command.prototype.update.call(this),this._skillWindow&&this._skillWindow.setStypeId(this.currentExt())},Window_SkillType.prototype.setSkillWindow=function(t){this._skillWindow=t},Window_SkillType.prototype.selectLast=function(){var t=this._actor.lastMenuSkill();t?this.selectExt(t.stypeId):this.select(0)},Window_SkillStatus.prototype=Object.create(Window_Base.prototype),Window_SkillStatus.prototype.constructor=Window_SkillStatus,Window_SkillStatus.prototype.initialize=function(t,e,i,r){Window_Base.prototype.initialize.call(this,t,e,i,r),this._actor=null},Window_SkillStatus.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh())},Window_SkillStatus.prototype.refresh=function(){if(this.contents.clear(),this._actor){var t=this.width-2*this.padding,e=this.height-2*this.padding,i=e/2-1.5*this.lineHeight(),r=t-162-this.textPadding();this.drawActorFace(this._actor,0,0,144,e),this.drawActorSimpleStatus(this._actor,162,i,r)}},Window_SkillList.prototype=Object.create(Window_Selectable.prototype),Window_SkillList.prototype.constructor=Window_SkillList,Window_SkillList.prototype.initialize=function(t,e,i,r){Window_Selectable.prototype.initialize.call(this,t,e,i,r),this._actor=null,this._stypeId=0,this._data=[]},Window_SkillList.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh(),this.resetScroll())},Window_SkillList.prototype.setStypeId=function(t){this._stypeId!==t&&(this._stypeId=t,this.refresh(),this.resetScroll())},Window_SkillList.prototype.maxCols=function(){return 2},Window_SkillList.prototype.spacing=function(){return 48},Window_SkillList.prototype.maxItems=function(){return this._data?this._data.length:1},Window_SkillList.prototype.item=function(){return this._data&&this.index()>=0?this._data[this.index()]:null},Window_SkillList.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this._data[this.index()])},Window_SkillList.prototype.includes=function(t){return t&&t.stypeId===this._stypeId},Window_SkillList.prototype.isEnabled=function(t){return this._actor&&this._actor.canUse(t)},Window_SkillList.prototype.makeItemList=function(){this._data=this._actor?this._actor.skills().filter(function(t){return this.includes(t)},this):[]},Window_SkillList.prototype.selectLast=function(){var t;t=$gameParty.inBattle()?this._actor.lastBattleSkill():this._actor.lastMenuSkill();var e=this._data.indexOf(t);this.select(e>=0?e:0)},Window_SkillList.prototype.drawItem=function(t){var e=this._data[t];if(e){var i=this.costWidth(),r=this.itemRect(t);r.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(e)),this.drawItemName(e,r.x,r.y,r.width-i),this.drawSkillCost(e,r.x,r.y,r.width),this.changePaintOpacity(1)}},Window_SkillList.prototype.costWidth=function(){return this.textWidth("000")},Window_SkillList.prototype.drawSkillCost=function(t,e,i,r){this._actor.skillTpCost(t)>0?(this.changeTextColor(this.tpCostColor()),this.drawText(this._actor.skillTpCost(t),e,i,r,"right")):this._actor.skillMpCost(t)>0&&(this.changeTextColor(this.mpCostColor()),this.drawText(this._actor.skillMpCost(t),e,i,r,"right"))},Window_SkillList.prototype.updateHelp=function(){this.setHelpWindowItem(this.item())},Window_SkillList.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_EquipStatus.prototype=Object.create(Window_Base.prototype),Window_EquipStatus.prototype.constructor=Window_EquipStatus,Window_EquipStatus.prototype.initialize=function(t,e){var i=this.windowWidth(),r=this.windowHeight();Window_Base.prototype.initialize.call(this,t,e,i,r),this._actor=null,this._tempActor=null,this.refresh()},Window_EquipStatus.prototype.windowWidth=function(){return 312},Window_EquipStatus.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_EquipStatus.prototype.numVisibleRows=function(){return 7},Window_EquipStatus.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh())},Window_EquipStatus.prototype.refresh=function(){if(this.contents.clear(),this._actor){this.drawActorName(this._actor,this.textPadding(),0);for(var t=0;t<6;t++)this.drawItem(0,this.lineHeight()*(1+t),2+t)}},Window_EquipStatus.prototype.setTempActor=function(t){this._tempActor!==t&&(this._tempActor=t,this.refresh())},Window_EquipStatus.prototype.drawItem=function(t,e,i){this.drawParamName(t+this.textPadding(),e,i),this._actor&&this.drawCurrentParam(t+140,e,i),this.drawRightArrow(t+188,e),this._tempActor&&this.drawNewParam(t+222,e,i)},Window_EquipStatus.prototype.drawParamName=function(t,e,i){this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(i),t,e,120)},Window_EquipStatus.prototype.drawCurrentParam=function(t,e,i){this.resetTextColor(),this.drawText(this._actor.param(i),t,e,48,"right")},Window_EquipStatus.prototype.drawRightArrow=function(t,e){this.changeTextColor(this.systemColor()),this.drawText("\u2192",t,e,32,"center")},Window_EquipStatus.prototype.drawNewParam=function(t,e,i){var r=this._tempActor.param(i),n=r-this._actor.param(i);this.changeTextColor(this.paramchangeTextColor(n)),this.drawText(r,t,e,48,"right")},Window_EquipCommand.prototype=Object.create(Window_HorzCommand.prototype),Window_EquipCommand.prototype.constructor=Window_EquipCommand,Window_EquipCommand.prototype.initialize=function(t,e,i){this._windowWidth=i,Window_HorzCommand.prototype.initialize.call(this,t,e)},Window_EquipCommand.prototype.windowWidth=function(){return this._windowWidth},Window_EquipCommand.prototype.maxCols=function(){return 3},Window_EquipCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.equip2,"equip"),this.addCommand(TextManager.optimize,"optimize"),this.addCommand(TextManager.clear,"clear")},Window_EquipSlot.prototype=Object.create(Window_Selectable.prototype),Window_EquipSlot.prototype.constructor=Window_EquipSlot,Window_EquipSlot.prototype.initialize=function(t,e,i,r){Window_Selectable.prototype.initialize.call(this,t,e,i,r),this._actor=null,this.refresh()},Window_EquipSlot.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh())},Window_EquipSlot.prototype.update=function(){Window_Selectable.prototype.update.call(this),this._itemWindow&&this._itemWindow.setSlotId(this.index())},Window_EquipSlot.prototype.maxItems=function(){return this._actor?this._actor.equipSlots().length:0},Window_EquipSlot.prototype.item=function(){return this._actor?this._actor.equips()[this.index()]:null},Window_EquipSlot.prototype.drawItem=function(t){if(this._actor){var e=this.itemRectForText(t);this.changeTextColor(this.systemColor()),this.changePaintOpacity(this.isEnabled(t)),this.drawText(this.slotName(t),e.x,e.y,138,this.lineHeight()),this.drawItemName(this._actor.equips()[t],e.x+138,e.y),this.changePaintOpacity(!0)}},Window_EquipSlot.prototype.slotName=function(t){var e=this._actor.equipSlots();return this._actor?$dataSystem.equipTypes[e[t]]:""},Window_EquipSlot.prototype.isEnabled=function(t){return!!this._actor&&this._actor.isEquipChangeOk(t)},Window_EquipSlot.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this.index())},Window_EquipSlot.prototype.setStatusWindow=function(t){this._statusWindow=t,this.callUpdateHelp()},Window_EquipSlot.prototype.setItemWindow=function(t){this._itemWindow=t},Window_EquipSlot.prototype.updateHelp=function(){Window_Selectable.prototype.updateHelp.call(this),this.setHelpWindowItem(this.item()),this._statusWindow&&this._statusWindow.setTempActor(null)},Window_EquipItem.prototype=Object.create(Window_ItemList.prototype),Window_EquipItem.prototype.constructor=Window_EquipItem,Window_EquipItem.prototype.initialize=function(t,e,i,r){Window_ItemList.prototype.initialize.call(this,t,e,i,r),this._actor=null,this._slotId=0},Window_EquipItem.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh(),this.resetScroll())},Window_EquipItem.prototype.setSlotId=function(t){this._slotId!==t&&(this._slotId=t,this.refresh(),this.resetScroll())},Window_EquipItem.prototype.includes=function(t){return null===t||!(this._slotId<0||t.etypeId!==this._actor.equipSlots()[this._slotId])&&this._actor.canEquip(t)},Window_EquipItem.prototype.isEnabled=function(t){return!0},Window_EquipItem.prototype.selectLast=function(){},Window_EquipItem.prototype.setStatusWindow=function(t){this._statusWindow=t,this.callUpdateHelp()},Window_EquipItem.prototype.updateHelp=function(){if(Window_ItemList.prototype.updateHelp.call(this),this._actor&&this._statusWindow){var t=JsonEx.makeDeepCopy(this._actor);t.forceChangeEquip(this._slotId,this.item()),this._statusWindow.setTempActor(t)}},Window_EquipItem.prototype.playOkSound=function(){},Window_Status.prototype=Object.create(Window_Selectable.prototype),Window_Status.prototype.constructor=Window_Status,Window_Status.prototype.initialize=function(){Window_Selectable.prototype.initialize.call(this,0,0,Graphics.boxWidth,Graphics.boxHeight),this._actor=null,this.refresh(),this.activate()},Window_Status.prototype.setActor=function(t){this._actor!==t&&(this._actor=t,this.refresh())},Window_Status.prototype.refresh=function(){if(this.contents.clear(),this._actor){var t=this.lineHeight();this.drawBlock1(0*t),this.drawHorzLine(1*t),this.drawBlock2(2*t),this.drawHorzLine(6*t),this.drawBlock3(7*t),this.drawHorzLine(13*t),this.drawBlock4(14*t)}},Window_Status.prototype.drawBlock1=function(t){this.drawActorName(this._actor,6,t),this.drawActorClass(this._actor,192,t),this.drawActorNickname(this._actor,432,t)},Window_Status.prototype.drawBlock2=function(t){this.drawActorFace(this._actor,12,t),this.drawBasicInfo(204,t),this.drawExpInfo(456,t)},Window_Status.prototype.drawBlock3=function(t){this.drawParameters(48,t),this.drawEquipments(432,t)},Window_Status.prototype.drawBlock4=function(t){this.drawProfile(6,t)},Window_Status.prototype.drawHorzLine=function(t){var e=t+this.lineHeight()/2-1;this.contents.paintOpacity=48,this.contents.fillRect(0,e,this.contentsWidth(),2,this.lineColor()),this.contents.paintOpacity=255},Window_Status.prototype.lineColor=function(){return this.normalColor()},Window_Status.prototype.drawBasicInfo=function(t,e){var i=this.lineHeight();this.drawActorLevel(this._actor,t,e+0*i),this.drawActorIcons(this._actor,t,e+1*i),this.drawActorHp(this._actor,t,e+2*i),this.drawActorMp(this._actor,t,e+3*i)},Window_Status.prototype.drawParameters=function(t,e){for(var i=this.lineHeight(),r=0;r<6;r++){var n=r+2,a=e+i*r;this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(n),t,a,160),this.resetTextColor(),this.drawText(this._actor.param(n),t+160,a,60,"right")}},Window_Status.prototype.drawExpInfo=function(t,e){var i=this.lineHeight(),r=TextManager.expTotal.format(TextManager.exp),n=TextManager.expNext.format(TextManager.level),a=this._actor.currentExp(),o=this._actor.nextRequiredExp();this._actor.isMaxLevel()&&(a="-------",o="-------"),this.changeTextColor(this.systemColor()),this.drawText(r,t,e+0*i,270),this.drawText(n,t,e+2*i,270),this.resetTextColor(),this.drawText(a,t,e+1*i,270,"right"),this.drawText(o,t,e+3*i,270,"right")},Window_Status.prototype.drawEquipments=function(t,e){for(var i=this._actor.equips(),r=Math.min(i.length,this.maxEquipmentLines()),n=0;n<r;n++)this.drawItemName(i[n],t,e+this.lineHeight()*n)},Window_Status.prototype.drawProfile=function(t,e){this.drawTextEx(this._actor.profile(),t,e)},Window_Status.prototype.maxEquipmentLines=function(){return 6},Window_Options.prototype=Object.create(Window_Command.prototype),Window_Options.prototype.constructor=Window_Options,Window_Options.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement()},Window_Options.prototype.windowWidth=function(){return 400},Window_Options.prototype.windowHeight=function(){return this.fittingHeight(Math.min(this.numVisibleRows(),12))},Window_Options.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=(Graphics.boxHeight-this.height)/2},Window_Options.prototype.makeCommandList=function(){this.addGeneralOptions(),this.addVolumeOptions()},Window_Options.prototype.addGeneralOptions=function(){this.addCommand(TextManager.alwaysDash,"alwaysDash"),this.addCommand(TextManager.commandRemember,"commandRemember")},Window_Options.prototype.addVolumeOptions=function(){this.addCommand(TextManager.bgmVolume,"bgmVolume"),this.addCommand(TextManager.bgsVolume,"bgsVolume"),this.addCommand(TextManager.meVolume,"meVolume"),this.addCommand(TextManager.seVolume,"seVolume")},Window_Options.prototype.drawItem=function(t){var e=this.itemRectForText(t),i=this.statusWidth(),r=e.width-i;this.resetTextColor(),this.changePaintOpacity(this.isCommandEnabled(t)),this.drawText(this.commandName(t),e.x,e.y,r,"left"),this.drawText(this.statusText(t),r,e.y,i,"right")},Window_Options.prototype.statusWidth=function(){return 120},Window_Options.prototype.statusText=function(t){var e=this.commandSymbol(t),i=this.getConfigValue(e);return this.isVolumeSymbol(e)?this.volumeStatusText(i):this.booleanStatusText(i)},Window_Options.prototype.isVolumeSymbol=function(t){return t.contains("Volume")},Window_Options.prototype.booleanStatusText=function(t){return t?"ON":"OFF"},Window_Options.prototype.volumeStatusText=function(t){return t+"%"},Window_Options.prototype.processOk=function(){var t=this.index(),e=this.commandSymbol(t),i=this.getConfigValue(e);this.isVolumeSymbol(e)?((i+=this.volumeOffset())>100&&(i=0),i=i.clamp(0,100),this.changeValue(e,i)):this.changeValue(e,!i)},Window_Options.prototype.cursorRight=function(t){var e=this.index(),i=this.commandSymbol(e),r=this.getConfigValue(i);this.isVolumeSymbol(i)?(r=(r+=this.volumeOffset()).clamp(0,100),this.changeValue(i,r)):this.changeValue(i,!0)},Window_Options.prototype.cursorLeft=function(t){var e=this.index(),i=this.commandSymbol(e),r=this.getConfigValue(i);this.isVolumeSymbol(i)?(r=(r-=this.volumeOffset()).clamp(0,100),this.changeValue(i,r)):this.changeValue(i,!1)},Window_Options.prototype.volumeOffset=function(){return 20},Window_Options.prototype.changeValue=function(t,e){this.getConfigValue(t)!==e&&(this.setConfigValue(t,e),this.redrawItem(this.findSymbol(t)),SoundManager.playCursor())},Window_Options.prototype.getConfigValue=function(t){return ConfigManager[t]},Window_Options.prototype.setConfigValue=function(t,e){ConfigManager[t]=e},Window_SavefileList.prototype=Object.create(Window_Selectable.prototype),Window_SavefileList.prototype.constructor=Window_SavefileList,Window_SavefileList.prototype.initialize=function(t,e,i,r){Window_Selectable.prototype.initialize.call(this,t,e,i,r),this.activate(),this._mode=null},Window_SavefileList.prototype.setMode=function(t){this._mode=t},Window_SavefileList.prototype.maxItems=function(){return DataManager.maxSavefiles()},Window_SavefileList.prototype.maxVisibleItems=function(){return 5},Window_SavefileList.prototype.itemHeight=function(){return Math.floor((this.height-2*this.padding)/this.maxVisibleItems())},Window_SavefileList.prototype.drawItem=function(t){var e=t+1,i=DataManager.isThisGameFile(e),r=DataManager.loadSavefileInfo(e),n=this.itemRectForText(t);this.resetTextColor(),"load"===this._mode&&this.changePaintOpacity(i),this.drawFileId(e,n.x,n.y),r&&(this.changePaintOpacity(i),this.drawContents(r,n,i),this.changePaintOpacity(!0))},Window_SavefileList.prototype.drawFileId=function(t,e,i){this.drawText(TextManager.file+" "+t,e,i,180)},Window_SavefileList.prototype.drawContents=function(t,e,i){var r=e.y+e.height;e.width>=420&&(this.drawGameTitle(t,e.x+192,e.y,e.width-192),i&&this.drawPartyCharacters(t,e.x+220,r-4));var n=this.lineHeight(),a=r-n;a>=n&&this.drawPlaytime(t,e.x,a,e.width)},Window_SavefileList.prototype.drawGameTitle=function(t,e,i,r){t.title&&this.drawText(t.title,e,i,r)},Window_SavefileList.prototype.drawPartyCharacters=function(t,e,i){if(t.characters)for(var r=0;r<t.characters.length;r++){var n=t.characters[r];this.drawCharacter(n[0],n[1],e+48*r,i)}},Window_SavefileList.prototype.drawPlaytime=function(t,e,i,r){t.playtime&&this.drawText(t.playtime,e,i,r,"right")},Window_SavefileList.prototype.playOkSound=function(){},Window_ShopCommand.prototype=Object.create(Window_HorzCommand.prototype),Window_ShopCommand.prototype.constructor=Window_ShopCommand,Window_ShopCommand.prototype.initialize=function(t,e){this._windowWidth=t,this._purchaseOnly=e,Window_HorzCommand.prototype.initialize.call(this,0,0)},Window_ShopCommand.prototype.windowWidth=function(){return this._windowWidth},Window_ShopCommand.prototype.maxCols=function(){return 3},Window_ShopCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.buy,"buy"),this.addCommand(TextManager.sell,"sell",!this._purchaseOnly),this.addCommand(TextManager.cancel,"cancel")},Window_ShopBuy.prototype=Object.create(Window_Selectable.prototype),Window_ShopBuy.prototype.constructor=Window_ShopBuy,Window_ShopBuy.prototype.initialize=function(t,e,i,r){var n=this.windowWidth();Window_Selectable.prototype.initialize.call(this,t,e,n,i),this._shopGoods=r,this._money=0,this.refresh(),this.select(0)},Window_ShopBuy.prototype.windowWidth=function(){return 456},Window_ShopBuy.prototype.maxItems=function(){return this._data?this._data.length:1},Window_ShopBuy.prototype.item=function(){return this._data[this.index()]},Window_ShopBuy.prototype.setMoney=function(t){this._money=t,this.refresh()},Window_ShopBuy.prototype.isCurrentItemEnabled=function(){return this.isEnabled(this._data[this.index()])},Window_ShopBuy.prototype.price=function(t){return this._price[this._data.indexOf(t)]||0},Window_ShopBuy.prototype.isEnabled=function(t){return t&&this.price(t)<=this._money&&!$gameParty.hasMaxItems(t)},Window_ShopBuy.prototype.refresh=function(){this.makeItemList(),this.createContents(),this.drawAllItems()},Window_ShopBuy.prototype.makeItemList=function(){this._data=[],this._price=[],this._shopGoods.forEach(function(t){var e=null;switch(t[0]){case 0:e=$dataItems[t[1]];break;case 1:e=$dataWeapons[t[1]];break;case 2:e=$dataArmors[t[1]]}e&&(this._data.push(e),this._price.push(0===t[2]?e.price:t[3]))},this)},Window_ShopBuy.prototype.drawItem=function(t){var e=this._data[t],i=this.itemRect(t);i.width-=this.textPadding(),this.changePaintOpacity(this.isEnabled(e)),this.drawItemName(e,i.x,i.y,i.width-96),this.drawText(this.price(e),i.x+i.width-96,i.y,96,"right"),this.changePaintOpacity(!0)},Window_ShopBuy.prototype.setStatusWindow=function(t){this._statusWindow=t,this.callUpdateHelp()},Window_ShopBuy.prototype.updateHelp=function(){this.setHelpWindowItem(this.item()),this._statusWindow&&this._statusWindow.setItem(this.item())},Window_ShopSell.prototype=Object.create(Window_ItemList.prototype),Window_ShopSell.prototype.constructor=Window_ShopSell,Window_ShopSell.prototype.initialize=function(t,e,i,r){Window_ItemList.prototype.initialize.call(this,t,e,i,r)},Window_ShopSell.prototype.isEnabled=function(t){return t&&t.price>0},Window_ShopNumber.prototype=Object.create(Window_Selectable.prototype),Window_ShopNumber.prototype.constructor=Window_ShopNumber,Window_ShopNumber.prototype.initialize=function(t,e,i){var r=this.windowWidth();Window_Selectable.prototype.initialize.call(this,t,e,r,i),this._item=null,this._max=1,this._price=0,this._number=1,this._currencyUnit=TextManager.currencyUnit,this.createButtons()},Window_ShopNumber.prototype.windowWidth=function(){return 456},Window_ShopNumber.prototype.number=function(){return this._number},Window_ShopNumber.prototype.setup=function(t,e,i){this._item=t,this._max=Math.floor(e),this._price=i,this._number=1,this.placeButtons(),this.updateButtonsVisiblity(),this.refresh()},Window_ShopNumber.prototype.setCurrencyUnit=function(t){this._currencyUnit=t,this.refresh()},Window_ShopNumber.prototype.createButtons=function(){var t=ImageManager.loadSystem("ButtonSet");this._buttons=[];for(var e=0;e<5;e++){var i=new Sprite_Button,r=48*e,n=48*(4===e?2:1);i.bitmap=t,i.setColdFrame(r,0,n,48),i.setHotFrame(r,48,n,48),i.visible=!1,this._buttons.push(i),this.addChild(i)}this._buttons[0].setClickHandler(this.onButtonDown2.bind(this)),this._buttons[1].setClickHandler(this.onButtonDown.bind(this)),this._buttons[2].setClickHandler(this.onButtonUp.bind(this)),this._buttons[3].setClickHandler(this.onButtonUp2.bind(this)),this._buttons[4].setClickHandler(this.onButtonOk.bind(this))},Window_ShopNumber.prototype.placeButtons=function(){for(var t=this._buttons.length,e=-16,i=0;i<t;i++)e+=this._buttons[i].width+16;for(var r=(this.width-e)/2,n=0;n<t;n++){var a=this._buttons[n];a.x=r,a.y=this.buttonY(),r+=a.width+16}},Window_ShopNumber.prototype.updateButtonsVisiblity=function(){TouchInput.date>Input.date?this.showButtons():this.hideButtons()},Window_ShopNumber.prototype.showButtons=function(){for(var t=0;t<this._buttons.length;t++)this._buttons[t].visible=!0},Window_ShopNumber.prototype.hideButtons=function(){for(var t=0;t<this._buttons.length;t++)this._buttons[t].visible=!1},Window_ShopNumber.prototype.refresh=function(){this.contents.clear(),this.drawItemName(this._item,0,this.itemY()),this.drawMultiplicationSign(),this.drawNumber(),this.drawTotalPrice()},Window_ShopNumber.prototype.drawMultiplicationSign=function(){var t=this.textWidth("\xd7"),e=this.cursorX()-2*t,i=this.itemY();this.resetTextColor(),this.drawText("\xd7",e,i,t)},Window_ShopNumber.prototype.drawNumber=function(){var t=this.cursorX(),e=this.itemY(),i=this.cursorWidth()-this.textPadding();this.resetTextColor(),this.drawText(this._number,t,e,i,"right")},Window_ShopNumber.prototype.drawTotalPrice=function(){var t=this._price*this._number,e=this.contentsWidth()-this.textPadding();this.drawCurrencyValue(t,this._currencyUnit,0,this.priceY(),e)},Window_ShopNumber.prototype.itemY=function(){return Math.round(this.contentsHeight()/2-1.5*this.lineHeight())},Window_ShopNumber.prototype.priceY=function(){return Math.round(this.contentsHeight()/2+this.lineHeight()/2)},Window_ShopNumber.prototype.buttonY=function(){return Math.round(this.priceY()+2.5*this.lineHeight())},Window_ShopNumber.prototype.cursorWidth=function(){var t=this.textWidth("0");return this.maxDigits()*t+2*this.textPadding()},Window_ShopNumber.prototype.cursorX=function(){return this.contentsWidth()-this.cursorWidth()-this.textPadding()},Window_ShopNumber.prototype.maxDigits=function(){return 2},Window_ShopNumber.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.processNumberChange()},Window_ShopNumber.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_ShopNumber.prototype.playOkSound=function(){},Window_ShopNumber.prototype.processNumberChange=function(){this.isOpenAndActive()&&(Input.isRepeated("right")&&this.changeNumber(1),Input.isRepeated("left")&&this.changeNumber(-1),Input.isRepeated("up")&&this.changeNumber(10),Input.isRepeated("down")&&this.changeNumber(-10))},Window_ShopNumber.prototype.changeNumber=function(t){var e=this._number;this._number=(this._number+t).clamp(1,this._max),this._number!==e&&(SoundManager.playCursor(),this.refresh())},Window_ShopNumber.prototype.updateCursor=function(){this.setCursorRect(this.cursorX(),this.itemY(),this.cursorWidth(),this.lineHeight())},Window_ShopNumber.prototype.onButtonUp=function(){this.changeNumber(1)},Window_ShopNumber.prototype.onButtonUp2=function(){this.changeNumber(10)},Window_ShopNumber.prototype.onButtonDown=function(){this.changeNumber(-1)},Window_ShopNumber.prototype.onButtonDown2=function(){this.changeNumber(-10)},Window_ShopNumber.prototype.onButtonOk=function(){this.processOk()},Window_ShopStatus.prototype=Object.create(Window_Base.prototype),Window_ShopStatus.prototype.constructor=Window_ShopStatus,Window_ShopStatus.prototype.initialize=function(t,e,i,r){Window_Base.prototype.initialize.call(this,t,e,i,r),this._item=null,this._pageIndex=0,this.refresh()},Window_ShopStatus.prototype.refresh=function(){if(this.contents.clear(),this._item){var t=this.textPadding();this.drawPossession(t,0),this.isEquipItem()&&this.drawEquipInfo(t,2*this.lineHeight())}},Window_ShopStatus.prototype.setItem=function(t){this._item=t,this.refresh()},Window_ShopStatus.prototype.isEquipItem=function(){return DataManager.isWeapon(this._item)||DataManager.isArmor(this._item)},Window_ShopStatus.prototype.drawPossession=function(t,e){var i=this.contents.width-this.textPadding()-t,r=this.textWidth("0000");this.changeTextColor(this.systemColor()),this.drawText(TextManager.possession,t,e,i-r),this.resetTextColor(),this.drawText($gameParty.numItems(this._item),t,e,i,"right")},Window_ShopStatus.prototype.drawEquipInfo=function(t,e){for(var i=this.statusMembers(),r=0;r<i.length;r++)this.drawActorEquipInfo(t,e+this.lineHeight()*(2.4*r),i[r])},Window_ShopStatus.prototype.statusMembers=function(){var t=this._pageIndex*this.pageSize(),e=t+this.pageSize();return $gameParty.members().slice(t,e)},Window_ShopStatus.prototype.pageSize=function(){return 4},Window_ShopStatus.prototype.maxPages=function(){return Math.floor(($gameParty.size()+this.pageSize()-1)/this.pageSize())},Window_ShopStatus.prototype.drawActorEquipInfo=function(t,e,i){var r=i.canEquip(this._item);this.changePaintOpacity(r),this.resetTextColor(),this.drawText(i.name(),t,e,168);var n=this.currentEquippedItem(i,this._item.etypeId);r&&this.drawActorParamChange(t,e,i,n),this.drawItemName(n,t,e+this.lineHeight()),this.changePaintOpacity(!0)},Window_ShopStatus.prototype.drawActorParamChange=function(t,e,i,r){var n=this.contents.width-this.textPadding()-t,a=this.paramId(),o=this._item.params[a]-(r?r.params[a]:0);this.changeTextColor(this.paramchangeTextColor(o)),this.drawText((o>0?"+":"")+o,t,e,n,"right")},Window_ShopStatus.prototype.paramId=function(){return DataManager.isWeapon(this._item)?2:3},Window_ShopStatus.prototype.currentEquippedItem=function(t,e){for(var i=[],r=t.equips(),n=t.equipSlots(),a=0;a<n.length;a++)n[a]===e&&i.push(r[a]);for(var o=this.paramId(),s=Number.MAX_VALUE,h=null,c=0;c<i.length;c++)i[c]&&i[c].params[o]<s&&(s=i[c].params[o],h=i[c]);return h},Window_ShopStatus.prototype.update=function(){Window_Base.prototype.update.call(this),this.updatePage()},Window_ShopStatus.prototype.updatePage=function(){this.isPageChangeEnabled()&&this.isPageChangeRequested()&&this.changePage()},Window_ShopStatus.prototype.isPageChangeEnabled=function(){return this.visible&&this.maxPages()>=2},Window_ShopStatus.prototype.isPageChangeRequested=function(){return!!Input.isTriggered("shift")||!(!TouchInput.isTriggered()||!this.isTouchedInsideFrame())},Window_ShopStatus.prototype.isTouchedInsideFrame=function(){var t=this.canvasToLocalX(TouchInput.x),e=this.canvasToLocalY(TouchInput.y);return t>=0&&e>=0&&t<this.width&&e<this.height},Window_ShopStatus.prototype.changePage=function(){this._pageIndex=(this._pageIndex+1)%this.maxPages(),this.refresh(),SoundManager.playCursor()},Window_NameEdit.prototype=Object.create(Window_Base.prototype),Window_NameEdit.prototype.constructor=Window_NameEdit,Window_NameEdit.prototype.initialize=function(t,e){var i=this.windowWidth(),r=this.windowHeight(),n=(Graphics.boxWidth-i)/2,a=(Graphics.boxHeight-(r+this.fittingHeight(9)+8))/2;Window_Base.prototype.initialize.call(this,n,a,i,r),this._actor=t,this._name=t.name().slice(0,this._maxLength),this._index=this._name.length,this._maxLength=e,this._defaultName=this._name,this.deactivate(),this.refresh(),ImageManager.reserveFace(t.faceName())},Window_NameEdit.prototype.windowWidth=function(){return 480},Window_NameEdit.prototype.windowHeight=function(){return this.fittingHeight(4)},Window_NameEdit.prototype.name=function(){return this._name},Window_NameEdit.prototype.restoreDefault=function(){return this._name=this._defaultName,this._index=this._name.length,this.refresh(),this._name.length>0},Window_NameEdit.prototype.add=function(t){return this._index<this._maxLength&&(this._name+=t,this._index++,this.refresh(),!0)},Window_NameEdit.prototype.back=function(){return this._index>0&&(this._index--,this._name=this._name.slice(0,this._index),this.refresh(),!0)},Window_NameEdit.prototype.faceWidth=function(){return 144},Window_NameEdit.prototype.charWidth=function(){var t=$gameSystem.isJapanese()?"\uff21":"A";return this.textWidth(t)},Window_NameEdit.prototype.left=function(){var t=(this.contentsWidth()+this.faceWidth())/2,e=(this._maxLength+1)*this.charWidth();return Math.min(t-e/2,this.contentsWidth()-e)},Window_NameEdit.prototype.itemRect=function(t){return{x:this.left()+t*this.charWidth(),y:54,width:this.charWidth(),height:this.lineHeight()}},Window_NameEdit.prototype.underlineRect=function(t){var e=this.itemRect(t);return e.x++,e.y+=e.height-4,e.width-=2,e.height=2,e},Window_NameEdit.prototype.underlineColor=function(){return this.normalColor()},Window_NameEdit.prototype.drawUnderline=function(t){var e=this.underlineRect(t),i=this.underlineColor();this.contents.paintOpacity=48,this.contents.fillRect(e.x,e.y,e.width,e.height,i),this.contents.paintOpacity=255},Window_NameEdit.prototype.drawChar=function(t){var e=this.itemRect(t);this.resetTextColor(),this.drawText(this._name[t]||"",e.x,e.y)},Window_NameEdit.prototype.refresh=function(){this.contents.clear(),this.drawActorFace(this._actor,0,0);for(var t=0;t<this._maxLength;t++)this.drawUnderline(t);for(var e=0;e<this._name.length;e++)this.drawChar(e);var i=this.itemRect(this._index);this.setCursorRect(i.x,i.y,i.width,i.height)},Window_NameInput.prototype=Object.create(Window_Selectable.prototype),Window_NameInput.prototype.constructor=Window_NameInput,Window_NameInput.LATIN1=["A","B","C","D","E","a","b","c","d","e","F","G","H","I","J","f","g","h","i","j","K","L","M","N","O","k","l","m","n","o","P","Q","R","S","T","p","q","r","s","t","U","V","W","X","Y","u","v","w","x","y","Z","[","]","^","_","z","{","}","|","~","0","1","2","3","4","!","#","$","%","&","5","6","7","8","9","(",")","*","+","-","/","=","@","<",">",":",";"," ","Page","OK"],Window_NameInput.LATIN2=["\xc1","\xc9","\xcd","\xd3","\xda","\xe1","\xe9","\xed","\xf3","\xfa","\xc0","\xc8","\xcc","\xd2","\xd9","\xe0","\xe8","\xec","\xf2","\xf9","\xc2","\xca","\xce","\xd4","\xdb","\xe2","\xea","\xee","\xf4","\xfb","\xc4","\xcb","\xcf","\xd6","\xdc","\xe4","\xeb","\xef","\xf6","\xfc","\u0100","\u0112","\u012a","\u014c","\u016a","\u0101","\u0113","\u012b","\u014d","\u016b","\xc3","\xc5","\xc6","\xc7","\xd0","\xe3","\xe5","\xe6","\xe7","\xf0","\xd1","\xd5","\xd8","\u0160","\u0174","\xf1","\xf5","\xf8","\u0161","\u0175","\xdd","\u0176","\u0178","\u017d","\xde","\xfd","\xff","\u0177","\u017e","\xfe","\u0132","\u0152","\u0133","\u0153","\xdf","\xab","\xbb"," ","Page","OK"],Window_NameInput.RUSSIA=["\u0410","\u0411","\u0412","\u0413","\u0414","\u0430","\u0431","\u0432","\u0433","\u0434","\u0415","\u0401","\u0416","\u0417","\u0418","\u0435","\u0451","\u0436","\u0437","\u0438","\u0419","\u041a","\u041b","\u041c","\u041d","\u0439","\u043a","\u043b","\u043c","\u043d","\u041e","\u041f","\u0420","\u0421","\u0422","\u043e","\u043f","\u0440","\u0441","\u0442","\u0423","\u0424","\u0425","\u0426","\u0427","\u0443","\u0444","\u0445","\u0446","\u0447","\u0428","\u0429","\u042a","\u042b","\u042c","\u0448","\u0449","\u044a","\u044b","\u044c","\u042d","\u042e","\u042f","^","_","\u044d","\u044e","\u044f","%","&","0","1","2","3","4","(",")","*","+","-","5","6","7","8","9",":",";"," ","","OK"],Window_NameInput.JAPAN1=["\u3042","\u3044","\u3046","\u3048","\u304a","\u304c","\u304e","\u3050","\u3052","\u3054","\u304b","\u304d","\u304f","\u3051","\u3053","\u3056","\u3058","\u305a","\u305c","\u305e","\u3055","\u3057","\u3059","\u305b","\u305d","\u3060","\u3062","\u3065","\u3067","\u3069","\u305f","\u3061","\u3064","\u3066","\u3068","\u3070","\u3073","\u3076","\u3079","\u307c","\u306a","\u306b","\u306c","\u306d","\u306e","\u3071","\u3074","\u3077","\u307a","\u307d","\u306f","\u3072","\u3075","\u3078","\u307b","\u3041","\u3043","\u3045","\u3047","\u3049","\u307e","\u307f","\u3080","\u3081","\u3082","\u3063","\u3083","\u3085","\u3087","\u308e","\u3084","\u3086","\u3088","\u308f","\u3093","\u30fc","\uff5e","\u30fb","\uff1d","\u2606","\u3089","\u308a","\u308b","\u308c","\u308d","\u3094","\u3092","\u3000","\u30ab\u30ca","\u6c7a\u5b9a"],Window_NameInput.JAPAN2=["\u30a2","\u30a4","\u30a6","\u30a8","\u30aa","\u30ac","\u30ae","\u30b0","\u30b2","\u30b4","\u30ab","\u30ad","\u30af","\u30b1","\u30b3","\u30b6","\u30b8","\u30ba","\u30bc","\u30be","\u30b5","\u30b7","\u30b9","\u30bb","\u30bd","\u30c0","\u30c2","\u30c5","\u30c7","\u30c9","\u30bf","\u30c1","\u30c4","\u30c6","\u30c8","\u30d0","\u30d3","\u30d6","\u30d9","\u30dc","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30d1","\u30d4","\u30d7","\u30da","\u30dd","\u30cf","\u30d2","\u30d5","\u30d8","\u30db","\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30c3","\u30e3","\u30e5","\u30e7","\u30ee","\u30e4","\u30e6","\u30e8","\u30ef","\u30f3","\u30fc","\uff5e","\u30fb","\uff1d","\u2606","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30f4","\u30f2","\u3000","\u82f1\u6570","\u6c7a\u5b9a"],Window_NameInput.JAPAN3=["\uff21","\uff22","\uff23","\uff24","\uff25","\uff41","\uff42","\uff43","\uff44","\uff45","\uff26","\uff27","\uff28","\uff29","\uff2a","\uff46","\uff47","\uff48","\uff49","\uff4a","\uff2b","\uff2c","\uff2d","\uff2e","\uff2f","\uff4b","\uff4c","\uff4d","\uff4e","\uff4f","\uff30","\uff31","\uff32","\uff33","\uff34","\uff50","\uff51","\uff52","\uff53","\uff54","\uff35","\uff36","\uff37","\uff38","\uff39","\uff55","\uff56","\uff57","\uff58","\uff59","\uff3a","\uff3b","\uff3d","\uff3e","\uff3f","\uff5a","\uff5b","\uff5d","\uff5c","\uff5e","\uff10","\uff11","\uff12","\uff13","\uff14","\uff01","\uff03","\uff04","\uff05","\uff06","\uff15","\uff16","\uff17","\uff18","\uff19","\uff08","\uff09","\uff0a","\uff0b","\uff0d","\uff0f","\uff1d","\uff20","\uff1c","\uff1e","\uff1a","\uff1b","\u3000","\u304b\u306a","\u6c7a\u5b9a"],Window_NameInput.prototype.initialize=function(t){var e=t.x,i=t.y+t.height+8,r=t.width,n=this.windowHeight();Window_Selectable.prototype.initialize.call(this,e,i,r,n),this._editWindow=t,this._page=0,this._index=0,this.refresh(),this.updateCursor(),this.activate()},Window_NameInput.prototype.windowHeight=function(){return this.fittingHeight(9)},Window_NameInput.prototype.table=function(){return $gameSystem.isJapanese()?[Window_NameInput.JAPAN1,Window_NameInput.JAPAN2,Window_NameInput.JAPAN3]:$gameSystem.isRussian()?[Window_NameInput.RUSSIA]:[Window_NameInput.LATIN1,Window_NameInput.LATIN2]},Window_NameInput.prototype.maxCols=function(){return 10},Window_NameInput.prototype.maxItems=function(){return 90},Window_NameInput.prototype.character=function(){return this._index<88?this.table()[this._page][this._index]:""},Window_NameInput.prototype.isPageChange=function(){return 88===this._index},Window_NameInput.prototype.isOk=function(){return 89===this._index},Window_NameInput.prototype.itemRect=function(t){return{x:t%10*42+24*Math.floor(t%10/5),y:Math.floor(t/10)*this.lineHeight(),width:42,height:this.lineHeight()}},Window_NameInput.prototype.refresh=function(){var t=this.table();this.contents.clear(),this.resetTextColor();for(var e=0;e<90;e++){var i=this.itemRect(e);i.x+=3,i.width-=6,this.drawText(t[this._page][e],i.x,i.y,i.width,"center")}},Window_NameInput.prototype.updateCursor=function(){var t=this.itemRect(this._index);this.setCursorRect(t.x,t.y,t.width,t.height)},Window_NameInput.prototype.isCursorMovable=function(){return this.active},Window_NameInput.prototype.cursorDown=function(t){(this._index<80||t)&&(this._index=(this._index+10)%90)},Window_NameInput.prototype.cursorUp=function(t){(this._index>=10||t)&&(this._index=(this._index+80)%90)},Window_NameInput.prototype.cursorRight=function(t){this._index%10<9?this._index++:t&&(this._index-=9)},Window_NameInput.prototype.cursorLeft=function(t){this._index%10>0?this._index--:t&&(this._index+=9)},Window_NameInput.prototype.cursorPagedown=function(){this._page=(this._page+1)%this.table().length,this.refresh()},Window_NameInput.prototype.cursorPageup=function(){this._page=(this._page+this.table().length-1)%this.table().length,this.refresh()},Window_NameInput.prototype.processCursorMove=function(){var t=this._page;Window_Selectable.prototype.processCursorMove.call(this),this.updateCursor(),this._page!==t&&SoundManager.playCursor()},Window_NameInput.prototype.processHandling=function(){this.isOpen()&&this.active&&(Input.isTriggered("shift")&&this.processJump(),Input.isRepeated("cancel")&&this.processBack(),Input.isRepeated("ok")&&this.processOk())},Window_NameInput.prototype.isCancelEnabled=function(){return!0},Window_NameInput.prototype.processCancel=function(){this.processBack()},Window_NameInput.prototype.processJump=function(){89!==this._index&&(this._index=89,SoundManager.playCursor())},Window_NameInput.prototype.processBack=function(){this._editWindow.back()&&SoundManager.playCancel()},Window_NameInput.prototype.processOk=function(){this.character()?this.onNameAdd():this.isPageChange()?(SoundManager.playOk(),this.cursorPagedown()):this.isOk()&&this.onNameOk()},Window_NameInput.prototype.onNameAdd=function(){this._editWindow.add(this.character())?SoundManager.playOk():SoundManager.playBuzzer()},Window_NameInput.prototype.onNameOk=function(){""===this._editWindow.name()?this._editWindow.restoreDefault()?SoundManager.playOk():SoundManager.playBuzzer():(SoundManager.playOk(),this.callOkHandler())},Window_ChoiceList.prototype=Object.create(Window_Command.prototype),Window_ChoiceList.prototype.constructor=Window_ChoiceList,Window_ChoiceList.prototype.initialize=function(t){this._messageWindow=t,Window_Command.prototype.initialize.call(this,0,0),this.openness=0,this.deactivate(),this._background=0},Window_ChoiceList.prototype.start=function(){this.updatePlacement(),this.updateBackground(),this.refresh(),this.selectDefault(),this.open(),this.activate()},Window_ChoiceList.prototype.selectDefault=function(){this.select($gameMessage.choiceDefaultType())},Window_ChoiceList.prototype.updatePlacement=function(){var t=$gameMessage.choicePositionType(),e=this._messageWindow.y;switch(this.width=this.windowWidth(),this.height=this.windowHeight(),t){case 0:this.x=0;break;case 1:this.x=(Graphics.boxWidth-this.width)/2;break;case 2:this.x=Graphics.boxWidth-this.width}this.y=e>=Graphics.boxHeight/2?e-this.height:e+this._messageWindow.height},Window_ChoiceList.prototype.updateBackground=function(){this._background=$gameMessage.choiceBackground(),this.setBackgroundType(this._background)},Window_ChoiceList.prototype.windowWidth=function(){var t=this.maxChoiceWidth()+2*this.padding;return Math.min(t,Graphics.boxWidth)},Window_ChoiceList.prototype.numVisibleRows=function(){var t=this._messageWindow.y,e=this._messageWindow.height,i=Graphics.boxHeight/2,r=$gameMessage.choices().length,n=8;return t<i&&t+e>i&&(n=4),r>n&&(r=n),r},Window_ChoiceList.prototype.maxChoiceWidth=function(){for(var t=96,e=$gameMessage.choices(),i=0;i<e.length;i++){var r=this.textWidthEx(e[i])+2*this.textPadding();t<r&&(t=r)}return t},Window_ChoiceList.prototype.textWidthEx=function(t){return this.drawTextEx(t,0,this.contents.height)},Window_ChoiceList.prototype.contentsHeight=function(){return this.maxItems()*this.itemHeight()},Window_ChoiceList.prototype.makeCommandList=function(){for(var t=$gameMessage.choices(),e=0;e<t.length;e++)this.addCommand(t[e],"choice")},Window_ChoiceList.prototype.drawItem=function(t){var e=this.itemRectForText(t);this.drawTextEx(this.commandName(t),e.x,e.y)},Window_ChoiceList.prototype.isCancelEnabled=function(){return-1!==$gameMessage.choiceCancelType()},Window_ChoiceList.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_ChoiceList.prototype.callOkHandler=function(){$gameMessage.onChoice(this.index()),this._messageWindow.terminateMessage(),this.close()},Window_ChoiceList.prototype.callCancelHandler=function(){$gameMessage.onChoice($gameMessage.choiceCancelType()),this._messageWindow.terminateMessage(),this.close()},Window_NumberInput.prototype=Object.create(Window_Selectable.prototype),Window_NumberInput.prototype.constructor=Window_NumberInput,Window_NumberInput.prototype.initialize=function(t){this._messageWindow=t,Window_Selectable.prototype.initialize.call(this,0,0,0,0),this._number=0,this._maxDigits=1,this.openness=0,this.createButtons(),this.deactivate()},Window_NumberInput.prototype.start=function(){this._maxDigits=$gameMessage.numInputMaxDigits(),this._number=$gameVariables.value($gameMessage.numInputVariableId()),this._number=this._number.clamp(0,Math.pow(10,this._maxDigits)-1),this.updatePlacement(),this.placeButtons(),this.updateButtonsVisiblity(),this.createContents(),this.refresh(),this.open(),this.activate(),this.select(0)},Window_NumberInput.prototype.updatePlacement=function(){var t=this._messageWindow.y;this.width=this.windowWidth(),this.height=this.windowHeight(),this.x=(Graphics.boxWidth-this.width)/2,this.y=t>=Graphics.boxHeight/2?t-this.height-8:t+this._messageWindow.height+8},Window_NumberInput.prototype.windowWidth=function(){return this.maxCols()*this.itemWidth()+2*this.padding},Window_NumberInput.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_NumberInput.prototype.maxCols=function(){return this._maxDigits},Window_NumberInput.prototype.maxItems=function(){return this._maxDigits},Window_NumberInput.prototype.spacing=function(){return 0},Window_NumberInput.prototype.itemWidth=function(){return 32},Window_NumberInput.prototype.createButtons=function(){var t=ImageManager.loadSystem("ButtonSet");this._buttons=[];for(var e=0;e<3;e++){var i=new Sprite_Button,r=48*[1,2,4][e],n=48*(2===e?2:1);i.bitmap=t,i.setColdFrame(r,0,n,48),i.setHotFrame(r,48,n,48),i.visible=!1,this._buttons.push(i),this.addChild(i)}this._buttons[0].setClickHandler(this.onButtonDown.bind(this)),this._buttons[1].setClickHandler(this.onButtonUp.bind(this)),this._buttons[2].setClickHandler(this.onButtonOk.bind(this))},Window_NumberInput.prototype.placeButtons=function(){for(var t=this._buttons.length,e=-16,i=0;i<t;i++)e+=this._buttons[i].width+16;for(var r=(this.width-e)/2,n=0;n<t;n++){var a=this._buttons[n];a.x=r,a.y=this.buttonY(),r+=a.width+16}},Window_NumberInput.prototype.updateButtonsVisiblity=function(){TouchInput.date>Input.date?this.showButtons():this.hideButtons()},Window_NumberInput.prototype.showButtons=function(){for(var t=0;t<this._buttons.length;t++)this._buttons[t].visible=!0},Window_NumberInput.prototype.hideButtons=function(){for(var t=0;t<this._buttons.length;t++)this._buttons[t].visible=!1},Window_NumberInput.prototype.buttonY=function(){return this._messageWindow.y>=Graphics.boxHeight/2?0-this._buttons[0].height-8:this.height+8},Window_NumberInput.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.processDigitChange()},Window_NumberInput.prototype.processDigitChange=function(){this.isOpenAndActive()&&(Input.isRepeated("up")?this.changeDigit(!0):Input.isRepeated("down")&&this.changeDigit(!1))},Window_NumberInput.prototype.changeDigit=function(t){var e=this.index(),i=Math.pow(10,this._maxDigits-1-e),r=Math.floor(this._number/i)%10;this._number-=r*i,this._number+=(r=t?(r+1)%10:(r+9)%10)*i,this.refresh(),SoundManager.playCursor()},Window_NumberInput.prototype.isTouchOkEnabled=function(){return!1},Window_NumberInput.prototype.isOkEnabled=function(){return!0},Window_NumberInput.prototype.isCancelEnabled=function(){return!1},Window_NumberInput.prototype.isOkTriggered=function(){return Input.isTriggered("ok")},Window_NumberInput.prototype.processOk=function(){SoundManager.playOk(),$gameVariables.setValue($gameMessage.numInputVariableId(),this._number),this._messageWindow.terminateMessage(),this.updateInputData(),this.deactivate(),this.close()},Window_NumberInput.prototype.drawItem=function(t){var e=this.itemRect(t),i=this._number.padZero(this._maxDigits).slice(t,t+1);this.resetTextColor(),this.drawText(i,e.x,e.y,e.width,"center")},Window_NumberInput.prototype.onButtonUp=function(){this.changeDigit(!0)};Window_NumberInput.prototype.onButtonDown=function(){this.changeDigit(!1)},Window_NumberInput.prototype.onButtonOk=function(){this.processOk(),this.hideButtons()},Window_EventItem.prototype=Object.create(Window_ItemList.prototype),Window_EventItem.prototype.constructor=Window_EventItem,Window_EventItem.prototype.initialize=function(t){this._messageWindow=t;var e=Graphics.boxWidth,i=this.windowHeight();Window_ItemList.prototype.initialize.call(this,0,0,e,i),this.openness=0,this.deactivate(),this.setHandler("ok",this.onOk.bind(this)),this.setHandler("cancel",this.onCancel.bind(this))},Window_EventItem.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_EventItem.prototype.numVisibleRows=function(){return 4},Window_EventItem.prototype.start=function(){this.refresh(),this.updatePlacement(),this.select(0),this.open(),this.activate()},Window_EventItem.prototype.updatePlacement=function(){this.y=this._messageWindow.y>=Graphics.boxHeight/2?0:Graphics.boxHeight-this.height},Window_EventItem.prototype.includes=function(t){var e=$gameMessage.itemChoiceItypeId();return DataManager.isItem(t)&&t.itypeId===e},Window_EventItem.prototype.isEnabled=function(t){return!0},Window_EventItem.prototype.onOk=function(){var t=this.item(),e=t?t.id:0;$gameVariables.setValue($gameMessage.itemChoiceVariableId(),e),this._messageWindow.terminateMessage(),this.close()},Window_EventItem.prototype.onCancel=function(){$gameVariables.setValue($gameMessage.itemChoiceVariableId(),0),this._messageWindow.terminateMessage(),this.close()},Window_Message.prototype=Object.create(Window_Base.prototype),Window_Message.prototype.constructor=Window_Message,Window_Message.prototype.initialize=function(){var t=this.windowWidth(),e=this.windowHeight();Window_Base.prototype.initialize.call(this,(Graphics.boxWidth-t)/2,0,t,e),this.openness=0,this.initMembers(),this.createSubWindows(),this.updatePlacement()},Window_Message.prototype.initMembers=function(){this._imageReservationId=Utils.generateRuntimeId(),this._background=0,this._positionType=2,this._waitCount=0,this._faceBitmap=null,this._textState=null,this.clearFlags()},Window_Message.prototype.subWindows=function(){return[this._goldWindow,this._choiceWindow,this._numberWindow,this._itemWindow]},Window_Message.prototype.createSubWindows=function(){this._goldWindow=new Window_Gold(0,0),this._goldWindow.x=Graphics.boxWidth-this._goldWindow.width,this._goldWindow.openness=0,this._choiceWindow=new Window_ChoiceList(this),this._numberWindow=new Window_NumberInput(this),this._itemWindow=new Window_EventItem(this)},Window_Message.prototype.windowWidth=function(){return Graphics.boxWidth},Window_Message.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_Message.prototype.clearFlags=function(){this._showFast=!1,this._lineShowFast=!1,this._pauseSkip=!1},Window_Message.prototype.numVisibleRows=function(){return 4},Window_Message.prototype.update=function(){for(this.checkToNotClose(),Window_Base.prototype.update.call(this);!this.isOpening()&&!this.isClosing();){if(this.updateWait())return;if(this.updateLoading())return;if(this.updateInput())return;if(this.updateMessage())return;if(!this.canStart())return void this.startInput();this.startMessage()}},Window_Message.prototype.checkToNotClose=function(){this.isClosing()&&this.isOpen()&&this.doesContinue()&&this.open()},Window_Message.prototype.canStart=function(){return $gameMessage.hasText()&&!$gameMessage.scrollMode()},Window_Message.prototype.startMessage=function(){this._textState={},this._textState.index=0,this._textState.text=this.convertEscapeCharacters($gameMessage.allText()),this.newPage(this._textState),this.updatePlacement(),this.updateBackground(),this.open()},Window_Message.prototype.updatePlacement=function(){this._positionType=$gameMessage.positionType(),this.y=this._positionType*(Graphics.boxHeight-this.height)/2,this._goldWindow.y=this.y>0?0:Graphics.boxHeight-this._goldWindow.height},Window_Message.prototype.updateBackground=function(){this._background=$gameMessage.background(),this.setBackgroundType(this._background)},Window_Message.prototype.terminateMessage=function(){this.close(),this._goldWindow.close(),$gameMessage.clear()},Window_Message.prototype.updateWait=function(){return this._waitCount>0&&(this._waitCount--,!0)},Window_Message.prototype.updateLoading=function(){return!(!this._faceBitmap||this._faceBitmap.isReady()&&(this.drawMessageFace(),this._faceBitmap=null,1))},Window_Message.prototype.updateInput=function(){return!!this.isAnySubWindowActive()||!!this.pause&&(this.isTriggered()&&(Input.update(),this.pause=!1,this._textState||this.terminateMessage()),!0)},Window_Message.prototype.isAnySubWindowActive=function(){return this._choiceWindow.active||this._numberWindow.active||this._itemWindow.active},Window_Message.prototype.updateMessage=function(){if(this._textState){for(;!this.isEndOfText(this._textState)&&(this.needsNewPage(this._textState)&&this.newPage(this._textState),this.updateShowFast(),this.processCharacter(this._textState),this._showFast||this._lineShowFast)&&!(this.pause||this._waitCount>0););return this.isEndOfText(this._textState)&&this.onEndOfText(),!0}return!1},Window_Message.prototype.onEndOfText=function(){this.startInput()||(this._pauseSkip?this.terminateMessage():this.startPause()),this._textState=null},Window_Message.prototype.startInput=function(){return $gameMessage.isChoice()?(this._choiceWindow.start(),!0):$gameMessage.isNumberInput()?(this._numberWindow.start(),!0):!!$gameMessage.isItemChoice()&&(this._itemWindow.start(),!0)},Window_Message.prototype.isTriggered=function(){return Input.isRepeated("ok")||Input.isRepeated("cancel")||TouchInput.isRepeated()},Window_Message.prototype.doesContinue=function(){return $gameMessage.hasText()&&!$gameMessage.scrollMode()&&!this.areSettingsChanged()},Window_Message.prototype.areSettingsChanged=function(){return this._background!==$gameMessage.background()||this._positionType!==$gameMessage.positionType()},Window_Message.prototype.updateShowFast=function(){this.isTriggered()&&(this._showFast=!0)},Window_Message.prototype.newPage=function(t){this.contents.clear(),this.resetFontSettings(),this.clearFlags(),this.loadMessageFace(),t.x=this.newLineX(),t.y=0,t.left=this.newLineX(),t.height=this.calcTextHeight(t,!1)},Window_Message.prototype.loadMessageFace=function(){this._faceBitmap=ImageManager.reserveFace($gameMessage.faceName(),0,this._imageReservationId)},Window_Message.prototype.drawMessageFace=function(){this.drawFace($gameMessage.faceName(),$gameMessage.faceIndex(),0,0),ImageManager.releaseReservation(this._imageReservationId)},Window_Message.prototype.newLineX=function(){return""===$gameMessage.faceName()?0:168},Window_Message.prototype.processNewLine=function(t){this._lineShowFast=!1,Window_Base.prototype.processNewLine.call(this,t),this.needsNewPage(t)&&this.startPause()},Window_Message.prototype.processNewPage=function(t){Window_Base.prototype.processNewPage.call(this,t),"\n"===t.text[t.index]&&t.index++,t.y=this.contents.height,this.startPause()},Window_Message.prototype.isEndOfText=function(t){return t.index>=t.text.length},Window_Message.prototype.needsNewPage=function(t){return!this.isEndOfText(t)&&t.y+t.height>this.contents.height},Window_Message.prototype.processEscapeCharacter=function(t,e){switch(t){case"$":this._goldWindow.open();break;case".":this.startWait(15);break;case"|":this.startWait(60);break;case"!":this.startPause();break;case">":this._lineShowFast=!0;break;case"<":this._lineShowFast=!1;break;case"^":this._pauseSkip=!0;break;default:Window_Base.prototype.processEscapeCharacter.call(this,t,e)}},Window_Message.prototype.startWait=function(t){this._waitCount=t},Window_Message.prototype.startPause=function(){this.startWait(10),this.pause=!0},Window_ScrollText.prototype=Object.create(Window_Base.prototype),Window_ScrollText.prototype.constructor=Window_ScrollText,Window_ScrollText.prototype.initialize=function(){Window_Base.prototype.initialize.call(this,0,0,Graphics.boxWidth,Graphics.boxHeight),this.opacity=0,this.hide(),this._text="",this._allTextHeight=0},Window_ScrollText.prototype.update=function(){Window_Base.prototype.update.call(this),$gameMessage.scrollMode()&&(this._text&&this.updateMessage(),!this._text&&$gameMessage.hasText()&&this.startMessage())},Window_ScrollText.prototype.startMessage=function(){this._text=$gameMessage.allText(),this.refresh(),this.show()},Window_ScrollText.prototype.refresh=function(){var t={index:0};t.text=this.convertEscapeCharacters(this._text),this.resetFontSettings(),this._allTextHeight=this.calcTextHeight(t,!0),this.createContents(),this.origin.y=-this.height,this.drawTextEx(this._text,this.textPadding(),1)},Window_ScrollText.prototype.contentsHeight=function(){return Math.max(this._allTextHeight,1)},Window_ScrollText.prototype.updateMessage=function(){this.origin.y+=this.scrollSpeed(),this.origin.y>=this.contents.height&&this.terminateMessage()},Window_ScrollText.prototype.scrollSpeed=function(){var t=$gameMessage.scrollSpeed()/2;return this.isFastForward()&&(t*=this.fastForwardRate()),t},Window_ScrollText.prototype.isFastForward=function(){return!$gameMessage.scrollNoFast()&&(Input.isPressed("ok")||Input.isPressed("shift")||TouchInput.isPressed())},Window_ScrollText.prototype.fastForwardRate=function(){return 3},Window_ScrollText.prototype.terminateMessage=function(){this._text=null,$gameMessage.clear(),this.hide()},Window_MapName.prototype=Object.create(Window_Base.prototype),Window_MapName.prototype.constructor=Window_MapName,Window_MapName.prototype.initialize=function(){var t=this.windowWidth(),e=this.windowHeight();Window_Base.prototype.initialize.call(this,0,0,t,e),this.opacity=0,this.contentsOpacity=0,this._showCount=0,this.refresh()},Window_MapName.prototype.windowWidth=function(){return 360},Window_MapName.prototype.windowHeight=function(){return this.fittingHeight(1)},Window_MapName.prototype.update=function(){Window_Base.prototype.update.call(this),this._showCount>0&&$gameMap.isNameDisplayEnabled()?(this.updateFadeIn(),this._showCount--):this.updateFadeOut()},Window_MapName.prototype.updateFadeIn=function(){this.contentsOpacity+=16},Window_MapName.prototype.updateFadeOut=function(){this.contentsOpacity-=16},Window_MapName.prototype.open=function(){this.refresh(),this._showCount=150},Window_MapName.prototype.close=function(){this._showCount=0},Window_MapName.prototype.refresh=function(){if(this.contents.clear(),$gameMap.displayName()){var t=this.contentsWidth();this.drawBackground(0,0,t,this.lineHeight()),this.drawText($gameMap.displayName(),0,0,t,"center")}},Window_MapName.prototype.drawBackground=function(t,e,i,r){var n=this.dimColor1(),a=this.dimColor2();this.contents.gradientFillRect(t,e,i/2,r,a,n),this.contents.gradientFillRect(t+i/2,e,i/2,r,n,a)},Window_BattleLog.prototype=Object.create(Window_Selectable.prototype),Window_BattleLog.prototype.constructor=Window_BattleLog,Window_BattleLog.prototype.initialize=function(){var t=this.windowWidth(),e=this.windowHeight();Window_Selectable.prototype.initialize.call(this,0,0,t,e),this.opacity=0,this._lines=[],this._methods=[],this._waitCount=0,this._waitMode="",this._baseLineStack=[],this._spriteset=null,this.createBackBitmap(),this.createBackSprite(),this.refresh()},Window_BattleLog.prototype.setSpriteset=function(t){this._spriteset=t},Window_BattleLog.prototype.windowWidth=function(){return Graphics.boxWidth},Window_BattleLog.prototype.windowHeight=function(){return this.fittingHeight(this.maxLines())},Window_BattleLog.prototype.maxLines=function(){return 10},Window_BattleLog.prototype.createBackBitmap=function(){this._backBitmap=new Bitmap(this.width,this.height)},Window_BattleLog.prototype.createBackSprite=function(){this._backSprite=new Sprite,this._backSprite.bitmap=this._backBitmap,this._backSprite.y=this.y,this.addChildToBack(this._backSprite)},Window_BattleLog.prototype.numLines=function(){return this._lines.length},Window_BattleLog.prototype.messageSpeed=function(){return 16},Window_BattleLog.prototype.isBusy=function(){return this._waitCount>0||this._waitMode||this._methods.length>0},Window_BattleLog.prototype.update=function(){this.updateWait()||this.callNextMethod()},Window_BattleLog.prototype.updateWait=function(){return this.updateWaitCount()||this.updateWaitMode()},Window_BattleLog.prototype.updateWaitCount=function(){return this._waitCount>0&&(this._waitCount-=this.isFastForward()?3:1,this._waitCount<0&&(this._waitCount=0),!0)},Window_BattleLog.prototype.updateWaitMode=function(){var t=!1;switch(this._waitMode){case"effect":t=this._spriteset.isEffecting();break;case"movement":t=this._spriteset.isAnyoneMoving()}return t||(this._waitMode=""),t},Window_BattleLog.prototype.setWaitMode=function(t){this._waitMode=t},Window_BattleLog.prototype.callNextMethod=function(){if(this._methods.length>0){var t=this._methods.shift();if(!t.name||!this[t.name])throw new Error("Method not found: "+t.name);this[t.name].apply(this,t.params)}},Window_BattleLog.prototype.isFastForward=function(){return Input.isLongPressed("ok")||Input.isPressed("shift")||TouchInput.isLongPressed()},Window_BattleLog.prototype.push=function(t){var e=Array.prototype.slice.call(arguments,1);this._methods.push({name:t,params:e})},Window_BattleLog.prototype.clear=function(){this._lines=[],this._baseLineStack=[],this.refresh()},Window_BattleLog.prototype.wait=function(){this._waitCount=this.messageSpeed()},Window_BattleLog.prototype.waitForEffect=function(){this.setWaitMode("effect")},Window_BattleLog.prototype.waitForMovement=function(){this.setWaitMode("movement")},Window_BattleLog.prototype.addText=function(t){this._lines.push(t),this.refresh(),this.wait()},Window_BattleLog.prototype.pushBaseLine=function(){this._baseLineStack.push(this._lines.length)},Window_BattleLog.prototype.popBaseLine=function(){for(var t=this._baseLineStack.pop();this._lines.length>t;)this._lines.pop()},Window_BattleLog.prototype.waitForNewLine=function(){var t=0;this._baseLineStack.length>0&&(t=this._baseLineStack[this._baseLineStack.length-1]),this._lines.length>t&&this.wait()},Window_BattleLog.prototype.popupDamage=function(t){t.startDamagePopup()},Window_BattleLog.prototype.performActionStart=function(t,e){t.performActionStart(e)},Window_BattleLog.prototype.performAction=function(t,e){t.performAction(e)},Window_BattleLog.prototype.performActionEnd=function(t){t.performActionEnd()},Window_BattleLog.prototype.performDamage=function(t){t.performDamage()},Window_BattleLog.prototype.performMiss=function(t){t.performMiss()},Window_BattleLog.prototype.performRecovery=function(t){t.performRecovery()},Window_BattleLog.prototype.performEvasion=function(t){t.performEvasion()},Window_BattleLog.prototype.performMagicEvasion=function(t){t.performMagicEvasion()},Window_BattleLog.prototype.performCounter=function(t){t.performCounter()},Window_BattleLog.prototype.performReflection=function(t){t.performReflection()},Window_BattleLog.prototype.performSubstitute=function(t,e){t.performSubstitute(e)},Window_BattleLog.prototype.performCollapse=function(t){t.performCollapse()},Window_BattleLog.prototype.showAnimation=function(t,e,i){i<0?this.showAttackAnimation(t,e):this.showNormalAnimation(e,i)},Window_BattleLog.prototype.showAttackAnimation=function(t,e){t.isActor()?this.showActorAttackAnimation(t,e):this.showEnemyAttackAnimation(t,e)},Window_BattleLog.prototype.showActorAttackAnimation=function(t,e){this.showNormalAnimation(e,t.attackAnimationId1(),!1),this.showNormalAnimation(e,t.attackAnimationId2(),!0)},Window_BattleLog.prototype.showEnemyAttackAnimation=function(t,e){SoundManager.playEnemyAttack()},Window_BattleLog.prototype.showNormalAnimation=function(t,e,i){if($dataAnimations[e]){var r=this.animationBaseDelay(),n=this.animationNextDelay();t.forEach(function(t){t.startAnimation(e,i,r),r+=n})}},Window_BattleLog.prototype.animationBaseDelay=function(){return 8},Window_BattleLog.prototype.animationNextDelay=function(){return 12},Window_BattleLog.prototype.refresh=function(){this.drawBackground(),this.contents.clear();for(var t=0;t<this._lines.length;t++)this.drawLineText(t)},Window_BattleLog.prototype.drawBackground=function(){var t=this.backRect(),e=this.backColor();this._backBitmap.clear(),this._backBitmap.paintOpacity=this.backPaintOpacity(),this._backBitmap.fillRect(t.x,t.y,t.width,t.height,e),this._backBitmap.paintOpacity=255},Window_BattleLog.prototype.backRect=function(){return{x:0,y:this.padding,width:this.width,height:this.numLines()*this.lineHeight()}},Window_BattleLog.prototype.backColor=function(){return"#000000"},Window_BattleLog.prototype.backPaintOpacity=function(){return 64},Window_BattleLog.prototype.drawLineText=function(t){var e=this.itemRectForText(t);this.contents.clearRect(e.x,e.y,e.width,e.height),this.drawTextEx(this._lines[t],e.x,e.y,e.width)},Window_BattleLog.prototype.startTurn=function(){this.push("wait")},Window_BattleLog.prototype.startAction=function(t,e,i){var r=e.item();this.push("performActionStart",t,e),this.push("waitForMovement"),this.push("performAction",t,e),this.push("showAnimation",t,i.clone(),r.animationId),this.displayAction(t,r)},Window_BattleLog.prototype.endAction=function(t){this.push("waitForNewLine"),this.push("clear"),this.push("performActionEnd",t)},Window_BattleLog.prototype.displayCurrentState=function(t){var e=t.mostImportantStateText();e&&(this.push("addText",t.name()+e),this.push("wait"),this.push("clear"))},Window_BattleLog.prototype.displayRegeneration=function(t){this.push("popupDamage",t)},Window_BattleLog.prototype.displayAction=function(t,e){var i=this._methods.length;DataManager.isSkill(e)?(e.message1&&this.push("addText",t.name()+e.message1.format(e.name)),e.message2&&this.push("addText",e.message2.format(e.name))):this.push("addText",TextManager.useItem.format(t.name(),e.name)),this._methods.length===i&&this.push("wait")},Window_BattleLog.prototype.displayCounter=function(t){this.push("performCounter",t),this.push("addText",TextManager.counterAttack.format(t.name()))},Window_BattleLog.prototype.displayReflection=function(t){this.push("performReflection",t),this.push("addText",TextManager.magicReflection.format(t.name()))},Window_BattleLog.prototype.displaySubstitute=function(t,e){var i=t.name();this.push("performSubstitute",t,e),this.push("addText",TextManager.substitute.format(i,e.name()))},Window_BattleLog.prototype.displayActionResults=function(t,e){e.result().used&&(this.push("pushBaseLine"),this.displayCritical(e),this.push("popupDamage",e),this.push("popupDamage",t),this.displayDamage(e),this.displayAffectedStatus(e),this.displayFailure(e),this.push("waitForNewLine"),this.push("popBaseLine"))},Window_BattleLog.prototype.displayFailure=function(t){t.result().isHit()&&!t.result().success&&this.push("addText",TextManager.actionFailure.format(t.name()))},Window_BattleLog.prototype.displayCritical=function(t){t.result().critical&&(t.isActor()?this.push("addText",TextManager.criticalToActor):this.push("addText",TextManager.criticalToEnemy))},Window_BattleLog.prototype.displayDamage=function(t){t.result().missed?this.displayMiss(t):t.result().evaded?this.displayEvasion(t):(this.displayHpDamage(t),this.displayMpDamage(t),this.displayTpDamage(t))},Window_BattleLog.prototype.displayMiss=function(t){var e;t.result().physical?(e=t.isActor()?TextManager.actorNoHit:TextManager.enemyNoHit,this.push("performMiss",t)):e=TextManager.actionFailure,this.push("addText",e.format(t.name()))},Window_BattleLog.prototype.displayEvasion=function(t){var e;t.result().physical?(e=TextManager.evasion,this.push("performEvasion",t)):(e=TextManager.magicEvasion,this.push("performMagicEvasion",t)),this.push("addText",e.format(t.name()))},Window_BattleLog.prototype.displayHpDamage=function(t){t.result().hpAffected&&(t.result().hpDamage>0&&!t.result().drain&&this.push("performDamage",t),t.result().hpDamage<0&&this.push("performRecovery",t),this.push("addText",this.makeHpDamageText(t)))},Window_BattleLog.prototype.displayMpDamage=function(t){t.isAlive()&&0!==t.result().mpDamage&&(t.result().mpDamage<0&&this.push("performRecovery",t),this.push("addText",this.makeMpDamageText(t)))},Window_BattleLog.prototype.displayTpDamage=function(t){t.isAlive()&&0!==t.result().tpDamage&&(t.result().tpDamage<0&&this.push("performRecovery",t),this.push("addText",this.makeTpDamageText(t)))},Window_BattleLog.prototype.displayAffectedStatus=function(t){t.result().isStatusAffected()&&(this.push("pushBaseLine"),this.displayChangedStates(t),this.displayChangedBuffs(t),this.push("waitForNewLine"),this.push("popBaseLine"))},Window_BattleLog.prototype.displayAutoAffectedStatus=function(t){t.result().isStatusAffected()&&(this.displayAffectedStatus(t,null),this.push("clear"))},Window_BattleLog.prototype.displayChangedStates=function(t){this.displayAddedStates(t),this.displayRemovedStates(t)},Window_BattleLog.prototype.displayAddedStates=function(t){t.result().addedStateObjects().forEach(function(e){var i=t.isActor()?e.message1:e.message2;e.id===t.deathStateId()&&this.push("performCollapse",t),i&&(this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",t.name()+i),this.push("waitForEffect"))},this)},Window_BattleLog.prototype.displayRemovedStates=function(t){t.result().removedStateObjects().forEach(function(e){e.message4&&(this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",t.name()+e.message4))},this)},Window_BattleLog.prototype.displayChangedBuffs=function(t){var e=t.result();this.displayBuffs(t,e.addedBuffs,TextManager.buffAdd),this.displayBuffs(t,e.addedDebuffs,TextManager.debuffAdd),this.displayBuffs(t,e.removedBuffs,TextManager.buffRemove)},Window_BattleLog.prototype.displayBuffs=function(t,e,i){e.forEach(function(e){this.push("popBaseLine"),this.push("pushBaseLine"),this.push("addText",i.format(t.name(),TextManager.param(e)))},this)},Window_BattleLog.prototype.makeHpDamageText=function(t){var e=t.result(),i=e.hpDamage,r=t.isActor();return i>0&&e.drain?(r?TextManager.actorDrain:TextManager.enemyDrain).format(t.name(),TextManager.hp,i):i>0?(r?TextManager.actorDamage:TextManager.enemyDamage).format(t.name(),i):i<0?(r?TextManager.actorRecovery:TextManager.enemyRecovery).format(t.name(),TextManager.hp,-i):(r?TextManager.actorNoDamage:TextManager.enemyNoDamage).format(t.name())},Window_BattleLog.prototype.makeMpDamageText=function(t){var e=t.result(),i=e.mpDamage,r=t.isActor();return i>0&&e.drain?(r?TextManager.actorDrain:TextManager.enemyDrain).format(t.name(),TextManager.mp,i):i>0?(r?TextManager.actorLoss:TextManager.enemyLoss).format(t.name(),TextManager.mp,i):i<0?(r?TextManager.actorRecovery:TextManager.enemyRecovery).format(t.name(),TextManager.mp,-i):""},Window_BattleLog.prototype.makeTpDamageText=function(t){var e=t.result().tpDamage,i=t.isActor();return e>0?(i?TextManager.actorLoss:TextManager.enemyLoss).format(t.name(),TextManager.tp,e):e<0?(i?TextManager.actorGain:TextManager.enemyGain).format(t.name(),TextManager.tp,-e):""},Window_PartyCommand.prototype=Object.create(Window_Command.prototype),Window_PartyCommand.prototype.constructor=Window_PartyCommand,Window_PartyCommand.prototype.initialize=function(){var t=Graphics.boxHeight-this.windowHeight();Window_Command.prototype.initialize.call(this,0,t),this.openness=0,this.deactivate()},Window_PartyCommand.prototype.windowWidth=function(){return 192},Window_PartyCommand.prototype.numVisibleRows=function(){return 4},Window_PartyCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.fight,"fight"),this.addCommand(TextManager.escape,"escape",BattleManager.canEscape())},Window_PartyCommand.prototype.setup=function(){this.clearCommandList(),this.makeCommandList(),this.refresh(),this.select(0),this.activate(),this.open()},Window_ActorCommand.prototype=Object.create(Window_Command.prototype),Window_ActorCommand.prototype.constructor=Window_ActorCommand,Window_ActorCommand.prototype.initialize=function(){var t=Graphics.boxHeight-this.windowHeight();Window_Command.prototype.initialize.call(this,0,t),this.openness=0,this.deactivate(),this._actor=null},Window_ActorCommand.prototype.windowWidth=function(){return 192},Window_ActorCommand.prototype.numVisibleRows=function(){return 4},Window_ActorCommand.prototype.makeCommandList=function(){this._actor&&(this.addSkillCommands(),this.addGuardCommand(),this.addItemCommand())},Window_ActorCommand.prototype.addAttackCommand=function(){this.addCommand(TextManager.attack,"attack",this._actor.canAttack())},Window_ActorCommand.prototype.addSkillCommands=function(){var t=this._actor.addedSkillTypes();t.sort(function(t,e){return t-e}),t.forEach(function(t){this.addCommand($dataSystem.skillTypes[t],"skill",!0,t)},this)},Window_ActorCommand.prototype.addGuardCommand=function(){this.addCommand(TextManager.guard,"guard",this._actor.canGuard())},Window_ActorCommand.prototype.addItemCommand=function(){this.addCommand(TextManager.item,"item")},Window_ActorCommand.prototype.setup=function(t){this._actor=t,this.clearCommandList(),this.makeCommandList(),this.refresh(),this.selectLast(),this.activate(),this.open()},Window_ActorCommand.prototype.processOk=function(){this._actor&&this._actor.setLastCommandSymbol(ConfigManager.commandRemember?this.currentSymbol():""),Window_Command.prototype.processOk.call(this)},Window_ActorCommand.prototype.selectLast=function(){if(this.select(0),this._actor&&ConfigManager.commandRemember){var t=this._actor.lastCommandSymbol();if(this.selectSymbol(t),"skill"===t){var e=this._actor.lastBattleSkill();e&&this.selectExt(e.stypeId)}}},Window_BattleStatus.prototype=Object.create(Window_Selectable.prototype),Window_BattleStatus.prototype.constructor=Window_BattleStatus,Window_BattleStatus.prototype.initialize=function(){var t=this.windowWidth(),e=this.windowHeight();Window_Selectable.prototype.initialize.call(this,Graphics.boxWidth-t,Graphics.boxHeight-e,t,e),this.refresh(),this.openness=0},Window_BattleStatus.prototype.windowWidth=function(){return Graphics.boxWidth-192},Window_BattleStatus.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_BattleStatus.prototype.numVisibleRows=function(){return 4},Window_BattleStatus.prototype.maxItems=function(){return $gameParty.battleMembers().length},Window_BattleStatus.prototype.refresh=function(){this.contents.clear(),this.drawAllItems()},Window_BattleStatus.prototype.drawItem=function(t){var e=$gameParty.battleMembers()[t];this.drawBasicArea(this.basicAreaRect(t),e),this.drawGaugeArea(this.gaugeAreaRect(t),e)},Window_BattleStatus.prototype.basicAreaRect=function(t){var e=this.itemRectForText(t);return e.width-=this.gaugeAreaWidth()+15,e},Window_BattleStatus.prototype.gaugeAreaRect=function(t){var e=this.itemRectForText(t);return e.x+=e.width-this.gaugeAreaWidth(),e.width=this.gaugeAreaWidth(),e},Window_BattleStatus.prototype.gaugeAreaWidth=function(){return 330},Window_BattleStatus.prototype.drawBasicArea=function(t,e){this.drawActorName(e,t.x+0,t.y,150),this.drawActorIcons(e,t.x+156,t.y,t.width-156)},Window_BattleStatus.prototype.drawGaugeArea=function(t,e){$dataSystem.optDisplayTp?this.drawGaugeAreaWithTp(t,e):this.drawGaugeAreaWithoutTp(t,e)},Window_BattleStatus.prototype.drawGaugeAreaWithTp=function(t,e){this.drawActorHp(e,t.x+0,t.y,108),this.drawActorMp(e,t.x+123,t.y,96),this.drawActorTp(e,t.x+234,t.y,96)},Window_BattleStatus.prototype.drawGaugeAreaWithoutTp=function(t,e){this.drawActorHp(e,t.x+0,t.y,201),this.drawActorMp(e,t.x+216,t.y,114)},Window_BattleActor.prototype=Object.create(Window_BattleStatus.prototype),Window_BattleActor.prototype.constructor=Window_BattleActor,Window_BattleActor.prototype.initialize=function(t,e){Window_BattleStatus.prototype.initialize.call(this),this.x=t,this.y=e,this.openness=255,this.hide()},Window_BattleActor.prototype.show=function(){this.select(0),Window_BattleStatus.prototype.show.call(this)},Window_BattleActor.prototype.hide=function(){Window_BattleStatus.prototype.hide.call(this),$gameParty.select(null)},Window_BattleActor.prototype.select=function(t){Window_BattleStatus.prototype.select.call(this,t),$gameParty.select(this.actor())},Window_BattleActor.prototype.actor=function(){return $gameParty.members()[this.index()]},Window_BattleEnemy.prototype=Object.create(Window_Selectable.prototype),Window_BattleEnemy.prototype.constructor=Window_BattleEnemy,Window_BattleEnemy.prototype.initialize=function(t,e){this._enemies=[];var i=this.windowWidth(),r=this.windowHeight();Window_Selectable.prototype.initialize.call(this,t,e,i,r),this.refresh(),this.hide()},Window_BattleEnemy.prototype.windowWidth=function(){return Graphics.boxWidth-192},Window_BattleEnemy.prototype.windowHeight=function(){return this.fittingHeight(this.numVisibleRows())},Window_BattleEnemy.prototype.numVisibleRows=function(){return 4},Window_BattleEnemy.prototype.maxCols=function(){return 2},Window_BattleEnemy.prototype.maxItems=function(){return this._enemies.length},Window_BattleEnemy.prototype.enemy=function(){return this._enemies[this.index()]},Window_BattleEnemy.prototype.enemyIndex=function(){var t=this.enemy();return t?t.index():-1},Window_BattleEnemy.prototype.drawItem=function(t){this.resetTextColor();var e=this._enemies[t].name(),i=this.itemRectForText(t);this.drawText(e,i.x,i.y,i.width)},Window_BattleEnemy.prototype.show=function(){this.refresh(),this.select(0),Window_Selectable.prototype.show.call(this)},Window_BattleEnemy.prototype.hide=function(){Window_Selectable.prototype.hide.call(this),$gameTroop.select(null)},Window_BattleEnemy.prototype.refresh=function(){this._enemies=$gameTroop.aliveMembers(),Window_Selectable.prototype.refresh.call(this)},Window_BattleEnemy.prototype.select=function(t){Window_Selectable.prototype.select.call(this,t),$gameTroop.select(this.enemy())},Window_BattleSkill.prototype=Object.create(Window_SkillList.prototype),Window_BattleSkill.prototype.constructor=Window_BattleSkill,Window_BattleSkill.prototype.initialize=function(t,e,i,r){Window_SkillList.prototype.initialize.call(this,t,e,i,r),this.hide()},Window_BattleSkill.prototype.show=function(){this.selectLast(),this.showHelpWindow(),Window_SkillList.prototype.show.call(this)},Window_BattleSkill.prototype.hide=function(){this.hideHelpWindow(),Window_SkillList.prototype.hide.call(this)},Window_BattleItem.prototype=Object.create(Window_ItemList.prototype),Window_BattleItem.prototype.constructor=Window_BattleItem,Window_BattleItem.prototype.initialize=function(t,e,i,r){Window_ItemList.prototype.initialize.call(this,t,e,i,r),this.hide()},Window_BattleItem.prototype.includes=function(t){return $gameParty.canUse(t)},Window_BattleItem.prototype.show=function(){this.selectLast(),this.showHelpWindow(),Window_ItemList.prototype.show.call(this)},Window_BattleItem.prototype.hide=function(){this.hideHelpWindow(),Window_ItemList.prototype.hide.call(this)},Window_TitleCommand.prototype=Object.create(Window_Command.prototype),Window_TitleCommand.prototype.constructor=Window_TitleCommand,Window_TitleCommand.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement(),this.openness=0,this.selectLast()},Window_TitleCommand._lastCommandSymbol=null,Window_TitleCommand.initCommandPosition=function(){this._lastCommandSymbol=null},Window_TitleCommand.prototype.windowWidth=function(){return 240},Window_TitleCommand.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=Graphics.boxHeight-this.height-96},Window_TitleCommand.prototype.makeCommandList=function(){this.addCommand(TextManager.newGame,"newGame"),this.addCommand(TextManager.continue_,"continue",this.isContinueEnabled()),this.addCommand(TextManager.options,"options")},Window_TitleCommand.prototype.isContinueEnabled=function(){return DataManager.isAnySavefileExists()},Window_TitleCommand.prototype.processOk=function(){Window_TitleCommand._lastCommandSymbol=this.currentSymbol(),Window_Command.prototype.processOk.call(this)},Window_TitleCommand.prototype.selectLast=function(){Window_TitleCommand._lastCommandSymbol?this.selectSymbol(Window_TitleCommand._lastCommandSymbol):this.isContinueEnabled()&&this.selectSymbol("continue")},Window_GameEnd.prototype=Object.create(Window_Command.prototype),Window_GameEnd.prototype.constructor=Window_GameEnd,Window_GameEnd.prototype.initialize=function(){Window_Command.prototype.initialize.call(this,0,0),this.updatePlacement(),this.openness=0,this.open()},Window_GameEnd.prototype.windowWidth=function(){return 240},Window_GameEnd.prototype.updatePlacement=function(){this.x=(Graphics.boxWidth-this.width)/2,this.y=(Graphics.boxHeight-this.height)/2},Window_GameEnd.prototype.makeCommandList=function(){this.addCommand(TextManager.toTitle,"toTitle"),this.addCommand(TextManager.cancel,"cancel")},Window_DebugRange.prototype=Object.create(Window_Selectable.prototype),Window_DebugRange.prototype.constructor=Window_DebugRange,Window_DebugRange.lastTopRow=0,Window_DebugRange.lastIndex=0,Window_DebugRange.prototype.initialize=function(t,e){this._maxSwitches=Math.ceil(($dataSystem.switches.length-1)/10),this._maxVariables=Math.ceil(($dataSystem.variables.length-1)/10);var i=this.windowWidth(),r=this.windowHeight();Window_Selectable.prototype.initialize.call(this,t,e,i,r),this.refresh(),this.setTopRow(Window_DebugRange.lastTopRow),this.select(Window_DebugRange.lastIndex),this.activate()},Window_DebugRange.prototype.windowWidth=function(){return 246},Window_DebugRange.prototype.windowHeight=function(){return Graphics.boxHeight},Window_DebugRange.prototype.maxItems=function(){return this._maxSwitches+this._maxVariables},Window_DebugRange.prototype.update=function(){Window_Selectable.prototype.update.call(this),this._editWindow&&(this._editWindow.setMode(this.mode()),this._editWindow.setTopId(this.topId()))},Window_DebugRange.prototype.mode=function(){return this.index()<this._maxSwitches?"switch":"variable"},Window_DebugRange.prototype.topId=function(){var t=this.index();return t<this._maxSwitches?10*t+1:10*(t-this._maxSwitches)+1},Window_DebugRange.prototype.refresh=function(){this.createContents(),this.drawAllItems()},Window_DebugRange.prototype.drawItem=function(t){var e,i,r=this.itemRectForText(t);t<this._maxSwitches?(e=10*t+1,i="S"):(e=10*(t-this._maxSwitches)+1,i="V");var n=e+9;i+=" ["+e.padZero(4)+"-"+n.padZero(4)+"]",this.drawText(i,r.x,r.y,r.width)},Window_DebugRange.prototype.isCancelTriggered=function(){return Window_Selectable.prototype.isCancelTriggered()||Input.isTriggered("debug")},Window_DebugRange.prototype.processCancel=function(){Window_Selectable.prototype.processCancel.call(this),Window_DebugRange.lastTopRow=this.topRow(),Window_DebugRange.lastIndex=this.index()},Window_DebugRange.prototype.setEditWindow=function(t){this._editWindow=t},Window_DebugEdit.prototype=Object.create(Window_Selectable.prototype),Window_DebugEdit.prototype.constructor=Window_DebugEdit,Window_DebugEdit.prototype.initialize=function(t,e,i){var r=this.fittingHeight(10);Window_Selectable.prototype.initialize.call(this,t,e,i,r),this._mode="switch",this._topId=1,this.refresh()},Window_DebugEdit.prototype.maxItems=function(){return 10},Window_DebugEdit.prototype.refresh=function(){this.contents.clear(),this.drawAllItems()},Window_DebugEdit.prototype.drawItem=function(t){var e=this._topId+t,i=e.padZero(4)+":",r=this.textWidth(i),n=this.textWidth("-00000000"),a=this.itemName(e),o=this.itemStatus(e),s=this.itemRectForText(t);this.resetTextColor(),this.drawText(i,s.x,s.y,s.width),s.x+=r,s.width-=r+n,this.drawText(a,s.x,s.y,s.width),this.drawText(o,s.x+s.width,s.y,n,"right")},Window_DebugEdit.prototype.itemName=function(t){return"switch"===this._mode?$dataSystem.switches[t]:$dataSystem.variables[t]},Window_DebugEdit.prototype.itemStatus=function(t){return"switch"===this._mode?$gameSwitches.value(t)?"[ON]":"[OFF]":String($gameVariables.value(t))},Window_DebugEdit.prototype.setMode=function(t){this._mode!==t&&(this._mode=t,this.refresh())},Window_DebugEdit.prototype.setTopId=function(t){this._topId!==t&&(this._topId=t,this.refresh())},Window_DebugEdit.prototype.currentId=function(){return this._topId+this.index()},Window_DebugEdit.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.active&&("switch"===this._mode?this.updateSwitch():this.updateVariable())},Window_DebugEdit.prototype.updateSwitch=function(){if(Input.isRepeated("ok")){var t=this.currentId();SoundManager.playCursor(),$gameSwitches.setValue(t,!$gameSwitches.value(t)),this.redrawCurrentItem()}},Window_DebugEdit.prototype.updateVariable=function(){var t=this.currentId(),e=$gameVariables.value(t);"number"==typeof e&&(Input.isRepeated("right")&&e++,Input.isRepeated("left")&&e--,Input.isRepeated("pagedown")&&(e+=10),Input.isRepeated("pageup")&&(e-=10),$gameVariables.value(t)!==e&&($gameVariables.setValue(t,e),SoundManager.playCursor(),this.redrawCurrentItem()))},function(){var t=Scene_Menu.prototype.create;Scene_Menu.prototype.create=function(){t.call(this),this._statusWindow.x=0,this._statusWindow.y=this._commandWindow.height,this._goldWindow.x=Graphics.boxWidth-this._goldWindow.width},Window_MenuCommand.prototype.windowWidth=function(){return Graphics.boxWidth},Window_MenuCommand.prototype.maxCols=function(){return 4},Window_MenuCommand.prototype.numVisibleRows=function(){return 2},Window_MenuStatus.prototype.windowWidth=function(){return Graphics.boxWidth},Window_MenuStatus.prototype.windowHeight=function(){var t=this.fittingHeight(1),e=this.fittingHeight(2);return Graphics.boxHeight-t-e},Window_MenuStatus.prototype.maxCols=function(){return 4},Window_MenuStatus.prototype.numVisibleRows=function(){return 1},Window_MenuStatus.prototype.drawItemImage=function(t){var e=$gameParty.members()[t],i=this.itemRectForText(t),r=Math.min(i.width,144),n=Math.min(i.height,144),a=this.lineHeight();this.changePaintOpacity(e.isBattleMember()),this.drawActorFace(e,i.x,i.y+2.5*a,r,n),this.changePaintOpacity(!0)},Window_MenuStatus.prototype.drawItemStatus=function(t){var e=$gameParty.members()[t],i=this.itemRectForText(t),r=i.x,n=i.y,a=i.width,o=n+i.height,s=this.lineHeight();this.drawActorName(e,r,n+0*s,a),this.drawActorLevel(e,r,n+1*s,a),this.drawActorClass(e,r,o-4*s,a),this.drawActorHp(e,r,o-3*s,a),this.drawActorMp(e,r,o-2*s,a),this.drawActorIcons(e,r,o-1*s,a)};var e=Window_MenuActor.prototype.initialize;Window_MenuActor.prototype.initialize=function(){e.call(this),this.y=this.fittingHeight(2)}}(),function(){var t=Scene_File.prototype.create;Scene_File.prototype.create=function(){t.call(this),this._listWindow.height=this._listWindow.fittingHeight(8);var e=this._listWindow.y+this._listWindow.height;this._statusWindow=new r(0,e,Graphics.boxWidth,Graphics.boxHeight-e),this._statusWindow.setMode(this.mode()),this._listWindow.statusWindow=this._statusWindow,this._listWindow.callUpdateHelp(),this.addWindow(this._statusWindow)};var e=Scene_File.prototype.start;Scene_File.prototype.start=function(){e.call(this),this._listWindow.ensureCursorVisible(),this._listWindow.callUpdateHelp()},Window_SavefileList.prototype.windowWidth=function(){return Graphics.boxWidth},Window_SavefileList.prototype.maxCols=function(){return 4},Window_SavefileList.prototype.numVisibleRows=function(){return 5},Window_SavefileList.prototype.spacing=function(){return 8},Window_SavefileList.prototype.itemHeight=function(){return 2*this.lineHeight()};var i=Window_SavefileList.prototype.callUpdateHelp;function r(){this.initialize.apply(this,arguments)}Window_SavefileList.prototype.callUpdateHelp=function(){i.call(this),this.active&&this.statusWindow&&this.statusWindow.setId(this.index()+1)},(r.prototype=Object.create(Window_Base.prototype)).constructor=r,r.prototype.initialize=function(t,e,i,r){Window_Base.prototype.initialize.call(this,t,e,i,r),this._id=1},r.prototype.setMode=function(t){this._mode=t},r.prototype.setId=function(t){this._id=t,this.refresh()},r.prototype.refresh=function(){this.contents.clear();var t=this._id,e=DataManager.isThisGameFile(t),i=DataManager.loadSavefileInfo(t),r=this.contents.rect;this.resetTextColor(),"load"===this._mode&&this.changePaintOpacity(e),this.drawFileId(t,r.x,r.y),i&&(this.changePaintOpacity(e),this.drawContents(i,r,e),this.changePaintOpacity(!0))},r.prototype.drawFileId=function(t,e,i){this.drawText(TextManager.file+" "+t,e,i,180)},r.prototype.drawContents=function(t,e,i){var r=e.y+e.height,n=r-this.lineHeight();this.drawText(t.title,e.x+192,e.y,e.width-192),i&&this.drawPartyfaces(t,e.x,r-144),this.drawText(t.playtime,e.x,n,e.width,"right")},r.prototype.drawPartyfaces=function(t,e,i){if(t&&t.faces)for(var r=0;r<t.faces.length;r++){var n=t.faces[r];this.drawFace(n[0],n[1],e+150*r,i)}}}(),function(){function t(t,e){return isNaN(t)?e:+(t||e)}var e,i,r=PluginManager.parameters("Community_Basic"),n=t(r.cacheLimit,10),a=t(r.screenWidth,816),o=t(r.screenHeight,624),s=r.renderingMode.toLowerCase(),h="on"===r.alwaysDash.toLowerCase(),c=t(r.changeWindowWidthTo,0),u=t(r.changeWindowHeightTo,0);c?e=c:a!==SceneManager._screenWidth&&(e=a),u?i=u:o!==SceneManager._screenHeight&&(i=o),ImageCache.limit=1e3*n*1e3,SceneManager._screenWidth=a,SceneManager._screenHeight=o,SceneManager._boxWidth=a,SceneManager._boxHeight=o,SceneManager.preferableRendererType=function(){return Utils.isOptionValid("canvas")?"canvas":Utils.isOptionValid("webgl")?"webgl":"canvas"===s?"canvas":"webgl"===s?"webgl":"auto"};var p=ConfigManager.applyData;ConfigManager.applyData=function(t){p.apply(this,arguments),void 0===t.alwaysDash&&(this.alwaysDash=h)};var l=SceneManager.initNwjs;SceneManager.initNwjs=function(){if(l.apply(this,arguments),Utils.isNwjs()&&e&&i){var t=e-window.innerWidth,r=i-window.innerHeight;window.moveBy(-t/2,-r/2),window.resizeBy(t,r)}}}(),function(){var t=PluginManager.parameters("EnemyBook"),e=String(t["Unknown Data"]||"??????"),i=Game_Interpreter.prototype.pluginCommand;Game_Interpreter.prototype.pluginCommand=function(t,e){if(i.call(this,t,e),"EnemyBook"===t)switch(e[0]){case"open":SceneManager.push(o);break;case"add":$gameSystem.addToEnemyBook(Number(e[1]));break;case"remove":$gameSystem.removeFromEnemyBook(Number(e[1]));break;case"complete":$gameSystem.completeEnemyBook();break;case"clear":$gameSystem.clearEnemyBook()}},Game_System.prototype.addToEnemyBook=function(t){this._enemyBookFlags||this.clearEnemyBook(),this._enemyBookFlags[t]=!0},Game_System.prototype.removeFromEnemyBook=function(t){this._enemyBookFlags&&(this._enemyBookFlags[t]=!1)},Game_System.prototype.completeEnemyBook=function(){this.clearEnemyBook();for(var t=1;t<$dataEnemies.length;t++)this._enemyBookFlags[t]=!0},Game_System.prototype.clearEnemyBook=function(){this._enemyBookFlags=[]},Game_System.prototype.isInEnemyBook=function(t){return!(!this._enemyBookFlags||!t||!this._enemyBookFlags[t.id])};var r=Game_Troop.prototype.setup;Game_Troop.prototype.setup=function(t){r.call(this,t),this.members().forEach(function(t){t.isAppeared()&&$gameSystem.addToEnemyBook(t.enemyId())},this)};var n=Game_Enemy.prototype.appear;Game_Enemy.prototype.appear=function(){n.call(this),$gameSystem.addToEnemyBook(this._enemyId)};var a=Game_Enemy.prototype.transform;function o(){this.initialize.apply(this,arguments)}function s(){this.initialize.apply(this,arguments)}function h(){this.initialize.apply(this,arguments)}Game_Enemy.prototype.transform=function(t){a.call(this,t),$gameSystem.addToEnemyBook(t)},(o.prototype=Object.create(Scene_MenuBase.prototype)).constructor=o,o.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},o.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this._indexWindow=new s(0,0),this._indexWindow.setHandler("cancel",this.popScene.bind(this));var t=this._indexWindow.height;this._statusWindow=new h(0,t,Graphics.boxWidth,Graphics.boxHeight-t),this.addWindow(this._indexWindow),this.addWindow(this._statusWindow),this._indexWindow.setStatusWindow(this._statusWindow)},(s.prototype=Object.create(Window_Selectable.prototype)).constructor=s,s.lastTopRow=0,s.lastIndex=0,s.prototype.initialize=function(t,e){var i=Graphics.boxWidth,r=this.fittingHeight(6);Window_Selectable.prototype.initialize.call(this,t,e,i,r),this.refresh(),this.setTopRow(s.lastTopRow),this.select(s.lastIndex),this.activate()},s.prototype.maxCols=function(){return 3},s.prototype.maxItems=function(){return this._list?this._list.length:0},s.prototype.setStatusWindow=function(t){this._statusWindow=t,this.updateStatus()},s.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.updateStatus()},s.prototype.updateStatus=function(){if(this._statusWindow){var t=this._list[this.index()];this._statusWindow.setEnemy(t)}},s.prototype.refresh=function(){this._list=[];for(var t=1;t<$dataEnemies.length;t++){var e=$dataEnemies[t];e.name&&"no"!==e.meta.book&&this._list.push(e)}this.createContents(),this.drawAllItems()},s.prototype.drawItem=function(t){var i,r=this._list[t],n=this.itemRectForText(t);i=$gameSystem.isInEnemyBook(r)?r.name:e,this.drawText(i,n.x,n.y,n.width)},s.prototype.processCancel=function(){Window_Selectable.prototype.processCancel.call(this),s.lastTopRow=this.topRow(),s.lastIndex=this.index()},(h.prototype=Object.create(Window_Base.prototype)).constructor=h,h.prototype.initialize=function(t,e,i,r){Window_Base.prototype.initialize.call(this,t,e,i,r),this._enemy=null,this._enemySprite=new Sprite,this._enemySprite.anchor.x=.5,this._enemySprite.anchor.y=.5,this._enemySprite.x=i/2-20,this._enemySprite.y=r/2,this.addChildToBack(this._enemySprite),this.refresh()},h.prototype.setEnemy=function(t){this._enemy!==t&&(this._enemy=t,this.refresh())},h.prototype.update=function(){if(Window_Base.prototype.update.call(this),this._enemySprite.bitmap){var t=this._enemySprite.bitmap.height,e=this.contents.height,i=1;t>e&&(i=e/t),this._enemySprite.scale.x=i,this._enemySprite.scale.y=i}},h.prototype.refresh=function(){var t=this._enemy,e=0,i=0,r=this.lineHeight();if(this.contents.clear(),t&&$gameSystem.isInEnemyBook(t)){var n,a=t.battlerName,o=t.battlerHue;n=$gameSystem.isSideView()?ImageManager.loadSvEnemy(a,o):ImageManager.loadEnemy(a,o),this._enemySprite.bitmap=n,this.resetTextColor(),this.drawText(t.name,e,i),e=this.textPadding(),i=r+this.textPadding();for(var s=0;s<8;s++)this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(s),e,i,160),this.resetTextColor(),this.drawText(t.params[s],e+160,i,60,"right"),i+=r;e=this.contents.width-280,i=r+this.textPadding(),this.resetTextColor(),this.drawText(t.exp,e,i),e+=this.textWidth(t.exp)+6,this.changeTextColor(this.systemColor()),this.drawText(TextManager.expA,e,i),e+=this.textWidth(TextManager.expA+"  "),this.resetTextColor(),this.drawText(t.gold,e,i),e+=this.textWidth(t.gold)+6,this.changeTextColor(this.systemColor()),this.drawText(TextManager.currencyUnit,e,i),e=this.contents.width-280,i+=r;for(var h=0;h<t.dropItems.length;h++){var c=t.dropItems[h];if(c.kind>0){var u=Game_Enemy.prototype.itemObject(c.kind,c.dataId);this.drawItemName(u,e,i,280),i+=r}}e=this.contents.width-480,i=this.textPadding()+7*r,this.drawTextEx(t.meta.desc1,e,i+0*r,480),this.drawTextEx(t.meta.desc2,e,i+1*r,480)}else this._enemySprite.bitmap=null}}(),function(){var t=PluginManager.parameters("ItemBook"),e=String(t["Unknown Data"]||"??????"),i=String(t["Price Text"]||"Price"),r=String(t["Equip Text"]||"Equip"),n=String(t["Type Text"]||"Type"),a=Game_Interpreter.prototype.pluginCommand;Game_Interpreter.prototype.pluginCommand=function(t,e){if(a.call(this,t,e),"ItemBook"===t)switch(e[0]){case"open":SceneManager.push(s);break;case"add":$gameSystem.addToItemBook(e[1],Number(e[2]));break;case"remove":$gameSystem.removeFromItemBook(e[1],Number(e[2]));break;case"complete":$gameSystem.completeItemBook();break;case"clear":$gameSystem.clearItemBook()}},Game_System.prototype.addToItemBook=function(t,e){this._ItemBookFlags||this.clearItemBook();var i=this.itemBookTypeToIndex(t);i>=0&&(this._ItemBookFlags[i][e]=!0)},Game_System.prototype.removeFromItemBook=function(t,e){if(this._ItemBookFlags){var i=this.itemBookTypeToIndex(t);i>=0&&(this._ItemBookFlags[i][e]=!1)}},Game_System.prototype.itemBookTypeToIndex=function(t){switch(t){case"item":return 0;case"weapon":return 1;case"armor":return 2;default:return-1}},Game_System.prototype.completeItemBook=function(){var t;for(this.clearItemBook(),t=1;t<$dataItems.length;t++)this._ItemBookFlags[0][t]=!0;for(t=1;t<$dataWeapons.length;t++)this._ItemBookFlags[1][t]=!0;for(t=1;t<$dataArmors.length;t++)this._ItemBookFlags[2][t]=!0},Game_System.prototype.clearItemBook=function(){this._ItemBookFlags=[[],[],[]]},Game_System.prototype.isInItemBook=function(t){if(this._ItemBookFlags&&t){var e=-1;return DataManager.isItem(t)?e=0:DataManager.isWeapon(t)?e=1:DataManager.isArmor(t)&&(e=2),e>=0&&!!this._ItemBookFlags[e][t.id]}return!1};var o=Game_Party.prototype.gainItem;function s(){this.initialize.apply(this,arguments)}function h(){this.initialize.apply(this,arguments)}function c(){this.initialize.apply(this,arguments)}Game_Party.prototype.gainItem=function(t,e,i){var r;o.call(this,t,e,i),t&&e>0&&(DataManager.isItem(t)?r="item":DataManager.isWeapon(t)?r="weapon":DataManager.isArmor(t)&&(r="armor"),$gameSystem.addToItemBook(r,t.id))},(s.prototype=Object.create(Scene_MenuBase.prototype)).constructor=s,s.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},s.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this._indexWindow=new h(0,0),this._indexWindow.setHandler("cancel",this.popScene.bind(this));var t=this._indexWindow.height;this._statusWindow=new c(0,t,Graphics.boxWidth,Graphics.boxHeight-t),this.addWindow(this._indexWindow),this.addWindow(this._statusWindow),this._indexWindow.setStatusWindow(this._statusWindow)},(h.prototype=Object.create(Window_Selectable.prototype)).constructor=h,h.lastTopRow=0,h.lastIndex=0,h.prototype.initialize=function(t,e){var i=Graphics.boxWidth,r=this.fittingHeight(6);Window_Selectable.prototype.initialize.call(this,t,e,i,r),this.refresh(),this.setTopRow(h.lastTopRow),this.select(h.lastIndex),this.activate()},h.prototype.maxCols=function(){return 3},h.prototype.maxItems=function(){return this._list?this._list.length:0},h.prototype.setStatusWindow=function(t){this._statusWindow=t,this.updateStatus()},h.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.updateStatus()},h.prototype.updateStatus=function(){if(this._statusWindow){var t=this._list[this.index()];this._statusWindow.setItem(t)}},h.prototype.refresh=function(){var t,e;for(this._list=[],t=1;t<$dataItems.length;t++)(e=$dataItems[t]).name&&1===e.itypeId&&"no"!==e.meta.book&&this._list.push(e);for(t=1;t<$dataWeapons.length;t++)(e=$dataWeapons[t]).name&&"no"!==e.meta.book&&this._list.push(e);for(t=1;t<$dataArmors.length;t++)(e=$dataArmors[t]).name&&"no"!==e.meta.book&&this._list.push(e);this.createContents(),this.drawAllItems()},h.prototype.drawItem=function(t){var i=this._list[t],r=this.itemRect(t),n=r.width-this.textPadding();if($gameSystem.isInItemBook(i))this.drawItemName(i,r.x,r.y,n);else{var a=Window_Base._iconWidth+4;this.drawText(e,r.x+a,r.y,n-a)}},h.prototype.processCancel=function(){Window_Selectable.prototype.processCancel.call(this),h.lastTopRow=this.topRow(),h.lastIndex=this.index()},(c.prototype=Object.create(Window_Base.prototype)).constructor=c,c.prototype.initialize=function(t,e,i,r){Window_Base.prototype.initialize.call(this,t,e,i,r)},c.prototype.setItem=function(t){this._item!==t&&(this._item=t,this.refresh())},c.prototype.refresh=function(){var t=this._item,e=0,a=0,o=this.lineHeight();if(this.contents.clear(),t&&$gameSystem.isInItemBook(t)){this.drawItemName(t,e,a),e=this.textPadding(),a=o+this.textPadding();var s=t.price>0?t.price:"-";if(this.changeTextColor(this.systemColor()),this.drawText(i,e,a,120),this.resetTextColor(),this.drawText(s,e+120,a,120,"right"),a+=o,DataManager.isWeapon(t)||DataManager.isArmor(t)){var h,c=$dataSystem.equipTypes[t.etypeId];this.changeTextColor(this.systemColor()),this.drawText(r,e,a,120),this.resetTextColor(),this.drawText(c,e+120,a,120,"right"),a+=o,h=DataManager.isWeapon(t)?$dataSystem.weaponTypes[t.wtypeId]:$dataSystem.armorTypes[t.atypeId],this.changeTextColor(this.systemColor()),this.drawText(n,e,a,120),this.resetTextColor(),this.drawText(h,e+120,a,120,"right"),e=this.textPadding()+300,a=o+this.textPadding();for(var u=2;u<8;u++)this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(u),e,a,160),this.resetTextColor(),this.drawText(t.params[u],e+160,a,60,"right"),a+=o}e=0,a=2*this.textPadding()+7*o,this.drawTextEx(t.description,e,a)}}}();var Liquidize=Liquidize||{};function Scene_Splash(){this.initialize.apply(this,arguments)}function runJs(){PluginManager.setup($plugins),SceneManager.run(Scene_Boot)}Liquidize.MadeWithMV={},Liquidize.MadeWithMV.Parameters=PluginManager.parameters("MadeWithMv"),Liquidize.MadeWithMV.ShowMV=JSON.parse(Liquidize.MadeWithMV.Parameters["Show Made With MV"]),Liquidize.MadeWithMV.MVImage=String(Liquidize.MadeWithMV.Parameters["Made with MV Image"]),Liquidize.MadeWithMV.ShowCustom=JSON.parse(Liquidize.MadeWithMV.Parameters["Show Custom Splash"]),Liquidize.MadeWithMV.CustomImage=String(Liquidize.MadeWithMV.Parameters["Custom Image"]),Liquidize.MadeWithMV.FadeOutTime=Number(Liquidize.MadeWithMV.Parameters["Fade Out Time"])||120,Liquidize.MadeWithMV.FadeInTime=Number(Liquidize.MadeWithMV.Parameters["Fade In Time"])||120,Liquidize.MadeWithMV.WaitTime=Number(Liquidize.MadeWithMV.Parameters["Wait Time"])||160,function(){var t=Scene_Boot.prototype.loadSystemImages;Scene_Boot.prototype.loadSystemImages=function(){t.call(this),Liquidize.MadeWithMV.ShowMV&&ImageManager.loadSystem(Liquidize.MadeWithMV.MVImage),Liquidize.MadeWithMV.ShowCustom&&ImageManager.loadSystem(Liquidize.MadeWithMV.CustomImage)};var e=Scene_Boot.prototype.start;Scene_Boot.prototype.start=function(){!Liquidize.MadeWithMV.ShowMV&&!Liquidize.MadeWithMV.ShowCustom||DataManager.isBattleTest()||DataManager.isEventTest()?e.call(this):SceneManager.goto(Scene_Splash)},Scene_Splash.prototype=Object.create(Scene_Base.prototype),Scene_Splash.prototype.constructor=Scene_Splash,Scene_Splash.prototype.initialize=function(){Scene_Base.prototype.initialize.call(this),this._mvSplash=null,this._customSplash=null,this._mvWaitTime=Liquidize.MadeWithMV.WaitTime,this._customWaitTime=Liquidize.MadeWithMV.WaitTime,this._mvFadeOut=!1,this._mvFadeIn=!1,this._customFadeOut=!1,this._customFadeIn=!1},Scene_Splash.prototype.create=function(){Scene_Base.prototype.create.call(this),this.createSplashes()},Scene_Splash.prototype.start=function(){Scene_Base.prototype.start.call(this),SceneManager.clearStack(),null!=this._mvSplash&&this.centerSprite(this._mvSplash),null!=this._customSplash&&this.centerSprite(this._customSplash)},Scene_Splash.prototype.update=function(){Liquidize.MadeWithMV.ShowMV&&(this._mvFadeIn?this._mvWaitTime>0&&0==this._mvFadeOut?this._mvWaitTime--:0==this._mvFadeOut&&(this._mvFadeOut=!0,this.startFadeOut(Liquidize.MadeWithMV.FadeOutTime,!1)):(this.startFadeIn(Liquidize.MadeWithMV.FadeInTime,!1),this._mvFadeIn=!0)),Liquidize.MadeWithMV.ShowCustom&&(Liquidize.MadeWithMV.ShowMV&&1==this._mvFadeOut?this._customFadeIn||0!=this._fadeDuration?this._customWaitTime>0&&0==this._customFadeOut?this._customWaitTime--:0==this._customFadeOut&&(this._customFadeOut=!0,this.startFadeOut(Liquidize.MadeWithMV.FadeOutTime,!1)):(this._customSplash.opacity=255,this._customWaitTime=Liquidize.MadeWithMV.WaitTime,this.startFadeIn(Liquidize.MadeWithMV.FadeInTime,!1),this._customFadeIn=!0):Liquidize.MadeWithMV.ShowMV||(this._customFadeIn?this._customWaitTime>0&&0==this._customFadeOut?this._customWaitTime--:0==this._customFadeOut&&(this._customFadeOut=!0,this.startFadeOut(Liquidize.MadeWithMV.FadeOutTime,!1)):(this._customSplash.opacity=255,this.startFadeIn(Liquidize.MadeWithMV.FadeInTime,!1),this._customFadeIn=!0))),Liquidize.MadeWithMV.ShowCustom?Liquidize.MadeWithMV.ShowMV&&1==this._mvFadeOut&&1==this._customFadeOut?this.gotoTitleOrTest():Liquidize.MadeWithMV.ShowMV||1!=this._customFadeOut||this.gotoTitleOrTest():1==this._mvFadeOut&&this.gotoTitleOrTest(),Scene_Base.prototype.update.call(this)},Scene_Splash.prototype.createSplashes=function(){Liquidize.MadeWithMV.ShowMV&&(this._mvSplash=new Sprite(ImageManager.loadSystem(Liquidize.MadeWithMV.MVImage)),this.addChild(this._mvSplash)),Liquidize.MadeWithMV.ShowCustom&&(this._customSplash=new Sprite(ImageManager.loadSystem(Liquidize.MadeWithMV.CustomImage)),this._customSplash.opacity=0,this.addChild(this._customSplash))},Scene_Splash.prototype.centerSprite=function(t){t.x=Graphics.width/2,t.y=Graphics.height/2,t.anchor.x=.5,t.anchor.y=.5},Scene_Splash.prototype.gotoTitleOrTest=function(){Scene_Base.prototype.start.call(this),SoundManager.preloadImportantSounds(),DataManager.isBattleTest()?(DataManager.setupBattleTest(),SceneManager.goto(Scene_Battle)):DataManager.isEventTest()?(DataManager.setupEventTest(),SceneManager.goto(Scene_Map)):(this.checkPlayerLocation(),DataManager.setupNewGame(),SceneManager.goto(Scene_Title),Window_TitleCommand.initCommandPosition()),this.updateDocumentTitle()},Scene_Splash.prototype.updateDocumentTitle=function(){document.title=$dataSystem.gameTitle},Scene_Splash.prototype.checkPlayerLocation=function(){if(0===$dataSystem.startMapId)throw new Error("Player's starting position is not set")}}(),function(){var t=PluginManager.parameters("SimpleMsgSideView"),e=0!=Number(t.displayAttack),i=Number(t.position||1),r=Window_BattleLog.prototype.addText;Window_BattleLog.prototype.addText=function(t){if($gameSystem.isSideView())return this.refresh(),void this.wait();r.call(this,t)},Window_BattleLog.prototype.addItemNameText=function(t){this._lines.push(t),this.refresh(),this.wait()};var n=Window_BattleLog.prototype.displayAction;Window_BattleLog.prototype.displayAction=function(t,i){$gameSystem.isSideView()?e||!DataManager.isSkill(i)||i.id!=t.attackSkillId()?this.push("addItemNameText",i.name):this.push("wait"):n.call(this,t,i)};var a=Window_BattleLog.prototype.drawLineText;Window_BattleLog.prototype.drawLineText=function(t){if($gameSystem.isSideView()&&1==i){var e=this.itemRectForText(t);return this.contents.clearRect(e.x,e.y,e.width,e.height),void this.drawText(this._lines[t],e.x,e.y,e.width,"center")}a.call(this,t)}}(),function(){var t=PluginManager.parameters("TitleCommandPosition"),e=Number(t["Offset X"]||0),i=Number(t["Offset Y"]||0),r=Number(t.Width||240),n=Number(t.Background||0),a=Window_TitleCommand.prototype.updatePlacement;Window_TitleCommand.prototype.updatePlacement=function(){a.call(this),this.x+=e,this.y+=i,this.setBackgroundType(n)},Window_TitleCommand.prototype.windowWidth=function(){return r}}(),function(){Game_Actor.prototype.attackSkillId=function(){var t=Game_BattlerBase.prototype.attackSkillId.call(this);if(this.hasNoWeapons())return t;var e=this.weapons()[0].meta.skill_id;return e?Number(e):t};var t=Scene_Battle.prototype.commandAttack;Scene_Battle.prototype.commandAttack=function(){BattleManager.inputtingAction().setAttack();var e=BattleManager.inputtingAction();e.needsSelection()&&e.isForOpponent()?t.call(this):this.onSelectAction()}}(),PluginManager.setup($plugins),window.onload=function(){SceneManager.run(Scene_Boot)};